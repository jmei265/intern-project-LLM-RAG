MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseAccount DiscoveryAccount DiscoverySub-techniques (4)IDNameT1087.001Local AccountT1087.002Domain AccountT1087.003Email AccountT1087.004Cloud AccountAdversaries may attempt to get a listing of valid accounts, usernames, or email addresses on a system or within a compromised environment. This information can help adversaries determine which accounts exist, which can aid in follow-on behavior such as brute-forcing, spear-phishing attacks, or account takeovers (e.g.,Valid Accounts).Adversaries may use several methods to enumerate accounts, including abuse of existing tools, built-in commands, and potential misconfigurations that leak account names and roles or permissions in the targeted environment.For examples, cloud environments typically provide easily accessible interfaces to obtain user lists.[1][2]On hosts, adversaries can use defaultPowerShelland other command line functionality to identify accounts. Information about email addresses and accounts may also be extracted by searching an infected system’s files.ID:T1087Sub-techniques:T1087.001,T1087.002,T1087.003,T1087.004ⓘTactic:DiscoveryⓘPlatforms:Azure AD, Google Workspace, IaaS, Linux, Office 365, SaaS, Windows, macOSContributors:Daniel Stepanic, Elastic; Microsoft Threat Intelligence Center (MSTIC); Travis Smith, TripwireVersion:2.4Created:31 May 2017Last Modified:12 January 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG1016FIN13FIN13has enumerated all users and their roles from a victim's main treasury system.[3]S0445ShimRatReporterShimRatReporterlisted all non-privileged and privileged accounts available on the machine.[4]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29obtained a list of users and their roles from an Exchange server usingGet-ManagementRoleAssignment.[5]S1065Woody RATWoody RATcan identify administrator accounts on an infected machine.[6]S0658XCSSETXCSSETattempts to discover accounts from various locations such as a user's Evernote, AppleID, Telegram, Skype, and WeChat data.[7]MitigationsIDMitigationDescriptionM1028Operating System ConfigurationPrevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is locatedHKLM\ SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI\EnumerateAdministrators. It can be disabled through GPO: Computer Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: E numerate administrator accounts on elevation.[8]M1018User Account ManagementManage the creation, modification, use, and permissions associated to user accounts.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor logs and other sources of command execution history for actions that could be taken to gather information about accounts, including the use of calls to cloud APIs that perform account discovery.System and network discovery techniques normally occur throughout an operation as an adversary learns the environment, and also to an extent in normal network operations. Therefore discovery data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.DS0022FileFile AccessMonitor access to file resources that contain local accounts and groups information such as/etc/passwd,/Usersdirectories, and the SAM database.If access requires high privileges, look for non-admin objects (such as users or processes) attempting to access restricted file resources.DS0009ProcessProcess CreationMonitor for processes that can be used to enumerate user accounts and groups such asnet.exeandnet1.exe, especially when executed in quick succession.[9]Information may also be acquired through Windows system management tools such asWindows Management InstrumentationandPowerShell.ReferencesAmazon. (n.d.). List Users. Retrieved August 11, 2020.Google. (2020, June 23). gcloud iam service-accounts list. Retrieved August 4, 2020.Ta, V., et al. (2022, August 8). FIN13: A Cybercriminal Threat Actor Focused on Mexico. Retrieved February 9, 2023.Yonathan Klijnsma. (2016, May 17). Mofang: A politically motivated information stealing adversary. Retrieved May 12, 2020.Cash, D. et al. (2020, December 14). Dark Halo Leverages SolarWinds Compromise to Breach Organizations. Retrieved December 29, 2020.MalwareBytes Threat Intelligence Team. (2022, August 3). Woody RAT: A new feature-rich malware spotted in the wild. Retrieved December 6, 2022.Mac Threat Response, Mobile Research Team. (2020, August 13). The XCSSET Malware: Inserts Malicious Code Into Xcode Projects, Performs UXSS Backdoor Planting in Safari, and Leverages Two Zero-day Exploits. Retrieved October 5, 2021.UCF. (n.d.). The system must require username and password to elevate a running application.. Retrieved December 18, 2017.Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 30, 2020.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.