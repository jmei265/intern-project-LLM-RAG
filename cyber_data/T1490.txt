MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseInhibit System RecoveryInhibit System RecoveryAdversaries may delete or remove built-in data and turn off services designed to aid in the recovery of a corrupted system to prevent recovery.[1][2]This may deny access to available backups and recovery options.Operating systems may contain features that can help fix corrupted systems, such as a backup catalog, volume shadow copies, and automatic repair features. Adversaries may disable or delete system recovery features to augment the effects ofData DestructionandData Encrypted for Impact.[1][2]Furthermore, adversaries may disable recovery notifications, then corrupt backups.[3]A number of native Windows utilities have been used by adversaries to disable or delete system recovery features:vssadmin.execan be used to delete all volume shadow copies on a system -vssadmin.exe delete shadows /all /quietWindows Management Instrumentationcan be used to delete volume shadow copies -wmic shadowcopy deletewbadmin.execan be used to delete the Windows Backup Catalog -wbadmin.exe delete catalog -quietbcdedit.execan be used to disable automatic Windows recovery features by modifying boot configuration data -bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled noREAgentC.execan be used to disable Windows Recovery Environment (WinRE) repair/recovery options of an infected systemdiskshadow.execan be used to delete all volume shadow copies on a system -diskshadow delete shadows all[4][5]On network devices, adversaries may leverageDisk Wipeto delete backup firmware images and reformat the file system, thenSystem Shutdown/Rebootto reload the device. Together this activity may leave network devices completely inoperable and inhibit recovery operations.Adversaries may also delete "online" backups that are connected to their network – whether via network storage media or through folders that sync to cloud services.[6]In cloud environments, adversaries may disable versioning and backup policies and delete snapshots, machine images, and prior versions of objects designed to be used in disaster recovery scenarios.[7][8]ID:T1490Sub-techniques:No sub-techniquesⓘTactic:ImpactⓘPlatforms:Containers, IaaS, Linux, Network, Windows, macOSⓘImpact Type:AvailabilityContributors:Austin Clark, @c2defense; Harjot Shah Singh; Joey Lei; Pallavi Sivakumaran, WithSecure; Yonatan Gotlib, Deep InstinctVersion:1.4Created:02 April 2019Last Modified:12 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS1129AkiraAkirawill delete system volume shadow copies via PowerShell commands.[9]S0640AvaddonAvaddondeletes backups and shadow copies using native system tools.[10][11]S0638BabukBabukhas the ability to delete shadow volumes usingvssadmin.exe delete shadows /all /quiet.[12][13]S0570BitPaymerBitPaymerattempts to remove the backup shadow files from the host usingvssadmin.exe Delete Shadows /All /Quiet.[14]S1070Black BastaBlack Bastacan delete shadow copies using vssadmin.exe.[15][16][17][18][19][20][21][22][22][23]S1068BlackCatBlackCatcan delete shadow copies usingvssadmin.exe delete shadows /all /quietandwmic.exe Shadowcopy Delete; it can also modify the boot loader usingbcdedit /set {default} recoveryenabled No.[24]S0611ClopClopcan delete the shadow volumes withvssadmin Delete Shadows /all /quietand can use bcdedit to disable recovery options.[25]S0608ConfickerConfickerresets system restore points and deletes backup files.[26]S0575ContiContican delete Windows Volume Shadow Copies usingvssadmin.[27]S1111DarkGateDarkGatecan delete system restore points through the commandcmd.exe /c vssadmin delete shadows /for=c: /all /quiet".[28]S0673DarkWatchmanDarkWatchmancan delete shadow volumes usingvssadmin.exe.[29]S0616DEATHRANSOMDEATHRANSOMcan delete volume shadow copies on compromised hosts.[30]S0659DiavolDiavolcan delete shadow copies using theIVssBackupComponentsCOM object to call theDeleteSnapshotsmethod.[31]S0605EKANSEKANSremoves backups of Volume Shadow Copies to disable any restoration capabilities.[32][33]S0618FIVEHANDSFIVEHANDShas the ability to delete volume shadow copies on compromised hosts.[30][34]S0132H1N1H1N1disable recovery options and deletes shadow copies from the victim.[35]S0617HELLOKITTYHELLOKITTYcan delete volume shadow copies on compromised hosts.[30]S0697HermeticWiperHermeticWipercan disable the VSS service on a compromised host using the service control manager.[36][37][38]S0260InvisiMoleInvisiMolecan can remove all system restore points.[39]S0389JCryJCryhas been observed deleting shadow copies to ensure that data cannot be restored easily.[40]S0449MazeMazehas attempted to delete the shadow volumes of infected machines, once before and once after the encryption process.[41][42]S0576MegaCortexMegaCortexhas deleted volume shadow copies usingvssadmin.exe.[43]S0688MeteorMeteorcan usebcdeditto delete different boot identifiers on a compromised host; it can also usevssadmin.exe delete shadows /all /quietandC:\\Windows\\system32\\wbem\\wmic.exe shadowcopy delete.[44]S0457NetwalkerNetwalkercan delete the infected system's Shadow Volumes to prevent recovery.[45][46]S0365Olympic DestroyerOlympic Destroyeruses the native Windows utilitiesvssadmin,wbadmin, andbcdeditto delete and disable operating system recovery features such as the Windows backup catalog and Windows Automatic Repair.[1]S1058PrestigePrestigecan delete the backup catalog from the target system using:c:\Windows\System32\wbadmin.exe delete catalog -quietand can also delete volume shadow copies using:\Windows\System32\vssadmin.exe delete shadows /all /quiet.[47]S0654ProLockProLockcan use vssadmin.exe to remove volume shadow copies.[48]S0583PysaPysahas the functionality to delete shadow copies.[49]S0481Ragnar LockerRagnar Lockercan delete volume shadow copies usingvssadmin delete shadows /all /quiet.[50]S0496REvilREvilcan use vssadmin to delete volume shadow copies and bcdedit to disable recovery features.[51][52][53][54][55][56][57][58][59]S0400RobbinHoodRobbinHooddeletes shadow copies to ensure that all the data cannot be restored easily.[60]S1073RoyalRoyalcan delete shadow copy backups with vssadmin.exe using the commanddelete shadows /all /quiet.[61][62][63]S0446RyukRyukhas usedvssadmin Delete Shadows /all /quietto to delete volume shadow copies andvssadmin resize shadowstorageto force deletion of shadow copies created by third-party applications.[64]S0366WannaCryWannaCryusesvssadmin,wbadmin,bcdedit, andwmicto delete and disable operating system recovery features.[65][2][66]S0612WastedLockerWastedLockercan delete shadow volumes.[67][68][69]G0102Wizard SpiderWizard Spiderhas used WMIC and vssadmin to manually delete volume shadow copies.Wizard Spiderhas also usedContiransomware to delete volume shadow copies automatically with the use of vssadmin.[70]MitigationsIDMitigationDescriptionM1053Data BackupConsider implementing IT disaster recovery plans that contain procedures for taking regular data backups that can be used to restore organizational data.[71]Ensure backups are stored off system and is protected from common methods adversaries may use to gain access and destroy the backups to prevent recovery. In cloud environments, enable versioning on storage objects where possible, and copy backups to other accounts or regions to isolate them from the original copies.[72]M1038Execution PreventionConsider using application control configured to block execution of utilities such asdiskshadow.exethat may not be required for a given system or network to prevent potential misuse by adversaries.M1028Operating System ConfigurationConsider technical controls to prevent the disabling of services or deletion of files involved in system recovery. Additionally, ensure that WinRE is enabled using the following command:reagentc /enable.[73]M1018User Account ManagementLimit the user accounts that have access to backups to only those required.DetectionIDData SourceData ComponentDetectsDS0010Cloud StorageCloud Storage DeletionMonitor for unexpected deletion of a cloud storage objects (ex: AWSdelete-object), especially those associated with cloud backups.DS0017CommandCommand ExecutionUse process monitoring to monitor the execution and command line parameters of binaries involved in inhibiting system recovery, such asvssadmin,wbadmin, andbcdedit.DS0022FileFile DeletionThe Windows event logs, ex. Event ID 524 indicating a system catalog was deleted, may contain entries associated with suspicious activity.DS0009ProcessProcess CreationUse process monitoring to monitor the execution and command line parameters of binaries involved in inhibiting system recovery, such asvssadmin,wbadmin, andbcdedit. After compromising a network of systems, threat actors often try to delete/resize Shadow Copy in an attempt to prevent administrators from restoring the systems to versions present before the attack. This is often done via vssadmin, a legitimate Windows tool to interact with shadow copies. This action is often employed by ransomware, may lead to a failure in recovering systems after an attack. The pseudo code detection focus on Windows Security and Sysmon process creation (4688 and 1). The use of wmic to delete shadow copy generates WMI-Activity Operationnal 5857 event and could generate 5858 (if the operation fails). These 2 EventIDs could be interesting when attackers use wmic without process creation and/or for forensics.Analytic 1 - Detecting Shadow Copy Deletion or Resize(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688")(CommandLine="vssadmindeleteshadows" OR CommandLine="wmicshadowcopydelete" OR CommandLine="vssadminresizeshadowstorage")) OR (EventCode="5857" ProviderName="MSVSS__PROVIDER") OR (EventCode="5858" Operation="Win32_ShadowCopy")Analytic 2 - BCDEdit Failure Recovery Modification(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") Image= "C:\Windows\System32\bcdedit.exe" AND CommandLine="recoveryenabled"DS0019ServiceService MetadataMonitor the status of services involved in system recovery.Note: For Windows, Event ID 7040 can be used to alert on changes to the start type of a service (e.g., going from enabled at startup to disabled) associated with system recovery.DS0020SnapshotSnapshot DeletionMonitor for unexpected deletion of snapshots (ex: AWSdelete-snapshot), especially those associated with cloud backups.DS0024Windows RegistryWindows Registry Key ModificationMonitor the registry for changes associated with system recovery features (ex: the creation ofHKEY_CURRENT_USER\Software\Policies\Microsoft\PreviousVersions\DisableLocalPage).ReferencesMercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer Takes Aim At Winter Olympics. Retrieved March 14, 2019.Berry, A., Homan, J., and Eitzman, R. (2017, May 23). WannaCry Malware Profile. Retrieved March 15, 2019.TheDFIRReport. (2022, March 1). Disabling notifications on Synology servers before ransom. Retrieved October 19, 2022.Microsoft Windows Server. (2023, February 3). Diskshadow. Retrieved November 21, 2023.Romain Dumont . (2022, September 21). Technical Analysis of Crytox Ransomware. Retrieved November 22, 2023.Steve Ranger. (2020, February 27). Ransomware victims thought their backups were safe. They were wrong. Retrieved March 21, 2023.Brian Prince. (2014, June 20). Code Hosting Service Shuts Down After Cyber Attack. Retrieved March 21, 2023.Spencer Gietzen. (n.d.). AWS Simple Storage Service S3 Ransomware Part 2: Prevention and Defense. Retrieved March 21, 2023.Max Kersten & Alexandre Mundo. (2023, November 29). Akira Ransomware. Retrieved April 4, 2024.Security Lab. (2020, June 5). Avaddon: From seeking affiliates to in-the-wild in 2 days. Retrieved August 19, 2021.Yuste, J. Pastrana, S. (2021, February 9). Avaddon ransomware: an in-depth analysis and decryption of infected systems. Retrieved August 19, 2021.Sogeti. (2021, March). Babuk Ransomware. Retrieved August 11, 2021.Mundo, A. et al. (2021, February). Technical Analysis of Babuk Ransomware. Retrieved August 11, 2021.Frankoff, S., Hartley, B. (2018, November 14). Big Game Hunting: The Evolution of INDRIK SPIDER From Dridex Wire Fraud to BitPaymer Targeted Ransomware. Retrieved January 6, 2021.Zargarov, N. (2022, May 2). New Black Basta Ransomware Hijacks Windows Fax Service. Retrieved March 7, 2023.Cyble. (2022, May 6). New ransomware variant targeting high-value organizations. Retrieved March 7, 2023.Gonzalez, I., Chavez I., et al. (2022, May 9). Examining the Black Basta Ransomware’s Infection Routine. Retrieved March 7, 2023.Avertium. (2022, June 1). AN IN-DEPTH LOOK AT BLACK BASTA RANSOMWARE. Retrieved March 7, 2023.Inman, R. and Gurney, P. (2022, June 6). Shining the Light on Black Basta. Retrieved March 8, 2023.Vilkomir-Preisman, S. (2022, August 18). Beating Black Basta Ransomware. Retrieved March 8, 2023.Elsad, A. (2022, August 25). Threat Assessment: Black Basta Ransomware. Retrieved March 8, 2023.Trend Micro. (2022, September 1). Ransomware Spotlight Black Basta. Retrieved March 8, 2023.Check Point. (2022, October 20). BLACK BASTA AND THE UNNOTICED DELIVERY. Retrieved March 8, 2023.Microsoft Defender Threat Intelligence. (2022, June 13). The many lives of BlackCat ransomware. Retrieved December 20, 2022.Mundo, A. (2019, August 1). Clop Ransomware. Retrieved May 10, 2021.Burton, K. (n.d.). The Conficker Worm. Retrieved February 18, 2021.Baskin, B. (2020, July 8). TAU Threat Discovery: Conti Ransomware. Retrieved February 17, 2021.Adi Zeligson & Rotem Kerner. (2018, November 13). Enter The DarkGate - New Cryptocurrency Mining and Ransomware Campaign. Retrieved February 9, 2024.Smith, S., Stafford, M. (2021, December 14). DarkWatchman: A new evolution in fileless techniques. Retrieved January 10, 2022.McLellan, T.  and Moore, J. et al. (2021, April 29). UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial Threat. Retrieved June 2, 2021.Neeamni, D., Rubinfeld, A.. (2021, July 1). Diavol - A New Ransomware Used By Wizard Spider?. Retrieved November 12, 2021.Dragos. (2020, February 3). EKANS Ransomware and ICS Operations. Retrieved February 9, 2021.Hinchliffe, A. Santos, D. (2020, June 26). Threat Assessment: EKANS Ransomware. Retrieved February 9, 2021.CISA. (2021, May 6). Analysis Report (AR21-126A) FiveHands Ransomware. Retrieved June 7, 2021.Reynolds, J.. (2016, September 14). H1N1: Technical analysis reveals new capabilities – part 2. Retrieved September 26, 2016.Thomas, W. et al. (2022, February 25). CrowdStrike Falcon Protects from New Wiper Malware Used in Ukraine Cyberattacks. Retrieved March 25, 2022.ESET. (2022, March 1). IsaacWiper and HermeticWizard: New wiper and worm targetingUkraine. Retrieved April 10, 2022.Dani, M. (2022, March 1). Ukrainian Targets Hit by HermeticWiper, New Datawiper Malware. Retrieved March 25, 2022.Hromcová, Z. (2018, June 07). InvisiMole: Surprisingly equipped spyware, undercover since 2013. Retrieved July 10, 2018.Lee, S.. (2019, May 14). JCry Ransomware. Retrieved June 18, 2019.Mundo, A. (2020, March 26). Ransomware Maze. Retrieved May 18, 2020.Brandt, A., Mackenzie, P.. (2020, September 17). Maze Attackers Adopt Ragnar Locker Virtual Machine Technique. Retrieved October 9, 2020.Del Fierro, C. Kessem, L.. (2020, January 8). From Mega to Giga: Cross-Version Comparison of Top MegaCortex Modifications. Retrieved February 15, 2021.Check Point Research Team. (2021, August 14). Indra - Hackers Behind Recent Attacks on Iran. Retrieved February 17, 2022.Victor, K.. (2020, May 18). Netwalker Fileless Ransomware Injected via Reflective Loading . Retrieved May 26, 2020.Szappanos, G., Brandt, A.. (2020, May 27). Netwalker ransomware tools give insight into threat actor. Retrieved May 27, 2020.MSTIC. (2022, October 14). New “Prestige” ransomware impacts organizations in Ukraine and Poland. Retrieved January 19, 2023.Group IB. (2020, September). LOCK LIKE  A PRO. Retrieved September 27, 2021.CERT-FR. (2020, April 1). ATTACKS INVOLVING THE MESPINOZA/PYSA RANSOMWARE. Retrieved March 1, 2021.SophosLabs. (2020, May 21). Ragnar Locker ransomware deploys virtual machine to dodge security. Retrieved June 29, 2020.Mamedov, O, et al. (2019, July 3). Sodin ransomware exploits Windows vulnerability and processor architecture. Retrieved August 4, 2020.Cylance. (2019, July 3). hreat Spotlight: Sodinokibi Ransomware. Retrieved August 4, 2020.Secureworks . (2019, September 24). REvil: The GandCrab Connection. Retrieved August 4, 2020.Cadieux, P, et al (2019, April 30). Sodinokibi ransomware exploits WebLogic Server vulnerability. Retrieved August 4, 2020.McAfee. (2019, October 2). McAfee ATR Analyzes Sodinokibi aka REvil Ransomware-as-a-Service – What The Code Tells Us. Retrieved August 4, 2020.Intel 471 Malware Intelligence team. (2020, March 31). REvil Ransomware-as-a-Service – An analysis of a ransomware affiliate operation. Retrieved August 4, 2020.Ozarslan, S. (2020, January 15). A Brief History of Sodinokibi. Retrieved August 5, 2020.Counter Threat Unit Research Team. (2019, September 24). REvil/Sodinokibi Ransomware. Retrieved August 4, 2020.Tetra Defense. (2020, March). CAUSE AND EFFECT: SODINOKIBI RANSOMWARE ANALYSIS. Retrieved December 14, 2020.Lee, S. (2019, May 17). CB TAU Threat Intelligence Notification: RobbinHood Ransomware Stops 181 Windows Services Before Encryption. Retrieved July 29, 2019.Cybereason Global SOC and Cybereason Security Research Teams. (2022, December 14). Royal Rumble: Analysis of Royal Ransomware. Retrieved March 30, 2023.Iacono, L. and Green, S. (2023, February 13). Royal Ransomware Deep Dive. Retrieved March 30, 2023.CISA. (2023, March 2). #StopRansomware: Royal Ransomware. Retrieved March 31, 2023.Hanel, A. (2019, January 10). Big Game Hunting with Ryuk: Another Lucrative Targeted Ransomware. Retrieved May 12, 2020.Noerenberg, E., Costis, A., and Quist, N. (2017, May 16). A Technical Analysis of WannaCry Ransomware. Retrieved March 25, 2019.Counter Threat Unit Research Team. (2017, May 18). WCry Ransomware Analysis. Retrieved March 26, 2019.Symantec Threat Intelligence. (2020, June 25). WastedLocker: Symantec Identifies Wave of Attacks Against U.S. Organizations. Retrieved May 20, 2021.Antenucci, S., Pantazopoulos, N., Sandee, M. (2020, June 23). WastedLocker: A New Ransomware Variant Developed By The Evil Corp Group. Retrieved September 14, 2021.Walter, J.. (2020, July 23). WastedLocker Ransomware: Abusing ADS and NTFS File Attributes. Retrieved September 14, 2021.Shilko, J., et al. (2021, October 7). FIN12: The Prolific Ransomware Intrusion Threat Actor That Has Aggressively Pursued Healthcare Targets. Retrieved June 15, 2023.Ready.gov. (n.d.). IT Disaster Recovery Plan. Retrieved March 15, 2019.Jay Chen. (2022, May 16). A Look Into Public Clouds From the Ransomware Actor's Perspective. Retrieved March 21, 2023.Microsoft, EliotSeattle, et al. (2022, August 18). REAgentC command-line options. Retrieved October 19, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.