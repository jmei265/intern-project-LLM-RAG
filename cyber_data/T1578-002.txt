MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseModify Cloud Compute InfrastructureCreate Cloud InstanceModify Cloud Compute Infrastructure:Create Cloud InstanceOther sub-techniques of Modify Cloud Compute Infrastructure (5)IDNameT1578.001Create SnapshotT1578.002Create Cloud InstanceT1578.003Delete Cloud InstanceT1578.004Revert Cloud InstanceT1578.005Modify Cloud Compute ConfigurationsAn adversary may create a new instance or virtual machine (VM) within the compute service of a cloud account to evade defenses. Creating a new instance may allow an adversary to bypass firewall rules and permissions that exist on instances currently residing within an account. An adversary mayCreate Snapshotof one or more volumes in an account, create a new instance, mount the snapshots, and then apply a less restrictive security policy to collectData from Local Systemor forRemote Data Staging.[1]Creating a new instance may also allow an adversary to carry out malicious activity within an environment without affecting the execution of current running instances.ID:T1578.002Sub-technique of:T1578ⓘTactic:Defense EvasionⓘPlatforms:IaaSⓘPermissions Required:UserVersion:1.1Created:14 May 2020Last Modified:08 March 2021Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionC0027C0027DuringC0027,Scattered Spiderused access to the victim's Azure tenant to create Azure VMs.[2]G1004LAPSUS$LAPSUS$has created new virtual machines within the target's cloud environment after leveraging credential access to cloud assets.[3]G1015Scattered SpiderDuringC0027,Scattered Spiderused access to the victim's Azure tenant to create Azure VMs.[2]Scattered Spiderhas also created Amazon EC2 instances within the victim's environment.[4]MitigationsIDMitigationDescriptionM1047AuditRoutinely check user permissions to ensure only the expected users have the capability to create new instances.M1018User Account ManagementLimit permissions for creating new instances in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies.[1]DetectionIDData SourceData ComponentDetectsDS0030InstanceInstance CreationThe creation of a new instance or VM is a common part of operations within many cloud environments. Events should then not be viewed in isolation, but as part of a chain of behavior that could lead to other activities. For example, the creation of an instance by a new user account or the unexpected creation of one or more snapshots followed by the creation of an instance may indicate suspicious activity.In AWS, CloudTrail logs capture the creation of an instance in the RunInstances event, and in Azure the creation of a VM may be captured in Azure activity logs.[5][6]Google's Admin Activity audit logs within their Cloud Audit logs can be used to detect the usage of gcloud compute instances create to create a VM.[7]Instance MetadataPeriodically baseline instances to identify malicious modifications or additions.ReferencesMandiant. (2020, February). M-Trends 2020. Retrieved April 24, 2020.Parisi, T. (2022, December 2). Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies. Retrieved June 30, 2023.MSTIC, DART, M365 Defender. (2022, March 24). DEV-0537 Criminal Actor Targeting Organizations for Data Exfiltration and Destruction. Retrieved May 17, 2022.CISA. (2023, November 16). Cybersecurity Advisory: Scattered Spider (AA23-320A). Retrieved March 18, 2024.Amazon. (n.d.). Search CloudTrail logs for API calls to EC2 Instances. Retrieved June 17, 2020.Microsoft. (n.d.). View Azure activity logs. Retrieved June 17, 2020.Google. (n.d.). Audit Logs. Retrieved June 1, 2020.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.