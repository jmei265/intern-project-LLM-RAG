MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseAbuse Elevation Control MechanismTCC ManipulationAbuse Elevation Control Mechanism:TCC ManipulationOther sub-techniques of Abuse Elevation Control Mechanism (6)IDNameT1548.001Setuid and SetgidT1548.002Bypass User Account ControlT1548.003Sudo and Sudo CachingT1548.004Elevated Execution with PromptT1548.005Temporary Elevated Cloud AccessT1548.006TCC ManipulationAdversaries can manipulate or abuse the Transparency, Consent, & Control (TCC) service or database to execute malicious applications with elevated permissions. TCC is a Privacy & Security macOS control mechanism used to determine if the running process has permission to access the data or services protected by TCC, such as screen sharing, camera, microphone, or Full Disk Access (FDA).When an application requests to access data or a service protected by TCC, the TCC daemon (tccd) checks the TCC database, located at/Library/Application Support/com.apple.TCC/TCC.db(and~/equivalent), for existing permissions. If permissions do not exist, then the user is prompted to grant permission. Once permissions are granted, the database stores the application's permissions and will not prompt the user again unless reset. For example, when a web browser requests permissions to the user's webcam, once granted the web browser may not explicitly prompt the user again.[1]Adversaries may manipulate the TCC database or otherwise abuse the TCC service to execute malicious content. This can be done in various ways, including using privileged system applications to execute malicious payloads or manipulating the database to grant their application TCC permissions.For example, adversaries can use Finder, which has FDA permissions by default, to execute maliciousAppleScriptwhile preventing a user prompt. For a system without System Integrity Protection (SIP) enabled, adversaries have also manipulated the operating system to load an adversary controlled TCC database using environment variables andLaunchctl.[2][3]Adversaries may also opt to instead inject code (e.g.,Process Injection) into targeted applications with the desired TCC permissions.ID:T1548.006Sub-technique of:T1548ⓘTactics:Defense Evasion,Privilege EscalationⓘPlatforms:macOSContributors:Marina LiangVersion:1.0Created:21 March 2024Last Modified:17 April 2024Version PermalinkLive VersionMitigationsIDMitigationDescriptionM1047AuditRoutinely check applications using Automation under Security & Privacy System Preferences. To reset permissions, user's can utilize thetccutil resetcommand. When using Mobile Device Management (MDM), review the list of enabled or disabled applications in theMDMOverrides.plistwhich overrides the TCC database.[2]M1026Privileged Account ManagementRemove unnecessary users from the local administrator group on systems.M1022Restrict File and Directory PermissionsWhen using an MDM, ensure the permissions granted are specific to the requirements of the binary. Full Disk Access should be restricted to only necessary binaries in alignment with policy.M1051Update SoftwareRoutinely update software. Where possible, ensure systems are macOS Sierra+ and SIP is enabled.[1]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may abuse or modify TCC mechanisms designed to control access to elevated privileges. macOS system logs may also indicate whenAuthorizationExecuteWithPrivilegesis being called.DS0022FileFile ModificationMonitor for changes to files associated with TCC settings, such as/Library/Application Support/com.apple.TCC/TCC.db.DS0009ProcessProcess CreationMonitor for newly executed processes that may circumvent TCC mechanisms designed to control access to elevated privileges. macOS system logs may also indicate whenAuthorizationExecuteWithPrivilegesis being called.ReferencesMarc-Etienne M.Léveillé. (2022, July 19). I see what you did there: A look at the CloudMensis macOS spyware. Retrieved March 21, 2024.Phil Stokes. (2021, July 1). Bypassing macOS TCC User Privacy Protections By Accident and Design. Retrieved March 21, 2024.Marina Liang. (2024, April 23). Return of the mac(OS): Transparency, Consent, and Control (TCC) Database Manipulation. Retrieved March 28, 2024.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.