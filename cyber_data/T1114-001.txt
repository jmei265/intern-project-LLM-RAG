MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseEmail CollectionLocal Email CollectionEmail Collection:Local Email CollectionOther sub-techniques of Email Collection (3)IDNameT1114.001Local Email CollectionT1114.002Remote Email CollectionT1114.003Email Forwarding RuleAdversaries may target user email on local systems to collect sensitive information. Files containing email data can be acquired from a user’s local system, such as Outlook storage or cache files.Outlook stores data locally in offline data files with an extension of .ost. Outlook 2010 and later supports .ost file sizes up to 50GB, while earlier versions of Outlook support up to 20GB.[1]IMAP accounts in Outlook 2013 (and earlier) and POP accounts use Outlook Data Files (.pst) as opposed to .ost, whereas IMAP accounts in Outlook 2016 (and later) use .ost files. Both types of Outlook data files are typically stored inC:\Users\<username>\Documents\Outlook FilesorC:\Users\<username>\AppData\Local\Microsoft\Outlook.[2]ID:T1114.001Sub-technique of:T1114ⓘTactic:CollectionⓘPlatforms:WindowsⓘPermissions Required:UserVersion:1.0Created:19 February 2020Last Modified:24 March 2020Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0006APT1APT1uses two utilities, GETMAIL and MAPIGET, to steal email. GETMAIL extracts emails from archived Outlook .pst files.[3]S0030CarbanakCarbanaksearches recursively for Outlook personal storage tables (PST) files within user directories and sends them back to the C2 server.[4]G0114ChimeraChimerahas harvested data from victim's e-mail including through execution ofwmic /node:process call create "cmd /c copy c:\Users\\\backup.pst c:\windows\temp\backup.pst" copy "i:\\\My Documents\.pst"copy.[5]S0050CosmicDukeCosmicDukesearches for Microsoft Outlook data files with extensions .pst and .ost for collection and exfiltration.[6]S0115CrimsonCrimsoncontains a command to collect and exfiltrate emails from Outlook.[7]S0367EmotetEmotethas been observed leveraging a module that scrapes email data from Outlook.[8]S0363EmpireEmpirehas the ability to collect emails on a target system.[9]S0526KGH_SPYKGH_SPYcan harvest data from mail clients.[10]G0059Magic HoundMagic Houndhas collected .PST archives.[11]C0002Night DragonDuringNight Dragon, threat actors used RAT malware to exfiltrate email archives.[12]S0594Out1Out1can parse e-mails on a target machine.[13]S0192PupyPupycan interact with a victim’s Outlook session and look through folders and emails.[14]S0650QakBotQakBotcan target and steal locally stored emails to support thread hijacking phishing campaigns.[15][16][17]S0226Smoke LoaderSmoke Loadersearches through Outlook files and directories (e.g., inbox, sent, templates, drafts, archives, etc.).[18]MitigationsIDMitigationDescriptionM1041Encrypt Sensitive InformationUse of encryption provides an added layer of security to sensitive information sent over email. Encryption using public key cryptography requires the adversary to obtain the private certificate along with an encryption key to decrypt messages.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments for actions that could be taken to gather local email files. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.DS0022FileFile AccessMonitor for unusual processes accessing local email files that may target user email on local systems to collect sensitive information.ReferencesN. O'Bryan. (2018, May 30). Managing Outlook Cached Mode and OST File Sizes. Retrieved February 19, 2020.Microsoft. (n.d.). Introduction to Outlook Data Files (.pst and .ost). Retrieved February 19, 2020.Mandiant. (n.d.). APT1 Exposing One of China’s Cyber Espionage Units. Retrieved July 18, 2016.Bennett, J., Vengerik, B. (2017, June 12). Behind the CARBANAK Backdoor. Retrieved June 11, 2018.Jansen, W . (2021, January 12). Abusing cloud services to fly under the radar. Retrieved January 19, 2021.F-Secure Labs. (2014, July). COSMICDUKE Cosmu with a twist of MiniDuke. Retrieved July 3, 2014.Huss, D. (2016, March 1). Operation Transparent Tribe. Retrieved June 8, 2016.CIS. (2018, December 12). MS-ISAC Security Primer- Emotet. Retrieved March 25, 2019.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.Dahan, A. et al. (2020, November 2). Back to the Future: Inside the Kimsuky KGH Spyware Suite. Retrieved November 6, 2020.Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018.McAfee® Foundstone® Professional Services and McAfee Labs™. (2011, February 10). Global Energy Cyberattacks: “Night Dragon”. Retrieved February 19, 2018.Peretz, A. and Theck, E. (2021, March 5). Earth Vetala – MuddyWater Continues to Target Organizations in the Middle East. Retrieved March 18, 2021.Nicolas Verdier. (n.d.). Retrieved January 29, 2018.Sette, N. et al. (2020, June 4). Qakbot Malware Now Exfiltrating Emails for Sophisticated Thread Hijacking Attacks. Retrieved September 27, 2021.Trend Micro. (2020, December 17). QAKBOT: A decade-old malware still with new tricks. Retrieved September 27, 2021.Kuzmenko, A. et al. (2021, September 2). QakBot technical analysis. Retrieved September 27, 2021.Baker, B., Unterbrink H. (2018, July 03). Smoking Guns - Smoke Loader learned new tricks. Retrieved July 5, 2018.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.