MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseIndicator RemovalClear Mailbox DataIndicator Removal:Clear Mailbox DataOther sub-techniques of Indicator Removal (9)IDNameT1070.001Clear Windows Event LogsT1070.002Clear Linux or Mac System LogsT1070.003Clear Command HistoryT1070.004File DeletionT1070.005Network Share Connection RemovalT1070.006TimestompT1070.007Clear Network Connection History and ConfigurationsT1070.008Clear Mailbox DataT1070.009Clear PersistenceAdversaries may modify mail and mail application data to remove evidence of their activity. Email applications allow users and other programs to export and delete mailbox data via command line tools or use of APIs. Mail application data can be emails, email metadata, or logs generated by the application or operating system, such as export requests.Adversaries may manipulate emails and mailbox data to remove logs, artifacts, and metadata, such as evidence ofPhishing/Internal Spearphishing,Email Collection,Mail Protocolsfor command and control, or email-based exfiltration such asExfiltration Over Alternative Protocol. For example, to remove evidence on Exchange servers adversaries have used theExchangePowerShellPowerShellmodule, includingRemove-MailboxExportRequestto remove evidence of mailbox exports.[1][2]On Linux and macOS, adversaries may also delete emails through a command line utility calledmailor useAppleScriptto interact with APIs on macOS.[3][4]Adversaries may also remove emails and metadata/headers indicative of spam or suspicious activity (for example, through the use of organization-wide transport rules) to reduce the likelihood of malicious emails being detected by security products.[5]ID:T1070.008Sub-technique of:T1070ⓘTactic:Defense EvasionⓘPlatforms:Google Workspace, Linux, Office 365, Windows, macOSContributors:Liran Ravich, CardinalOpsVersion:1.1Created:08 July 2022Last Modified:12 April 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0477GoopyGoopyhas the ability to delete emails used for C2 once the content has been copied.[3]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29removed evidence of email export requests usingRemove-MailboxExportRequest.[1]MitigationsIDMitigationDescriptionM1047AuditIn an Exchange environment, Administrators can useGet-TransportRule/Remove-TransportRuleto discover and remove potentially malicious transport rules.[6]M1029Remote Data StorageAutomatically forward mail data and events to a log server or data repository to prevent conditions in which the adversary can locate and manipulate data on the local system. When possible, minimize time delay on event reporting to avoid prolonged storage on the local system.M1022Restrict File and Directory PermissionsProtect generated event files that are stored locally with proper permissions and authentication and limit opportunities for adversaries to increase privileges by preventing Privilege Escalation opportunities.DetectionIDData SourceData ComponentDetectsDS0015Application LogApplication Log ContentIn environments using Exchange, monitor logs for the creation or modification of mail processing settings, such as transport rules.DS0017CommandCommand ExecutionMonitor executed commands and arguments that may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined emails. In Exchange environments, monitor for PowerShell cmdlets that may create or alter transport rules, such asNew-TransportRuleandSet-TransportRule.[6]DS0022FileFile DeletionMonitor for deletion of generated artifacts on a host system, including logs or captured files such as quarantined emails.On Windows 10, mail application data is stored inC:\Users\Username\AppData\Local\Comms\Unistore\data. On Linux, mail data is stored in/var/spool/mailor/var/mail. On macOS, mail data is stored in~/Library/Mail.File ModificationMonitor for changes made to generated artifacts on a host system, including logs or captured files such as quarantined emails.On Windows 10, mail application data is stored inC:\Users\Username\AppData\Local\Comms\Unistore\data. On Linux, mail data is stored in/var/spool/mailor/var/mail. On macOS, mail data is stored in~/Library/Mail.DS0009ProcessProcess CreationMonitor for newly executed processes with arguments that may delete or alter generated artifacts on a host system, including logs or captured files such as quarantined emails.ReferencesCash, D. et al. (2020, December 14). Dark Halo Leverages SolarWinds Compromise to Breach Organizations. Retrieved December 29, 2020.Microsoft. (2017, September 25). ExchangePowerShell. Retrieved June 10, 2022.Dahan, A. (2017). Operation Cobalt Kitty. Retrieved December 27, 2018.Michael Kerrisk. (2021, August 27). mailx(1p) — Linux manual page. Retrieved June 10, 2022.Microsoft. (2023, September 22). Malicious OAuth applications abuse cloud email services to spread spam. Retrieved March 13, 2023.Microsoft. (2023, February 22). Manage mail flow rules in Exchange Online. Retrieved March 13, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.