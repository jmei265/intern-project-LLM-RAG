MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseBoot or Logon Autostart ExecutionWinlogon Helper DLLBoot or Logon Autostart Execution:Winlogon Helper DLLOther sub-techniques of Boot or Logon Autostart Execution (14)IDNameT1547.001Registry Run Keys / Startup FolderT1547.002Authentication PackageT1547.003Time ProvidersT1547.004Winlogon Helper DLLT1547.005Security Support ProviderT1547.006Kernel Modules and ExtensionsT1547.007Re-opened ApplicationsT1547.008LSASS DriverT1547.009Shortcut ModificationT1547.010Port MonitorsT1547.012Print ProcessorsT1547.013XDG Autostart EntriesT1547.014Active SetupT1547.015Login ItemsAdversaries may abuse features of Winlogon to execute DLLs and/or executables when a user logs in. Winlogon.exe is a Windows component responsible for actions at logon/logoff as well as the secure attention sequence (SAS) triggered by Ctrl-Alt-Delete. Registry entries inHKLM\Software[\Wow6432Node\]\Microsoft\Windows NT\CurrentVersion\Winlogon\andHKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\are used to manage additional helper programs and functionalities that support Winlogon.[1]Malicious modifications to these Registry keys may cause Winlogon to load and execute malicious DLLs and/or executables. Specifically, the following subkeys have been known to be possibly vulnerable to abuse:[1]Winlogon\Notify - points to notification package DLLs that handle Winlogon eventsWinlogon\Userinit - points to userinit.exe, the user initialization program executed when a user logs onWinlogon\Shell - points to explorer.exe, the system shell executed when a user logs onAdversaries may take advantage of these features to repeatedly execute malicious code and establish persistence.ID:T1547.004Sub-technique of:T1547ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:WindowsⓘPermissions Required:Administrator, SYSTEMContributors:PraetorianVersion:1.2Created:24 January 2020Last Modified:14 February 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0534BazarBazarcan use Winlogon Helper DLL to establish persistence.[2]S0351CannonCannonadds the Registry keyHKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogonto establish persistence.[3]S1066DarkTortillaDarkTortillahas established persistence via theSoftware\Microsoft\Windows NT\CurrentVersion\Winlogonregistry key.[4]S0200DipsindADipsindvariant registers as a Winlogon Event Notify DLL to establish persistence.[5]S0168GazerGazercan establish persistence by setting the value "Shell" with "explorer.exe, %malware_pathfile%" under the Registry keyHKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon.[6]S0387KeyBoyKeyBoyissues the commandreg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"to achieve persistence.[7][8]S0375RemexiRemexiachieves persistence using Userinit by adding the Registry keyHKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit.[9]S0379Revenge RATRevenge RATcreates a Registry key atHKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shellto survive a system reboot.[10]G0081Tropic TrooperTropic Trooperhas created the Registry keyHKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shelland sets the value to establish persistence.[11][12]G0010TurlaTurlaestablished persistence by adding a Shell value under the Registry keyHKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon.[13]G0102Wizard SpiderWizard Spiderhas established persistence using Userinit by adding the Registry key HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon.[14]MitigationsIDMitigationDescriptionM1038Execution PreventionIdentify and block potentially malicious software that may be executed through the Winlogon helper process by using application control[15]tools like AppLocker[16][17]that are capable of auditing and/or blocking unknown DLLs.M1018User Account ManagementLimit the privileges of user accounts so that only authorized administrators can perform Winlogon helper changes.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may abuse features of Winlogon to execute DLLs and/or executables when a user logs in.DS0011ModuleModule LoadNew DLLs written to System32 that do not correlate with known good software or patching may also be suspicious. Look for abnormal process behavior that may be due to a process loading a malicious DLL. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.DS0009ProcessProcess CreationMonitor for the execution of processes that may abuse features of Winlogon to execute DLLs and/or executables when a user logs in.Analytic 1 - Modification of the Winlogon Registry Key(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") | where  (CommandLine LIKE "%Microsoft\Windows NT\CurrentVersion\Winlogon%" AND (CommandLine LIKE "%Userinit%" OR CommandLine LIKE "%Shell%" OR CommandLine LIKE "%Notify%"))  AND  (CommandLine LIKE "%reg%" OR CommandLine LIKE "%add%" OR CommandLine LIKE "%/d%" OR  CommandLine LIKE "%Set-ItemProperty%" OR CommandLine LIKE "%New-ItemProperty%" CommandLine LIKE "%-value%")DS0024Windows RegistryWindows Registry Key ModificationMonitor for changes to Registry entries associated with Winlogon that do not correlate with known software, patch cycles, etc. Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing current Winlogon helper values.[18]Analytic 1 - Registry Edit with Modification of Userinit, Shell or Notifysource="WinEventLog:Security" EventCode="4657" (ObjectValueName="Userinit" OR ObjectValueName="Shell" OR ObjectValueName="Notify") OR source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="13" (TargetObject="Userinit" OR TargetObject="Shell" OR TargetObject="*Notify")ReferencesLangendorf, S. (2013, September 24). Windows Registry Persistence, Part 2: The Run Keys and Search-Order. Retrieved April 11, 2018.Sadique, M. and Singh, A. (2020, September 29). Spear Phishing Campaign Delivers Buer and Bazar Malware. Retrieved November 19, 2020.Falcone, R., Lee, B. (2018, November 20). Sofacy Continues Global Attacks and Wheels Out New ‘Cannon’ Trojan. Retrieved November 26, 2018.Secureworks Counter Threat Unit Research Team. (2022, August 17). DarkTortilla Malware Analysis. Retrieved November 3, 2022.Windows Defender Advanced Threat Hunting Team. (2016, April 29). PLATINUM: Targeted attacks in South and Southeast Asia. Retrieved February 15, 2018.ESET. (2017, August). Gazing at Gazer: Turla’s new second stage backdoor. Retrieved September 14, 2017.Parys, B. (2017, February 11). The KeyBoys are back in town. Retrieved June 13, 2019.Hulcoop, A., et al. (2016, November 17). It’s Parliamentary KeyBoy and the targeting of the Tibetan Community. Retrieved June 13, 2019.Legezo, D. (2019, January 30). Chafer used Remexi malware to spy on Iran-based foreign diplomatic entities. Retrieved April 17, 2019.Livelli, K, et al. (2018, November 12). Operation Shaheen. Retrieved May 1, 2019.Ray, V. (2016, November 22). Tropic Trooper Targets Taiwanese Government and Fossil Fuel Provider With Poison Ivy. Retrieved November 9, 2018.Chen, J.. (2020, May 12). Tropic Trooper’s Back: USBferry Attack Targets Air gapped Environments. Retrieved May 20, 2020.ESET, et al. (2018, January). Diplomats in Eastern Europe bitten by a Turla mosquito. Retrieved July 3, 2018.Kimberly Goody, Jeremy Kennelly, Joshua Shilko, Steve Elovitz, Douglas Bienstock. (2020, October 28). Unhappy Hour Special: KEGTAP and SINGLEMALT With a Ransomware Chaser. Retrieved October 28, 2020.Beechey, J. (2010, December). Application Whitelisting: Panacea or Propaganda?. Retrieved November 18, 2014.Tomonaga, S. (2016, January 26). Windows Commands Abused by Attackers. Retrieved February 2, 2016.NSA Information Assurance Directorate. (2014, August). Application Whitelisting Using Microsoft AppLocker. Retrieved March 31, 2016.Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.