MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseBoot or Logon Autostart ExecutionSecurity Support ProviderBoot or Logon Autostart Execution:Security Support ProviderOther sub-techniques of Boot or Logon Autostart Execution (14)IDNameT1547.001Registry Run Keys / Startup FolderT1547.002Authentication PackageT1547.003Time ProvidersT1547.004Winlogon Helper DLLT1547.005Security Support ProviderT1547.006Kernel Modules and ExtensionsT1547.007Re-opened ApplicationsT1547.008LSASS DriverT1547.009Shortcut ModificationT1547.010Port MonitorsT1547.012Print ProcessorsT1547.013XDG Autostart EntriesT1547.014Active SetupT1547.015Login ItemsAdversaries may abuse security support providers (SSPs) to execute DLLs when the system boots. Windows SSP DLLs are loaded into the Local Security Authority (LSA) process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs.The SSP configuration is stored in two Registry keys:HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Security PackagesandHKLM\SYSTEM\CurrentControlSet\Control\Lsa\OSConfig\Security Packages. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.[1]ID:T1547.005Sub-technique of:T1547ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:WindowsⓘPermissions Required:AdministratorVersion:1.0Created:24 January 2020Last Modified:25 March 2020Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0363EmpireEmpirecan enumerate Security Support Providers (SSPs) as well as utilizePowerSploit'sInstall-SSPandInvoke-Mimikatzto install malicious SSPs and log authentication events.[2]S0002MimikatzTheMimikatzcredential dumper contains an implementation of an SSP.[3]S0194PowerSploitPowerSploit'sInstall-SSPPersistence module can be used to establish by installing a SSP DLL.[4][5]MitigationsIDMitigationDescriptionM1025Privileged Process IntegrityWindows 8.1, Windows Server 2012 R2, and later versions may make LSA run as a Protected Process Light (PPL) by setting the Registry keyHKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL, which requires all SSP DLLs to be signed by Microsoft.[1][6]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may abuse security support providers (SSPs) to execute DLLs when the system boots.DS0011ModuleModule LoadMonitor the LSA process for DLL loads. Windows 8.1 and Windows Server 2012 R2 may generate events when unsigned SSP DLLs try to load into the LSA by setting the Registry keyHKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\LSASS.exewith AuditLevel = 8.[1][6]DS0024Windows RegistryWindows Registry Key ModificationMonitor the Registry for changes to the SSP Registry keys. Windows 8.1 and Windows Server 2012 R2 may generate events when unsigned SSP DLLs try to load into the LSA by setting the Registry keyHKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\LSASS.exewith AuditLevel = 8.[1][6]ReferencesGraeber, M. (2014, October). Analysis of Malicious Security Support Provider DLLs. Retrieved March 1, 2017.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015.PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018.PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018.Microsoft. (2013, July 31). Configuring Additional LSA Protection. Retrieved June 24, 2015.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.