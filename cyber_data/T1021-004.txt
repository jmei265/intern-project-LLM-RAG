MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseRemote ServicesSSHRemote Services:SSHOther sub-techniques of Remote Services (8)IDNameT1021.001Remote Desktop ProtocolT1021.002SMB/Windows Admin SharesT1021.003Distributed Component Object ModelT1021.004SSHT1021.005VNCT1021.006Windows Remote ManagementT1021.007Cloud ServicesT1021.008Direct Cloud VM ConnectionsAdversaries may useValid Accountsto log into remote machines using Secure Shell (SSH). The adversary may then perform actions as the logged-on user.SSH is a protocol that allows authorized users to open remote shells on other computers. Many Linux and macOS versions come with SSH installed by default, although typically disabled until the user enables it. The SSH server can be configured to use standard password authentication or public-private keypairs in lieu of or in addition to a password. In this authentication scenario, the user’s public key must be in a special file on the computer running the server that lists which keypairs are allowed to login as that user.ID:T1021.004Sub-technique of:T1021ⓘTactic:Lateral MovementⓘPlatforms:Linux, macOSⓘSystem Requirements:An SSH server is configured and running.Version:1.2Created:11 February 2020Last Modified:11 August 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0087APT39APT39used secure shell (SSH) to move laterally among their targets.[1]G1023APT5APT5has used SSH for lateral movement in compromised environments including for enabling access to ESXi host servers.[2]G0098BlackTechBlackTechhas used Putty for remote access.[3]C0032C0032During theC0032campaign,TEMP.Velesrelied on encrypted SSH-based tunnels to transfer tools and for remote command/program execution.[4]S0154Cobalt StrikeCobalt Strikecan SSH to a remote service.[5][6]C0029Cutting EdgeDuringCutting Edge, threat actors used SSH for lateral movement.[7]S0363EmpireEmpirecontains modules for executing commands over SSH as well as in-memory VNC agent injection.[8]G1016FIN13FIN13has remotely accessed compromised environments via secure shell (SSH) for lateral movement.[9]G0046FIN7FIN7has used SSH to move laterally through victim environments.[10]G0117Fox KittenFox Kittenhas used the PuTTY and Plink tools for lateral movement.[11]G0036GCMANGCMANuses Putty for lateral movement.[12]S0599KinsingKinsinghas used SSH for lateral movement.[13]G0032Lazarus GroupLazarus Groupused SSH and the PuTTy PSCP utility to gain access to a restricted segment of a compromised network.[14]G0065LeviathanLeviathanused ssh for internal reconnaissance.[15]G0045menuPassmenuPasshas used Putty Secure Copy Client (PSCP) to transfer data.[16]G0049OilRigOilRighas used Putty to access compromised systems.[17]G0106RockeRockehas spread its coinminer via SSH.[18]G0139TeamTNTTeamTNThas used SSH to connect back to victim machines.[19]TeamTNThas also used SSH to transfer tools and payloads onto victim hosts and execute them.[20]MitigationsIDMitigationDescriptionM1042Disable or Remove Feature or ProgramDisable the SSH daemon on systems that do not require it. For macOS ensure Remote Login is disabled under Sharing Preferences.[21]M1032Multi-factor AuthenticationRequire multi-factor authentication for SSH connections wherever possible, such as password protected SSH keys.M1018User Account ManagementLimit which user accounts are allowed to login via SSH.DetectionIDData SourceData ComponentDetectsDS0028Logon SessionLogon Session CreationMonitor for user accounts logged into systems that may useValid Accountsto log into remote machines using Secure Shell (SSH). For example, on Linux systems SSH logon activity can be found in the logs located in/var/log/auth.logor/var/log/securedepending on the distro you are using.For Linux systems, the Audit framework (auditd) can be used to monitor any writes to SSH log files that store information about logged in accounts such as /var/log/auth.log.For macOS systems (10.12+), Unified Logs can be queried to show SSH daemon (sshd) messages that include information on logged in accounts. The following command-line can be used to query the last hour’s worth of unified logs in this manner:log show -info --debug --predicate 'processImagePath CONTAINS "sshd" AND eventMessage CONTAINS "Accepted"' --last 1h | grep sshdDS0029Network TrafficNetwork Connection CreationMonitor for newly constructed network connections (typically port 22) that may useValid Accountsto log into remote machines using Secure Shell (SSH). Use of SSH may be legitimate depending on the environment and how it’s used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with SSH.Network Analysis Frameworks such as Zeek can be used to capture, decode, and alert on network traffic. Accordingly, they can be used to look for the creation of SSH network connections.DS0009ProcessProcess CreationMonitor for newly executed processes that may useValid Accountsto log into remote machines using Secure Shell (SSH). For example, on macOS systemslog show --predicate 'process = "sshd"'can be used to review incoming SSH connection attempts for suspicious activity. The commandlog show --info --predicate 'process = "ssh" or eventMessage contains "ssh"'can be used to review outgoing SSH connection activity.[21]For Linux systems, the Audit framework (auditd) can be used to monitor for the creation of SSH related processes such as ssh.For macOS systems (10.12+), the above command can be used to look through the Unified Logs for SSH connection activity, though we also recommend including the "—debug" parameter to ensure that all relevant data is returned:log show --info --debug --predicate 'process = "ssh" or eventMessage contains "ssh"'ReferencesHawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019.Perez, D. et al. (2021, May 27). Re-Checking Your Pulse: Updates on Chinese APT Actors Compromising Pulse Secure VPN Devices. Retrieved February 5, 2024.Threat Intelligence. (2020, September 29). Palmerworm: Espionage Gang Targets the Media, Finance, and Other Sectors. Retrieved March 25, 2022.Miller, S, et al. (2019, April 10). TRITON Actor TTP Profile, Custom Attack Tools, Detections, and ATT&CK Mapping. Retrieved April 16, 2019.Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.Meltzer, M. et al. (2024, January 10). Active Exploitation of Two Zero-Day Vulnerabilities in Ivanti Connect Secure VPN. Retrieved February 27, 2024.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.Ta, V., et al. (2022, August 8). FIN13: A Cybercriminal Threat Actor Focused on Mexico. Retrieved February 9, 2023.Loui, E. and Reynolds, J. (2021, August 30). CARBON SPIDER Embraces Big Game Hunting, Part 1. Retrieved September 20, 2021.CISA. (2020, September 15). Iran-Based Threat Actor Exploits VPN Vulnerabilities. Retrieved December 21, 2020.Kaspersky Lab's Global Research & Analysis Team. (2016, February 8). APT-style bank robberies increase with Metel, GCMAN and Carbanak 2.0 attacks. Retrieved April 20, 2016.Singer, G. (2020, April 3). Threat Alert: Kinsing Malware Attacks Targeting Container Environments. Retrieved April 1, 2021.Vyacheslav Kopeytsev and Seongsu Park. (2021, February 25). Lazarus targets defense industry with ThreatNeedle. Retrieved October 27, 2021.Plan, F., et al. (2019, March 4). APT40: Examining a China-Nexus Espionage Actor. Retrieved March 18, 2019.PwC and BAE Systems. (2017, April). Operation Cloud Hopper. Retrieved April 5, 2017.Unit42. (2016, May 1). Evasive Serpens Unit 42 Playbook Viewer. Retrieved February 6, 2023.Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.Fishbein, N. (2020, September 8). Attackers Abusing Legitimate Cloud Monitoring Tools to Conduct Cyber Attacks. Retrieved September 22, 2021.Darin Smith. (2022, April 21). TeamTNT targeting AWS, Alibaba. Retrieved August 4, 2022.Sarah Edwards. (2020, April 30). Analysis of Apple Unified Logs: Quarantine Edition [Entry 6] – Working From Home? Remote Logins. Retrieved August 19, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.