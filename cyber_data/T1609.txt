MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseContainer Administration CommandContainer Administration CommandAdversaries may abuse a container administration service to execute commands within a container. A container administration service such as the Docker daemon, the Kubernetes API server, or the kubelet may allow remote management of containers within an environment.[1][2][3]In Docker, adversaries may specify an entrypoint during container deployment that executes a script or command, or they may use a command such asdocker execto execute a command within a running container.[4][5]In Kubernetes, if an adversary has sufficient permissions, they may gain remote execution in a container in the cluster via interaction with the Kubernetes API server, the kubelet, or by running a command such askubectl exec.[6]ID:T1609Sub-techniques:No sub-techniquesⓘTactic:ExecutionⓘPlatforms:ContainersⓘSupports Remote:YesContributors:Alfredo Oliveira, Trend Micro; Brad Geesaman, @bradgeesaman; Center for Threat-Informed Defense (CTID); David Fiser, @anu4is, Trend Micro; Magno Logan, @magnologan, Trend Micro; Vishwas Manral, McAfee; Yossi Weizman, Azure Defender Research TeamVersion:1.2Created:29 March 2021Last Modified:15 April 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0601HildegardHildegardwas executed through the kubelet API run command and by executing commands on running containers.[7]S0599KinsingKinsingwas executed with an Ubuntu container entry point that runs shell scripts.[8]S0683PeiratesPeiratescan usekubectlor the Kubernetes API to run commands.[9]S0623SiloscapeSiloscapecan send kubectl commands to victim clusters through an IRC channel and can run kubectl locally to spread once within a victim cluster.[10]G0139TeamTNTTeamTNTexecutedHildegardthrough the kubelet API run command and by executing commands on running containers.[7]MitigationsIDMitigationDescriptionM1042Disable or Remove Feature or ProgramRemove unnecessary tools and software from containers.M1038Execution PreventionUse read-only containers, read-only file systems, and minimal images when possible to prevent the execution of commands.[11]Where possible, also consider using application control and software restriction tools (such as those provided by SELinux) to restrict access to files, processes, and system calls in containers.[12]M1035Limit Access to Resource Over NetworkLimit communications with the container service to managed and secured channels, such as local Unix sockets or remote access via SSH. Require secure port access to communicate with the APIs over TLS by disabling unauthenticated access to the Docker API and Kubernetes API Server.[13][14]In Kubernetes clusters deployed in cloud environments, use native cloud platform features to restrict the IP ranges that are permitted to access to API server.[15]Where possible, consider enabling just-in-time (JIT) access to the Kubernetes API to place additional restrictions on access.[16]M1026Privileged Account ManagementEnsure containers are not running as root by default. In Kubernetes environments, consider defining Pod Security Standards that prevent pods from running privileged containers and using theNodeRestrictionadmission controller to deny the kublet access to nodes and pods outside of the node it belongs to.[11][17]M1018User Account ManagementEnforce authentication and role-based access control on the container service to restrict users to the least privileges required.[11]When using Kubernetes, avoid giving users wildcard permissions or adding users to thesystem:mastersgroup, and useRoleBindingsrather thanClusterRoleBindingsto limit user privileges to specific namespaces.[18]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor commands and arguments executed by container services. In Docker, the daemon log provides insight into events at the daemon and container service level. Kubernetes system component logs may also detect activities running in and out of containers in the cluster.DS0009ProcessProcess CreationContainer administration service activities and executed commands can be captured through logging of process execution with command-line arguments on the container as well as within the underlying host.ReferencesDocker. (n.d.). DockerD CLI. Retrieved March 29, 2021.The Kubernetes Authors. (n.d.). The Kubernetes API. Retrieved March 29, 2021.The Kubernetes Authors. (n.d.). Kubelet. Retrieved March 29, 2021.Docker. (n.d.). Docker run reference. Retrieved March 29, 2021.Docker. (n.d.). Docker Exec. Retrieved March 29, 2021.The Kubernetes Authors. (n.d.). Get a Shell to a Running Container. Retrieved March 29, 2021.Chen, J. et al. (2021, February 3). Hildegard: New TeamTNT Cryptojacking Malware Targeting Kubernetes. Retrieved April 5, 2021.Singer, G. (2020, April 3). Threat Alert: Kinsing Malware Attacks Targeting Container Environments. Retrieved April 1, 2021.InGuardians. (2022, January 5). Peirates GitHub. Retrieved February 8, 2022.Prizmant, D. (2021, June 7). Siloscape: First Known Malware Targeting Windows Containers to Compromise Cloud Environments. Retrieved June 9, 2021.National Security Agency, Cybersecurity and Infrastructure Security Agency. (2022, March). Kubernetes Hardening Guide. Retrieved April 1, 2022.Kubernetes. (n.d.). Configure a Security Context for a Pod or Container. Retrieved March 8, 2023.Docker. (n.d.). Protect the Docker Daemon Socket. Retrieved March 29, 2021.The Kubernetes Authors. (n.d.). Controlling Access to The Kubernetes API. Retrieved March 29, 2021.Kubernetes. (n.d.). Overview of Cloud Native Security. Retrieved March 8, 2023.Microsoft. (2023, February 27). AKS-managed Azure Active Directory integration. Retrieved March 8, 2023.Kubernetes. (n.d.). Admission Controllers Reference. Retrieved March 8, 2023.Kubernetes. (n.d.). Role Based Access Control Good Practices. Retrieved March 8, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.