MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseSystem Binary Proxy ExecutionMavinjectSystem Binary Proxy Execution:MavinjectOther sub-techniques of System Binary Proxy Execution (14)IDNameT1218.001Compiled HTML FileT1218.002Control PanelT1218.003CMSTPT1218.004InstallUtilT1218.005MshtaT1218.007MsiexecT1218.008OdbcconfT1218.009Regsvcs/RegasmT1218.010Regsvr32T1218.011Rundll32T1218.012VerclsidT1218.013MavinjectT1218.014MMCT1218.015Electron ApplicationsAdversaries may abuse mavinject.exe to proxy execution of malicious code. Mavinject.exe is the Microsoft Application Virtualization Injector, a Windows utility that can inject code into external processes as part of Microsoft Application Virtualization (App-V).[1]Adversaries may abuse mavinject.exe to inject malicious DLLs into running processes (i.e.Dynamic-link Library Injection), allowing for arbitrary code execution (ex.C:\Windows\system32\mavinject.exe PID /INJECTRUNNING PATH_DLL).[2][3]Since mavinject.exe may be digitally signed by Microsoft, proxying execution via this method may evade detection by security products because the execution is masked under a legitimate process.In addition toDynamic-link Library Injection, Mavinject.exe can also be abused to perform import descriptor injection via its/HMODULEcommand-line parameter (ex.mavinject.exe PID /HMODULE=BASE_ADDRESS PATH_DLL ORDINAL_NUMBER). This command would inject an import table entry consisting of the specified DLL into the module at the given base address.[4]ID:T1218.013Sub-technique of:T1218ⓘTactic:Defense EvasionⓘPlatforms:WindowsVersion:2.0Created:22 September 2021Last Modified:19 April 2022Version PermalinkLive VersionMitigationsIDMitigationDescriptionM1042Disable or Remove Feature or ProgramConsider removing mavinject.exe if Microsoft App-V is not used within a given environment.M1038Execution PreventionUse application control configured to block execution of mavinject.exe if it is not required for a given system or network to prevent potential misuse by adversaries.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionAdversaries may rename abusable binaries to evade detections, but the argumentINJECTRUNNINGis required for mavinject.exe to performDynamic-link Library Injectionand may therefore be monitored to alert malicious activity.DS0009ProcessProcess CreationMonitor the execution and arguments of mavinject.exe. Compare recent invocations of mavinject.exe with prior history of known good arguments and injected DLLs to determine anomalous and potentially adversarial activity.ReferencesLOLBAS. (n.d.). Mavinject.exe. Retrieved September 22, 2021.Fernando Martinez. (2021, July 6). Lazarus campaign TTPs and evolution. Retrieved September 22, 2021.Reaqta. (2017, December 16). From False Positive to True Positive: the story of Mavinject.exe, the Microsoft Injector. Retrieved September 22, 2021.Matt Graeber. (2018, May 29). mavinject.exe Functionality Deconstructed. Retrieved September 22, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.