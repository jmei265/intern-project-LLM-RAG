MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseBoot or Logon Initialization ScriptsBoot or Logon Initialization ScriptsSub-techniques (5)IDNameT1037.001Logon Script (Windows)T1037.002Login HookT1037.003Network Logon ScriptT1037.004RC ScriptsT1037.005Startup ItemsAdversaries may use scripts automatically executed at boot or logon initialization to establish persistence.[1][2]Initialization scripts can be used to perform administrative functions, which may often execute other programs or send information to an internal logging server. These scripts can vary based on operating system and whether applied locally or remotely.Adversaries may use these scripts to maintain persistence on a single system. Depending on the access configuration of the logon scripts, either local credentials or an administrator account may be necessary.An adversary may also be able to escalate their privileges since some boot or logon initialization scripts run with higher privileges.ID:T1037Sub-techniques:T1037.001,T1037.002,T1037.003,T1037.004,T1037.005ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:Linux, Network, Windows, macOSVersion:2.3Created:31 May 2017Last Modified:16 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0016APT29APT29has hijacked legitimate application-specific startup scripts to enable malware to execute on system startup.[1]G0106RockeRockehas installed an "init.d" startup script to maintain persistence.[2]S1078RotaJakiroDepending on the Linux distribution and when executing with root permissions,RotaJakiromay install persistence using a.conffile in the/etc/init/folder.[3]MitigationsIDMitigationDescriptionM1022Restrict File and Directory PermissionsRestrict write access to logon scripts to specific administrators.M1024Restrict Registry PermissionsEnsure proper permissions are set for Registry hives to prevent users from modifying keys for logon scripts that may lead to persistence.DetectionIDData SourceData ComponentDetectsDS0026Active DirectoryActive Directory Object ModificationMonitor for changes made in the Active Directory that may use scripts automatically executed at boot or logon initialization to establish persistence.DS0017CommandCommand ExecutionMonitor executed commands and arguments that may consist of logon scripts for unusual access by abnormal users or at abnormal times.DS0022FileFile CreationMonitor for newly constructed files that may use scripts automatically executed at boot or logon initialization to establish persistence.File ModificationMonitor for changes made to files that are modified by unusual accounts outside of normal administration duties.DS0009ProcessProcess CreationMonitor for newly executed processes that may use scripts automatically executed at boot or logon initialization to establish persistence. Adversaries may schedule software to run whenever a user logs into the system; this is done to establish persistence and sometimes for lateral movement. This trigger is established through the registry keyHKEY_CURRENT_USER\EnvironmentUserInitMprLogonScript. This signature looks edits to existing keys or creation of new keys in that path. Users purposefully adding benign scripts to this path will result in false positives; that case is rare, however. There are other ways of running a script at startup or login that are not covered in this signature. Note that this signature overlaps with the Windows Sysinternals Autoruns tool, which would also show changes to this registry path.Analytic 1 - Boot or Logon Initialization Scripts(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") AND CommandLine="regadd\EnvironmentUserInitMprLogonScript"DS0024Windows RegistryWindows Registry Key CreationMonitor for newly constructed windows registry keys that may use scripts automatically executed at boot or logon initialization to establish persistence.ReferencesMandiant. (2022, May 2). UNC3524: Eye Spy on Your Email. Retrieved August 17, 2023.Anomali Labs. (2019, March 15). Rocke Evolves Its Arsenal With a New Malware Family Written in Golang. Retrieved April 24, 2019.Alex Turing, Hui Wang. (2021, April 28). RotaJakiro: A long live secret backdoor with 0 VT detection. Retrieved June 14, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.