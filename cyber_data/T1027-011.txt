MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseObfuscated Files or InformationFileless StorageObfuscated Files or Information:Fileless StorageOther sub-techniques of Obfuscated Files or Information (13)IDNameT1027.001Binary PaddingT1027.002Software PackingT1027.003SteganographyT1027.004Compile After DeliveryT1027.005Indicator Removal from ToolsT1027.006HTML SmugglingT1027.007Dynamic API ResolutionT1027.008Stripped PayloadsT1027.009Embedded PayloadsT1027.010Command ObfuscationT1027.011Fileless StorageT1027.012LNK Icon SmugglingT1027.013Encrypted/Encoded FileAdversaries may store data in "fileless" formats to conceal malicious activity from defenses. Fileless storage can be broadly defined as any format other than a file. Common examples of non-volatile fileless storage include the Windows Registry, event logs, or WMI repository.[1][2]Similar to fileless in-memory behaviors such asReflective Code LoadingandProcess Injection, fileless data storage may remain undetected by anti-virus and other endpoint security tools that can only access specific file formats from disk storage.Adversaries may use fileless storage to conceal various types of stored data, including payloads/shellcode (potentially being used as part ofPersistence) and collected data not yet exfiltrated from the victim (e.g.,Local Data Staging). Adversaries also often encrypt, encode, splice, or otherwise obfuscate this fileless data when stored.Some forms of fileless storage activity may indirectly create artifacts in the file system, but in central and otherwise difficult to inspect formats such as the WMI (e.g.,%SystemRoot%\System32\Wbem\Repository) or Registry (e.g.,%SystemRoot%\System32\Config) physical files.[1]ID:T1027.011Sub-technique of:T1027ⓘTactic:Defense EvasionⓘPlatforms:WindowsContributors:Christopher Peacock; Denise Tan; Mark Wee; Simona David; Xavier RousseauVersion:1.0Created:23 March 2023Last Modified:04 May 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0050APT32APT32's backdoor has stored its configuration in a registry key.[3]S0631ChaesSome versions ofChaesstored its instructions (otherwise in ainstructions.inifile) in the Registry.[4]S0023CHOPSTICKCHOPSTICKmay store RC4 encrypted configuration information in the Windows Registry.[5]S0126ComRATComRAThas stored encrypted orchestrator code and payloads in the Registry.[6][7]S0673DarkWatchmanDarkWatchmancan store configuration strings, keylogger, and output of components in the Registry.[8]S0343Exaramel for WindowsExaramel for Windowsstores the backdoor's configuration in the Registry in XML format.[9]S0666GelsemiumGelsemiumcan store its components in the Registry.[10]S0531GrandoreiroGrandoreirocan store its configuration in the Registry atHKCU\Software\under frequently changing names including%USERNAME%andToolTech-RM.[11]S0256MosquitoMosquitostores configuration values under the Registry keyHKCU\Software\Microsoft[dllname].[12]S0198NETWIRENETWIREcan store its configuration information in the Registry underHKCU:\Software\Netwire.[13]C0012Operation CuckooBeesDuringOperation CuckooBees, the threat actors stroed payloads in Windows CLFS (Common Log File System) transactional logs.[14]S0517PillowmintPillowminthas stored a compressed payload in the Registry keyHKLM\SOFTWARE\Microsoft\DRM.[15]S0501PipeMonPipeMonhas stored its encrypted payload in the Registry underHKLM\SOFTWARE\Microsoft\Print\Components\.[16]S0518PolyglotDukePolyglotDukecan store encrypted JSON configuration files in the Registry.[17]S0650QakBotQakBotcan store its configuration information in a randomly named subkey underHKCU\Software\Microsoft.[18][19]S0269QUADAGENTQUADAGENTstores a session identifier unique to the compromised system as well as a pre-shared key used for encrypting and decrypting C2 communications within a Registry key (such asHKCU\Office365DCOMCheck) in theHKCUhive.[20]S0662RCSessionRCSessioncan store its obfuscated configuration file in the Registry underHKLM\SOFTWARE\PlusorHKCU\SOFTWARE\Plus.[21][22]S0511RegDukeRegDukecan store its encryption key in the Registry.[17]S0496REvilREvilcan save encryption parameters and system information in the Registry.[23][24][25][26][27]S0596ShadowPadShadowPadmaintains a configuration block and virtual file system in the Registry.[28][29]S0589SibotSibothas installed a second-stage script in theHKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\sibotregistry key.[30]S0663SysUpdateSysUpdatecan store its encoded configuration file withinSoftware\Classes\scConfigin eitherHKEY_LOCAL_MACHINEorHKEY_CURRENT_USER.[31]S0665ThreatNeedleThreatNeedlecan save its configuration data as a RC4-encrypted Registry key underHKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\GameCon.[32]S0668TinyTurlaTinyTurlacan save its configuration parameters in the Registry.[33]G0010TurlaTurlahas used the Registry to store encrypted and encoded payloads.[34][35]S0263TYPEFRAMETYPEFRAMEcan install and store encrypted configuration data under the Registry keyHKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\ShellCompatibility\Applications\laxhost.dllandHKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\PrintConfigs.[36]S0022UroburosUroburoscan store configuration information for the kernel driver and kernel driver loader components in an encrypted blob typically found atHKLM:\SOFTWARE\Classes\.wav\OpenWithProgIds.[37]S0476ValakValakhas the ability to store information regarding the C2 server and downloads in the Registry keyHKCU\Software\ApplicationContainer\Appsw64.[38][39][40]S0180VolgmerVolgmerstores an encoded configuration file inHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\WMI\Security.[41][42]MitigationsIDMitigationDescriptionM1047AuditConsider periodic review of common fileless storage locations (such as the Registry or WMI repository) to potentially identify abnormal and malicious data.DetectionIDData SourceData ComponentDetectsDS0024Windows RegistryWindows Registry Key CreationMonitor for the creation of Registry values that may highlight storage of malicious data such as commands or payloads.DS0005WMIWMI CreationMonitor for the creation of WMI Objects and values that may highlight storage of malicious data such as commands or payloads.ReferencesMicrosoft. (2023, February 6). Fileless threats. Retrieved March 23, 2023.Legezo, D. (2022, May 4). A new secret stash for “fileless” malware. Retrieved March 23, 2023.Dumont, R. (2019, March 20). Fake or Fake: Keeping up with OceanLotus decoys. Retrieved April 1, 2019.Salem, E. (2020, November 17). CHAES: Novel Malware Targeting Latin American E-Commerce. Retrieved June 30, 2021.FireEye. (2015). APT28: A WINDOW INTO RUSSIA’S CYBER ESPIONAGE OPERATIONS?. Retrieved August 19, 2015.Faou, M. (2020, May). From Agent.btz to ComRAT v4: A ten-year journey. Retrieved June 15, 2020.CISA. (2020, October 29). Malware Analysis Report (AR20-303A). Retrieved December 9, 2020.Smith, S., Stafford, M. (2021, December 14). DarkWatchman: A new evolution in fileless techniques. Retrieved January 10, 2022.Cherepanov, A., Lipovsky, R. (2018, October 11). New TeleBots backdoor: First evidence linking Industroyer to NotPetya. Retrieved November 27, 2018.Dupuy, T. and Faou, M. (2021, June). Gelsemium. Retrieved November 30, 2021.ESET. (2020, April 28). Grandoreiro: How engorged can an EXE get?. Retrieved November 13, 2020.ESET, et al. (2018, January). Diplomats in Eastern Europe bitten by a Turla mosquito. Retrieved July 3, 2018.Lambert, T. (2020, January 29). Intro to Netwire. Retrieved January 7, 2021.Cybereason Nocturnus. (2022, May 4). Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques. Retrieved September 22, 2022.Trustwave SpiderLabs. (2020, June 22). Pillowmint: FIN7’s Monkey Thief . Retrieved July 27, 2020.Tartare, M. et al. (2020, May 21). No “Game over” for the Winnti Group. Retrieved August 24, 2020.Faou, M., Tartare, M., Dupuy, T. (2019, October). OPERATION GHOST. Retrieved September 23, 2020.Rainey, K. (n.d.). Qbot. Retrieved September 27, 2021.Group IB. (2020, September). LOCK LIKE  A PRO. Retrieved September 27, 2021.Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.Lunghi, D. et al. (2020, February). Uncovering DRBControl. Retrieved November 12, 2021.Global Threat Center, Intelligence Team. (2020, December). APT27 Turns to Ransomware. Retrieved November 12, 2021.Cylance. (2019, July 3). hreat Spotlight: Sodinokibi Ransomware. Retrieved August 4, 2020.Secureworks . (2019, September 24). REvil: The GandCrab Connection. Retrieved August 4, 2020.McAfee. (2019, October 2). McAfee ATR Analyzes Sodinokibi aka REvil Ransomware-as-a-Service – What The Code Tells Us. Retrieved August 4, 2020.Intel 471 Malware Intelligence team. (2020, March 31). REvil Ransomware-as-a-Service – An analysis of a ransomware affiliate operation. Retrieved August 4, 2020.Counter Threat Unit Research Team. (2019, September 24). REvil/Sodinokibi Ransomware. Retrieved August 4, 2020.Kaspersky Lab. (2017, August). ShadowPad: popular server management software hit in supply chain attack. Retrieved March 22, 2021.Chen, J., et al. (2022). Delving Deep: An Analysis of Earth Lusca’s Operations. Retrieved July 1, 2022.Nafisi, R., Lelli, A. (2021, March 4). GoldMax, GoldFinder, and Sibot: Analyzing NOBELIUM’s layered persistence. Retrieved March 8, 2021.Lunghi, D. and Lu, K. (2021, April 9). Iron Tiger APT Updates Toolkit With Evolved SysUpdate Malware. Retrieved November 12, 2021.Vyacheslav Kopeytsev and Seongsu Park. (2021, February 25). Lazarus targets defense industry with ThreatNeedle. Retrieved October 27, 2021.Cisco Talos. (2021, September 21). TinyTurla - Turla deploys new malware to keep a secret backdoor on victim machines. Retrieved December 2, 2021.Faou, M. and Dumont R.. (2019, May 29). A dive into Turla PowerShell usage. Retrieved June 14, 2019.Symantec DeepSight Adversary Intelligence Team. (2019, June 20). Waterbug: Espionage Group Rolls Out Brand-New Toolset in Attacks Against Governments. Retrieved July 8, 2019.US-CERT. (2018, June 14). MAR-10135536-12 – North Korean Trojan: TYPEFRAME. Retrieved July 13, 2018.FBI et al. (2023, May 9). Hunting Russian Intelligence “Snake” Malware. Retrieved June 8, 2023.Salem, E. et al. (2020, May 28). VALAK: MORE THAN MEETS THE EYE . Retrieved June 19, 2020.Duncan, B. (2020, July 24). Evolution of Valak, from Its Beginnings to Mass Distribution. Retrieved August 31, 2020.Reaves, J. and Platt, J. (2020, June). Valak Malware and the Connection to Gozi Loader ConfCrew. Retrieved August 31, 2020.US-CERT. (2017, November 22). Alert (TA17-318B): HIDDEN COBRA – North Korean Trojan: Volgmer. Retrieved December 7, 2017.Yagi, J. (2014, August 24). Trojan.Volgmer. Retrieved July 16, 2018.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.