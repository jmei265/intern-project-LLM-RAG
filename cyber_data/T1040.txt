MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseNetwork SniffingNetwork SniffingAdversaries may passively sniff network traffic to capture information about an environment, including authentication material passed over the network. Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection. An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.Data captured via this technique may include user credentials, especially those sent over an insecure, unencrypted protocol. Techniques for name service resolution poisoning, such asLLMNR/NBT-NS Poisoning and SMB Relay, can also be used to capture credentials to websites, proxies, and internal systems by redirecting traffic to an adversary.Network sniffing may reveal configuration details, such as running services, version numbers, and other network characteristics (e.g. IP addresses, hostnames, VLAN IDs) necessary for subsequentLateral Movementand/orDefense Evasionactivities. Adversaries may likely also utilize network sniffing duringAdversary-in-the-Middle(AiTM) to passively gain additional knowledge about the environment.In cloud-based environments, adversaries may still be able to use traffic mirroring services to sniff network traffic from virtual machines. For example, AWS Traffic Mirroring, GCP Packet Mirroring, and Azure vTap allow users to define specified instances to collect traffic from and specified targets to send collected traffic to.[1][2][3]Often, much of this traffic will be in cleartext due to the use of TLS termination at the load balancer level to reduce the strain of encrypting and decrypting traffic.[4][5]The adversary can then use exfiltration techniques such as Transfer Data to Cloud Account in order to access the sniffed traffic.[4]On network devices, adversaries may perform network captures usingNetwork Device CLIcommands such asmonitor capture.[6][7]ID:T1040Sub-techniques:No sub-techniquesⓘTactics:Credential Access,DiscoveryⓘPlatforms:IaaS, Linux, Network, Windows, macOSⓘSystem Requirements:Network interface access and packet capture driverContributors:Austin Clark, @c2defense; Eliraz Levi, Hunters; Itamar Mizrahi, Cymptom; Oleg Kolesnikov, Securonix; Tiago Faria, 3CORESecVersion:1.6Created:31 May 2017Last Modified:19 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionC00282015 Ukraine Electric Power AttackDuring the2015 Ukraine Electric Power Attack,Sandworm TeamusedBlackEnergy’s network sniffer module to discover user credentials being sent over the network between the local LAN and the power grid’s industrial control systems.[8]G0007APT28APT28deployed the open source tool Responder to conduct NetBIOS Name Service poisoning, which captured usernames and hashed passwords that allowed access to legitimate credentials.[9][10]APT28close-access teams have used Wi-Fi pineapples to intercept Wi-Fi signals and user credentials.[11]G0064APT33APT33has used SniffPass to collect credentials by sniffing network traffic.[12]G0105DarkVishnyaDarkVishnyaused network sniffing to obtain login data.[13]S0367EmotetEmotethas been observed to hook network APIs to monitor network traffic.[14]S0363EmpireEmpirecan be used to conduct packet captures on target hosts.[15]S0661FoggyWebFoggyWebcan configure custom listeners to passively monitor all incoming HTTP GET and POST requests sent to the AD FS server from the intranet/internet and intercept HTTP requests that match the custom URI patterns defined by the actor.[16]S0357ImpacketImpacketcan be used to sniff network traffic via an interface or raw socket.[17]G0094KimsukyKimsukyhas used the Nirsoft SniffPass network sniffer to obtain passwords sent over non-secure protocols.[18][19]S0443MESSAGETAPMESSAGETAPuses the libpcap library to listen to all traffic and parses network protocols starting with Ethernet and IP layers. It continues parsing protocol layers including SCTP, SCCP, and TCAP and finally extracts SMS message data and routing metadata.[20]S0590NBTscanNBTscancan dump and print whole packet content.[21][22]S0587PenquinPenquincan sniff network traffic to look for packets matching specific conditions.[23][24]S0378PoshC2PoshC2contains a module for taking packet captures on compromised hosts.[25]S0019ReginReginappears to have functionality to sniff for credentials passed over HTTP, SMTP, and SMB.[26]S0174ResponderRespondercaptures hashes and credentials that are sent to the system after the name services have been poisoned.[27]G0034Sandworm TeamSandworm Teamhas used intercepter-NG to sniff passwords in network traffic.[28]MitigationsIDMitigationDescriptionM1041Encrypt Sensitive InformationEnsure that all wired and/or wireless traffic is encrypted appropriately. Use best practices for authentication protocols, such as Kerberos, and ensure web traffic that may contain credentials is protected by SSL/TLS.M1032Multi-factor AuthenticationUse multi-factor authentication wherever possible.M1030Network SegmentationDeny direct access of broadcasts and multicast sniffing, and prevent attacks such asLLMNR/NBT-NS Poisoning and SMB RelayM1018User Account ManagementIn cloud environments, ensure that users are not granted permissions to create or modify traffic mirrors unless this is explicitly required.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments for actions that aid in sniffing network traffic to capture information about an environment, including authentication material passed over the networkDS0009ProcessProcess CreationMonitor for newly executed processes that can aid in sniffing network traffic to capture information about an environment, including authentication material passed over the networkNote: The Analytic is for Windows systems and looks for new processes that have the names of the most common network sniffing tools. While this may be noisy on networks where sysadmins are using any of these tools on a regular basis, in most networks their use is noteworthy.Analytic 1 - Windows(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") ANDImage="tshark.exe" ORImage="windump.exe" OR(Image="*logman.exe" AND ParentImage!="C:\Program Files\Windows Event Reporting\Core\EventReporting.AgentService.exe") ORImage= "tcpdump.exe" ORImage= "wprui.exe" ORImage= "wpr.exe" )ReferencesAmazon Web Services. (n.d.). How Traffic Mirroring works. Retrieved March 17, 2022.Google Cloud. (n.d.). Packet Mirroring overview. Retrieved March 17, 2022.Microsoft. (2022, February 9). Virtual network TAP. Retrieved March 17, 2022.Spencer Gietzen. (2019, September 17). Abusing VPC Traffic Mirroring in AWS. Retrieved March 17, 2022.Luke Paine. (2020, March 11). Through the Looking Glass — Part 1. Retrieved March 17, 2022.US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.Cisco. (2022, August 17). Configure and Capture Embedded Packet on Software. Retrieved July 13, 2022.Charles McLellan. (2016, March 4). How hackers attacked Ukraine's power grid: Implications for Industrial IoT security. Retrieved September 27, 2023.FireEye. (2015). APT28: A WINDOW INTO RUSSIA’S CYBER ESPIONAGE OPERATIONS?. Retrieved August 19, 2015.Smith, L. and Read, B.. (2017, August 11). APT28 Targets Hospitality Sector, Presents Threat to Travelers. Retrieved August 17, 2017.Brady, S . (2018, October 3). Indictment - United States vs Aleksei Sergeyevich Morenets, et al.. Retrieved October 1, 2020.Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019.Golovanov, S. (2018, December 6). DarkVishnya: Banks attacked through direct connection to local network. Retrieved May 15, 2020.Salvio, J.. (2014, June 27). New Banking Malware Uses Network Sniffing for Data Theft. Retrieved March 25, 2019.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.Ramin Nafisi. (2021, September 27). FoggyWeb: Targeted NOBELIUM malware leads to persistent backdoor. Retrieved October 4, 2021.SecureAuth. (n.d.).  Retrieved January 15, 2019.CISA, FBI, CNMF. (2020, October 27). https://us-cert.cisa.gov/ncas/alerts/aa20-301a. Retrieved November 4, 2020.ASERT team. (2018, December 5). STOLEN PENCIL Campaign Targets Academia. Retrieved February 5, 2019.Leong, R., Perez, D., Dean, T. (2019, October 31). MESSAGETAP: Who’s Reading Your Text Messages?. Retrieved May 11, 2020.Bezroutchko, A. (2019, November 19). NBTscan man page. Retrieved March 17, 2021.SecTools. (2003, June 11). NBTscan. Retrieved March 17, 2021.Leonardo. (2020, May 29). MALWARE TECHNICAL INSIGHT TURLA “Penquin_x64”. Retrieved March 11, 2021.Baumgartner, K. and Raiu, C. (2014, December 8). The ‘Penquin’ Turla. Retrieved March 11, 2021.Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.Kaspersky Lab's Global Research and Analysis Team. (2014, November 24). THE REGIN PLATFORM NATION-STATE OWNAGE OF GSM NETWORKS. Retrieved December 1, 2014.Gaffie, L. (2016, August 25). Responder. Retrieved November 17, 2017.Cherepanov, A.. (2016, December 13). The rise of TeleBots: Analyzing disruptive KillDisk attacks. Retrieved June 10, 2020.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.