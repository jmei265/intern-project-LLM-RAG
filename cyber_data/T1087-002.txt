MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseAccount DiscoveryDomain AccountAccount Discovery:Domain AccountOther sub-techniques of Account Discovery (4)IDNameT1087.001Local AccountT1087.002Domain AccountT1087.003Email AccountT1087.004Cloud AccountAdversaries may attempt to get a listing of domain accounts. This information can help adversaries determine which domain accounts exist to aid in follow-on behavior such as targeting specific accounts which possess particular privileges.Commands such asnet user /domainandnet group /domainof theNetutility,dscacheutil -q groupon macOS, andldapsearchon Linux can list domain users and groups.PowerShellcmdlets includingGet-ADUserandGet-ADGroupMembermay enumerate members of Active Directory groups.[1]ID:T1087.002Sub-technique of:T1087ⓘTactic:DiscoveryⓘPlatforms:Linux, Windows, macOSContributors:ExtraHop; Miriam Wiesner, @miriamxyra, Microsoft SecurityVersion:1.2Created:21 February 2020Last Modified:15 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0552AdFindAdFindcan enumerate domain users.[2][3][4][5][6]G0096APT41APT41used built-innetcommands to enumerate domain administrator users.[7]S0239BankshotBankshotgathers domain and account names/information through process monitoring.[8]S0534BazarBazarhas the ability to identify domain administrator accounts.[9][10]S1068BlackCatBlackCatcan utilizenet usecommands to identify domain users.[11]S0521BloodHoundBloodHoundcan collect information about domain users, including identification of domain admin accounts.[12]S0635BoomBoxBoomBoxhas the ability to execute an LDAP query to enumerate the distinguished name, SAM account name, and display name for all domain users.[13]G0060BRONZE BUTLERBRONZE BUTLERhas usednet user /domainto identify account information.[14]S1063Brute Ratel C4Brute Ratel C4can use LDAP queries,net group "Domain Admins" /domainandnet user /domainfor discovery.[15][16]G0114ChimeraChimerahas has usednet user /domandnet user Administratorto enumerate domain accounts including administrator accounts.[17][18]S0154Cobalt StrikeCobalt Strikecan determine if the user on an infected machine is in the admin or domain admin group.[19]S0488CrackMapExecCrackMapExeccan enumerate the domain user accounts on a targeted system.[20]G0035DragonflyDragonflyhas used batch scripts to enumerate users on a victim domain controller.[21]S0105dsquerydsquerycan be used to gather information on user accounts within a domain.[22][23]S0363EmpireEmpirecan acquire local and domain user account information.[24][25]G1016FIN13FIN13can identify user accounts associated with a Service Principal Name and query Service Principal Names within the domain by utilizing the following scripts:GetUserSPNs.vbsandquerySpn.vbs.[26][27]G0037FIN6FIN6has used Metasploit’sPsExecNTDSGRAB module to obtain a copy of the victim's Active Directory database.[28]G0117Fox KittenFox Kittenhas used the Softerra LDAP browser to browse documentation on service accounts.[29]S1022IceAppleTheIceAppleActive Directory Querier module  can perform authenticated requests against an Active Directory server.[30]S0483IcedIDIcedIDcan query LDAP to identify additional users on the network to infect.[31]G0004Ke3changKe3changperforms account discovery using commands such asnet localgroup administratorsandnet group "REDACTED" /domainon specific permissions groups.[32]G1004LAPSUS$LAPSUS$has used the AD Explorer tool to enumerate users on a victim's network.[33][34]G0045menuPassmenuPasshas used the Microsoft administration tool csvde.exe to export Active Directory data.[35]G0069MuddyWaterMuddyWaterhas usedcmd.exe net user /domainto enumerate domain users.[36]S0039NetNetcommands used with the/domainflag can be used to gather information about and manipulate user accounts on the current domain.[37]G0049OilRigOilRighas runnet user,net user /domain,net group "domain admins" /domain, andnet group "Exchange Trusted Subsystem" /domainto get account listings on a victim.[38]C0012Operation CuckooBeesDuringOperation CuckooBees, the threat actors used thedsqueryanddsgetcommands to get domain environment information and to query users in administrative groups.[39]C0022Operation Dream JobDuringOperation Dream Job,Lazarus Groupqueried compromised victim's active directory servers to obtain the list of employees including administrator accounts.[40]C0014Operation WocaoDuringOperation Wocao, threat actors used thenetcommand to retrieve information about domain accounts.[41]S0165OSInfoOSInfoenumerates local and domain users[42]G0033Poseidon GroupPoseidon Groupsearches for administrator accounts on both the local victim machine and the network.[43]S0378PoshC2PoshC2can enumerate local and domain user account information.[44]S0184POWRUNERPOWRUNERmay collect user account information by runningnet user /domainor a series of other commands on a victim.[45]G0034Sandworm TeamSandworm Teamhas used a tool to query Active Directory using LDAP, discovering information about usernames listed in AD.[46]G1015Scattered SpiderScattered Spiderleverages legitimate domain accounts to gain access to the target environment.[47][48]S0692SILENTTRINITYSILENTTRINITYcan useSystem.Security.AccessControlnamespaces to retrieve domain user information.[49]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29used PowerShell to discover domain accounts by exectuingGet-ADUserandGet-ADGroupMember.[1][50]S0516SoreFangSoreFangcan enumerate domain accounts vianet.exe user /domain.[51]S0603StuxnetStuxnetenumerates user accounts of the domain.[52]S0018SykipotSykipotmay usenet group "domain admins" /domainto display accounts in the "domain admins" permissions group andnet localgroup "administrators"to list local system administrator group membership.[53]G1022ToddyCatToddyCathas runnet user %USER% /domfor account discovery.[54]G0010TurlaTurlahas usednet user /domainto enumerate domain accounts.[55]S0476ValakValakhas the ability to enumerate domain admin accounts.[56]G1017Volt TyphoonVolt Typhoonhas runnet group /domandnet group "Domain Admins" /domin compromised environments for account discovery.[57][58]G0102Wizard SpiderWizard Spiderhas identified domain admins through the use ofnet group "Domain admins" /DOMAIN.Wizard Spiderhas also leveraged the PowerShell cmdletGet-ADComputerto collect account names from Active Directory data.[10][59]MitigationsIDMitigationDescriptionM1028Operating System ConfigurationPrevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located atHKLM\ SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI\EnumerateAdministrators. It can be disabled through GPO: Computer Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: Enumerate administrator accounts on elevation.[60]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor for execution of commands and arguments associated with enumeration or information gathering of domain accounts and groups, such asnet user /domainandnet group /domain,dscacheutil -q groupon macOS, andldapsearchon Linux.System and network discovery techniques normally occur throughout an operation as an adversary learns the environment, and also to an extent in normal network operations. Therefore discovery data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.DS0036GroupGroup EnumerationMonitor for logging that may suggest a list of available groups and/or their associated settings has been extracted, ex. Windows EID 4798 and 4799.DS0029Network TrafficNetwork Traffic ContentMonitor and analyze traffic patterns and packet inspection associated to LDAP and MSRPC that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure).DS0009ProcessOS API ExecutionMonitor for API calls that may attempt to gather information about domain accounts such as type of user, privileges and groups.Process CreationMonitor for processes that can be used to enumerate domain accounts and groups, such asnet.exeandnet1.exe, especially when executed in quick succession.[61]Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.ReferencesCrowdStrike. (2022, January 27). Early Bird Catches the Wormhole: Observations from the StellarParticle Campaign. Retrieved February 7, 2022.Brian Donohue, Katie Nickels, Paul Michaud, Adina Bodkins, Taylor Chapman, Tony Lambert, Jeff Felling, Kyle Rainey, Mike Haag, Matt Graeber, Aaron Didier.. (2020, October 29). A Bazar start: How one hospital thwarted a Ryuk ransomware outbreak. Retrieved October 30, 2020.McKeague, B. et al. (2019, April 5). Pick-Six: Intercepting a FIN6 Intrusion, an Actor Recently Tied to Ryuk and LockerGoga Ransomware. Retrieved April 17, 2019.Goody, K., et al (2019, January 11). A Nasty Trick: From Credential Theft Malware to Business Disruption. Retrieved May 12, 2020.Cybereason. (2022, August 17). Bumblebee Loader – The High Road to Enterprise Domain Control. Retrieved August 29, 2022.Kamble, V. (2022, June 28). Bumblebee: New Loader Rapidly Assuming Central Position in Cyber-crime Ecosystem. Retrieved August 24, 2022.Nikita Rostovcev. (2022, August 18). APT41 World Tour 2021 on a tight schedule. Retrieved February 22, 2024.Sherstobitoff, R. (2018, March 08). Hidden Cobra Targets Turkish Financial Sector With New Bankshot Implant. Retrieved May 18, 2018.Pantazopoulos, N. (2020, June 2). In-depth analysis of the new Team9 malware family. Retrieved December 1, 2020.The DFIR Report. (2020, October 8). Ryuk’s Return. Retrieved October 9, 2020.Microsoft Defender Threat Intelligence. (2022, June 13). The many lives of BlackCat ransomware. Retrieved December 20, 2022.Red Team Labs. (2018, April 24). Hidden Administrative Accounts: BloodHound to the Rescue. Retrieved October 28, 2020.MSTIC. (2021, May 28). Breaking down NOBELIUM’s latest early-stage toolset. Retrieved August 4, 2021.Counter Threat Unit Research Team. (2017, October 12). BRONZE BUTLER Targets Japanese Enterprises. Retrieved January 4, 2018.Harbison, M. and Renals, P. (2022, July 5). When Pentest Tools Go Brutal: Red-Teaming Tool Being Abused by Malicious Actors. Retrieved February 1, 2023.Kenefick, I. et al. (2022, October 12). Black Basta Ransomware Gang Infiltrates Networks via QAKBOT, Brute Ratel, and Cobalt Strike. Retrieved February 6, 2023.Cycraft. (2020, April 15). APT Group Chimera - APT Operation Skeleton key Targets Taiwan Semiconductor Vendors. Retrieved August 24, 2020.Jansen, W . (2021, January 12). Abusing cloud services to fly under the radar. Retrieved January 19, 2021.Dahan, A. et al. (2019, December 11). DROPPING ANCHOR: FROM A TRICKBOT INFECTION TO THE DISCOVERY OF THE ANCHOR MALWARE. Retrieved September 10, 2020.byt3bl33d3r. (2018, September 8). SMB: Command Reference. Retrieved July 17, 2020.US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.Microsoft. (n.d.). Dsquery. Retrieved April 18, 2016.Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.SecureWorks 2019, August 27 LYCEUM Takes Center Stage in Middle East Campaign Retrieved. 2019/11/19Ta, V., et al. (2022, August 8). FIN13: A Cybercriminal Threat Actor Focused on Mexico. Retrieved February 9, 2023.Sygnia Incident Response Team. (2022, January 5). TG2003: ELEPHANT BEETLE UNCOVERING AN ORGANIZED FINANCIAL-THEFT OPERATION. Retrieved February 9, 2023.FireEye Threat Intelligence. (2016, April). Follow the Money: Dissecting the Operations of the Cyber Crime Group FIN6. Retrieved June 1, 2016.CISA. (2020, September 15). Iran-Based Threat Actor Exploits VPN Vulnerabilities. Retrieved December 21, 2020.CrowdStrike. (2022, May). ICEAPPLE: A NOVEL INTERNET INFORMATION SERVICES (IIS) POST-EXPLOITATION FRAMEWORK. Retrieved June 27, 2022.Kessem, L., et al. (2017, November 13). New Banking Trojan IcedID Discovered by IBM X-Force Research. Retrieved July 14, 2020.Villeneuve, N., Bennett, J. T., Moran, N., Haq, T., Scott, M., & Geers, K. (2014). OPERATION “KE3CHANG”: Targeted Attacks Against Ministries of Foreign Affairs. Retrieved November 12, 2014.MSTIC, DART, M365 Defender. (2022, March 24). DEV-0537 Criminal Actor Targeting Organizations for Data Exfiltration and Destruction. Retrieved May 17, 2022.Brown, D., et al. (2022, April 28). LAPSUS$: Recent techniques, tactics and procedures. Retrieved December 22, 2022.PwC and BAE Systems. (2017, April). Operation Cloud Hopper: Technical Annex. Retrieved April 13, 2017.Peretz, A. and Theck, E. (2021, March 5). Earth Vetala – MuddyWater Continues to Target Organizations in the Middle East. Retrieved March 18, 2021.Microsoft. (2017, February 14). Net Commands On Windows Operating Systems. Retrieved March 19, 2020.Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.Cybereason Nocturnus. (2022, May 4). Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques. Retrieved September 22, 2022.Breitenbacher, D and Osis, K. (2020, June 17). OPERATION IN(TER)CEPTION: Targeted Attacks Against European Aerospace and Military Companies. Retrieved December 20, 2021.Dantzig, M. v., Schamper, E. (2019, December 19). Operation Wocao: Shining a light on one of China’s hidden hacking groups. Retrieved October 8, 2020.Symantec Security Response. (2016, September 6). Buckeye cyberespionage group shifts gaze from US to Hong Kong. Retrieved September 26, 2016.Kaspersky Lab's Global Research and Analysis Team. (2016, February 9). Poseidon Group: a Targeted Attack Boutique specializing in global cyber-espionage. Retrieved March 16, 2016.Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.Cherepanov, A.. (2016, December 13). The rise of TeleBots: Analyzing disruptive KillDisk attacks. Retrieved June 10, 2020.CISA. (2023, November 16). Cybersecurity Advisory: Scattered Spider (AA23-320A). Retrieved March 18, 2024.Microsoft. (2023, October 25). Octo Tempest crosses boundaries to facilitate extortion, encryption, and destruction. Retrieved March 18, 2024.Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.Secureworks CTU. (n.d.). IRON RITUAL. Retrieved February 24, 2022.CISA. (2020, July 16). MAR-10296782-1.v1 – SOREFANG. Retrieved September 29, 2020.Nicolas Falliere, Liam O Murchu, Eric Chien 2011, February W32.Stuxnet Dossier (Version 1.4) Retrieved. 2017/09/22Blasco, J. (2011, December 12). Another Sykipot sample likely targeting US federal agencies. Retrieved March 28, 2016.Dedola, G. et al. (2023, October 12). ToddyCat: Keep calm and check logs. Retrieved January 3, 2024.Faou, M. (2020, May). From Agent.btz to ComRAT v4: A ten-year journey. Retrieved June 15, 2020.Salem, E. et al. (2020, May 28). VALAK: MORE THAN MEETS THE EYE . Retrieved June 19, 2020.NSA et al. (2023, May 24). People's Republic of China State-Sponsored Cyber Actor Living off the Land to Evade Detection. Retrieved July 27, 2023.Counter Threat Unit Research Team. (2023, May 24). Chinese Cyberespionage Group BRONZE SILHOUETTE Targets U.S. Government and Defense Organizations. Retrieved July 27, 2023.Shilko, J., et al. (2021, October 7). FIN12: The Prolific Ransomware Intrusion Threat Actor That Has Aggressively Pursued Healthcare Targets. Retrieved June 15, 2023.UCF. (n.d.). The system must require username and password to elevate a running application.. Retrieved December 18, 2017.Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 30, 2020.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.