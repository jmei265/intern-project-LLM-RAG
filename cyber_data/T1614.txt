MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseSystem Location DiscoverySystem Location DiscoverySub-techniques (1)IDNameT1614.001System Language DiscoveryAdversaries may gather information in an attempt to calculate the geographical location of a victim host. Adversaries may use the information fromSystem Location Discoveryduring automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.Adversaries may attempt to infer the location of a system using various system checks, such as time zone, keyboard layout, and/or language settings.[1][2][3]Windows API functions such asGetLocaleInfoWcan also be used to determine the locale of the host.[1]In cloud environments, an instance's availability zone may also be discovered by accessing the instance metadata service from the instance.[4][5]Adversaries may also attempt to infer the location of a victim host using IP addressing, such as via online geolocation IP-lookup services.[6][2]ID:T1614Sub-techniques:T1614.001ⓘTactic:DiscoveryⓘPlatforms:IaaS, Linux, Windows, macOSⓘPermissions Required:UserContributors:Hiroki Nagahama, NEC Corporation; Katie Nickels, Red Canary; Manikantan Srinivasan, NEC Corporation India; Pooja Natarajan, NEC Corporation India; Wes HurdVersion:1.0Created:01 April 2021Last Modified:15 October 2021Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS1025AmadeyAmadeydoes not run any tasks or install additional malware if the victim machine is based in Russia.[7]S0115CrimsonCrimsoncan identify the geographical location of a victim host.[8]S1111DarkGateDarkGatequeries system locale information during execution.[9]Later versions ofDarkGatequeryGetSystemDefaultLCIDfor locale information to determine if the malware is executing in Russian-speaking countries.[10]S0673DarkWatchmanDarkWatchmancan identity the OS locale of a compromised host.[11]S0632GrimAgentGrimAgentcan identify the country code on a compromised host.[12]S0262QuasarRATQuasarRATcan determine the country a victim host is located in.[13]S0481Ragnar LockerBefore executing malicious code,Ragnar Lockerchecks the Windows APIGetLocaleInfoWand doesn't encrypt files if it finds a former Soviet country.[1]S1018Saint BotSaint Bothas conducted system locale checks to see if the compromised host is in Russia, Ukraine, Belarus, Armenia, Kazakhstan, or Moldova.[14][15]S0461SDBbotSDBbotcan collected the country code of a compromised machine.[16]G1008SideCopySideCopyhas identified the country location of a compromised host.[17]S1124SocGholishSocGholishcan use IP-based geolocation to limit infections to victims in North America, Europe, and a small number of Asian-Pacific nations.[18]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may gather information in an attempt to calculate the geographical location of a victim host.DS0009ProcessOS API ExecutionRemote access tools with built-in features may interact directly with the Windows API, such as callingGetLocaleInfoWto gather information.[1]Process CreationMonitor newly executed processes that may gather information in an attempt to calculate the geographical location of a victim host.ReferencesFBI. (2020, November 19). Indicators of Compromise Associated with Ragnar Locker Ransomware. Retrieved April 1, 2021.Wisniewski, C. (2016, May 3). Location-based threats: How cybercriminals target you based on where you live. Retrieved April 1, 2021.Abrams, L. (2020, October 23). New RAT malware gets commands via Discord, has ransomware feature. Retrieved April 1, 2021.Amazon. (n.d.). Instance identity documents. Retrieved April 2, 2021.Microsoft. (2021, February 21). Azure Instance Metadata Service (Windows). Retrieved April 2, 2021.Dedola, G. (2020, August 20). Transparent Tribe: Evolution analysis, part 1. Retrieved April 1, 2021.Kasuya, M. (2020, January 8). Threat Spotlight: Amadey Bot Targets Non-Russian Users. Retrieved July 14, 2022.Dedola, G. (2020, August 20). Transparent Tribe: Evolution analysis, part 1. Retrieved September 2, 2021.Adi Zeligson & Rotem Kerner. (2018, November 13). Enter The DarkGate - New Cryptocurrency Mining and Ransomware Campaign. Retrieved February 9, 2024.Ernesto Fernández Provecho, Pham Duy Phuc, Ciana Driscoll & Vinoo Thomas. (2023, November 21). The Continued Evolution of the DarkGate Malware-as-a-Service. Retrieved February 9, 2024.Smith, S., Stafford, M. (2021, December 14). DarkWatchman: A new evolution in fileless techniques. Retrieved January 10, 2022.Priego, A. (2021, July). THE BROTHERS GRIM: THE REVERSING TALE OF GRIMAGENT MALWARE USED BY RYUK. Retrieved July 16, 2021.CISA. (2018, December 18). Analysis Report (AR18-352A) Quasar Open-Source Remote Administration Tool. Retrieved August 1, 2022.Hasherezade. (2021, April 6). A deep dive into Saint Bot, a new downloader. Retrieved June 9, 2022.Unit 42. (2022, February 25). Spear Phishing Attacks Target Organizations in Ukraine, Payloads Include the Document Stealer OutSteel and the Downloader SaintBot. Retrieved June 9, 2022.Financial Security Institute. (2020, February 28). Profiling of TA505 Threat Group That Continues to Attack the Financial Sector. Retrieved July 14, 2022.Threat Intelligence Team. (2021, December 2). SideCopy APT: Connecting lures victims, payloads to infrastructure. Retrieved June 13, 2022.Secureworks. (n.d.). GOLD PRELUDE . Retrieved March 22, 2024.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.