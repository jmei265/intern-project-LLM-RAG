MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseModify Authentication ProcessMulti-Factor AuthenticationModify Authentication Process:Multi-Factor AuthenticationOther sub-techniques of Modify Authentication Process (9)IDNameT1556.001Domain Controller AuthenticationT1556.002Password Filter DLLT1556.003Pluggable Authentication ModulesT1556.004Network Device AuthenticationT1556.005Reversible EncryptionT1556.006Multi-Factor AuthenticationT1556.007Hybrid IdentityT1556.008Network Provider DLLT1556.009Conditional Access PoliciesAdversaries may disable or modify multi-factor authentication (MFA) mechanisms to enable persistent access to compromised accounts.Once adversaries have gained access to a network by either compromising an account lacking MFA or by employing an MFA bypass method such asMulti-Factor Authentication Request Generation, adversaries may leverage their access to modify or completely disable MFA defenses. This can be accomplished by abusing legitimate features, such as excluding users from Azure AD Conditional Access Policies, registering a new yet vulnerable/adversary-controlled MFA method, or by manually patching MFA programs and configuration files to bypass expected functionality.[1][2]For example, modifying the Windows hosts file (C:\windows\system32\drivers\etc\hosts) to redirect MFA calls to localhost instead of an MFA server may cause the MFA process to fail. If a "fail open" policy is in place, any otherwise successful authentication attempt may be granted access without enforcing MFA.[3]Depending on the scope, goals, and privileges of the adversary, MFA defenses may be disabled for individual accounts or for all accounts tied to a larger group, such as all domain accounts in a victim's network environment.[3]ID:T1556.006Sub-technique of:T1556ⓘTactics:Credential Access,Defense Evasion,PersistenceⓘPlatforms:Azure AD, Google Workspace, IaaS, Linux, Office 365, SaaS, Windows, macOSⓘDefense Bypassed:Multi-Factor AuthenticationContributors:Liran Ravich, CardinalOps; Muhammad Moiz Arshad, @5T34L7HVersion:1.2Created:31 May 2022Last Modified:16 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0677AADInternalsTheAADInternalsSet-AADIntUserMFAcommand can be used to disable MFA for a specified user.G1015Scattered SpiderAfter compromising user accounts,Scattered Spiderregisters their own MFA tokens.[4]S1104SLOWPULSESLOWPULSEcan insert malicious logic to bypass RADIUS and ACE two factor authentication (2FA) flows if a designated attacker-supplied password is provided.[5]MitigationsIDMitigationDescriptionM1047AuditReview MFA actions alongside authentication logs to ensure that MFA-based logins are functioning as intended. Review user accounts to ensure that all accounts have MFA enabled.[6]M1032Multi-factor AuthenticationEnsure that MFA and MFA policies and requirements are properly implemented for existing and deactivated or dormant accounts and devices. If possible, consider configuring MFA solutions to "fail closed" rather than grant access in case of serious errors.M1018User Account ManagementEnsure that proper policies are implemented to dictate the secure enrollment and deactivation of MFA for user accounts.DetectionIDData SourceData ComponentDetectsDS0026Active DirectoryActive Directory Object ModificationMonitor for changes made to AD security settings related to MFA logon requirements, such as changes to Azure AD Conditional Access Policies or the registration of new MFA applications.DS0015Application LogApplication Log ContentMonitor for changes made to global multi-factor authentication settings in Identity-as-a-Service providers. For example, in Okta environments, the eventssystem.mfa.factor.activateandsystem.mfa.factor.deactivatewill trigger when an MFA factor is globally activated or deactivated.[7]DS0028Logon SessionLogon Session CreationMonitor for logon sessions for user accounts and devices that did not require MFA for authentication.DS0002User AccountUser Account AuthenticationMonitor for account authentications in which MFA credentials are not provided by the user account to the authenticating entity.User Account ModificationMonitor for the enrollment of devices and user accounts with alternative security settings that do not require MFA credentials for successful logon. Monitor for attempts to disable MFA on individual user accounts.[6]Additionally, monitor for attempts to change or reset users’ MFA factor settings. For example, in Okta environments, the eventuser.mfa.factor.reset_allwill trigger when all MFA factors are reset for a user.[7]ReferencesMandiant. (n.d.). APT42: Crooked Charms, Cons and Compromise. Retrieved September 16, 2022.Microsoft. (2022, August 26). Use Azure AD access reviews to manage users excluded from Conditional Access policies. Retrieved August 30, 2022.Cyber Security Infrastructure Agency. (2022, March 15). Russian State-Sponsored Cyber Actors Gain Network Access by Exploiting Default Multifactor Authentication Protocols and “PrintNightmare” Vulnerability. Retrieved May 31, 2022.CISA. (2023, November 16). Cybersecurity Advisory: Scattered Spider (AA23-320A). Retrieved March 18, 2024.Perez, D. et al. (2021, April 20). Check Your Pulse: Suspected APT Actors Leverage Authentication Bypass Techniques and Pulse Secure Zero-Day. Retrieved February 5, 2024.Pany, D. & Hanley, C. (2023, May 3). Cloudy with a Chance of Bad Logs: Cloud Platform Log Configurations to Consider in Investigations. Retrieved October 16, 2023.Okta Defensive Cyber Operations. (2023, August 31). Cross-Tenant Impersonation: Prevention and Detection. Retrieved March 4, 2024.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.