MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseBoot or Logon Autostart ExecutionPrint ProcessorsBoot or Logon Autostart Execution:Print ProcessorsOther sub-techniques of Boot or Logon Autostart Execution (14)IDNameT1547.001Registry Run Keys / Startup FolderT1547.002Authentication PackageT1547.003Time ProvidersT1547.004Winlogon Helper DLLT1547.005Security Support ProviderT1547.006Kernel Modules and ExtensionsT1547.007Re-opened ApplicationsT1547.008LSASS DriverT1547.009Shortcut ModificationT1547.010Port MonitorsT1547.012Print ProcessorsT1547.013XDG Autostart EntriesT1547.014Active SetupT1547.015Login ItemsAdversaries may abuse print processors to run malicious DLLs during system boot for persistence and/or privilege escalation. Print processors are DLLs that are loaded by the print spooler service,spoolsv.exe, during boot.[1]Adversaries may abuse the print spooler service by adding print processors that load malicious DLLs at startup. A print processor can be installed through theAddPrintProcessorAPI call with an account that hasSeLoadDriverPrivilegeenabled. Alternatively, a print processor can be registered to the print spooler service by adding theHKLM\SYSTEM\[CurrentControlSet or ControlSet001]\Control\Print\Environments\[Windows architecture: e.g., Windows x64]\Print Processors\[user defined]\DriverRegistry key that points to the DLL.For the malicious print processor to be correctly installed, the payload must be located in the dedicated system print-processor directory, that can be found with theGetPrintProcessorDirectoryAPI call, or referenced via a relative path from this directory.[2]After the print processors are installed, the print spooler service, which starts during boot, must be restarted in order for them to run.[3]The print spooler service runs under SYSTEM level permissions, therefore print processors installed by an adversary may run under elevated privileges.ID:T1547.012Sub-technique of:T1547ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:WindowsⓘPermissions Required:Administrator, SYSTEMContributors:Mathieu Tartare, ESET; Tahseen Bin TajVersion:1.1Created:05 October 2020Last Modified:04 October 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG1006Earth LuscaEarth Luscahas added the Registry keyHKLM\SYSTEM\ControlSet001\Control\Print\Environments\Windows x64\Print Processors\UDPrint" /v Driver /d "spool.dll /fto load malware as a Print Processor.[4]S0666GelsemiumGelsemiumcan drop itself inC:\Windows\System32\spool\prtprocs\x64\winprint.dllto be loaded automatically by the spoolsv Windows service.[5]S0501PipeMonThePipeMoninstaller has modified the Registry keyHKLM\SYSTEM\CurrentControlSet\Control\Print\Environments\Windows x64\Print Processorsto installPipeMonas a Print Processor.[3]MitigationsIDMitigationDescriptionM1018User Account ManagementLimit user accounts that can load or unload device drivers by disablingSeLoadDriverPrivilege.DetectionIDData SourceData ComponentDetectsDS0027DriverDriver LoadMonitor for unusual kernel driver installation activity that may abuse print processors to run malicious DLLs during system boot for persistence and/or privilege escalation.DS0022FileFile CreationMonitor for newly constructed files that may abuse print processors to run malicious DLLs during system boot for persistence and/or privilege escalation.DS0011ModuleModule LoadMonitor for abnormal DLLs that are loaded byspoolsv.exe. Print processors that do not correlate with known good software or patching may be suspicious.  New print processor DLLs are written to the print processor directory.DS0009ProcessOS API ExecutionMonitor process API calls toAddPrintProcessorandGetPrintProcessorDirectory.DS0024Windows RegistryWindows Registry Key ModificationMonitor Registry writes toHKLM\SYSTEM\ControlSet001\Control\Print\Environments\[Windows architecture]\Print Processors\[user defined]\DriverorHKLM\SYSTEM\CurrentControlSet\Control\Print\Environments\[Windows architecture]\Print Processors\[user defined]\Driveras they pertain to print processor installations.ReferencesMicrosoft. (2023, June 26). Introduction to print processors. Retrieved September 27, 2023.Microsoft. (2018, May 31). AddPrintProcessor function. Retrieved October 5, 2020.Tartare, M. et al. (2020, May 21). No “Game over” for the Winnti Group. Retrieved August 24, 2020.Chen, J., et al. (2022). Delving Deep: An Analysis of Earth Lusca’s Operations. Retrieved July 1, 2022.Dupuy, T. and Faou, M. (2021, June). Gelsemium. Retrieved November 30, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.