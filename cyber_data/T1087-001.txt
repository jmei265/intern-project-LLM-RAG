MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseAccount DiscoveryLocal AccountAccount Discovery:Local AccountOther sub-techniques of Account Discovery (4)IDNameT1087.001Local AccountT1087.002Domain AccountT1087.003Email AccountT1087.004Cloud AccountAdversaries may attempt to get a listing of local system accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior.Commands such asnet userandnet localgroupof theNetutility andidandgroupson macOS and Linux can list local users and groups.[1][2][3]On Linux, local users can also be enumerated through the use of the/etc/passwdfile. On macOS thedscl . list /Userscommand can be used to enumerate local accounts.ID:T1087.001Sub-technique of:T1087ⓘTactic:DiscoveryⓘPlatforms:Linux, Windows, macOSContributors:Daniel Stepanic, Elastic; Miriam Wiesner, @miriamxyra, Microsoft SecurityVersion:1.4Created:21 February 2020Last Modified:11 January 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0018admin@338admin@338actors used the following commands following exploitation of a machine withLOWBALLmalware to enumerate user accounts:net user >> %temp%\downloadnet user /domain >> %temp%\download[4]S0331Agent TeslaAgent Teslacan collect account information from the victim’s machine.[5]G0006APT1APT1used the commandsnet localgroup,net user, andnet groupto find accounts on the system.[1]G0022APT3APT3has used a tool that can obtain info about local and global group users, power users, and administrators.[6]G0050APT32APT32enumerated administrative users using the commandsnet localgroup administrators.[7]G0096APT41APT41used built-innetcommands to enumerate local administrator groups.[8]S0239BankshotBankshotgathers domain and account names/information through process monitoring.[9]S0534BazarBazarcan identify administrator accounts on an infected host.[10]S0570BitPaymerBitPaymercan enumerate the sessions for each user logged onto the infected host.[11]S0521BloodHoundBloodHoundcan identify users with local administrator rights.[12]G0114ChimeraChimerahas usednet userfor account discovery.[13]S0244ComnieComnieuses thenet usercommand.[14]S0038DuquThe discovery modules used withDuqucan collect information on accounts and permissions.[15]S0081EliseEliseexecutesnet userafter initial communication is made to the remote server.[16]S0363EmpireEmpirecan acquire local and domain user account information.[17]S0091EpicEpicgathers a list of all user accounts, privilege classes, and time of last logon.[18]G0117Fox KittenFox Kittenhas accessed ntuser.dat and UserClass.dat on compromised hosts.[19]S0049GeminiDukeGeminiDukecollects information on local user accounts from the victim.[20]S0537HyperStackHyperStackcan enumerate all account names on a remote share.[21]S0260InvisiMoleInvisiMolehas a command to list account information on the victim’s machine.[22]S0265KazuarKazuargathers information on local groups and members on the victim’s machine.[23]G0004Ke3changKe3changperforms account discovery using commands such asnet localgroup administratorsandnet group "REDACTED" /domainon specific permissions groups.[24]S0236KwampirsKwampirscollects a list of accounts with the commandnet users.[25]S1015MilanMilanhas runC:\Windows\system32\cmd.exe /c cmd /c dir c:\users\ /s 2>&1to discover local accounts.[26]S0084Mis-TypeMis-Typemay create a file containing the results of the commandcmd.exe /c net user {Username}.[27]G1009Moses StaffMoses Staffhas collected the administrator username from a compromised host.[28]S0233MURKYTOPMURKYTOPhas the capability to retrieve information about users on remote hosts.[29]S0039NetCommands undernet usercan be used inNetto gather information about and manipulate user accounts.[30]G0049OilRigOilRighas runnet user,net user /domain,net group "domain admins" /domain, andnet group "Exchange Trusted Subsystem" /domainto get account listings on a victim.[31]C0012Operation CuckooBeesDuringOperation CuckooBees, the threat actors used thenet usercommand to gather account information.[32]S0165OSInfoOSInfoenumerates local and domain users[6]S0598P.A.S. WebshellP.A.S. Webshellcan display the /etc/passwd file on a compromised host.[33]S0453PonyPonyhas used theNetUserEnumfunction to enumerate local accounts.[34]G0033Poseidon GroupPoseidon Groupsearches for administrator accounts on both the local victim machine and the network.[35]S0378PoshC2PoshC2can enumerate local and domain user account information.[36]S0194PowerSploitPowerSploit'sGet-ProcessTokenGroupPrivesc-PowerUp module can enumerate all SIDs associated with its current token.[37][38]S0223POWERSTATSPOWERSTATScan retrieve usernames from compromised hosts.[39]S0196PUNCHBUGGYPUNCHBUGGYcan gather user names.[40]S0192PupyPupyuses PowerView and Pywerview to perform discovery commands such as net user, net group, net local group, etc.[41]S0241RATANKBARATANKBAuses thenet usercommand.[42]S0125RemsecRemseccan obtain a list of users.[43]S0085S-TypeS-Typehas run the commandnet useron a victim.[27]S0063SHOTPUTSHOTPUThas a command to retrieve information about connected users.[44]S0649SMOKEDHAMSMOKEDHAMhas usednet.exe userandnet.exe usersto enumerate local accounts on a compromised host.[45]S0516SoreFangSoreFangcan collect usernames from the local system vianet.exe user.[46]S0603StuxnetStuxnetenumerates user accounts of the local host.[47]G0027Threat Group-3390Threat Group-3390has usednet userto conduct internal discovery of systems.[48]S0266TrickBotTrickBotcollects the users of the system.[49][50]G0010TurlaTurlahas usednet userto enumerate local accounts on the system.[51][52]S0452USBferryUSBferrycan usenet userto gather information about local accounts.[53]S0476ValakValakhas the ability to enumerate local admin accounts.[54]MitigationsIDMitigationDescriptionM1028Operating System ConfigurationPrevent administrator accounts from being enumerated when an application is elevating through UAC since it can lead to the disclosure of account names. The Registry key is located atHKLM\ SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI\EnumerateAdministrators. It can be disabled through GPO: Computer Configuration > [Policies] > Administrative Templates > Windows Components > Credential User Interface: Enumerate administrator accounts on elevation.[55]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor for execution of commands and arguments associated with enumeration or information gathering of local accounts and groups such asnet user,net account,net localgroup,Get-LocalUser, anddscl.System and network discovery techniques normally occur throughout an operation as an adversary learns the environment, and also to an extent in normal network operations. Therefore discovery data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.DS0022FileFile AccessMonitor access to file resources that contain local accounts and groups information such as/etc/passwd,/Usersdirectories, and the Windows SAM database.If access requires high privileges, look for non-admin objects (such as users or processes) attempting to access restricted file resources.DS0036GroupGroup EnumerationMonitor for logging that may suggest a list of available groups and/or their associated settings has been extracted, ex. Windows EID 4798 and 4799.DS0009ProcessOS API ExecutionMonitor for API calls (such asNetUserEnum()) that may attempt to gather local accounts information such as type of user, privileges and groups.Process CreationMonitor for processes that can be used to enumerate user accounts and groups such asnet.exeandnet1.exe, especially when executed in quick succession.[56]Information may also be acquired through Windows system management tools such asWindows Management InstrumentationandPowerShell.Note: Event IDs are for Sysmon (Event ID 1 - process creation) and Windows Security Log (Event ID 4688 - a new process has been created). - For Linux, auditing frameworks such as the Linux Auditing System (auditd) can be used to alert on the enumeration/reading of files that store local users, including/etc/passwd. - For MacOS, utilities that work in concert with Apple’s Endpoint Security Framework such as Process Monitor can be used to track usage of commands such asidandgroups.Analytic 1 - Net Discovery Commands(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") Image="net.exe" OR Image="net1.exe"ReferencesMandiant. (n.d.). APT1 Exposing One of China’s Cyber Espionage Units. Retrieved July 18, 2016.MacKenzie, D. and Robbins, A. (n.d.). id(1) - Linux man page. Retrieved January 11, 2024.MacKenzie, D. and Youngman, J. (n.d.). groups(1) - Linux man page. Retrieved January 11, 2024.FireEye Threat Intelligence. (2015, December 1). China-based Cyber Threat Group Uses Dropbox for Malware Communications and Targets Hong Kong Media Outlets. Retrieved December 4, 2015.The DigiTrust Group. (2017, January 12). The Rise of Agent Tesla. Retrieved November 5, 2018.Symantec Security Response. (2016, September 6). Buckeye cyberespionage group shifts gaze from US to Hong Kong. Retrieved September 26, 2016.Dahan, A. (2017). Operation Cobalt Kitty. Retrieved December 27, 2018.Nikita Rostovcev. (2022, August 18). APT41 World Tour 2021 on a tight schedule. Retrieved February 22, 2024.Sherstobitoff, R. (2018, March 08). Hidden Cobra Targets Turkish Financial Sector With New Bankshot Implant. Retrieved May 18, 2018.Pantazopoulos, N. (2020, June 2). In-depth analysis of the new Team9 malware family. Retrieved December 1, 2020.Frankoff, S., Hartley, B. (2018, November 14). Big Game Hunting: The Evolution of INDRIK SPIDER From Dridex Wire Fraud to BitPaymer Targeted Ransomware. Retrieved January 6, 2021.Red Team Labs. (2018, April 24). Hidden Administrative Accounts: BloodHound to the Rescue. Retrieved October 28, 2020.Jansen, W . (2021, January 12). Abusing cloud services to fly under the radar. Retrieved January 19, 2021.Grunzweig, J. (2018, January 31). Comnie Continues to Target Organizations in East Asia. Retrieved June 7, 2018.Symantec Security Response. (2011, November). W32.Duqu: The precursor to the next Stuxnet. Retrieved September 17, 2015.Falcone, R., et al.. (2015, June 16). Operation Lotus Blossom. Retrieved February 15, 2016.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.Kaspersky Lab's Global Research & Analysis Team. (2014, August 06). The Epic Turla Operation: Solving some of the mysteries of Snake/Uroboros. Retrieved November 7, 2018.CISA. (2020, September 15). Iran-Based Threat Actor Exploits VPN Vulnerabilities. Retrieved December 21, 2020.F-Secure Labs. (2015, September 17). The Dukes: 7 years of Russian cyberespionage. Retrieved December 10, 2015.Accenture. (2020, October). Turla uses HyperStack, Carbon, and Kazuar to compromise government entity. Retrieved December 2, 2020.Hromcová, Z. (2018, June 07). InvisiMole: Surprisingly equipped spyware, undercover since 2013. Retrieved July 10, 2018.Levene, B, et al. (2017, May 03). Kazuar: Multiplatform Espionage Backdoor with API Access. Retrieved July 17, 2018.Villeneuve, N., Bennett, J. T., Moran, N., Haq, T., Scott, M., & Geers, K. (2014). OPERATION “KE3CHANG”: Targeted Attacks Against Ministries of Foreign Affairs. Retrieved November 12, 2014.Symantec Security Response Attack Investigation Team. (2018, April 23). New Orangeworm attack group targets the healthcare sector in the U.S., Europe, and Asia. Retrieved May 8, 2018.ClearSky Cyber Security . (2021, August). New Iranian Espionage Campaign By “Siamesekitten” - Lyceum. Retrieved June 6, 2022.Gross, J. (2016, February 23). Operation Dust Storm. Retrieved December 22, 2021.Checkpoint Research. (2021, November 15). Uncovering MosesStaff techniques: Ideology over Money. Retrieved August 11, 2022.FireEye. (2018, March 16). Suspected Chinese Cyber Espionage Group (TEMP.Periscope) Targeting U.S. Engineering and Maritime Industries. Retrieved April 11, 2018.Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015.Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.Cybereason Nocturnus. (2022, May 4). Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques. Retrieved September 22, 2022.ANSSI. (2021, January 27). SANDWORM INTRUSION SET CAMPAIGN TARGETING CENTREON SYSTEMS. Retrieved March 30, 2021.hasherezade. (2016, April 11). No money, but Pony! From a mail to a trojan horse. Retrieved May 21, 2020.Kaspersky Lab's Global Research and Analysis Team. (2016, February 9). Poseidon Group: a Targeted Attack Boutique specializing in global cyber-espionage. Retrieved March 16, 2016.Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018.PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018.Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018.Gorelik, M.. (2019, June 10). SECURITY ALERT: FIN8 IS BACK IN BUSINESS, TARGETING THE HOSPITALITY INDUSTRY. Retrieved June 13, 2019.Nicolas Verdier. (n.d.). Retrieved January 29, 2018.Trend Micro. (2017, February 27). RATANKBA: Delving into Large-scale Watering Holes against Enterprises. Retrieved May 22, 2018.Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Technical Analysis. Retrieved August 17, 2016.Falcone, R. and Wartell, R.. (2015, July 27). Observations on CVE-2015-3113, Prior Zero-Days and the Pirpi Payload. Retrieved January 22, 2016.FireEye. (2021, June 16). Smoking Out a DARKSIDE Affiliate’s Supply Chain Software Compromise. Retrieved September 22, 2021.CISA. (2020, July 16). MAR-10296782-1.v1 – SOREFANG. Retrieved September 29, 2020.Nicolas Falliere, Liam O Murchu, Eric Chien 2011, February W32.Stuxnet Dossier (Version 1.4) Retrieved. 2017/09/22Counter Threat Unit Research Team. (2017, June 27). BRONZE UNION Cyberespionage Persists Despite Disclosures. Retrieved July 13, 2017.Salinas, M., Holguin, J. (2017, June). Evolution of Trickbot. Retrieved July 31, 2018.Anthony, N., Pascual, C.. (2018, November 1). Trickbot Shows Off New Trick: Password Grabber Module. Retrieved November 16, 2018.Faou, M. (2020, May). From Agent.btz to ComRAT v4: A ten-year journey. Retrieved June 15, 2020.Faou, M. (2020, December 2). Turla Crutch: Keeping the “back door” open. Retrieved December 4, 2020.Chen, J.. (2020, May 12). Tropic Trooper’s Back: USBferry Attack Targets Air gapped Environments. Retrieved May 20, 2020.Salem, E. et al. (2020, May 28). VALAK: MORE THAN MEETS THE EYE . Retrieved June 19, 2020.UCF. (n.d.). The system must require username and password to elevate a running application.. Retrieved December 18, 2017.Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 30, 2020.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.