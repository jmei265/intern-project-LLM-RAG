MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseHide ArtifactsHidden Files and DirectoriesHide Artifacts:Hidden Files and DirectoriesOther sub-techniques of Hide Artifacts (12)IDNameT1564.001Hidden Files and DirectoriesT1564.002Hidden UsersT1564.003Hidden WindowT1564.004NTFS File AttributesT1564.005Hidden File SystemT1564.006Run Virtual InstanceT1564.007VBA StompingT1564.008Email Hiding RulesT1564.009Resource ForkingT1564.010Process Argument SpoofingT1564.011Ignore Process InterruptsT1564.012File/Path ExclusionsAdversaries may set files and directories to be hidden to evade detection mechanisms. To prevent normal users from accidentally changing special files on a system, most operating systems have the concept of a ‘hidden’ file. These files don’t show up when a user browses the file system with a GUI or when using normal commands on the command line. Users must explicitly ask to show the hidden files either via a series of Graphical User Interface (GUI) prompts or with command line switches (dir /afor Windows andls –afor Linux and macOS).On Linux and Mac, users can mark specific files as hidden simply by putting a "." as the first character in the file or folder name[1][2]. Files and folders that start with a period, ‘.’, are by default hidden from being viewed in the Finder application and standard command-line utilities like "ls". Users must specifically change settings to have these files viewable.Files on macOS can also be marked with the UF_HIDDEN flag which prevents them from being seen in Finder.app, but still allows them to be seen in Terminal.app[3]. On Windows, users can mark specific files as hidden by using the attrib.exe binary. Many applications create these hidden files and folders to store information so that it doesn’t clutter up the user’s workspace. For example, SSH utilities create a .ssh folder that’s hidden and contains the user’s known hosts and keys.Adversaries can use this to their advantage to hide files and folders anywhere on the system and evading a typical user or system analysis that does not incorporate investigation of hidden files.ID:T1564.001Sub-technique of:T1564ⓘTactic:Defense EvasionⓘPlatforms:Linux, Windows, macOSⓘPermissions Required:UserⓘDefense Bypassed:Host forensic analysisVersion:1.0Created:26 February 2020Last Modified:29 March 2020Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0331Agent TeslaAgent Teslahas created hidden folders.[4]S0584AppleJeusAppleJeushas added a leading.to plist filenames, unlisting them from the Finder app and default Terminal directory listings.[5]G0007APT28APT28has saved files with hidden file attributes.[6][6]G0050APT32APT32's macOS backdoor hides the clientID file via a chflags function.[7]S0438AttorAttorcan set attributes of log files and directories to HIDDEN, SYSTEM, ARCHIVE, or a combination of those.[8]S0475BackConfigBackConfighas the ability to set folders or files to be hidden from the Windows Explorer default view.[9]S0274CalistoCalistouses a hidden directory named .calisto to store data from the victim’s machine before exfiltration.[10][11]S0484CarberpCarberphas created a hidden file in the Startup folder of the current user.[12]S1043ccf32ccf32has created a hidden directory on targeted systems, naming it after the current local time (year, month, and day).[13]S0660ClamblingClamblinghas the ability to set its file attributes to hidden.[14]S1105COATHANGERCOATHANGERcreates and installs itself to a hidden installation directory.[15]S0369CoinTickerCoinTickerdownloads the following hidden files to evade detection and maintain persistence: /private/tmp/.info.enc, /private/tmp/.info.py, /private/tmp/.server.sh, ~/Library/LaunchAgents/.espl.plist, ~/Library/Containers/.[random string]/[random string].[16]S0497DaclsDaclshas had its payload named with a dot prefix to make it hidden from view in the Finder application.[17][18]S1111DarkGateDarkGateinitial installation involves dropping several files to a hidden directory named after the victim machine name.[19]S0634EnvyScoutEnvyScoutcan use hidden directories and files to hide malicious executables.[20]S0569ExplosiveExplosivehas commonly set file and path attributes to hidden.[21]G1016FIN13FIN13has created hidden files and folders within a compromised Linux system/tmpdirectory.FIN13also has usedattrib.exeto hide gathered local host information.[22][23]S0277FruitFlyFruitFlysaves itself with a leading "." to make it a hidden file.[24]G0125HAFNIUMHAFNIUMhas hidden files on a compromised host.[25]S0278iKitteniKittensaves itself with a leading "." so that it's hidden from users by default.[24]S0434Imminent MonitorImminent Monitorhas a dynamic debugging feature to set the file attribute to hidden.[26]S0260InvisiMoleInvisiMolecan create hidden system directories.[27]S0015IxesheIxeshesets its own executable file's attributes to hidden.[28]S0162KomplexTheKomplexpayload is stored in a hidden directory at/Users/Shared/.local/kextd.[1]G0032Lazarus GroupLazarus Grouphas used a VBA Macro to set its file attributes to System and Hidden and has named files with a dot prefix to hide them from the Finder application.[29][17][18][30]S0447LokibotLokibothas the ability to copy itself to a hidden file and directory.[31]S0451LoudMinerLoudMinerhas set the attributes of the VirtualBox directory and VBoxVmService parent directory to "hidden".[32]G1014LuminousMothLuminousMothhas used malware to store malicious binaries in hidden directories on victim's USB drives.[33]S0409MacheteMachetehas the capability to exfiltrate stolen data to a hidden folder on a removable drive.[34]S0282MacSpyMacSpystores itself in~/Library/.DS_Stores/[35]S0339MicropsiaMicropsiacreates a new hidden directory to store all components' outputs in a dedicated sub-folder for each.[36]G0129Mustang PandaMustang Panda'sPlugXvariant has created a hidden folder on USB drives namedRECYCLE.BINto store malicious executables and collected data.[37]S0198NETWIRENETWIREcan copy itself to and launch itself from hidden folders.[38]S0439OkrumBefore exfiltration,Okrum's backdoor has used hidden files to store logs and outputs from backdoor commands.[39]S0402OSX/ShlayerOSX/Shlayerhas executed a .command script from a hidden directory in a mounted DMG.[40]S0352OSX_OCEANLOTUS.DOSX_OCEANLOTUS.Dsets the main loader file’s attributes to hidden.[41]S0013PlugXPlugXcan modify the characteristics of folders to hide them from the compromised user.[42]S0428PoetRATPoetRAThas the ability to hide and unhide files.[43]S0650QakBotQakBothas placed its payload in hidden subdirectories.[44]S0262QuasarRATQuasarRAThas the ability to set file attributes to "hidden" to hide files from the compromised user's view in Windows File Explorer.[45]S0448Rising SunRising Suncan modify file attributes to hide files.[46]G0106RockeRockedownloaded a file "libprocesshider", which could hide files on the target system.[47][48]S0533SLOTHFULMEDIASLOTHFULMEDIAhas been created with a hidden attribute to insure it's not visible to the victim.[49]S0663SysUpdateSysUpdatehas the ability to set file attributes to hidden.[50]S0595ThiefQuestThiefQuesthides a copy of itself in the user's~/Librarydirectory by using a.at the beginning of the file name followed by 9 random characters.[51]G0134Transparent TribeTransparent Tribecan hide legitimate directories and replace them with malicious copies of the same name.[52]G0081Tropic TrooperTropic Trooperhas created a hidden directory underC:\ProgramData\Apple\Updates\andC:\Users\Public\Documents\Flash\.[53][54]S0366WannaCryWannaCryusesattrib +hto make some of its files hidden.[55]S0612WastedLockerWastedLockerhas copied a random file from the Windows System32 folder to the%APPDATA%location under a different hidden filename.[56]S0658XCSSETXCSSETuses a hidden folder named.xcassetsand.gitto embed itself in Xcode.[57]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor the file system and shell commands for files being created with a leading "." and the Windows command-line use of attrib.exe to add the hidden attribute.DS0022FileFile CreationMonitor the file system and shell commands for files being created with a leading "."File MetadataMonitor for contextual data about a file, which may include information such as name, the content (ex: signature, headers, or data/media), user/owner, permissions may set files and directories to be hidden to evade detection mechanisms.DS0009ProcessProcess CreationMonitor newly executed processes that may set files and directories to be hidden to evade detection mechanisms.ReferencesDani Creus, Tyler Halfpop, Robert Falcone. (2016, September 26). Sofacy's 'Komplex' OS X Trojan. Retrieved July 8, 2017.Thomas Reed. (2017, January 18). New Mac backdoor using antiquated code. Retrieved July 5, 2017.Claud Xiao. (n.d.). WireLurker: A New Era in iOS and OS X Malware. Retrieved July 10, 2017.Walter, J. (2020, August 10). Agent Tesla | Old RAT Uses New Tricks to Stay on Top. Retrieved December 11, 2020.Cybersecurity and Infrastructure Security Agency. (2021, February 21). AppleJeus: Analysis of North Korea’s Cryptocurrency Malware. Retrieved March 1, 2021.Mercer, W., et al. (2017, October 22). "Cyber Conflict" Decoy Document Used in Real Cyber Conflict. Retrieved November 2, 2018.Dumont, R.. (2019, April 9). OceanLotus: macOS malware update. Retrieved April 15, 2019.Hromcova, Z. (2019, October). AT COMMANDS, TOR-BASED COMMUNICATIONS: MEET ATTOR, A FANTASY CREATURE AND ALSO A SPY PLATFORM. Retrieved May 6, 2020.Hinchliffe, A. and Falcone, R. (2020, May 11). Updated BackConfig Malware Targeting Government and Military Organizations in South Asia. Retrieved June 17, 2020.Kuzin, M., Zelensky S. (2018, July 20). Calisto Trojan for macOS. Retrieved September 7, 2018.Pantig, J. (2018, July 30). OSX.Calisto. Retrieved September 7, 2018.Trusteer Fraud Prevention Center. (2010, October 7). Carberp Under the Hood of Carberp: Malware & Configuration Analysis. Retrieved July 15, 2020.Vrabie, V. (2020, November). Dissecting a Chinese APT Targeting South Eastern Asian Government Institutions. Retrieved September 19, 2022.Lunghi, D. et al. (2020, February). Uncovering DRBControl. Retrieved November 12, 2021.Dutch Military Intelligence and Security Service (MIVD) & Dutch General Intelligence and Security Service (AIVD). (2024, February 6). Ministry of Defense of the Netherlands uncovers COATHANGER, a stealthy Chinese FortiGate RAT. Retrieved February 7, 2024.Thomas Reed. (2018, October 29). Mac cryptocurrency ticker app installs backdoors. Retrieved April 23, 2019.Stokes, P. (2020, July 27). Four Distinct Families of Lazarus Malware Target Apple’s macOS Platform. Retrieved August 7, 2020.Mabutas, G. (2020, May 11). New MacOS Dacls RAT Backdoor Shows Lazarus’ Multi-Platform Attack Capability. Retrieved August 10, 2020.Adi Zeligson & Rotem Kerner. (2018, November 13). Enter The DarkGate - New Cryptocurrency Mining and Ransomware Campaign. Retrieved February 9, 2024.MSTIC. (2021, May 28). Breaking down NOBELIUM’s latest early-stage toolset. Retrieved August 4, 2021.Threat Intelligence and Research. (2015, March 30). VOLATILE CEDAR. Retrieved February 8, 2021.Ta, V., et al. (2022, August 8). FIN13: A Cybercriminal Threat Actor Focused on Mexico. Retrieved February 9, 2023.Sygnia Incident Response Team. (2022, January 5). TG2003: ELEPHANT BEETLE UNCOVERING AN ORGANIZED FINANCIAL-THEFT OPERATION. Retrieved February 9, 2023.Patrick Wardle. (n.d.). Mac Malware of 2017. Retrieved September 21, 2018.Eoin Miller. (2021, March 23). Defending Against the Zero Day: Analyzing Attacker Behavior Post-Exploitation of Microsoft Exchange. Retrieved October 27, 2022.QiAnXin Threat Intelligence Center. (2019, February 18). APT-C-36: Continuous Attacks Targeting Colombian Government Institutions and Corporations. Retrieved May 5, 2020.Hromcova, Z. and Cherpanov, A. (2020, June). INVISIMOLE: THE HIDDEN PART OF THE STORY. Retrieved July 16, 2020.Sancho, D., et al. (2012, May 22). IXESHE An APT Campaign. Retrieved June 7, 2019.Sherstobitoff, R. (2018, February 12). Lazarus Resurfaces, Targets Global Banks and Bitcoin Users. Retrieved February 19, 2018.Saini, A. and Hossein, J. (2022, January 27). North Korea’s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.Hoang, M. (2019, January 31). Malicious Activity Report: Elements of  Lokibot Infostealer. Retrieved May 15, 2020.Malik, M. (2019, June 20). LoudMiner: Cross-platform mining in cracked VST software. Retrieved May 18, 2020.Lechtik, M, and etl. (2021, July 14). LuminousMoth APT: Sweeping attacks for the chosen few. Retrieved October 20, 2022.ESET. (2019, July). MACHETE JUST GOT SHARPER Venezuelan government institutions under attack. Retrieved September 13, 2019.PETER EWANE. (2017, June 9). MacSpy: OS X RAT as a Service. Retrieved September 21, 2018.Tsarfaty, Y. (2018, July 25). Micropsia Malware. Retrieved November 13, 2018.Hamzeloofard, S. (2020, January 31). New wave of PlugX targets Hong Kong | Avira Blog. Retrieved April 13, 2021.Lambert, T. (2020, January 29). Intro to Netwire. Retrieved January 7, 2021.Hromcova, Z. (2019, July). OKRUM AND KETRICAN: AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITY. Retrieved May 6, 2020.Carbon Black Threat Analysis Unit. (2019, February 12). New macOS Malware Variant of Shlayer (OSX) Discovered. Retrieved August 8, 2019.Horejsi, J. (2018, April 04). New MacOS Backdoor Linked to OceanLotus Found. Retrieved November 13, 2018.Raggi, M. et al. (2022, March 7). The Good, the Bad, and the Web Bug: TA416 Increases Operational Tempo Against European Governments as Conflict in Ukraine Escalates. Retrieved March 16, 2022.Mercer, W, et al. (2020, April 16). PoetRAT: Python RAT uses COVID-19 lures to target Azerbaijan public and private sectors. Retrieved April 27, 2020.Kenefick, I. et al. (2022, October 12). Black Basta Ransomware Gang Infiltrates Networks via QAKBOT, Brute Ratel, and Cobalt Strike. Retrieved February 6, 2023.CISA. (2018, December 18). Analysis Report (AR18-352A) Quasar Open-Source Remote Administration Tool. Retrieved August 1, 2022.Sherstobitoff, R., Malhotra, A., et. al.. (2018, December 18). Operation Sharpshooter Campaign Targets Global Defense, Critical Infrastructure. Retrieved May 14, 2020.Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.Xingyu, J.. (2019, January 17). Malware Used by Rocke Group Evolves to Evade Detection by Cloud Security Products. Retrieved May 26, 2020.DHS/CISA, Cyber National Mission Force. (2020, October 1). Malware Analysis Report (MAR) MAR-10303705-1.v1 – Remote Access Trojan: SLOTHFULMEDIA. Retrieved October 2, 2020.Lunghi, D. and Lu, K. (2021, April 9). Iron Tiger APT Updates Toolkit With Evolved SysUpdate Malware. Retrieved November 12, 2021.Patrick Wardle. (2020, June 29). OSX.EvilQuest Uncovered part i: infection, persistence, and more!. Retrieved March 18, 2021.Dedola, G. (2020, August 20). Transparent Tribe: Evolution analysis, part 1. Retrieved September 2, 2021.Horejsi, J., et al. (2018, March 14). Tropic Trooper’s New Strategy. Retrieved November 9, 2018.Chen, J.. (2020, May 12). Tropic Trooper’s Back: USBferry Attack Targets Air gapped Environments. Retrieved May 20, 2020.Noerenberg, E., Costis, A., and Quist, N. (2017, May 16). A Technical Analysis of WannaCry Ransomware. Retrieved March 25, 2019.Antenucci, S., Pantazopoulos, N., Sandee, M. (2020, June 23). WastedLocker: A New Ransomware Variant Developed By The Evil Corp Group. Retrieved September 14, 2021.Mac Threat Response, Mobile Research Team. (2020, August 13). The XCSSET Malware: Inserts Malicious Code Into Xcode Projects, Performs UXSS Backdoor Planting in Safari, and Leverages Two Zero-day Exploits. Retrieved October 5, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.