MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseTraffic SignalingSocket FiltersTraffic Signaling:Socket FiltersOther sub-techniques of Traffic Signaling (2)IDNameT1205.001Port KnockingT1205.002Socket FiltersAdversaries may attach filters to a network socket to monitor then activate backdoors used for persistence or command and control. With elevated permissions, adversaries can use features such as thelibpcaplibrary to open sockets and install filters to allow or disallow certain types of data to come through the socket. The filter may apply to all traffic passing through the specified network interface (or every interface if not specified). When the network interface receives a packet matching the filter criteria, additional actions can be triggered on the host, such as activation of a reverse shell.To establish a connection, an adversary sends a crafted packet to the targeted host that matches the installed filter criteria.[1]Adversaries have used these socket filters to trigger the installation of implants, conduct ping backs, and to invoke command shells. Communication with these socket filters may also be used in conjunction withProtocol Tunneling.[2][3]Filters can be installed on any Unix-like platform withlibpcapinstalled or on Windows hosts usingWinpcap.  Adversaries may use eitherlibpcapwithpcap_setfilteror the standard library functionsetsockoptwithSO_ATTACH_FILTERoptions. Since the socket connection is not active until the packet is received, this behavior may be difficult to detect due to the lack of activity on a host, low CPU overhead, and limited visibility into raw socket usage.ID:T1205.002Sub-technique of:T1205ⓘTactics:Defense Evasion,Persistence,Command and ControlⓘPlatforms:Linux, Windows, macOSContributors:CrowdStrike; Tim (Wadhwa-)BrownVersion:1.0Created:30 September 2022Last Modified:20 October 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0587PenquinPenquininstalls aTCPandUDPfilter on theeth0interface.[3]S1123PITSTOPPITSTOPcan listen and evaluate incoming commands on the domain socket, created by PITHOOK malware, located at/data/runtime/cockpit/wd.fdfor a predefined magic byte sequence.PITSTOPcan then duplicate the socket for further communication over TLS.[4]MitigationsIDMitigationDescriptionM1037Filter Network TrafficMitigation of some variants of this technique could be achieved through the use of stateful firewalls, depending upon how it is implemented.DetectionIDData SourceData ComponentDetectsDS0029Network TrafficNetwork Connection CreationMonitor recently started applications creating raw socket connections.[5]DS0009ProcessProcess CreationIdentify running processes with raw sockets. Ensure processes listed have a need for an open raw socket and are in accordance with enterprise policy.[5]ReferencesLuis Martin Garcia. (2008, February 1). Hakin9 Issue 2/2008 Vol 3 No.2 VoIP Abuse: Storming SIP Security. Retrieved October 18, 2022.ExaTrack. (2022, May 11). Tricephalic Hellkeeper: a tale of a passive backdoor. Retrieved October 18, 2022.Leonardo. (2020, May 29). MALWARE TECHNICAL INSIGHT TURLA “Penquin_x64”. Retrieved March 11, 2021.Lin, M. et al. (2024, February 27). Cutting Edge, Part 3: Investigating Ivanti Connect Secure VPN Exploitation and Persistence Attempts. Retrieved March 1, 2024.Jamie Harries. (2022, May 25). Hunting a Global Telecommunications Threat: DecisiveArchitect and Its Custom Implant JustForFun. Retrieved October 18, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.