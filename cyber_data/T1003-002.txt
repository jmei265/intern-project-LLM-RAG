MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseOS Credential DumpingSecurity Account ManagerOS Credential Dumping:Security Account ManagerOther sub-techniques of OS Credential Dumping (8)IDNameT1003.001LSASS MemoryT1003.002Security Account ManagerT1003.003NTDST1003.004LSA SecretsT1003.005Cached Domain CredentialsT1003.006DCSyncT1003.007Proc FilesystemT1003.008/etc/passwd and /etc/shadowAdversaries may attempt to extract credential material from the Security Account Manager (SAM) database either through in-memory techniques or through the Windows Registry where the SAM database is stored. The SAM is a database file that contains local accounts for the host, typically those found with thenet usercommand. Enumerating the SAM database requires SYSTEM level access.A number of tools can be used to retrieve the SAM file through in-memory techniques:pwdumpx.exegsecdumpMimikatzsecretsdump.pyAlternatively, the SAM can be extracted from the Registry with Reg:reg save HKLM\sam samreg save HKLM\system systemCreddump7 can then be used to process the SAM database locally to retrieve hashes.[1]Notes:RID 500 account is the local, built-in administrator.RID 501 is the guest account.User accounts start with a RID of 1,000+.ID:T1003.002Sub-technique of:T1003ⓘTactic:Credential AccessⓘPlatforms:WindowsContributors:Ed Williams, Trustwave, SpiderLabs; Olaf Hartong, Falcon ForceVersion:1.1Created:11 February 2020Last Modified:24 July 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0016APT29APT29has used thereg savecommand to save registry hives.[2]G0096APT41APT41extracted user account data from the Security Account Managerr (SAM), making a copy of this database from the registry using thereg savecommand or by exploiting volume shadow copies.[3]G1023APT5APT5has copied and exfiltrated the SAM Registry hive from targeted systems.[4]C0017C0017DuringC0017,APT41copied theSAMandSYSTEMRegistry hives for credential harvesting.[5]S0154Cobalt StrikeCobalt Strikecan recover hashed passwords.[6]S0050CosmicDukeCosmicDukecollects Windows account hashes.[7]S0046CozyCarPassword stealer and NTLM stealer modules inCozyCarharvest stored credentials from the victim, including credentials used as part of Windows NTLM user authentication.[8]S0488CrackMapExecCrackMapExeccan dump usernames and hashed passwords from the SAM.[9]G0035DragonflyDragonflyhas dropped and executed SecretsDump to dump password hashes.[10]S0120FgdumpFgdumpcan dump Windows password hashes.[11]G1016FIN13FIN13has extracted the SAM and SYSTEM registry hives using thereg.exebinary for obtaining password hashes from a compromised machine.[12]G0093GALLIUMGALLIUMusedregcommands to dump specific hives from the Windows Registry, such as the SAM hive, and obtain password hashes.[13]S0008gsecdumpgsecdumpcan dump Windows password hashes from the SAM.[14]S0376HOPLIGHTHOPLIGHThas the capability to harvest credentials and passwords from the SAM database.[15]S1022IceAppleIceApple's Credential Dumper module can dump encrypted password hashes from SAM registry keys, includingHKLM\SAM\SAM\Domains\Account\FandHKLM\SAM\SAM\Domains\Account\Users\*\V.[16]S0357ImpacketSecretsDump andMimikatzmodules withinImpacketcan perform credential dumping to obtain account and password information.[17]G0004Ke3changKe3changhas dumped credentials, including by using gsecdump.[18][19]S0250KoadicKoadiccan gather hashed passwords by dumping SAM/SECURITY hive.[20]G0045menuPassmenuPasshas used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.[21][22]S0002MimikatzMimikatzperforms credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the SAM table.[23][24][25][26]S0080MivastMivasthas the capability to gather NTLM password information.[27]C0002Night DragonDuringNight Dragon, threat actors dumped account hashes usinggsecdump.[28]C0012Operation CuckooBeesDuringOperation CuckooBees, the threat actors leveraged a custom tool to dump OS credentials and used following commands:reg save HKLM\\SYSTEM system.hiv,reg save HKLM\\SAM sam.hiv, andreg save HKLM\\SECURITY security.hiv, to dump SAM, SYSTEM and SECURITY hives.[29]S0371POWERTONPOWERTONhas the ability to dump password hashes.[30]S0006pwdumppwdumpcan be used to dump credentials from the SAM.[31]S0125RemsecRemseccan dump the SAM database.[32]G0027Threat Group-3390Threat Group-3390actors have usedgsecdumpto dump credentials. They have also dumped credentials from domain controllers.[33][34]G0102Wizard SpiderWizard Spiderhas acquired credentials from the SAM/SECURITY registry hives.[35]MitigationsIDMitigationDescriptionM1028Operating System ConfigurationConsider disabling or restricting NTLM.[36]M1027Password PoliciesEnsure that local administrator accounts have complex, unique passwords across all systems on the network.M1026Privileged Account ManagementDo not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.M1017User TrainingLimit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may attempt to extract credential material from the Security Account Manager (SAM) database either through in-memory techniques or through the Windows Registry where the SAM database is stored.DS0022FileFile AccessMonitor for hash dumpers opening the Security Accounts Manager (SAM) on the local file system (%SystemRoot%/system32/config/SAM). Some hash dumpers will open the local file system as a device and parse to the SAM table to avoid file access defenses. Others will make an in-memory copy of the SAM table before reading hashes. Detection of compromisedValid Accountsin-use by adversaries may help as well.File CreationMonitor newly constructed files being written with default names that have extracted credentials from the Security Account Manager.DS0024Windows RegistryWindows Registry Key AccessMonitor for the SAM registry key dump being created to access stored account password hashes. Some hash dumpers will open the local file system as a device and parse to the SAM table to avoid file access defenses. Others will make an in-memory copy of the SAM table before reading hashes. Detection of compromisedValid Accountsin-use by adversaries may help as well.ReferencesFlathers, R. (2018, February 19). creddump7. Retrieved April 11, 2018.Mandiant. (2022, May 2). UNC3524: Eye Spy on Your Email. Retrieved August 17, 2023.Nikita Rostovcev. (2022, August 18). APT41 World Tour 2021 on a tight schedule. Retrieved February 22, 2024.Perez, D. et al. (2021, May 27). Re-Checking Your Pulse: Updates on Chinese APT Actors Compromising Pulse Secure VPN Devices. Retrieved February 5, 2024.Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.F-Secure Labs. (2015, September 17). The Dukes: 7 years of Russian cyberespionage. Retrieved December 10, 2015.F-Secure Labs. (2015, April 22). CozyDuke: Malware Analysis. Retrieved December 10, 2015.byt3bl33d3r. (2018, September 8). SMB: Command Reference. Retrieved July 17, 2020.US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.Mandiant. (n.d.). APT1 Exposing One of China’s Cyber Espionage Units. Retrieved July 18, 2016.Sygnia Incident Response Team. (2022, January 5). TG2003: ELEPHANT BEETLE UNCOVERING AN ORGANIZED FINANCIAL-THEFT OPERATION. Retrieved February 9, 2023.Cybereason Nocturnus. (2019, June 25). Operation Soft Cell: A Worldwide Campaign Against Telecommunications Providers. Retrieved July 18, 2019.Vincent Tiu. (2017, September 15).  HackTool:Win32/Gsecdump. Retrieved January 10, 2024.US-CERT. (2019, April 10). MAR-10135536-8 – North Korean Trojan: HOPLIGHT. Retrieved April 19, 2019.CrowdStrike. (2022, May). ICEAPPLE: A NOVEL INTERNET INFORMATION SERVICES (IIS) POST-EXPLOITATION FRAMEWORK. Retrieved June 27, 2022.SecureAuth. (n.d.).  Retrieved January 15, 2019.Villeneuve, N., Bennett, J. T., Moran, N., Haq, T., Scott, M., & Geers, K. (2014). OPERATION “KE3CHANG”: Targeted Attacks Against Ministries of Foreign Affairs. Retrieved November 12, 2014.Smallridge, R. (2018, March 10). APT15 is alive and strong: An analysis of RoyalCli and RoyalDNS. Retrieved April 4, 2018.Magius, J., et al. (2017, July 19). Koadic. Retrieved June 18, 2018.PwC and BAE Systems. (2017, April). Operation Cloud Hopper: Technical Annex. Retrieved April 13, 2017.Twi1ight. (2015, July 11). AD-Pentest-Script - wmiexec.vbs. Retrieved June 29, 2017.Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015.Deply, B., Le Toux, V. (2016, June 5). module ~ lsadump. Retrieved August 7, 2017.Grafnetter, M. (2015, October 26). Retrieving DPAPI Backup Keys from Active Directory. Retrieved December 19, 2017.The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019.Stama, D.. (2015, February 6). Backdoor.Mivast. Retrieved February 15, 2016.McAfee® Foundstone® Professional Services and McAfee Labs™. (2011, February 10). Global Energy Cyberattacks: “Night Dragon”. Retrieved February 19, 2018.Cybereason Nocturnus. (2022, May 4). Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques. Retrieved September 22, 2022.Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019.Wikipedia. (2007, August 9). pwdump. Retrieved June 22, 2016.Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Technical Analysis. Retrieved August 17, 2016.Dell SecureWorks Counter Threat Unit Threat Intelligence. (2015, August 5). Threat Group-3390 Targets Organizations for Cyberespionage. Retrieved August 18, 2018.Counter Threat Unit Research Team. (2017, June 27). BRONZE UNION Cyberespionage Persists Despite Disclosures. Retrieved July 13, 2017.Kimberly Goody, Jeremy Kennelly, Joshua Shilko, Steve Elovitz, Douglas Bienstock. (2020, October 28). Unhappy Hour Special: KEGTAP and SINGLEMALT With a Ransomware Chaser. Retrieved October 28, 2020.Microsoft. (2012, November 29). Using security policies to restrict NTLM traffic. Retrieved December 4, 2017.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.