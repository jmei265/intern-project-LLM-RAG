MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseSteal Web Session CookieSteal Web Session CookieAn adversary may steal web application or service session cookies and use them to gain access to web applications or Internet services as an authenticated user without needing credentials. Web applications and services often use session cookies as an authentication token after a user has authenticated to a website.Cookies are often valid for an extended period of time, even if the web application is not actively used. Cookies can be found on disk, in the process memory of the browser, and in network traffic to remote systems. Additionally, other applications on the targets machine might store sensitive authentication cookies in memory (e.g. apps which authenticate to cloud services). Session cookies can be used to bypasses some multi-factor authentication protocols.[1]There are several examples of malware targeting cookies from web browsers on the local system.[2][3]Adversaries may also steal cookies by injecting malicious JavaScript content into websites or relying onUser Executionby tricking victims into running malicious JavaScript in their browser.[4][5]There are also open source frameworks such asEvilginx2andMuraenathat can gather session cookies through a malicious proxy (e.g.,Adversary-in-the-Middle) that can be set up by an adversary and used in phishing campaigns.[6][7]After an adversary acquires a valid cookie, they can then perform aWeb Session Cookietechnique to login to the corresponding web application.ID:T1539Sub-techniques:No sub-techniquesⓘTactic:Credential AccessⓘPlatforms:Google Workspace, Linux, Office 365, SaaS, Windows, macOSContributors:Goldstein Menachem; Johann Rehberger; Microsoft Threat Intelligence Center (MSTIC)Version:1.3Created:08 October 2019Last Modified:16 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0657BLUELIGHTBLUELIGHTcan harvest cookies from Internet Explorer, Edge, Chrome, and Naver Whale browsers.[8]S0631ChaesChaeshas used a script that extracts the web session cookie and sends it to the C2 server.[9]S0492CookieMinerCookieMinercan steal Google Chrome and Apple Safari browser cookies from the victim’s machine.[10]S0568EVILNUMEVILNUMcan harvest cookies and upload them to the C2 server.[11]G0120EvilnumEvilnumcan steal cookies and session information from browsers.[12]S0531GrandoreiroGrandoreirocan steal the victim's cookies to use for duplicating the active session from another device.[13]G1014LuminousMothLuminousMothhas used an unnamed post-exploitation tool to steal cookies from the Chrome browser.[14]S0650QakBotQakBothas the ability to capture web session cookies.[15][16]G0034Sandworm TeamSandworm Teamused information stealer malware to collect browser session cookies.[17]G1015Scattered SpiderScattered Spiderretrieves browser cookies via Raccoon Stealer.[18]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29stole Chrome browser cookies by copying the Chrome profile directories of targeted users.[19]S0467TajMahalTajMahalhas the ability to steal web session cookies from Internet Explorer, Netscape Navigator, FireFox and RealNetworks applications.[2]S0658XCSSETXCSSETusesscpto access the~/Library/Cookies/Cookies.binarycookiesfile.[20]MitigationsIDMitigationDescriptionM1032Multi-factor AuthenticationA physical second factor key that uses the target login domain as part of the negotiation protocol will prevent session cookie theft through proxy methods.[21]M1054Software ConfigurationConfigure browsers or tasks to regularly delete persistent cookies.Additionally, minimize the length of time a web cookie is viable to potentially reduce the impact of stolen cookies while also increasing the needed frequency of cookie theft attempts – providing defenders with additional chances at detection.[22]For example, use non-persistent cookies to limit the duration a session ID will remain on the web client cache where an attacker could obtain it.[23]M1017User TrainingTrain users to identify aspects of phishing attempts where they're asked to enter credentials into a site that has the incorrect domain for the application they are logging into. Additionally, train users not to run untrusted JavaScript in their browser, such as by copying and pasting code or dragging and dropping bookmarklets.DetectionIDData SourceData ComponentDetectsDS0022FileFile AccessMonitor for an attempt by a user to gain access to a network or computing resource, often by providing credentials to cloud service management consoles. Some cloud providers, such as AWS, provide distinct log events for login attempts to the management console.DS0009ProcessProcess AccessMonitor for attempts by programs to inject into or dump browser process memory.ReferencesRehberger, J. (2018, December). Pivot to the Cloud using Pass the Cookie. Retrieved April 5, 2019.GReAT. (2019, April 10). Project TajMahal – a sophisticated new APT framework. Retrieved October 14, 2019.Chen, Y., Hu, W., Xu, Z., et. al. (2019, January 31). Mac Malware Steals Cryptocurrency Exchanges’ Cookies. Retrieved October 14, 2019.Tiago Pereira. (2023, November 2). Attackers use JavaScript URLs, API forms and more to scam users in popular online game “Roblox”. Retrieved January 2, 2024.Brian Krebs. (2023, May 30). Discord Admins Hacked by Malicious Bookmarks. Retrieved January 2, 2024.Gretzky, Kuba. (2019, April 10). Retrieved October 8, 2019.Orrù, M., Trotta, G.. (2019, September 11). Muraena. Retrieved October 14, 2019.Cash, D., Grunzweig, J., Meltzer, M., Adair, S., Lancaster, T. (2021, August 17). North Korean APT InkySquid Infects Victims Using Browser Exploits. Retrieved September 30, 2021.Salem, E. (2020, November 17). CHAES: Novel Malware Targeting Latin American E-Commerce. Retrieved June 30, 2021.Chen, y., et al. (2019, January 31). Mac Malware Steals Cryptocurrency Exchanges’ Cookies. Retrieved July 22, 2020.Adamitis, D. (2020, May 6). Phantom in the Command Shell. Retrieved December 22, 2021.Porolli, M. (2020, July 9). More evil: A deep look at Evilnum and its toolset. Retrieved January 22, 2021.Abramov, D. (2020, April 13). Grandoreiro Malware Now Targeting Banks in Spain. Retrieved November 12, 2020.Lechtik, M, and etl. (2021, July 14). LuminousMoth APT: Sweeping attacks for the chosen few. Retrieved October 20, 2022.Sette, N. et al. (2020, June 4). Qakbot Malware Now Exfiltrating Emails for Sophisticated Thread Hijacking Attacks. Retrieved September 27, 2021.Kuzmenko, A. et al. (2021, September 2). QakBot technical analysis. Retrieved September 27, 2021.Billy Leonard. (2023, April 19). Ukraine remains Russia’s biggest cyber focus in 2023. Retrieved March 1, 2024.CISA. (2023, November 16). Cybersecurity Advisory: Scattered Spider (AA23-320A). Retrieved March 18, 2024.CrowdStrike. (2022, January 27). Early Bird Catches the Wormhole: Observations from the StellarParticle Campaign. Retrieved February 7, 2022.Mac Threat Response, Mobile Research Team. (2020, August 13). The XCSSET Malware: Inserts Malicious Code Into Xcode Projects, Performs UXSS Backdoor Planting in Safari, and Leverages Two Zero-day Exploits. Retrieved October 5, 2021.Gretzky, K.. (2018, July 26). Evilginx 2 - Next Generation of Phishing 2FA Tokens. Retrieved October 14, 2019.Microsoft Incident Response. (2022, November 16). Token tactics: How to prevent, detect, and respond to cloud token theft. Retrieved December 26, 2023.OWASP CheatSheets Series Team. (n.d.). Session Management Cheat Sheet. Retrieved December 26, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.