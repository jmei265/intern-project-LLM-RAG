MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseShared ModulesShared ModulesAdversaries may execute malicious payloads via loading shared modules. Shared modules are executable files that are loaded into processes to provide access to reusable code, such as specific custom functions or invoking OS API functions (i.e.,Native API).Adversaries may use this functionality as a way to execute arbitrary payloads on a victim system. For example, adversaries can modularize functionality of their malware into shared objects that perform various functions such as managing C2 network communications or execution of specific actions on objective.The Linux & macOS module loader can load and execute shared objects from arbitrary local paths. This functionality resides indlfcn.hin functions such asdlopenanddlsym. Although macOS can execute.sofiles, common practice uses.dylibfiles.[1][2][3][4]The Windows module loader can be instructed to load DLLs from arbitrary local paths and arbitrary Universal Naming Convention (UNC) network paths. This functionality resides inNTDLL.dlland is part of the WindowsNative APIwhich is called from functions likeLoadLibraryat run time.[5]ID:T1129Sub-techniques:No sub-techniquesⓘTactic:ExecutionⓘPlatforms:Linux, Windows, macOSContributors:Stefan KanthakVersion:2.2Created:31 May 2017Last Modified:12 October 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0373AstarothAstarothuses the LoadLibraryExW() function to load additional modules.[6]S0438AttorAttor's dispatcher can execute additional plugins by loading the respective DLLs.[7]S0520BLINDINGCANBLINDINGCANhas loaded and executed DLLs in memory during runtime on a victim machine.[8]S0415BOOSTWRITEBOOSTWRITEhas used the DWriteCreateFactory() function to load additional modules.[9]S1039BumblebeeBumblebeecan useLoadLibraryto attempt to execute GdiPlus.dll.[10]S0673DarkWatchmanDarkWatchmancan load DLLs.[11]S0567DtrackDtrackcontains a function that callsLoadLibraryandGetProcAddress.[12]S0661FoggyWebFoggyWeb's loader can call theload()function to load theFoggyWebdll into an Application Domain on a compromised AD FS server.[13]S0032gh0st RATgh0st RATcan load DLLs into memory.[14]S0203HydraqHydraqcreates a backdoor through which remote attackers can load and call DLL functions.[15][16]S0607KillDiskKillDiskloads and executes functions from a DLL.[17]S0455MetamorfoMetamorfohad used AutoIt to load and execute the DLL payload.[18]S0352OSX_OCEANLOTUS.DFor network communications,OSX_OCEANLOTUS.Dloads a dynamic library (.dylibfile) usingdlopen()and obtains a function pointer to execute within that shared library usingdlsym().[4]S0501PipeMonPipeMonhas used call toLoadLibraryto load its installer.PipeMonloads its modules using reflective loading or custom shellcode.[19]S0196PUNCHBUGGYPUNCHBUGGYcan load a DLL using the LoadLibrary API.[20]S1078RotaJakiroRotaJakirouses dynamically linked shared libraries (.sofiles) to execute additional functionality usingdlopen()anddlsym().[3]S0603StuxnetStuxnetcalls LoadLibrary then executes exports from a DLL.[21]S0467TajMahalTajMahalhas the ability to inject theLoadLibrarycall template DLL into running processes.[22]MitigationsIDMitigationDescriptionM1038Execution PreventionIdentify and block potentially malicious software executed through this technique by using application control tools capable of preventing unknown modules from being loaded.DetectionIDData SourceData ComponentDetectsDS0011ModuleModule LoadMonitoring module loads may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances, since benign use of shared modules load functions are common and may be difficult to distinguish from malicious behavior. Legitimate software will likely only need to load routine, bundled, or system modules such that deviation from known module loads may be suspiciousLimiting module loads to trusted directories, such as%SystemRoot%and%ProgramFiles%on Windows, may protect against module loads from unsafe paths.DS0009ProcessOS API ExecutionMonitor for API calls that may execute malicious payloads via loading shared modules.ReferencesApple. (2012, July 23). Overview of Dynamic Libraries. Retrieved September 7, 2023.Wheeler, D. (2003, April 11). Shared Libraries. Retrieved September 7, 2023.Alex Turing, Hui Wang. (2021, April 28). RotaJakiro: A long live secret backdoor with 0 VT detection. Retrieved June 14, 2023.Erye Hernandez and Danny Tsechansky. (2017, June 22). The New and Improved macOS Backdoor from OceanLotus. Retrieved September 8, 2023.Microsoft. (2023, April 28). What is a DLL. Retrieved September 7, 2023.Salem, E. (2019, February 13). ASTAROTH MALWARE USES LEGITIMATE OS AND ANTIVIRUS PROCESSES TO STEAL PASSWORDS AND PERSONAL DATA. Retrieved April 17, 2019.Hromcova, Z. (2019, October). AT COMMANDS, TOR-BASED COMMUNICATIONS: MEET ATTOR, A FANTASY CREATURE AND ALSO A SPY PLATFORM. Retrieved May 6, 2020.US-CERT. (2020, August 19). MAR-10295134-1.v1 – North Korean Remote Access Trojan: BLINDINGCAN. Retrieved August 19, 2020.Carr, N, et all. (2019, October 10). Mahalo FIN7: Responding to the Criminal Operators’ New Tools and Techniques. Retrieved October 11, 2019.Salem, A. (2022, April 27). The chronicles of Bumblebee: The Hook, the Bee, and the Trickbot connection. Retrieved September 2, 2022.Smith, S., Stafford, M. (2021, December 14). DarkWatchman: A new evolution in fileless techniques. Retrieved January 10, 2022.Hod Gavriel. (2019, November 21). Dtrack: In-depth analysis of APT on a nuclear power plant. Retrieved January 20, 2021.Ramin Nafisi. (2021, September 27). FoggyWeb: Targeted NOBELIUM malware leads to persistent backdoor. Retrieved October 4, 2021.Quinn, J. (2019, March 25). The odd case of a Gh0stRAT variant. Retrieved July 15, 2020.Symantec Security Response. (2010, January 18). The Trojan.Hydraq Incident. Retrieved February 20, 2018.Lelli, A. (2010, January 11). Trojan.Hydraq. Retrieved February 20, 2018.Fernando Merces, Byron Gelera, Martin Co. (2018, June 7). KillDisk Variant Hits Latin American Finance Industry. Retrieved January 12, 2021.Zhang, X. (2020, February 4). Another Metamorfo Variant Targeting Customers of Financial Institutions in More Countries. Retrieved July 30, 2020.Tartare, M. et al. (2020, May 21). No “Game over” for the Winnti Group. Retrieved August 24, 2020.Elovitz, S. & Ahl, I. (2016, August 18). Know Your Enemy:  New Financially-Motivated & Spear-Phishing Group. Retrieved February 26, 2018.Nicolas Falliere, Liam O Murchu, Eric Chien 2011, February W32.Stuxnet Dossier (Version 1.4) Retrieved. 2017/09/22GReAT. (2019, April 10). Project TajMahal – a sophisticated new APT framework. Retrieved October 14, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.