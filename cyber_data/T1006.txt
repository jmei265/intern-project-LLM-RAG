MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseDirect Volume AccessDirect Volume AccessAdversaries may directly access a volume to bypass file access controls and file system monitoring. Windows allows programs to have direct access to logical volumes. Programs with direct access may read and write files directly from the drive by analyzing file system data structures. This technique may bypass Windows file access controls as well as file system monitoring tools.[1]Utilities, such asNinjaCopy, exist to perform these actions in PowerShell.[2]Adversaries may also use built-in or third-party utilities (such asvssadmin,wbadmin, andesentutl) to create shadow copies or backups of data from system volumes.[3]ID:T1006Sub-techniques:No sub-techniquesⓘTactic:Defense EvasionⓘPlatforms:Network, WindowsⓘDefense Bypassed:File monitoring, File system access controlsContributors:Tom Simpson, CrowdStrike Falcon OverWatchVersion:2.2Created:31 May 2017Last Modified:16 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0404esentutlesentutlcan use the Volume Shadow Copy service to copy locked files such asntds.dit.[3][4]G1015Scattered SpiderScattered Spiderhas created volume shadow copies of virtual domain controller disks to extract theNTDS.ditfile.[5]MitigationsIDMitigationDescriptionM1040Behavior Prevention on EndpointSome endpoint security solutions can be configured to block some types of behaviors related to efforts by an adversary to create backups, such as command execution or preventing API calls to backup related services.M1018User Account ManagementEnsure only accounts required to configure and manage backups have the privileges to do so. Monitor these accounts for unauthorized backup activity.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that could be taken to copy files from the logical drive and evade common file system protections. Since this technique may also be used throughPowerShell, additional logging of PowerShell scripts is recommended.DS0016DriveDrive AccessMonitor handle opens on volumes that are made by processes to determine when they may be directly collecting data from logical drives.[2]DS0022FileFile CreationMonitor for the creation of volume shadow copy and backup files, especially unexpected and irregular activity (relative to time, user, etc.).ReferencesHakobyan, A. (2009, January 8). FDump - Dumping File Sectors Directly from Disk using Logical Offsets. Retrieved November 12, 2014.Bialek, J. (2015, December 16). Invoke-NinjaCopy.ps1. Retrieved June 2, 2016.LOLBAS. (n.d.). Esentutl.exe. Retrieved September 3, 2019.Cary, M. (2018, December 6). Locked File Access Using ESENTUTL.exe. Retrieved September 5, 2019.Microsoft. (2023, October 25). Octo Tempest crosses boundaries to facilitate extortion, encryption, and destruction. Retrieved March 18, 2024.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.