MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseImpair DefensesImpair DefensesSub-techniques (11)IDNameT1562.001Disable or Modify ToolsT1562.002Disable Windows Event LoggingT1562.003Impair Command History LoggingT1562.004Disable or Modify System FirewallT1562.006Indicator BlockingT1562.007Disable or Modify Cloud FirewallT1562.008Disable or Modify Cloud LogsT1562.009Safe Mode BootT1562.010Downgrade AttackT1562.011Spoof Security AlertingT1562.012Disable or Modify Linux Audit SystemAdversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. This not only involves impairing preventative defenses, such as firewalls and anti-virus, but also detection capabilities that defenders can use to audit activity and identify malicious behavior. This may also span both native defenses as well as supplemental capabilities installed by users and administrators.Adversaries may also impair routine operations that contribute to defensive hygiene, such as blocking users from logging out of a computer or stopping it from being shut down. These restrictions can further enable malicious operations as well as the continued propagation of incidents.[1]Adversaries could also target event aggregation and analysis mechanisms, or otherwise disrupt these procedures by altering other system components.ID:T1562Sub-techniques:T1562.001,T1562.002,T1562.003,T1562.004,T1562.006,T1562.007,T1562.008,T1562.009,T1562.010,T1562.011,T1562.012ⓘTactic:Defense EvasionⓘPlatforms:Containers, IaaS, Linux, Network, Office 365, Windows, macOSⓘDefense Bypassed:Anti-virus, Digital Certificate Validation, File monitoring, Firewall, Host forensic analysis, Host intrusion prevention systems, Log analysis, Signature-based detectionVersion:1.5Created:21 February 2020Last Modified:20 October 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0059Magic HoundMagic Houndhas disabled LSA protection on compromised hosts using"reg" add HKLM\SYSTEM\CurrentControlSet\Control\LSA /v RunAsPPL /t REG_DWORD /d 0 /f.[2]S0603StuxnetStuxnetreduces the integrity level of objects to allow write actions.[3]MitigationsIDMitigationDescriptionM1047AuditRoutinely check account role permissions to ensure only expected users and roles have permission to modify defensive tools and settings.M1038Execution PreventionUse application control where appropriate, especially regarding the execution of tools outside of the organization's security policies (such as rootkit removal tools) that have been abused to impair system defenses. Ensure that only approved security applications are used and running on enterprise systems.M1022Restrict File and Directory PermissionsEnsure proper process and file permissions are in place to prevent adversaries from disabling or interfering with security/logging services.M1024Restrict Registry PermissionsEnsure proper Registry permissions are in place to prevent adversaries from disabling or interfering with security/logging services.M1054Software ConfigurationConsider implementing policies on internal web servers, such HTTP Strict Transport Security, that enforce the use of HTTPS/network traffic encryption to prevent insecure connections.[4]M1018User Account ManagementEnsure proper user permissions are in place to prevent adversaries from disabling or interfering with security/logging services.DetectionIDData SourceData ComponentDetectsDS0025Cloud ServiceCloud Service DisableMonitor logs for API calls to disable logging. In AWS, monitor for:StopLoggingandDeleteTrail.[5]In GCP, monitor for:google.logging.v2.ConfigServiceV2.UpdateSink.[6]In Azure, monitor foraz monitor diagnostic-settings delete.[7]Additionally, a sudden loss of a log source may indicate that it has been disabled.Cloud Service ModificationMonitor changes made to cloud services for unexpected modifications to settings and/or data.DS0017CommandCommand ExecutionMonitor executed commands and arguments that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.DS0027DriverDriver LoadMonitor for unusual/suspicious driver activity, especially regarding EDR and drivers associated with security tools as well as those that may be abused to disable security products.DS0022FileFile DeletionMonitor for missing log files hosts and services with known active periods.File ModificationMonitor changes made to configuration files that contain settings for logging and defensive tools.DS0018FirewallFirewall DisableMonitor for changes in the status of the system firewall such as Windows Security Auditing events 5025 (The Windows firewall service has been stopped) and 5034 (The Windows firewall driver was stopped).Firewall Rule ModificationMonitor for changes made to firewall rules for unexpected modifications to allow/block specific network traffic that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.DS0009ProcessOS API ExecutionMonitor for the abnormal execution of API functions associated with system logging.Process CreationMonitor newly executed processes that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.Process ModificationUsing another process or third-party tools, monitor for modifications or access to system processes associated with logging.Process TerminationMonitor for unexpected deletions of a running process (ex: Sysmon EID 5 or Windows EID 4689) that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.DS0012ScriptScript ExecutionMonitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.DS0013Sensor HealthHost StatusMonitor logging, messaging, and other artifacts highlighting the health of host sensors (ex: metrics, errors, and/or exceptions from logging applications) that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. Lack of log events may be suspicious.DS0019ServiceService MetadataMonitor contextual data about a service/daemon, which may include information such as name, service executable, start type that that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.DS0002User AccountUser Account ModificationMonitor for changes to account settings associated with users/tenants that may impact defensive logging capabilities, such as theUpdate UserandChange User Licenseevents in the Azure AD audit log.[8]DS0024Windows RegistryWindows Registry Key DeletionMonitor for unexpected deletion of windows registry keys that that may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms.Windows Registry Key ModificationMonitor Registry edits for modifications to services and startup programs that correspond to security tools.ReferencesThe DFIR Report. (2022, November 8). Emotet Strikes Again – LNK File Leads to Domain Wide Ransomware. Retrieved March 6, 2023.DFIR Report. (2022, March 21). APT35 Automates Initial Access Using ProxyShell. Retrieved May 25, 2022.Nicolas Falliere, Liam O Murchu, Eric Chien 2011, February W32.Stuxnet Dossier (Version 1.4) Retrieved. 2017/09/22Chromium. (n.d.). HTTP Strict Transport Security. Retrieved May 24, 2023.Amazon Web Services. (n.d.). Stopping CloudTrail from Sending Events to CloudWatch Logs. Retrieved October 16, 2020.Google. (n.d.). Configuring Data Access audit logs. Retrieved October 16, 2020.Microsoft. (n.d.). az monitor diagnostic-settings. Retrieved October 16, 2020.Mandiant. (2021, January 19). Remediation and Hardening Strategies for Microsoft 365 to Defend Against UNC2452. Retrieved January 22, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.