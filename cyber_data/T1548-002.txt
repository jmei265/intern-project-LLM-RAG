MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseAbuse Elevation Control MechanismBypass User Account ControlAbuse Elevation Control Mechanism:Bypass User Account ControlOther sub-techniques of Abuse Elevation Control Mechanism (6)IDNameT1548.001Setuid and SetgidT1548.002Bypass User Account ControlT1548.003Sudo and Sudo CachingT1548.004Elevated Execution with PromptT1548.005Temporary Elevated Cloud AccessT1548.006TCC ManipulationAdversaries may bypass UAC mechanisms to elevate process privileges on system. Windows User Account Control (UAC) allows a program to elevate its privileges (tracked as integrity levels ranging from low to high) to perform a task under administrator-level permissions, possibly by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action.[1]If the UAC protection level of a computer is set to anything but the highest level, certain Windows programs can elevate privileges or execute some elevatedComponent Object Modelobjects without prompting the user through the UAC notification box.[2][3]An example of this is use ofRundll32to load a specifically crafted DLL which loads an auto-elevatedComponent Object Modelobject and performs a file operation in a protected directory which would typically require elevated access. Malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user.[4]Many methods have been discovered to bypass UAC. The Github readme page for UACME contains an extensive list of methods[5]that have been discovered and implemented, but may not be a comprehensive list of bypasses. Additional bypass methods are regularly discovered and some used in the wild, such as:eventvwr.execan auto-elevate and execute a specified binary or script.[6][7]Another bypass is possible through some lateral movement techniques if credentials for an account with administrator privileges are known, since UAC is a single system security mechanism, and the privilege or integrity of a process running on one system will be unknown on remote systems and default to high integrity.[8]ID:T1548.002Sub-technique of:T1548ⓘTactics:Privilege Escalation,Defense EvasionⓘPlatforms:WindowsⓘPermissions Required:Administrator, UserⓘEffective Permissions:AdministratorⓘDefense Bypassed:Windows User Account ControlContributors:Casey Smith; Stefan KanthakVersion:2.1Created:30 January 2020Last Modified:21 April 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0584AppleJeusAppleJeushas presented the user with a UAC prompt to elevate privileges while installing.[9]G0016APT29APT29has bypassed UAC.[10]G0067APT37APT37has a function in the initial dropper to bypass Windows UAC in order to execute the next payload with higher privileges.[11]S0129AutoIt backdoorAutoIt backdoorattempts to escalate privileges by bypassing User Access Control.[12]S0640AvaddonAvaddonbypasses UAC using the CMSTPLUA COM interface.[13]S0606Bad RabbitBad Rabbithas attempted to bypass UAC and gain elevated administrative privileges.[14]S1081BADHATCHBADHATCHcan utilize the CMSTPLUA COM interface and the SilentCleanup task to bypass UAC.[15]S0570BitPaymerBitPaymercan suppress UAC prompts by setting theHKCU\Software\Classes\ms-settings\shell\open\commandregistry key on Windows 10 orHKCU\Software\Classes\mscfile\shell\open\commandon Windows 7 and launching theeventvwr.mscprocess, which launchesBitPaymerwith elevated privileges.[16]S1068BlackCatBlackCatcan bypass UAC to escalate privileges.[17]S0089BlackEnergyBlackEnergyattempts to bypass default User Access Control (UAC) settings by exploiting a backward-compatibility setting found in Windows 7 and later.[18]G0060BRONZE BUTLERBRONZE BUTLERhas used a Windows 10 specific tool and xxmm to bypass UAC for privilege escalation.[19][20]S1039BumblebeeBumblebeehas the ability to bypass UAC to deploy post exploitation tools with elevated privileges.[21]S0660ClamblingClamblinghas the ability to bypass UAC using apassuac.dllfile.[22][23]G0080Cobalt GroupCobalt Grouphas bypassed UAC.[24]S0154Cobalt StrikeCobalt Strikecan use a number of known techniques to bypass Windows UAC.[25][26]S0527CSPY DownloaderCSPY Downloadercan bypass UAC using the SilentCleanup task to execute the binary with elevated privileges.[27]S1111DarkGateDarkGateuses two distinct User Account Control (UAC) bypass techniques to escalate privileges.[28]S0134DowndelphDowndelphbypasses UAC to escalate privileges by using a custom "RedirectEXE" shim database.[29]G1006Earth LuscaEarth Luscahas used the Fodhelper UAC bypass technique to gain elevated privileges.[30]S0363EmpireEmpireincludes various modules to attempt to bypass UAC for escalation of privileges.[31]G0120EvilnumEvilnumhas used PowerShell to bypass UAC.[32]S0182FinFisherFinFisherperforms UAC bypass.[33][34]S0666GelsemiumGelsemiumcan bypass UAC to elevate process privileges on a compromised host.[35]S0531GrandoreiroGrandoreirocan bypass UAC by registering as the default handler for .MSC files.[36]S0132H1N1H1N1bypasses user access control by using a DLL hijacking vulnerability in the Windows Update Standalone Installer (wusa.exe).[37]S0260InvisiMoleInvisiMolecan use fileless UAC bypass and create an elevated COM object to escalate privileges.[38][39]S0250KoadicKoadichas 2 methods for elevating integrity. It can bypass UAC througheventvwr.exeandsdclt.exe.[40]S0669KOCTOPUSKOCTOPUSwill perform UAC bypass either through fodhelper.exe or eventvwr.exe.[41]S0356KONNIKONNIhas bypassed UAC by performing token impersonation as well as an RPC-based method, this included bypassing UAC set to "AlwaysNotify".[42][43]S0447LokibotLokibothas utilized multiple techniques to bypass UAC.[44]G0069MuddyWaterMuddyWateruses various techniques to bypass UAC.[45]C0006Operation HoneybeeDuringOperation Honeybee, the threat actors used the malicious NTWDBLIB.DLL andcliconfig.exeto bypass UAC protections.[46]G0040PatchworkPatchworkbypassed User Access Control (UAC).[47]S0501PipeMonPipeMoninstaller can use UAC bypass techniques to install the payload.[48]S0254PLAINTEEAn older variant ofPLAINTEEperforms UAC bypass.[49]S0378PoshC2PoshC2can utilize multiple methods to bypass UAC.[50]S0192PupyPupycan bypass Windows UAC through either DLL hijacking, eventvwr, or appPaths.[51]S0262QuasarRATQuasarRATcan generate a UAC pop-up Window to prompt the target user to run a command as the administrator.[52]S0458RamsayRamsaycan useUACMefor privilege escalation.[53][54]S0662RCSessionRCSessioncan bypass UAC to escalate privileges.[22]S0332RemcosRemcoshas a command for UAC bypassing.[55]S0148RTMRTMcan attempt to run the program as admin, then show a fake error message and a legitimate UAC bypass prompt to the user in an attempt to socially engineer the user into escalating privileges.[56]S1018Saint BotSaint Bothas attempted to bypass UAC usingfodhelper.exeto escalate privileges.[57]S0074SakulaSakulacontains UAC bypass code for both 32- and 64-bit systems.[58]S0140ShamoonShamoonattempts to disable UAC remote restrictions by modifying the Registry.[59]S0444ShimRatShimRathas hijacked the cryptbase.dll within migwiz.exe to escalate privileges. This prevented the User Access Control window from appearing.[60]S0692SILENTTRINITYSILENTTRINITYcontains a number of modules that can bypass UAC, including through Window's Device Manager, Manage Optional Features, and an image hijack on the.mscfile extension.[61]G0027Threat Group-3390AThreat Group-3390tool can use a public UAC bypass method to elevate privileges.[62]S0116UACMeUACMecontains many methods for bypassing Windows User Account Control on multiple versions of the operating system.[5]S0670WarzoneRATWarzoneRATcan usesdclt.exeto bypass UAC in Windows 10 to escalate privileges; for older Windows versionsWarzoneRATcan use the IFileOperation exploit to bypass the UAC module.[63][64]S0612WastedLockerWastedLockercan perform a UAC bypass if it is not executed with administrator rights or if the infected host runs Windows Vista or later.[65]S0141Winnti for WindowsWinnti for Windowscan use a variant of the sysprep UAC bypass.[66]S0230ZeroTManyZeroTsamples can perform UAC bypass by using eventvwr.exe to execute a malicious file.[67]MitigationsIDMitigationDescriptionM1047AuditCheck for common UAC bypass weaknesses on Windows systems to be aware of the risk posture and address issues where appropriate.[5]M1026Privileged Account ManagementRemove users from the local administrator group on systems.M1051Update SoftwareConsider updating Windows to the latest version and patch level to utilize the latest protective measures against UAC bypass.[5]M1052User Account ControlAlthough UAC bypass techniques exist, it is still prudent to use the highest enforcement level for UAC when possible and mitigate bypass opportunities that exist with techniques such asDLL Search Order Hijacking.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may bypass UAC mechanisms to elevate process privileges on system.DS0009ProcessProcess CreationMonitor newly executed processes, such aseventvwr.exeandsdclt.exe, that may bypass UAC mechanisms to elevate process privileges on system.Threat actors often, after compromising a machine, try to disable User Access Control (UAC) to escalate privileges. This is often done by changing the registry key for system policies using "reg.exe", a legitimate tool provided by Microsoft for modifying the registry via command prompt or scripts. This action interferes with UAC and may enable a threat actor to escalate privileges on the compromised system, thereby allowing further exploitation of the system.Analytic 1 - UAC Bypass(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688")  IntegrityLevel=High|search (ParentCommandLine="\"c:\windows\system32\dism.exe\""".xml" AND Image!="c:\users\\appdata\local\temp\\dismhost.exe") OR ParentImage=c:\windows\system32\fodhelper.exe OR (CommandLine="\"c:\windows\system32\wusa.exe\"/quiet" AND User!=NOT_TRANSLATED AND CurrentDirectory=c:\windows\system32\ AND ParentImage!=c:\windows\explorer.exe) OR CommandLine=".exe\"cleanmgr.exe /autoclean" OR (ParentImage="c:\windows\dccw.exe" AND Image!="c:\windows\system32\cttune.exe") OR Image="c:\program files\windows media player\osk.exe" OR ParentImage="c:\windows\system32\slui.exe"|eval PossibleTechniques=case(like(lower(ParentCommandLine),"%c:\windows\system32\dism.exe%"), "UACME #23", like(lower(Image),"c:\program files\windows media player\osk.exe"), "UACME #32", like(lower(ParentImage),"c:\windows\system32\fodhelper.exe"),  "UACME #33", like(lower(CommandLine),"%.exe\"%cleanmgr.exe /autoclean%"), "UACME #34", like(lower(Image),"c:\windows\system32\wusa.exe"), "UACME #36", like(lower(ParentImage),"c:\windows\%dccw.exe"), "UACME #37", like(lower(ParentImage),"c:\windows\system32\slui.exe"), "UACME #45")Analytic 2 - Disable UAC(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") ParentImage="C:\Windows\System32\cmd.exe" CommandLine="reg.exeHKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\SystemREG_DWORD /d 0*""Process MetadataMonitor contextual data about a running process, which may include information such as environment variables, image name, user/owner that may bypass UAC mechanisms to elevate process privileges on system.DS0024Windows RegistryWindows Registry Key ModificationSome UAC bypass methods rely on modifying specific, user-accessible Registry settings. For example:* Theeventvwr.exebypass uses the[HKEY_CURRENT_USER]\Software\Classes\mscfile\shell\open\commandRegistry key.[6]* Thesdclt.exebypass uses the[HKEY_CURRENT_USER]\Software\Microsoft\Windows\CurrentVersion\App Paths\control.exeand[HKEY_CURRENT_USER]\Software\Classes\exefile\shell\runas\command\isolatedCommandRegistry keys.[68][69]Analysts should monitor these Registry settings for unauthorized changes.UAC Bypass is an interesting technique in that new implementations are regularly found and existing implementations may be fixed (i.e., patched) by Microsoft in new builds of Windows. Therefore, it is important to validate than detections for UAC Bypass are still relevant (i.e., they target non-patched implementations).Note: Sysmon Event ID 12 (Registry Key Create/Delete), Sysmon Event ID 13 (Registry Value Set), and Sysmon Event ID 14 (Registry Key and Value Rename) are useful for creating detections around Registry Key Modification in the context of UAC Bypass.ReferencesLich, B. (2016, May 31). How User Account Control Works. Retrieved June 3, 2016.Russinovich, M. (2009, July). User Account Control: Inside Windows 7 User Account Control. Retrieved July 26, 2016.Microsoft. (n.d.). The COM Elevation Moniker. Retrieved July 26, 2016.Davidson, L. (n.d.). Windows 7 UAC whitelist. Retrieved November 12, 2014.UACME Project. (2016, June 16). UACMe. Retrieved July 26, 2016.Nelson, M. (2016, August 15). "Fileless" UAC Bypass using eventvwr.exe and Registry Hijacking. Retrieved December 27, 2016.Salvio, J., Joven, R. (2016, December 16). Malicious Macro Bypasses UAC to Elevate Privilege for Fareit Malware. Retrieved December 27, 2016.Medin, T. (2013, August 8). PsExec UAC Bypass. Retrieved June 3, 2016.Cybersecurity and Infrastructure Security Agency. (2021, February 21). AppleJeus: Analysis of North Korea’s Cryptocurrency Malware. Retrieved March 1, 2021.Dunwoody, M. and Carr, N.. (2016, September 27). No Easy Breach DerbyCon 2016. Retrieved October 4, 2016.GReAT. (2019, May 13). ScarCruft continues to evolve, introduces Bluetooth harvester. Retrieved June 4, 2019.Settle, A., et al. (2016, August 8). MONSOON - Analysis Of An APT Campaign. Retrieved September 22, 2016.Yuste, J. Pastrana, S. (2021, February 9). Avaddon ransomware: an in-depth analysis and decryption of infected systems. Retrieved August 19, 2021.Mamedov, O. Sinitsyn, F.  Ivanov, A.. (2017, October 24). Bad Rabbit ransomware. Retrieved January 28, 2021.Vrabie, V., et al. (2021, March 10). FIN8 Returns with Improved BADHATCH Toolkit. Retrieved September 8, 2021.Frankoff, S., Hartley, B. (2018, November 14). Big Game Hunting: The Evolution of INDRIK SPIDER From Dridex Wire Fraud to BitPaymer Targeted Ransomware. Retrieved January 6, 2021.Microsoft Defender Threat Intelligence. (2022, June 13). The many lives of BlackCat ransomware. Retrieved December 20, 2022.F-Secure Labs. (2014). BlackEnergy & Quedagh: The convergence of crimeware and APT attacks. Retrieved March 24, 2016.Counter Threat Unit Research Team. (2017, October 12). BRONZE BUTLER Targets Japanese Enterprises. Retrieved January 4, 2018.Chen, J. et al. (2019, November). Operation ENDTRADE: TICK’s Multi-Stage Backdoors for Attacking Industries and Stealing Classified Data. Retrieved June 9, 2020.Cybereason. (2022, August 17). Bumblebee Loader – The High Road to Enterprise Domain Control. Retrieved August 29, 2022.Lunghi, D. et al. (2020, February). Uncovering DRBControl. Retrieved November 12, 2021.Chen, T. and Chen, Z. (2020, February 17). CLAMBLING - A New Backdoor Base On Dropbox. Retrieved November 12, 2021.Matveeva, V. (2017, August 15). Secrets of Cobalt. Retrieved October 10, 2018.Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.Dahan, A. et al. (2020, November 2). Back to the Future: Inside the Kimsuky KGH Spyware Suite. Retrieved November 6, 2020.Adi Zeligson & Rotem Kerner. (2018, November 13). Enter The DarkGate - New Cryptocurrency Mining and Ransomware Campaign. Retrieved February 9, 2024.ESET. (2016, October). En Route with Sednit - Part 3: A Mysterious Downloader. Retrieved November 21, 2016.Chen, J., et al. (2022). Delving Deep: An Analysis of Earth Lusca’s Operations. Retrieved July 1, 2022.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.Porolli, M. (2020, July 9). More evil: A deep look at Evilnum and its toolset. Retrieved January 22, 2021.FinFisher. (n.d.). Retrieved December 20, 2017.Allievi, A.,Flori, E. (2018, March 01). FinFisher exposed: A researcher’s tale of defeating traps, tricks, and complex virtual machines. Retrieved July 9, 2018.Dupuy, T. and Faou, M. (2021, June). Gelsemium. Retrieved November 30, 2021.ESET. (2020, April 28). Grandoreiro: How engorged can an EXE get?. Retrieved November 13, 2020.Reynolds, J.. (2016, September 14). H1N1: Technical analysis reveals new capabilities – part 2. Retrieved September 26, 2016.Hromcová, Z. (2018, June 07). InvisiMole: Surprisingly equipped spyware, undercover since 2013. Retrieved July 10, 2018.Hromcova, Z. and Cherpanov, A. (2020, June). INVISIMOLE: THE HIDDEN PART OF THE STORY. Retrieved July 16, 2020.Magius, J., et al. (2017, July 19). Koadic. Retrieved June 18, 2018.Jazi, H. (2021, February). LazyScripter: From Empire to double RAT. Retrieved November 24, 2021.Karmi, D. (2020, January 4). A Look Into Konni 2019 Campaign. Retrieved April 28, 2020.Threat Intelligence Team. (2021, August 23). New variant of Konni malware used in campaign targetting Russia. Retrieved January 5, 2022.Muhammad, I., Unterbrink, H.. (2021, January 6). A Deep Dive into Lokibot Infection Chain. Retrieved August 31, 2021.ClearSky Cyber Security. (2018, November). MuddyWater Operations in Lebanon and Oman: Using an Israeli compromised domain for a two-stage campaign. Retrieved November 29, 2018.Sherstobitoff, R. (2018, March 02). McAfee Uncovers Operation Honeybee, a Malicious Document Campaign Targeting Humanitarian Aid Groups. Retrieved May 16, 2018.Cymmetria. (2016). Unveiling Patchwork - The Copy-Paste APT. Retrieved August 3, 2016.Tartare, M. et al. (2020, May 21). No “Game over” for the Winnti Group. Retrieved August 24, 2020.Ash, B., et al. (2018, June 26). RANCOR: Targeted Attacks in South East Asia Using PLAINTEE and DDKONG Malware Families. Retrieved July 2, 2018.Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.Nicolas Verdier. (n.d.). Retrieved January 29, 2018.CISA. (2018, December 18). Analysis Report (AR18-352A) Quasar Open-Source Remote Administration Tool. Retrieved August 1, 2022.Sanmillan, I.. (2020, May 13). Ramsay: A cyber‑espionage toolkit tailored for air‑gapped networks. Retrieved May 27, 2020.Antiy CERT. (2020, April 20). Analysis of Ramsay components of Darkhotel's infiltration and isolation network. Retrieved March 24, 2021.Bacurio, F., Salvio, J. (2017, February 14). REMCOS: A New RAT In The Wild. Retrieved November 6, 2018.Faou, M. and Boutin, J. (2017, February). Read The Manual: A Guide to the RTM Banking Trojan. Retrieved March 9, 2017.Unit 42. (2022, February 25). Spear Phishing Attacks Target Organizations in Ukraine, Payloads Include the Document Stealer OutSteel and the Downloader SaintBot. Retrieved June 9, 2022.Dell SecureWorks Counter Threat Unit Threat Intelligence. (2015, July 30). Sakula Malware Family. Retrieved January 26, 2016.Falcone, R.. (2016, November 30). Shamoon 2: Return of the Disttrack Wiper. Retrieved January 11, 2017.Yonathan Klijnsma. (2016, May 17). Mofang: A politically motivated information stealing adversary. Retrieved May 12, 2020.Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.Pantazopoulos, N., Henry T. (2018, May 18). Emissary Panda – A potential new malicious tool. Retrieved June 25, 2018.Harakhavik, Y. (2020, February 3). Warzone: Behind the enemy lines. Retrieved December 17, 2021.Mohanta, A. (2020, November 25). Warzone RAT comes with UAC bypass technique. Retrieved April 7, 2022.Antenucci, S., Pantazopoulos, N., Sandee, M. (2020, June 23). WastedLocker: A New Ransomware Variant Developed By The Evil Corp Group. Retrieved September 14, 2021.Novetta Threat Research Group. (2015, April 7). Winnti Analysis. Retrieved February 8, 2017.Huss, D., et al. (2017, February 2). Oops, they did it again: APT Targets Russia and Belarus with ZeroT and PlugX. Retrieved April 5, 2018.Nelson, M. (2017, March 14). Bypassing UAC using App Paths. Retrieved May 25, 2017.Nelson, M. (2017, March 17). "Fileless" UAC Bypass Using sdclt.exe. Retrieved May 25, 2017.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.