MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseInter-Process CommunicationXPC ServicesInter-Process Communication:XPC ServicesOther sub-techniques of Inter-Process Communication (3)IDNameT1559.001Component Object ModelT1559.002Dynamic Data ExchangeT1559.003XPC ServicesAdversaries can provide malicious content to an XPC service daemon for local code execution. macOS uses XPC services for basic inter-process communication between various processes, such as between the XPC Service daemon and third-party application privileged helper tools. Applications can send messages to the XPC Service daemon, which runs as root, using the low-level XPC ServiceC APIor the high levelNSXPCConnection APIin order to handle tasks that require elevated privileges (such as network connections). Applications are responsible for providing the protocol definition which serves as a blueprint of the XPC services. Developers typically use XPC Services to provide applications stability and privilege separation between the application client and the daemon.[1][2]Adversaries can abuse XPC services to execute malicious content. Requests for malicious execution can be passed through the application's XPC Services handler.[3][4]This may also include identifying and abusing improper XPC client validation and/or poor sanitization of input parameters to conductExploitation for Privilege Escalation.ID:T1559.003Sub-technique of:T1559ⓘTactic:ExecutionⓘPlatforms:macOSContributors:Csaba Fitzl @theevilbit of Offensive SecurityVersion:1.0Created:12 October 2021Last Modified:20 April 2022Version PermalinkLive VersionMitigationsIDMitigationDescriptionM1013Application Developer GuidanceEnable the Hardened Runtime capability when developing applications. Do not include thecom.apple.security.get-task-allowentitlement with the value set to any variation of true.DetectionIDData SourceData ComponentDetectsDS0009ProcessProcess AccessMonitor for processes making abnormal calls to higher privileged processes, such as a user application connecting to a VPN service.[5]ReferencesApple. (2016, September 9). Creating XPC Services. Retrieved April 19, 2022.Apple. (n.d.). Retrieved October 12, 2021.Mickey Jin. (2021, June 3). CVE-2021-30724: CVMServer Vulnerability in macOS and iOS. Retrieved October 12, 2021.Wojciech Reguła. (2020, June 29). Learn XPC exploitation. Retrieved October 12, 2021.VerSprite. (2018, January 24). Exploiting VyprVPN for MacOS. Retrieved April 20, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.