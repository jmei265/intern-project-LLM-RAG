MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseNetwork Share DiscoveryNetwork Share DiscoveryAdversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement. Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network.File sharing over a Windows network occurs over the SMB protocol.[1][2]Netcan be used to query a remote system for available shared drives using thenet view \\remotesystemcommand. It can also be used to query shared drives on the local system usingnet share. For macOS, thesharing -lcommand lists all shared points used for smb services.ID:T1135Sub-techniques:No sub-techniquesⓘTactic:DiscoveryⓘPlatforms:Linux, Windows, macOSContributors:PraetorianVersion:3.2Created:14 December 2017Last Modified:29 September 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS1129AkiraAkiracan identify remote file shares for encryption.[3]G0006APT1APT1listed connected network shares.[4]G0050APT32APT32used thenet viewcommand to show all shares available, including the administrative shares such asC$andADMIN$.[5]G0082APT38APT38has enumerated network shares on a compromised host.[6]G0087APT39APT39has used the post exploitation toolCrackMapExecto enumerate network shares.[7]G0096APT41APT41used thenet sharecommand as part of network reconnaissance.[8][9]S0640AvaddonAvaddonhas enumerated shared folders and mapped volumes.[10]S1053AvosLockerAvosLockerhas enumerated shared drives on a compromised network.[11][12]S0638BabukBabukhas the ability to enumerate network shares.[13]S0606Bad RabbitBad Rabbitenumerates open SMB shares on internal victim networks.[14]S1081BADHATCHBADHATCHcan check a user's access to the C$ share on a compromised machine.[15]S0534BazarBazarcan enumerate shared drives on the domain.[16]S0570BitPaymerBitPaymercan search for network shares on the domain or workgroup usingnet view.[17]S1068BlackCatBlackCathas the ability to discover network shares on compromised networks.[18][19]C0015C0015DuringC0015, the threat actors executed the PowerView ShareFinder module to identify open shares.[20]G0114ChimeraChimerahas usednet shareandnet viewto identify network shares of interest.[21]S0660ClamblingClamblinghas the ability to enumerate network shares.[22]S0611ClopClopcan enumerate network shares.[23]S0154Cobalt StrikeCobalt Strikecan query shared drives on the local system.[24]S0575ContiContican enumerate remote open SMB network shares usingNetShareEnum().[25][26]S0488CrackMapExecCrackMapExeccan enumerate the shared folders and associated permissions for a targeted network.[27]S0625CubaCubacan discover shared resources using theNetShareEnumAPI call.[28]G0105DarkVishnyaDarkVishnyascanned the network for public shared folders.[29]S0616DEATHRANSOMDEATHRANSOMhas the ability to use loop operations to enumerate network resources.[30]S0659DiavolDiavolhas aENMDSKScommand to enumerates available network shares.[31]G0035DragonflyDragonflyhas identified and browsed file servers in the victim network, sometimes , viewing files pertaining to ICS or Supervisory Control and Data Acquisition (SCADA) systems.[32]S0367EmotetEmotethas enumerated non-hidden network shares usingWNetEnumResourceW.[33]S0363EmpireEmpirecan find shared drives on the local system.[34]G1016FIN13FIN13has executed net view commands for enumeration of open shares on compromised machines.[35][36]S0618FIVEHANDSFIVEHANDScan enumerate network shares and mounted drives on a network.[37]S0696FlagproFlagprohas been used to executenet viewto discover mapped network shares.[38]S0617HELLOKITTYHELLOKITTYhas the ability to enumerate network resources.[30]S0260InvisiMoleInvisiMolecan gather network share information.[39]S0250KoadicKoadiccan scan local network for open SMB.[40]S1075KOPILUWAKKOPILUWAKcan usenetstatandNetto discover network shares.[41]S0236KwampirsKwampirscollects a list of network shares with the commandnet share.[42]S0233MURKYTOPMURKYTOPhas the capability to retrieve information about shares on remote hosts.[43]S0039NetThenet view \remotesystemandnet sharecommands inNetcan be used to find shared drives and directories on remote and local systems respectively.[44]S0365Olympic DestroyerOlympic Destroyerwill attempt to enumerate mapped network shares to later attempt to wipe all files on those shares.[45]C0012Operation CuckooBeesDuringOperation CuckooBees, the threat actors used thenet sharecommand as part of their advanced reconnaissance.[46]C0014Operation WocaoDuringOperation Wocao, threat actors discovered network disks mounted to the system usingnetstat.[47]S0165OSInfoOSInfodiscovers shares on the network[48]S0013PlugXPlugXhas a module to enumerate network shares.[49]S0192PupyPupycan list local and remote shared drives and folders over SMB.[50]S0650QakBotQakBotcan usenet shareto identify network shares for use in lateral movement.[51][52]S0686QuietSieveQuietSievecan identify and search networked drives for specific file name extensions.[53]S0458RamsayRamsaycan scan for network drives which may contain documents for collection.[54][55]S1073RoyalRoyalcan enumerate the shared resources of a given IP addresses using the API callNetShareEnum.[56]S1085SardonicSardonichas the ability to execute thenet viewcommand.[57]S0444ShimRatShimRatcan enumerate connected drives for infected host machines.[58]S0692SILENTTRINITYSILENTTRINITYcan enumerate shares on a compromised host.[59]G0054SowbugSowbuglisted remote shared drives that were accessible from a victim.[60]S0603StuxnetStuxnetenumerates the directories of a network resource.[61]G0131Tonto TeamTonto Teamhas used tools such asNBTscanto enumerate network shares.[62]S0266TrickBotTrickBotmodule shareDll/mshareDll discovers network shares via the WNetOpenEnumA API.[63][64]G0081Tropic TrooperTropic Trooperusednetviewto scan target systems for shared resources.[65]S0612WastedLockerWastedLockercan identify network adjacent and accessible drives.[66]S0689WhisperGateWhisperGatecan enumerate connected remote logical drives.[67]G0102Wizard SpiderWizard Spiderhas used the "net view" command to locate mapped network shares.[68]S0251ZebrocyZebrocyidentifies network drives when they are added to victim systems.[69]MitigationsIDMitigationDescriptionM1028Operating System ConfigurationEnable Windows Group Policy "Do Not Allow Anonymous Enumeration of SAM Accounts and Shares" security setting to limit users who can enumerate network shares.[70]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.DS0009ProcessOS API ExecutionMonitor for API calls that may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.Process CreationMonitor for newly executed processes that may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.ReferencesWikipedia. (2017, April 15). Shared resource. Retrieved June 30, 2017.Microsoft. (n.d.). Share a Folder or Drive. Retrieved June 30, 2017.Max Kersten & Alexandre Mundo. (2023, November 29). Akira Ransomware. Retrieved April 4, 2024.Mandiant. (n.d.). APT1 Exposing One of China’s Cyber Espionage Units. Retrieved July 18, 2016.Dahan, A. (2017). Operation Cobalt Kitty. Retrieved December 27, 2018.DHS/CISA. (2020, August 26). FASTCash 2.0: North Korea's BeagleBoyz Robbing Banks. Retrieved September 29, 2021.Rusu, B. (2020, May 21). Iranian Chafer APT Targeted Air Transportation and Government in Kuwait and Saudi Arabia. Retrieved May 22, 2020.Fraser, N., et al. (2019, August 7). Double DragonAPT41, a dual espionage and cyber crime operation APT41. Retrieved September 23, 2019.Rostovcev, N. (2021, June 10). Big airline heist APT41 likely behind a third-party attack on Air India. Retrieved August 26, 2021.Yuste, J. Pastrana, S. (2021, February 9). Avaddon ransomware: an in-depth analysis and decryption of infected systems. Retrieved August 19, 2021.Hasherezade. (2021, July 23). AvosLocker enters the ransomware scene, asks for partners. Retrieved January 11, 2023.FBI, FinCEN, Treasury. (2022, March 17). Indicators of Compromise Associated with AvosLocker Ransomware. Retrieved January 11, 2023.Sogeti. (2021, March). Babuk Ransomware. Retrieved August 11, 2021.M.Léveille, M-E.. (2017, October 24). Bad Rabbit: Not‑Petya is back with improved ransomware. Retrieved January 28, 2021.Vrabie, V., et al. (2021, March 10). FIN8 Returns with Improved BADHATCH Toolkit. Retrieved September 8, 2021.Pantazopoulos, N. (2020, June 2). In-depth analysis of the new Team9 malware family. Retrieved December 1, 2020.Frankoff, S., Hartley, B. (2018, November 14). Big Game Hunting: The Evolution of INDRIK SPIDER From Dridex Wire Fraud to BitPaymer Targeted Ransomware. Retrieved January 6, 2021.Microsoft Defender Threat Intelligence. (2022, June 13). The many lives of BlackCat ransomware. Retrieved December 20, 2022.Brandt, Andrew. (2022, July 14). BlackCat ransomware attacks not merely a byproduct of bad luck. Retrieved December 20, 2022.DFIR Report. (2021, November 29). CONTInuing the Bazar Ransomware Story. Retrieved September 29, 2022.Jansen, W . (2021, January 12). Abusing cloud services to fly under the radar. Retrieved January 19, 2021.Lunghi, D. et al. (2020, February). Uncovering DRBControl. Retrieved November 12, 2021.Mundo, A. (2019, August 1). Clop Ransomware. Retrieved May 10, 2021.Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.Baskin, B. (2020, July 8). TAU Threat Discovery: Conti Ransomware. Retrieved February 17, 2021.Podlosky, A., Hanel, A. et al. (2020, October 16). WIZARD SPIDER Update: Resilient, Reactive and Resolute. Retrieved June 15, 2021.byt3bl33d3r. (2018, September 8). SMB: Command Reference. Retrieved July 17, 2020.Roccio, T., et al. (2021, April). Technical Analysis of Cuba Ransomware. Retrieved June 18, 2021.Golovanov, S. (2018, December 6). DarkVishnya: Banks attacked through direct connection to local network. Retrieved May 15, 2020.McLellan, T.  and Moore, J. et al. (2021, April 29). UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial Threat. Retrieved June 2, 2021.Neeamni, D., Rubinfeld, A.. (2021, July 1). Diavol - A New Ransomware Used By Wizard Spider?. Retrieved November 12, 2021.US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.Binary Defense. (n.d.). Emotet Evolves With new Wi-Fi Spreader. Retrieved September 8, 2023.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.Ta, V., et al. (2022, August 8). FIN13: A Cybercriminal Threat Actor Focused on Mexico. Retrieved February 9, 2023.Sygnia Incident Response Team. (2022, January 5). TG2003: ELEPHANT BEETLE UNCOVERING AN ORGANIZED FINANCIAL-THEFT OPERATION. Retrieved February 9, 2023.Matthews, M. and Backhouse, W. (2021, June 15). Handy guide to a new Fivehands ransomware variant. Retrieved June 24, 2021.Hada, H. (2021, December 28).  Flagpro The new malware used by BlackTech. Retrieved March 25, 2022.Hromcová, Z. (2018, June 07). InvisiMole: Surprisingly equipped spyware, undercover since 2013. Retrieved July 10, 2018.Magius, J., et al. (2017, July 19). Koadic. Retrieved June 18, 2018.Hawley, S. et al. (2023, February 2). Turla: A Galaxy of Opportunity. Retrieved May 15, 2023.Symantec Security Response Attack Investigation Team. (2018, April 23). New Orangeworm attack group targets the healthcare sector in the U.S., Europe, and Asia. Retrieved May 8, 2018.FireEye. (2018, March 16). Suspected Chinese Cyber Espionage Group (TEMP.Periscope) Targeting U.S. Engineering and Maritime Industries. Retrieved April 11, 2018.Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015.Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer Takes Aim At Winter Olympics. Retrieved March 14, 2019.Cybereason Nocturnus. (2022, May 4). Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques. Retrieved September 22, 2022.Dantzig, M. v., Schamper, E. (2019, December 19). Operation Wocao: Shining a light on one of China’s hidden hacking groups. Retrieved October 8, 2020.Symantec Security Response. (2016, September 6). Buckeye cyberespionage group shifts gaze from US to Hong Kong. Retrieved September 26, 2016.Computer Incident Response Center Luxembourg. (2013, March 29). Analysis of a PlugX variant. Retrieved November 5, 2018.Nicolas Verdier. (n.d.). Retrieved January 29, 2018.Mendoza, E. et al. (2020, May 25). Qakbot Resurges, Spreads through VBS Files. Retrieved September 27, 2021.Kuzmenko, A. et al. (2021, September 2). QakBot technical analysis. Retrieved September 27, 2021.Microsoft Threat Intelligence Center. (2022, February 4). ACTINIUM targets Ukrainian organizations. Retrieved February 18, 2022.Sanmillan, I.. (2020, May 13). Ramsay: A cyber‑espionage toolkit tailored for air‑gapped networks. Retrieved May 27, 2020.Antiy CERT. (2020, April 20). Analysis of Ramsay components of Darkhotel's infiltration and isolation network. Retrieved March 24, 2021.Cybereason Global SOC and Cybereason Security Research Teams. (2022, December 14). Royal Rumble: Analysis of Royal Ransomware. Retrieved March 30, 2023.Budaca, E., et al. (2021, August 25). FIN8 Threat Actor Goes Agile with New Sardonic Backdoor. Retrieved August 9, 2023.Yonathan Klijnsma. (2016, May 17). Mofang: A politically motivated information stealing adversary. Retrieved May 12, 2020.Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.Symantec Security Response. (2017, November 7). Sowbug: Cyber espionage group targets South American and Southeast Asian governments. Retrieved November 16, 2017.Nicolas Falliere, Liam O Murchu, Eric Chien 2011, February W32.Stuxnet Dossier (Version 1.4) Retrieved. 2017/09/22Daniel Lughi, Jaromir Horejsi. (2020, October 2). Tonto Team - Exploring the TTPs of an advanced threat actor operating a large infrastructure. Retrieved October 17, 2021.Boutin, J. (2020, October 12). ESET takes part in global operation to disrupt Trickbot. Retrieved March 15, 2021.Tudorica, R., Maximciuc, A., Vatamanu, C. (2020, March 18). New TrickBot Module Bruteforces RDP Connections, Targets Select Telecommunication Services in US and Hong Kong. Retrieved March 15, 2021.Alintanahin, K. (2015). Operation Tropic Trooper: Relying on Tried-and-Tested Flaws to Infiltrate Secret Keepers. Retrieved June 14, 2019.Walter, J.. (2020, July 23). WastedLocker Ransomware: Abusing ADS and NTFS File Attributes. Retrieved September 14, 2021.Biasini, N. et al.. (2022, January 21). Ukraine Campaign Delivers Defacement and Wipers, in Continued Escalation. Retrieved March 14, 2022.DHS/CISA. (2020, October 28). Ransomware Activity Targeting the Healthcare and Public Health Sector. Retrieved October 28, 2020.Kaspersky Lab's Global Research & Analysis Team. (2018, February 20). A Slice of 2017 Sofacy Activity. Retrieved November 27, 2018.Microsoft. (2017, April 19). Network access: Do not allow anonymous enumeration of SAM accounts and shares. Retrieved May 20, 2020.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.