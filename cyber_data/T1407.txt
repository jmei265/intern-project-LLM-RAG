MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesMobileDownload New Code at RuntimeDownload New Code at RuntimeAdversaries may download and execute dynamic code not included in the original application package after installation. This technique is primarily used to evade static analysis checks and pre-publication scans in official app stores. In some cases, more advanced dynamic or behavioral analysis techniques could detect this behavior. However, in conjunction withExecution Guardrailstechniques, detecting malicious code downloaded after installation could be difficult.On Android, dynamic code could include native code, Dalvik code, or JavaScript code that utilizes Android WebView’sJavascriptInterfacecapability.On iOS, dynamic code could be downloaded and executed through 3rd party libraries such as JSPatch.[1]ID:T1407Sub-techniques:No sub-techniquesTactic Type:Post-Adversary Device AccessⓘTactic:Defense EvasionⓘPlatforms:Android, iOSⓘMTC ID:APP-20Version:1.5Created:25 October 2017Last Modified:08 August 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS1061AbstractEmuAbstractEmucan download and install additional malware after initial infection.[2]S0422AnubisAnubiscan download attacker-specified APK files.[3]S1079BOULDSPYBOULDSPYcan download and run code obtained from the C2.[4]S0293BrainTestOriginal samples ofBrainTestdownload their exploit packs for rooting from a remote server after installation.[5]S1094BRATABRATAhas used an initial dropper to download an additional malicious application, and downloads its configuration file from the C2 server.[6][7]S0432BreadBreadhas utilized JavaScript within WebViews that loaded a URL hosted on a Bread-controlled server which provided functions to run.Breaddownloads billing fraud execution steps at runtime.[8]S0655BusyGasperBusyGaspercan download a payload or updates from either its C2 server or email attachments in the adversary’s inbox.[9]S0529CarbonStealCarbonStealcan dynamically load additional functionality.[10]S0480CerberusCerberuscan update the malicious payload module on command.[11]S1083ChameleonChameleoncan download new code at runtime.[12]S0555CHEMISTGAMESCHEMISTGAMEScan download new modules while running.[13]S0505Desert ScorpionDesert Scorpionhas been distributed in multiple stages.[14]S0550DoubleAgentDoubleAgenthas downloaded additional code to root devices, such as TowelRoot.[10]S0420DvmapDvmapcan download code and binaries from the C2 server to execute on the device as root.[15]S0507eSurveSurv’s Android version is distributed in three stages: the dropper, the second stage payload, and the third stage payload which isExodus.[16]S0478EventBotEventBotcan download new libraries when instructed to.[17]S0405ExodusExodusOne, after checking in, sends a POST request and then downloadsExodusTwo, the second stage binaries.[18]S0577FrozenCellFrozenCellhas downloaded and installed additional applications.[19]S0535Golden CupGolden Cuphas been distributed in two stages.[20]S0551GoldenEagleGoldenEaglecan download new code to update itself.[10]S0536GPlayedGPlayedhas the capability to remotely load plugins and download and compile new .NET code.[21]S0544HenBoxHenBoxcan load additional Dalvik code while running.[22]S0325JudyJudybypasses Google Play's protections by downloading a malicious payload at runtime after installation.[23]S0485MandrakeMandrakecan download its second (Loader) and third (Core) stages after the dropper is installed.[24]S0295RCSAndroidRCSAndroidhas the ability to dynamically download and execute new code at runtime.[25]S0539Red Alert 2.0Red Alert 2.0can download additional overlay templates.[26]S1055SharkBotSharkBotcan use the Android "Direct Reply" feature to spread the malware to other devices. It can also download the full version of the malware after initial device compromise.[27]S0549SilkBeanSilkBeancan install new applications which are obtained from the C2 server.[10]S0327SkygofreeSkygofreecan download executable code from the C2 server after the implant starts or after a specific command.[28]S0324SpyDealerSpyDealerdownloads and executes root exploits from a remote server.[29]S0545TERRACOTTATERRACOTTAcan download additional modules at runtime via JavaScriptevalstatements.[30]S0424TriadaTriadautilizes a backdoor in a Play Store app to install additional trojanized apps from the Command and Control server.[31]S0506ViperRATViperRAThas been installed in two stages and can secretly install new applications.[32]G0112WindshiftWindshifthas included malware functionality capable of downloading new DEX files at runtime during Operation BULL.[33]S0489WolfRATWolfRATcan update the running malware.[34]S0311YiSpecterYiSpecterhas used private APIs to download and install other pieces of itself, as well as other malicious apps.[35]S0494ZenZencan dynamically load executable code from remote sources.[36]S0287ZergHelperZergHelperattempts to extend its capabilities via dynamic updating of its code.[37]MitigationsIDMitigationDescriptionM1006Use Recent OS VersionApplications that target Android API level 29 or higher cannot execute native code stored in the application's internal data storage directory, limiting the ability of applications to download and execute native code at runtime.[38]DetectionIDData SourceData ComponentDetectsDS0041Application VettingAPI CallsApplication vetting services could look for indications that the application downloads and executes new code at runtime (e.g., on Android, use ofDexClassLoader,System.load, or the WebViewJavaScriptInterfacecapability; on iOS, use of JSPatch or similar capabilities).Network CommunicationApplication vetting services may be able to list domains and/or IP addresses that applications communicate with.DS0029Network TrafficNetwork Traffic ContentMobile security products may provide URL inspection services that could determine if a domain being visited is malicious.ReferencesJing Xie, Zhaofeng Chen, Jimmy Su. (2016, January 27). HOT OR NOT? THE BENEFITS AND RISKS OF IOS REMOTE HOT PATCHING. Retrieved December 9, 2016.P Shunk, K Balaam. (2021, October 28). Rooting Malware Makes a Comeback: Lookout Discovers Global Campaign. Retrieved February 6, 2023.K. Sun. (2019, January 17). Google Play Apps Drop Anubis, Use Motion-based Evasion. Retrieved January 20, 2021.Kyle Schmittle, Alemdar Islamoglu, Paul Shunk, Justin Albrecht. (2023, April 27). Lookout Discovers Android Spyware Tied to Iranian Police Targeting Minorities: BouldSpy. Retrieved July 21, 2023.Chris Dehghanpoor. (2016, January 6). Brain Test re-emerges: 13 apps found in Google Play  Read more: Brain Test re-emerges: 13 apps found in Google Play. Retrieved December 21, 2016.Federico Valentini, Francesco Lubatti. (2022, January 24). How BRATA is monitoring your bank account. Retrieved December 18, 2023.Fernando Ruiz. (2021, April 12). BRATA Keeps Sneaking into Google Play, Now Targeting USA and Spain. Retrieved December 18, 2023.A. Guertin, V. Kotov, Android Security & Privacy Team. (2020, January 9). PHA Family Highlights: Bread (and Friends) . Retrieved April 27, 2020.Alexey Firsh. (2018, August 29). BusyGasper – the unfriendly spy. Retrieved October 1, 2021.A. Kumar, K. Del Rosso, J. Albrecht, C. Hebeisen. (2020, June 1). Mobile APT Surveillance Campaigns Targeting Uyghurs - A collection of long-running Android tooling connected to a Chinese mAPT actor. Retrieved November 10, 2020.Threat Fabric. (2019, August). Cerberus - A new banking Trojan from the underworld. Retrieved June 26, 2020.Cyble Research & Intelligence Labs. (2023, April 13). Banking Trojan targeting mobile users in Australia and Poland. Retrieved August 16, 2023.B. Leonard, N. Mehta. (2019, November 21). The Secret Life of Sandworms. Retrieved December 31, 2020.A. Blaich, M. Flossman. (2018, April 16). Lookout finds new surveillanceware in Google Play with ties to known threat actor targeting the Middle East. Retrieved September 11, 2020.R. Unuchek. (2017, June 8). Dvmap: the first Android malware with code injection. Retrieved December 10, 2019.A. Bauer. (2019, April 8). Lookout discovers phishing sites distributing new iOS and Android surveillanceware. Retrieved September 11, 2020.D. Frank, L. Rochberger, Y. Rimmer, A. Dahan. (2020, April 30). EventBot: A New Mobile Banking Trojan is Born. Retrieved June 26, 2020.Security Without Borders. (2019, March 29). Exodus: New Android Spyware Made in Italy. Retrieved September 3, 2019.Michael Flossman. (2017, October 5). FrozenCell: Multi-platform surveillance campaign against Palestinians. Retrieved November 11, 2020.R. Iarchy, E. Rynkowski. (2018, July 5). GoldenCup: New Cyber Threat Targeting World Cup Fans. Retrieved October 29, 2020.V. Ventura. (2018, October 11).  GPlayed Trojan - .Net playing with Google Market . Retrieved November 24, 2020.A. Hinchliffe, M. Harbison, J. Miller-Osborn, et al. (2018, March 13). HenBox: The Chickens Come Home to Roost. Retrieved September 9, 2019.CheckPoint. (2017, May 25). The Judy Malware: Possibly the largest malware campaign found on Google Play. Retrieved September 18, 2018.R. Gevers, M. Tivadar, R. Bleotu, A. M. Barbatei, et al.. (2020, May 14). Uprooting Mandrake: The Story of an Advanced Android Spyware Framework That Went Undetected for 4 Years. Retrieved July 15, 2020.Veo Zhang. (2015, July 21). Hacking Team RCSAndroid Spying Tool Listens to Calls; Roots Devices to Get In. Retrieved December 22, 2016.J. Chandraiah. (2018, July 23). Red Alert 2.0: Android Trojan targets security-seekers. Retrieved December 14, 2020.RIFT: Research and Intelligence Fusion Team. (2022, March 3). SharkBot: a “new” generation Android banking Trojan being distributed on Google Play Store. Retrieved January 18, 2023.Nikita Buchka and Alexey Firsh. (2018, January 16). Skygofree: Following in the footsteps of HackingTeam. Retrieved September 24, 2018.Wenjun Hu, Cong Zheng and Zhi Xu. (2017, July 6). SpyDealer: Android Trojan Spying on More Than 40 Apps. Retrieved September 18, 2018.Satori Threat Intelligence and Research Team. (2020, August). TERRACOTTA Android Malware: A Technical Study. Retrieved December 18, 2020.Lukasz Siewierski. (2019, June 6). PHA Family Highlights: Triada. Retrieved July 16, 2019.M. Flossman. (2017, February 16). ViperRAT: The mobile APT targeting the Israeli Defense Force that should be on your radar. Retrieved September 11, 2020.The BlackBerry Research & Intelligence Team. (2020, October). BAHAMUT: Hack-for-Hire Masters of Phishing, Fake News, and Fake Apps. Retrieved February 8, 2021.W. Mercer, P. Rascagneres, V. Ventura. (2020, May 19).  The wolf is back... . Retrieved July 20, 2020.Claud Xiao. (2015, October 4). YiSpecter: First iOS Malware That Attacks Non-jailbroken Apple iOS Devices by Abusing Private APIs. Retrieved March 3, 2023.Siewierski, L. (2019, January 11). PHA Family Highlights: Zen and its cousins . Retrieved July 27, 2020.Claud Xiao. (2016, February 21). Pirated iOS App Store’s Client Successfully Evaded Apple iOS Code Review. Retrieved December 12, 2016.Android Developers. (n.d.). Behavior changes: all apps - Removed execute permission for app home directory. Retrieved September 20, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.