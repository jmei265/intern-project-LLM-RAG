MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseTraffic SignalingPort KnockingTraffic Signaling:Port KnockingOther sub-techniques of Traffic Signaling (2)IDNameT1205.001Port KnockingT1205.002Socket FiltersAdversaries may use port knocking to hide open ports used for persistence or command and control. To enable a port, an adversary sends a series of attempted connections to a predefined sequence of closed ports. After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.This technique has been observed both for the dynamic opening of a listening port as well as the initiating of a connection to a listening server on a different system.The observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r[1], is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.ID:T1205.001Sub-technique of:T1205ⓘTactics:Defense Evasion,Persistence,Command and ControlⓘPlatforms:Linux, Network, Windows, macOSⓘPermissions Required:UserVersion:1.1Created:01 July 2020Last Modified:11 March 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS1060MafaldaMafaldacan use port-knocking to authenticate itself to another implant called Cryshell to establish an indirect connection to the C2 server.[2][3]S1059metaMainmetaMainhas authenticated itself to a different implant, Cryshell, through a port knocking and handshake procedure.[2]G0056PROMETHIUMPROMETHIUMhas used a script that configures the knockd service and firewall to only accept C2 connections from systems that use a specified sequence of knock ports.[4]MitigationsIDMitigationDescriptionM1037Filter Network TrafficMitigation of some variants of this technique could be achieved through the use of stateful firewalls, depending upon how it is implemented.DetectionIDData SourceData ComponentDetectsDS0029Network TrafficNetwork Connection CreationMonitor for newly constructed network connections that are sent or received by untrusted hosts.Network Traffic FlowMonitor and analyze network flows associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider analyzing newly constructed network connections that are sent or received by untrusted hosts, unexpcted hardware devices, or other uncommon data flows.ReferencesHartrell, Greg. (2002, August). Get a handle on cd00r: The invisible backdoor. Retrieved October 13, 2018.Ehrlich, A., et al. (2022, September). THE MYSTERY OF METADOR | AN UNATTRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES. Retrieved January 23, 2023.SentinelLabs. (2022, September 22). Metador Technical Appendix. Retrieved April 4, 2023.Tudorica, R. et al. (2020, June 30). StrongPity APT - Revealing Trojanized Tools, Working Hours and Infrastructure. Retrieved July 20, 2020.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.