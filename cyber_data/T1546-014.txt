MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseEvent Triggered ExecutionEmondEvent Triggered Execution:EmondOther sub-techniques of Event Triggered Execution (16)IDNameT1546.001Change Default File AssociationT1546.002ScreensaverT1546.003Windows Management Instrumentation Event SubscriptionT1546.004Unix Shell Configuration ModificationT1546.005TrapT1546.006LC_LOAD_DYLIB AdditionT1546.007Netsh Helper DLLT1546.008Accessibility FeaturesT1546.009AppCert DLLsT1546.010AppInit DLLsT1546.011Application ShimmingT1546.012Image File Execution Options InjectionT1546.013PowerShell ProfileT1546.014EmondT1546.015Component Object Model HijackingT1546.016Installer PackagesAdversaries may gain persistence and elevate privileges by executing malicious content triggered by the Event Monitor Daemon (emond). Emond is aLaunch Daemonthat accepts events from various services, runs them through a simple rules engine, and takes action. The emond binary at/sbin/emondwill load any rules from the/etc/emond.d/rules/directory and take action once an explicitly defined event takes place.The rule files are in the plist format and define the name, event type, and action to take. Some examples of event types include system startup and user authentication. Examples of actions are to run a system command or send an email. The emond service will not launch if there is no file present in the QueueDirectories path/private/var/db/emondClients, specified in theLaunch Daemonconfiguration file at/System/Library/LaunchDaemons/com.apple.emond.plist.[1][2][3]Adversaries may abuse this service by writing a rule to execute commands when a defined event occurs, such as system start up or user authentication.[1][2][3]Adversaries may also be able to escalate privileges from administrator to root as the emond service is executed with root privileges by theLaunch Daemonservice.ID:T1546.014Sub-technique of:T1546ⓘTactics:Privilege Escalation,PersistenceⓘPlatforms:macOSⓘPermissions Required:AdministratorContributors:Ivan SinyakovVersion:1.0Created:24 January 2020Last Modified:20 April 2022Version PermalinkLive VersionMitigationsIDMitigationDescriptionM1042Disable or Remove Feature or ProgramConsider disabling emond by removing theLaunch Daemonplist file.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may gain persistence and elevate privileges by executing malicious content triggered by the Event Monitor Daemon (emond).DS0022FileFile CreationMonitor emond rules creation by checking for files created in/etc/emond.d/rules/and/private/var/db/emondClients.File ModificationMonitor emond rules creation by checking for files modified in/etc/emond.d/rules/and/private/var/db/emondClients.DS0009ProcessProcess CreationMonitor newly executed processes that may gain persistence and elevate privileges by executing malicious content triggered by the Event Monitor Daemon (emond).ReferencesRoss, Chris. (2018, January 17). Leveraging Emond on macOS For Persistence. Retrieved September 10, 2019.Reynolds, James. (2016, April 7). What is emond?. Retrieved September 10, 2019.Stokes, Phil. (2019, June 17). HOW MALWARE PERSISTS ON MACOS. Retrieved September 10, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.