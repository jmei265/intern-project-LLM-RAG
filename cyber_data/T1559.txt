MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseInter-Process CommunicationInter-Process CommunicationSub-techniques (3)IDNameT1559.001Component Object ModelT1559.002Dynamic Data ExchangeT1559.003XPC ServicesAdversaries may abuse inter-process communication (IPC) mechanisms for local code or command execution. IPC is typically used by processes to share data, communicate with each other, or synchronize execution. IPC is also commonly used to avoid situations such as deadlocks, which occurs when processes are stuck in a cyclic waiting pattern.Adversaries may abuse IPC to execute arbitrary code or commands. IPC mechanisms may differ depending on OS, but typically exists in a form accessible through programming languages/libraries or native interfaces such as WindowsDynamic Data ExchangeorComponent Object Model. Linux environments support several different IPC mechanisms, two of which being sockets and pipes.[1]Higher level execution mediums, such as those ofCommand and Scripting Interpreters, may also leverage underlying IPC mechanisms. Adversaries may also useRemote Servicessuch asDistributed Component Object Modelto facilitate remote IPC execution.[2]ID:T1559Sub-techniques:T1559.001,T1559.002,T1559.003ⓘTactic:ExecutionⓘPlatforms:Linux, Windows, macOSⓘPermissions Required:Administrator, SYSTEM, UserⓘSupports Remote:YesVersion:1.2Created:12 February 2020Last Modified:11 March 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0687Cyclops BlinkCyclops Blinkhas the ability to create a pipe to enable inter-process communication.[3]S0537HyperStackHyperStackcan connect to the IPC$ share on remote machines.[4]S1100NinjaNinjacan use pipes to redirect the standard input and the standard output.[5]S1123PITSTOPPITSTOPcan listen over the Unix domain socket located at/data/runtime/cockpit/wd.fd.[6]S1078RotaJakiroWhen executing with non-root permissions,RotaJakirouses the theshmget APIto create shared memory between other knownRotaJakiroprocesses. This allows processes to communicate with each other and share their PID.[7]S0022UroburosUroburoshas the ability to move data between its kernel and user mode components, generally using named pipes.[8]MitigationsIDMitigationDescriptionM1013Application Developer GuidanceEnable the Hardened Runtime capability when developing applications. Do not include thecom.apple.security.get-task-allowentitlement with the value set to any variation of true.M1048Application Isolation and SandboxingEnsure all COM alerts and Protected View are enabled.[9]M1040Behavior Prevention on EndpointOn Windows 10, enable Attack Surface Reduction (ASR) rules to prevent DDE attacks and spawning of child processes from Office programs.[10][11]M1042Disable or Remove Feature or ProgramRegistry keys specific to Microsoft Office feature control security can be set to disable automatic DDE/OLE execution.[12][13][14]Microsoft also created, and enabled by default, Registry keys to completely disable DDE execution in Word and Excel.[15]M1026Privileged Account ManagementModify Registry settings (directly or using Dcomcnfg.exe) inHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{AppID_GUID}associated with the process-wide security of individual COM applications.[16]Modify Registry settings (directly or using Dcomcnfg.exe) inHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Oleassociated with system-wide security defaults for all COM applications that do no set their own process-wide security.[17][18]M1054Software ConfigurationConsider disabling embedded files in Office programs, such as OneNote, that do not work with Protected View.[11][14]DetectionIDData SourceData ComponentDetectsDS0011ModuleModule LoadMonitor DLL/PE file events, specifically creation of these binary files as well as the loading of DLLs into processes. Look for DLLs that are not recognized or not normally loaded into a process.DS0009ProcessProcess AccessMonitor for processes making abnormal calls to higher privileged processes, such as a user application connecting to a VPN service.[19]Process CreationMonitor for newly executed processes that are associated with abuse of IPC mechanismsDS0012ScriptScript ExecutionMonitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.ReferencesN/A. (2021, April 1). Inter Process Communication (IPC). Retrieved March 11, 2022.Hamilton, C. (2019, June 4). Hunting COM Objects. Retrieved June 10, 2019.Haquebord, F. et al. (2022, March 17). Cyclops Blink Sets Sights on Asus Routers. Retrieved March 17, 2022.Accenture. (2020, October). Turla uses HyperStack, Carbon, and Kazuar to compromise government entity. Retrieved December 2, 2020.Dedola, G. (2022, June 21). APT ToddyCat. Retrieved January 3, 2024.Lin, M. et al. (2024, February 27). Cutting Edge, Part 3: Investigating Ivanti Connect Secure VPN Exploitation and Persistence Attempts. Retrieved March 1, 2024.Alex Turing, Hui Wang. (2021, April 28). RotaJakiro: A long live secret backdoor with 0 VT detection. Retrieved June 14, 2023.FBI et al. (2023, May 9). Hunting Russian Intelligence “Snake” Malware. Retrieved June 8, 2023.Microsoft. (n.d.). What is Protected View?. Retrieved November 22, 2017.Brower, N. & D'Souza-Wiltshire, I. (2017, November 9). Enable Attack surface reduction. Retrieved February 3, 2018.Nelson, M. (2018, January 29). Reviving DDE: Using OneNote and Excel for Code Execution. Retrieved February 3, 2018.Microsoft. (2017, November 8). Microsoft Security Advisory 4053440 - Securely opening Microsoft Office documents that contain Dynamic Data Exchange (DDE) fields. Retrieved November 21, 2017.Cimpanu, C. (2017, December 15). Microsoft Disables DDE Feature in Word to Prevent Further Malware Attacks. Retrieved December 19, 2017.Dormann, W. (2017, October 20). Disable DDEAUTO for Outlook, Word, OneNote, and Excel versions 2010, 2013, 2016. Retrieved February 3, 2018.Microsoft. (2017, December 12). ADV170021 - Microsoft Office Defense in Depth Update. Retrieved February 3, 2018.Microsoft. (n.d.). Setting Process-Wide Security Through the Registry. Retrieved November 21, 2017.Microsoft. (n.d.). Registry Values for System-Wide Security. Retrieved November 21, 2017.Microsoft. (n.d.). DCOM Security Enhancements in Windows XP Service Pack 2 and Windows Server 2003 Service Pack 1. Retrieved November 22, 2017.VerSprite. (2018, January 24). Exploiting VyprVPN for MacOS. Retrieved April 20, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.