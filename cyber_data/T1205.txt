MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseTraffic SignalingTraffic SignalingSub-techniques (2)IDNameT1205.001Port KnockingT1205.002Socket FiltersAdversaries may use traffic signaling to hide open ports or other malicious functionality used for persistence or command and control. Traffic signaling involves the use of a magic value or sequence that must be sent to a system to trigger a special response, such as opening a closed port or executing a malicious task. This may take the form of sending a series of packets with certain characteristics before a port will be opened that the adversary can use for command and control. Usually this series of packets consists of attempted connections to a predefined sequence of closed ports (i.e.Port Knocking), but can involve unusual flags, specific strings, or other unique characteristics. After the sequence is completed, opening a port may be accomplished by the host-based firewall, but could also be implemented by custom software.Adversaries may also communicate with an already open port, but the service listening on that port will only respond to commands or trigger other malicious functionality if passed the appropriate magic value(s).The observation of the signal packets to trigger the communication can be conducted through different methods. One means, originally implemented by Cd00r[1], is to use the libpcap libraries to sniff for the packets in question. Another method leverages raw sockets, which enables the malware to use ports that are already open for use by other programs.On network devices, adversaries may use crafted packets to enableNetwork Device Authenticationfor standard services offered by the device such as telnet.  Such signaling may also be used to open a closed service port such as telnet, or to trigger module modification of malware implants on the device, adding, removing, or changing malicious capabilities.  Adversaries may use crafted packets to attempt to connect to one or more (open or closed) ports, but may also attempt to connect to a router interface, broadcast, and network address IP on the same port in order to achieve their goals and objectives.[2][3][4]To enable this traffic signaling on embedded devices, adversaries must first achieve and leveragePatch System Imagedue to the monolithic nature of the architecture.Adversaries may also use the Wake-on-LAN feature to turn on powered off systems. Wake-on-LAN is a hardware feature that allows a powered down system to be powered on, or woken up, by sending a magic packet to it. Once the system is powered on, it may become a target for lateral movement.[5][6]ID:T1205Sub-techniques:T1205.001,T1205.002ⓘTactics:Defense Evasion,Persistence,Command and ControlⓘPlatforms:Linux, Network, Windows, macOSⓘDefense Bypassed:Defensive network service scanningContributors:Josh Day, Gigamon; Tony LeeVersion:2.4Created:18 April 2018Last Modified:19 October 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS1118BUSHWALKBUSHWALKcan modify theDSUserAgentCap.pmPerl module on Ivanti Connect Secure VPNs and either activate or deactivate depending on the value of the user agent in incoming HTTP requests.[7]S0220ChaosChaosprovides a reverse shell is triggered upon receipt of a packet with a special string, sent to any port.[8]C0029Cutting EdgeDuringCutting Edge, threat actors sent a magic 48-byte sequence to enable the PITSOCK backdoor to communicate via the/tmp/clientsDownload.socksocket.[7]S0641KobalosKobalosis triggered by an incoming TCP connection to a legitimate service from a specific source port.[9][10]S0664PandoraPandoracan identify if incoming HTTP traffic contains a token and if so it will intercept the traffic and process the received command.[11]S0587PenquinPenquinwill connect to C2 only after sniffing a "magic packet" value in TCP or UDP packets matching specific conditions.[12][13]S0446RyukRyukhas used Wake-on-Lan to power on turned off systems for lateral movement.[5]S0519SYNful KnockSYNful Knockcan be sent instructions via special packets to change its functionality. Code for new functionality can be included in these messages.[3]S0221UmbreonUmbreonprovides additional access using its backdoor Espeon, providing a reverse shell upon receipt of a special packet.[14]S0022UroburosUroburoscan intercept the first client to server packet in the 3-way TCP handshake to determine if the packet contains the correct unique value for a specificUroburosimplant. If the value does not match, the packet and the rest of the TCP session are passed to the legitimate listening application.[15]S0430Winnti for LinuxWinnti for Linuxhas used a passive listener, capable of identifying a specific magic value before executing tasking, as a secondary command and control (C2) mechanism.[16]S1114ZIPLINEZIPLINEcan identify a specific string in intercepted network traffic,SSH-2.0-OpenSSH_0.3xx., to trigger its command functionality.[17]MitigationsIDMitigationDescriptionM1042Disable or Remove Feature or ProgramDisable Wake-on-LAN if it is not needed within an environment.M1037Filter Network TrafficMitigation of some variants of this technique could be achieved through the use of stateful firewalls, depending upon how it is implemented.DetectionIDData SourceData ComponentDetectsDS0029Network TrafficNetwork Connection CreationMonitor for newly constructed network connections that are sent or received by untrusted hosts.Network Traffic ContentMonitor and analyze network packet contents to detect application layer protocols, leveraging SSL/TLS inspection for encrypted traffic, that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, protocol port mismatch, anomalous syntax, or structure). Consider packet inspection for Wake-on-LAN magic packet consists of 6 bytes ofFFfollowed by sixteen repetitions of the target system's IEEE address. Seeing this string anywhere in a packet's payload may be indicative of a Wake-on-LAN attempt.[18]Network Traffic FlowMonitor and analyze network flows associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider analyzing newly constructed network connections that are sent or received by untrusted hosts, unexpcted hardware devices, or other uncommon data flows.DS0009ProcessProcess CreationIdentify running processes with raw sockets. Ensure processes listed have a need for an open raw socket and are in accordance with enterprise policy.[19]ReferencesHartrell, Greg. (2002, August). Get a handle on cd00r: The invisible backdoor. Retrieved October 13, 2018.Graham Holmes. (2015, October 8). Evolution of attacks on Cisco IOS devices. Retrieved October 19, 2020.Bill Hau, Tony Lee, Josh Homan. (2015, September 15). SYNful Knock - A Cisco router implant - Part I. Retrieved October 19, 2020.Omar Santos. (2020, October 19). Attackers Continue to Target Legacy Devices. Retrieved October 20, 2020.Abrams, L. (2021, January 14). Ryuk Ransomware Uses Wake-on-Lan To Encrypt Offline Devices. Retrieved February 11, 2021.AMD. (1995, November 1). Magic Packet Technical White Paper. Retrieved February 17, 2021.Lin, M. et al. (2024, February 27). Cutting Edge, Part 3: Investigating Ivanti Connect Secure VPN Exploitation and Persistence Attempts. Retrieved March 1, 2024.Sebastian Feldmann. (2018, February 14). Chaos: a Stolen Backdoor Rising Again. Retrieved March 5, 2018.M.Leveille, M., Sanmillan, I. (2021, February 2). Kobalos – A complex Linux threat to high performance computing infrastructure. Retrieved August 24, 2021.M.Leveille, M., Sanmillan, I. (2021, January). A WILD KOBALOS APPEARS Tricksy Linux malware goes after HPCs. Retrieved August 24, 2021.Lunghi, D. and Lu, K. (2021, April 9). Iron Tiger APT Updates Toolkit With Evolved SysUpdate Malware. Retrieved November 12, 2021.Leonardo. (2020, May 29). MALWARE TECHNICAL INSIGHT TURLA “Penquin_x64”. Retrieved March 11, 2021.Baumgartner, K. and Raiu, C. (2014, December 8). The ‘Penquin’ Turla. Retrieved March 11, 2021.Fernando Mercês. (2016, September 5). Pokémon-themed Umbreon Linux Rootkit Hits x86, ARM Systems. Retrieved March 5, 2018.FBI et al. (2023, May 9). Hunting Russian Intelligence “Snake” Malware. Retrieved June 8, 2023.Chronicle Blog. (2019, May 15). Winnti: More than just Windows and Gates. Retrieved April 29, 2020.McLellan, T. et al. (2024, January 12). Cutting Edge: Suspected APT Targets Ivanti Connect Secure VPN in New Zero-Day Exploitation. Retrieved February 27, 2024.Perry, David. (2020, August 11). WakeOnLAN (WOL). Retrieved February 17, 2021.Jamie Harries. (2022, May 25). Hunting a Global Telecommunications Threat: DecisiveArchitect and Its Custom Implant JustForFun. Retrieved October 18, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.