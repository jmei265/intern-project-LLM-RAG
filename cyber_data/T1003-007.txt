MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseOS Credential DumpingProc FilesystemOS Credential Dumping:Proc FilesystemOther sub-techniques of OS Credential Dumping (8)IDNameT1003.001LSASS MemoryT1003.002Security Account ManagerT1003.003NTDST1003.004LSA SecretsT1003.005Cached Domain CredentialsT1003.006DCSyncT1003.007Proc FilesystemT1003.008/etc/passwd and /etc/shadowAdversaries may gather credentials from the proc filesystem or/proc. The proc filesystem is a pseudo-filesystem used as an interface to kernel data structures for Linux based systems managing virtual memory. For each process, the/proc/<PID>/mapsfile shows how memory is mapped within the process’s virtual address space. And/proc/<PID>/mem, exposed for debugging purposes, provides access to the process’s virtual address space.[1][2]When executing with root privileges, adversaries can search these memory locations for all processes on a system that contain patterns indicative of credentials. Adversaries may use regex patterns, such asgrep -E "^[0-9a-f-]* r" /proc/"$pid"/maps | cut -d' ' -f 1, to look for fixed strings in memory structures or cached hashes.[3]When running without privileged access, processes can still view their own virtual memory locations. Some services or programs may save credentials in clear text inside the process’s memory.[4][5]If running as or with the permissions of a web browser, a process can search the/maps&/memlocations for common website credential patterns (that can also be used to find adjacent memory within the same structure) in which hashes or cleartext credentials may be located.ID:T1003.007Sub-technique of:T1003ⓘTactic:Credential AccessⓘPlatforms:LinuxContributors:Tim (Wadhwa-)BrownVersion:1.2Created:11 February 2020Last Modified:10 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0349LaZagneLaZagnecan use the<PID>/mapsand<PID>/memfiles to identify regex patterns to dump cleartext passwords from the browser's process memory.[6][1]S0179MimiPenguinMimiPenguincan use the<PID>/mapsand<PID>/memfile to search for regex patterns and dump the process memory.[4][1]S1109PACEMAKERPACEMAKERhas the ability to extract credentials from OS memory.[7]MitigationsIDMitigationDescriptionM1027Password PoliciesEnsure that root accounts have complex, unique passwords across all systems on the network.M1026Privileged Account ManagementFollow best practices in restricting access to privileged accounts to avoid hostile programs from accessing sensitive information.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may gather credentials from information stored in the Proc filesystem or/proc. For instance, adversaries may use regex patterns to search for process memory that may be exfiltrated or searched for credentials.[3][8]grep -E "^[0-9a-f-]* r" /proc/"$pid"/maps | grep -E 'heap|stack' | cut -d' ' -f 1grep -E "^[0-9a-f-]* r" /proc/"$PID"/maps | grep heap | cut -d' ' -f 1DS0022FileFile AccessMonitor for unexpected access to passwords and hashes stored in memory, processes must open a maps file in the /proc filesystem for the process being analyzed. This file is stored under the path/proc/\/maps, where the\directory is the unique pid of the program being interrogated for such authentication data. The AuditD monitoring tool, which ships stock in many Linux distributions, can be used to watch for hostile processes opening this file in the proc file system, alerting on the pid, process name, and arguments of such programs.ReferencesHuseyin Can YUCEEL & Picus Labs. (2022, March 22). Retrieved March 31, 2023.baeldung. (2022, April 8). Understanding the Linux /proc/id/maps File. Retrieved March 31, 2023.Atomic Red Team. (2023, November). T1003.007 - OS Credential Dumping: Proc Filesystem. Retrieved March 28, 2024.Gregal, H. (2017, May 12). MimiPenguin. Retrieved December 5, 2017.Carlos Polop. (2023, March 5). Linux Privilege Escalation. Retrieved March 31, 2023.Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018.Perez, D. et al. (2021, April 20). Check Your Pulse: Suspected APT Actors Leverage Authentication Bypass Techniques and Pulse Secure Zero-Day. Retrieved February 5, 2024.Gregal, Hunter. (2019, September 17). MimiPenguin 2.0. Retrieved March 28, 2024.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.