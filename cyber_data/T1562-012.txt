MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseImpair DefensesDisable or Modify Linux Audit SystemImpair Defenses:Disable or Modify Linux Audit SystemOther sub-techniques of Impair Defenses (11)IDNameT1562.001Disable or Modify ToolsT1562.002Disable Windows Event LoggingT1562.003Impair Command History LoggingT1562.004Disable or Modify System FirewallT1562.006Indicator BlockingT1562.007Disable or Modify Cloud FirewallT1562.008Disable or Modify Cloud LogsT1562.009Safe Mode BootT1562.010Downgrade AttackT1562.011Spoof Security AlertingT1562.012Disable or Modify Linux Audit SystemAdversaries may disable or modify the Linux audit system to hide malicious activity and avoid detection. Linux admins use the Linux Audit system to track security-relevant information on a system. The Linux Audit system operates at the kernel-level and maintains event logs on application and system activity such as process, network, file, and login events based on pre-configured rules.Often referred to asauditd, this is the name of the daemon used to write events to disk and is governed by the parameters set in theaudit.confconfiguration file. Two primary ways to configure the log generation rules are through the command lineauditctlutility and the file/etc/audit/audit.rules,  containing a sequence ofauditctlcommands loaded at boot time.[1][2]With root privileges, adversaries may be able to ensure their activity is not logged through disabling the Audit system service, editing the configuration/rule files, or by hooking the Audit system library functions. Using the command line, adversaries can disable the Audit system service through killing processes associated withauditddaemon or usesystemctlto stop the Audit service. Adversaries can also hook Audit system functions to disable logging or modify the rules contained in the/etc/audit/audit.rulesoraudit.conffiles to ignore malicious activity.[3][4]ID:T1562.012Sub-technique of:T1562ⓘTactic:Defense EvasionⓘPlatforms:LinuxContributors:Tim (Wadhwa-)BrownVersion:1.0Created:24 May 2023Last Modified:03 October 2023Version PermalinkLive VersionMitigationsIDMitigationDescriptionM1047AuditRoutinely check account role permissions to ensure only expected users and roles have permission to modify logging settings.To ensure Audit rules can not be modified at runtime, add theauditctl -e 2as the last command in the audit.rules files. Once started, any attempt to change the configuration in this mode will be audited and denied. The configuration can only be changed by rebooting the machine.M1018User Account ManagementAn adversary must already have root level access on the local system to make full use of this technique; be sure to restrict users and accounts to the least privileges they require.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionCommand-line invocation of theauditctlutility may be unusual, depending on how systems are typically used in a particular environment. At runtime, look for commands to modify or create rules using theauditctlutility.DS0022FileFile DeletionMonitor for missing log files from machines with known active periods.File ModificationMonitor changes made to the/etc/audit/audit.rulesfile containing the sequence ofauditctlcommands loaded at boot time.DS0009ProcessOS API ExecutionMonitor for abnormal execution of syslog and other functions associated with system logging.Process ModificationUsing another process or third-party tools, monitor for potentially malicious modifications or access to theauditdsystem process.ReferencesJahoda, M. et al.. (2017, March 14). Red Hat  Security Guide - Chapter 7 - System Auditing. Retrieved December 20, 2017.IzySec. (2022, January 26). Linux auditd for Threat Detection. Retrieved September 29, 2023.Radoslaw Zdonczyk. (2023, July 30). Honeypot Recon: New Variant of SkidMap Targeting Redis. Retrieved September 29, 2023.M.Léveillé, M.. (2014, February 21). An In-depth Analysis of Linux/Ebury. Retrieved April 19, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.