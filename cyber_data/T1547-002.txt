MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseBoot or Logon Autostart ExecutionAuthentication PackageBoot or Logon Autostart Execution:Authentication PackageOther sub-techniques of Boot or Logon Autostart Execution (14)IDNameT1547.001Registry Run Keys / Startup FolderT1547.002Authentication PackageT1547.003Time ProvidersT1547.004Winlogon Helper DLLT1547.005Security Support ProviderT1547.006Kernel Modules and ExtensionsT1547.007Re-opened ApplicationsT1547.008LSASS DriverT1547.009Shortcut ModificationT1547.010Port MonitorsT1547.012Print ProcessorsT1547.013XDG Autostart EntriesT1547.014Active SetupT1547.015Login ItemsAdversaries may abuse authentication packages to execute DLLs when the system boots. Windows authentication package DLLs are loaded by the Local Security Authority (LSA) process at system start. They provide support for multiple logon processes and multiple security protocols to the operating system.[1]Adversaries can use the autostart mechanism provided by LSA authentication packages for persistence by placing a reference to a binary in the Windows Registry locationHKLM\SYSTEM\CurrentControlSet\Control\Lsa\with the key value of"Authentication Packages"=<target binary>. The binary will then be executed by the system when the authentication packages are loaded.ID:T1547.002Sub-technique of:T1547ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:WindowsⓘPermissions Required:AdministratorVersion:1.0Created:24 January 2020Last Modified:20 April 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0143FlameFlamecan use Windows Authentication Packages for persistence.[2]MitigationsIDMitigationDescriptionM1025Privileged Process IntegrityWindows 8.1, Windows Server 2012 R2, and later versions, may make LSA run as a Protected Process Light (PPL) by setting the Registry keyHKLM\SYSTEM\CurrentControlSet\Control\Lsa\RunAsPPL, which requires all DLLs loaded by LSA to be signed by Microsoft.[3][4]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may abuse authentication packages to execute DLLs when the system boots.DS0011ModuleModule LoadMonitor the LSA process for DLL loads. Windows 8.1 and Windows Server 2012 R2 may generate events when unsigned DLLs try to load into the LSA by setting the Registry keyHKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\LSASS.exewith AuditLevel = 8.[3][4]DS0024Windows RegistryWindows Registry Key ModificationMonitor the Registry for changes to the LSA Registry keys. Windows 8.1 and Windows Server 2012 R2 may generate events when unsigned DLLs try to load into the LSA by setting the Registry keyHKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\LSASS.exewith AuditLevel = 8.[3][4]ReferencesMicrosoft. (n.d.). Authentication Packages. Retrieved March 1, 2017.sKyWIper Analysis Team. (2012, May 31). sKyWIper (a.k.a. Flame a.k.a. Flamer):  A complex malware for targeted attacks. Retrieved September 6, 2018.Graeber, M. (2014, October). Analysis of Malicious Security Support Provider DLLs. Retrieved March 1, 2017.Microsoft. (2013, July 31). Configuring Additional LSA Protection. Retrieved June 24, 2015.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.