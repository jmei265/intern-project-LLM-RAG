MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseProxyProxySub-techniques (4)IDNameT1090.001Internal ProxyT1090.002External ProxyT1090.003Multi-hop ProxyT1090.004Domain FrontingAdversaries may use a connection proxy to direct network traffic between systems or act as an intermediary for network communications to a command and control server to avoid direct connections to their infrastructure. Many tools exist that enable traffic redirection through proxies or port redirection, includingHTRAN, ZXProxy, and ZXPortMap.[1]Adversaries use these types of proxies to manage command and control communications, reduce the number of simultaneous outbound network connections, provide resiliency in the face of connection loss, or to ride over existing trusted communications paths between victims to avoid suspicion. Adversaries may chain together multiple proxies to further disguise the source of malicious traffic.Adversaries can also take advantage of routing schemes in Content Delivery Networks (CDNs) to proxy command and control traffic.ID:T1090Sub-techniques:T1090.001,T1090.002,T1090.003,T1090.004ⓘTactic:Command and ControlⓘPlatforms:Linux, Network, Windows, macOSContributors:Heather Linn; Jon Sheedy; Walker JohnsonVersion:3.1Created:31 May 2017Last Modified:30 August 2021Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0096APT41APT41used a tool called CLASSFON to covertly proxy network communications.[2]S0456Aria-bodyAria-bodyhas the ability to use a reverse SOCKS proxy module.[3]S0347AuditCredAuditCredcan utilize proxy for communications.[4]S0245BADCALLBADCALLfunctions as a proxy server between the victim and C2 server.[5]S1081BADHATCHBADHATCHcan use SOCKS4 and SOCKS5 proxies to connect to actor-controlled C2 servers.BADHATCHcan also emulate a reverse proxy on a compromised machine to connect with actor-controlled C2 servers.[6]S0268BisonalBisonalhas supported use of a proxy server.[7]G0108Blue MockingbirdBlue Mockingbirdhas used frp, ssf, and Venom to establish SOCKS proxy connections.[8]C0017C0017DuringC0017,APT41used the Cloudflare CDN to proxy C2 traffic.[9]C0027C0027DuringC0027,Scattered Spiderinstalled the open-source rsocx reverse proxy tool on a targeted ESXi appliance.[10]S0348Cardinal RATCardinal RATcan act as a reverse proxy.[11]G1021Cinnamon TempestCinnamon Tempesthas used a customized version of the Iox port-forwarding and proxy tool.[12]G0052CopyKittensCopyKittenshas used the AirVPN service for operational activity.[13]S0384DridexDridexcontains a backconnect module for tunneling network traffic through a victim's computer. Infected computers become part of a P2P botnet that can relay C2 traffic to other infected peers.[14][15]G1006Earth LuscaEarth Luscaadopted Cloudflare as a proxy for compromised servers.[16]G0117Fox KittenFox Kittenhas used the open source reverse proxy tools including FRPC and Go Proxy to establish connections from C2 to local servers.[17][18][19]S1044FunnyDreamFunnyDreamcan identify and use configured proxies in a compromised network for C2 communication.[20]S0690Green LambertGreen Lambertcan use proxies for C2 traffic.[21][22]S0246HARDRAINHARDRAINuses the commandcmd.exe /c netsh firewall add portopening TCP 443 "adp"and makes the victim machine function as a proxy server.[23]S0376HOPLIGHTHOPLIGHThas multiple proxy options that mask traffic between the malware and the remote operators.[24]S0040HTRANHTRANcan proxy TCP socket connections to obfuscate command and control infrastructure.[25][26]S0283jRATjRATcan serve as a SOCKS proxy server.[27]S0487KesselKesselcan use a proxy during exfiltration if set in the configuration.[28]S1051KEYPLUGKEYPLUGhas used Cloudflare CDN associated infrastructure to redirect C2 communications to malicious domains.[9]S0669KOCTOPUSKOCTOPUShas deployed a modified version of Invoke-Ngrok to expose open local ports to the Internet.[29]G1004LAPSUS$LAPSUS$has leverage NordVPN for its egress points when targeting intended victims.[30]S1121LITTLELAMB.WOOLTEALITTLELAMB.WOOLTEAhas the ability to function as a SOCKS proxy.[31]G0059Magic HoundMagic Houndhas used Fast Reverse Proxy (FRP) for RDP traffic.[32]G1019MoustachedBouncerMoustachedBouncerhas used a reverse proxy tool similar to the GitHub repository revsocks.[33]S0108netshnetshcan be used to set up a proxy tunnel to allow remote host access to an infected host.[34]S0198NETWIRENETWIREcan implement use of proxies to pivot traffic.[35]S0508ngrokngrokcan be used to proxy connections to machines located behind NAT or firewalls.[36][37]C0013Operation SharpshooterForOperation Sharpshooter, the threat actors used the ExpressVPN service to hide their location.[38]C0014Operation WocaoDuringOperation Wocao, threat actors used a custom proxy tool called "Agent" which has support for multiple hops.[39]S0435PLEADPLEADhas the ability to proxy network communications.[40]G1005POLONIUMPOLONIUMhas used the AirVPN service for operational activity.[13]S0378PoshC2PoshC2contains modules that allow for use of proxies in command and control.[41]S0262QuasarRATQuasarRATcan communicate over a reverse proxy using SOCKS5.[42][43]S0629RainyDayRainyDaycan use proxy tools including boost_proxy_client for reverse proxy functionality.[44]S0332RemcosRemcosuses the infected hosts as SOCKS5 proxies to allow for tunneling and proxying.[45]S1099SamuraiSamuraihas the ability to proxy connections to specified remote IPs and ports through a a proxy module.[46]G0034Sandworm TeamSandworm Team's BCS-server tool can create an internal proxy server to redirect traffic from the adversary-controlled C2 to internal servers which may not be connected to the internet, but are interconnected locally.[47]S0461SDBbotSDBbothas the ability to use port forwarding to establish a proxy between a target host and C2.[48]S0273SocksbotSocksbotcan start SOCKS proxy threads.[49]S0615SombRATSombRAThas the ability to use an embedded SOCKS proxy in C2 communications.[50]S0436TSCookieTSCookiehas the ability to proxy communications with command and control (C2) servers.[51]G0010TurlaTurlaRPC backdoors have included local UPnP RPC proxies.[52]S0263TYPEFRAMEATYPEFRAMEvariant can force the compromised system to function as a proxy server.[53]S0386UrsnifUrsnifhas used a peer-to-peer (P2P) network for C2.[54][55]S0207VasportVasportis capable of tunneling though a proxy.[56]G1017Volt TyphoonVolt Typhoonhas used compromised devices and customized versions of open source tools  such as Fast Reverse Proxy (FRP), Earthworm, andImpacketto proxy network traffic.[57][58]S0670WarzoneRATWarzoneRAThas the capability to act as a reverse proxy.[59]G0124WindigoWindigohas delivered a generic Windows proxy Win32/Glubteta.M.Windigohas also used multiple reverse proxy chains as part of their C2 infrastructure.[60]S0117XTunnelXTunnelrelays traffic between a C2 server and a victim.[61]S1114ZIPLINEZIPLINEcan create a proxy server on compromised hosts.[62][63]S0412ZxShellZxShellcan set up an HTTP or SOCKS proxy.[2][64]MitigationsIDMitigationDescriptionM1037Filter Network TrafficTraffic to known anonymity networks and C2 infrastructure can be blocked through the use of network allow and block lists. It should be noted that this kind of blocking may be circumvented by other techniques likeDomain Fronting.M1031Network Intrusion PreventionNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Signatures are often for unique indicators within protocols and may be based on the specific C2 protocol used by a particular adversary or tool, and will likely be different across various malware families and versions. Adversaries will likely change tool C2 signatures over time or construct protocols in such a way as to avoid detection by common defensive tools.[65]M1020SSL/TLS InspectionIf it is possible to inspect HTTPS traffic, the captures can be analyzed for connections that appear to be domain fronting.DetectionIDData SourceData ComponentDetectsDS0029Network TrafficNetwork Connection CreationMonitor for newly constructed network connections that are sent or received by untrusted hosts.Network Traffic ContentMonitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).Network Traffic FlowMonitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.ReferencesWilhoit, K. (2013, March 4). In-Depth Look: APT Attack Tools of the Trade. Retrieved December 2, 2015.Fraser, N., et al. (2019, August 7). Double DragonAPT41, a dual espionage and cyber crime operation APT41. Retrieved September 23, 2019.CheckPoint. (2020, May 7). Naikon APT: Cyber Espionage Reloaded. Retrieved May 26, 2020.Trend Micro. (2018, November 20). Lazarus Continues Heists, Mounts Attacks on Financial Organizations in Latin America. Retrieved December 3, 2018.US-CERT. (2018, February 06). Malware Analysis Report (MAR) - 10135536-G. Retrieved June 7, 2018.Vrabie, V., et al. (2021, March 10). FIN8 Returns with Improved BADHATCH Toolkit. Retrieved September 8, 2021.Mercer, W., et al. (2020, March 5). Bisonal: 10 years of play. Retrieved January 26, 2022.Lambert, T. (2020, May 7). Introducing Blue Mockingbird. Retrieved May 26, 2020.Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.Parisi, T. (2022, December 2). Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies. Retrieved June 30, 2023.Grunzweig, J.. (2017, April 20). Cardinal RAT Active for Over Two Years. Retrieved December 8, 2018.Biderman, O. et al. (2022, October 3). REVEALING EMPEROR DRAGONFLY: NIGHT SKY AND CHEERSCRYPT - A SINGLE RANSOMWARE GROUP. Retrieved December 6, 2023.Microsoft. (2022, June 2). Exposing POLONIUM activity and infrastructure targeting Israeli organizations. Retrieved July 1, 2022.Dell SecureWorks Counter Threat Unit Threat Intelligence. (2015, October 13). Dridex (Bugat v5) Botnet Takeover Operation. Retrieved May 31, 2019.Check Point Research. (2021, January 4). Stopping Serial Killer: Catching the Next Strike. Retrieved September 7, 2021.Chen, J., et al. (2022). Delving Deep: An Analysis of Earth Lusca’s Operations. Retrieved July 1, 2022.CISA. (2020, September 15). Iran-Based Threat Actor Exploits VPN Vulnerabilities. Retrieved December 21, 2020.ClearSky. (2020, December 17). Pay2Key Ransomware – A New Campaign by Fox Kitten. Retrieved December 21, 2020.Check Point. (2020, November 6). Ransomware Alert: Pay2Key. Retrieved January 4, 2021.Vrabie, V. (2020, November). Dissecting a Chinese APT Targeting South Eastern Asian Government Institutions. Retrieved September 19, 2022.Sandvik, Runa. (2021, October 1). Made In America: Green Lambert for OS X. Retrieved March 21, 2022.Sandvik, Runa. (2021, October 18). Green Lambert and ATT&CK. Retrieved March 21, 2022.US-CERT. (2018, February 05). Malware Analysis Report (MAR) - 10135536-F. Retrieved June 11, 2018.US-CERT. (2019, April 10). MAR-10135536-8 – North Korean Trojan: HOPLIGHT. Retrieved April 19, 2019.Haq, T., Moran, N., Vashisht, S., Scott, M. (2014, September). OPERATION QUANTUM ENTANGLEMENT. Retrieved November 4, 2015.The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019.Kamluk, V. & Gostev, A. (2016, February). Adwind - A Cross-Platform RAT. Retrieved April 23, 2019.Dumont, R., M.Léveillé, M., Porcher, H. (2018, December 1). THE DARK SIDE OF THE FORSSHE A landscape of OpenSSH backdoors. Retrieved July 16, 2020.Jazi, H. (2021, February). LazyScripter: From Empire to double RAT. Retrieved November 24, 2021.MSTIC, DART, M365 Defender. (2022, March 24). DEV-0537 Criminal Actor Targeting Organizations for Data Exfiltration and Destruction. Retrieved May 17, 2022.Lin, M. et al. (2024, February 27). Cutting Edge, Part 3: Investigating Ivanti Connect Secure VPN Exploitation and Persistence Attempts. Retrieved March 1, 2024.DFIR Report. (2021, November 15). Exchange Exploit Leads to Domain Wide Ransomware. Retrieved January 5, 2023.Faou, M. (2023, August 10). MoustachedBouncer: Espionage against foreign diplomats in Belarus. Retrieved September 25, 2023.Kaspersky Lab's Global Research and Analysis Team. (2017, February 8). Fileless attacks against enterprise networks. Retrieved February 8, 2017.Lambert, T. (2020, January 29). Intro to Netwire. Retrieved January 7, 2021.Segura, J. (2020, February 26). Fraudsters cloak credit card skimmer with fake content delivery network, ngrok server. Retrieved September 15, 2020.Cimpanu, C. (2018, September 13). Sly malware author hides cryptomining botnet behind ever-shifting proxy service. Retrieved September 15, 2020.I. Ilascu. (2019, March 3). Op 'Sharpshooter' Connected to North Korea's Lazarus Group. Retrieved September 26, 2022.Dantzig, M. v., Schamper, E. (2019, December 19). Operation Wocao: Shining a light on one of China’s hidden hacking groups. Retrieved October 8, 2020.Tomonaga, S. (2018, June 8). PLEAD Downloader Used by BlackTech. Retrieved May 6, 2020.Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.MaxXor. (n.d.). QuasarRAT. Retrieved July 10, 2018.Meltzer, M, et al. (2018, June 07). Patchwork APT Group Targets US Think Tanks. Retrieved July 16, 2018.Vrabie, V. (2021, April 23). NAIKON – Traces from a Military Cyber-Espionage Operation. Retrieved June 29, 2021.Klijnsma, Y. (2018, January 23). Espionage Campaign Leverages Spear Phishing, RATs Against Turkish Defense Contractors. Retrieved November 6, 2018.Dedola, G. (2022, June 21). APT ToddyCat. Retrieved January 3, 2024.Cherepanov, A.. (2016, December 13). The rise of TeleBots: Analyzing disruptive KillDisk attacks. Retrieved June 10, 2020.Schwarz, D. et al. (2019, October 16). TA505 Distributes New SDBbot Remote Access Trojan with Get2 Downloader. Retrieved May 29, 2020.Lunghi, D., et al. (2017, December). Untangling the Patchwork Cyberespionage Group. Retrieved July 10, 2018.CISA. (2021, May 6). Analysis Report (AR21-126A) FiveHands Ransomware. Retrieved June 7, 2021.Tomonaga, S.. (2019, September 18). Malware Used by BlackTech after Network Intrusion. Retrieved May 6, 2020.Faou, M. and Dumont R.. (2019, May 29). A dive into Turla PowerShell usage. Retrieved June 14, 2019.US-CERT. (2018, June 14). MAR-10135536-12 – North Korean Trojan: TYPEFRAME. Retrieved July 13, 2018.NJCCIC. (2016, September 27). Ursnif. Retrieved June 4, 2019.Proofpoint Staff. (2016, August 25). Nightmare on Tor Street: Ursnif variant Dreambot adds Tor functionality. Retrieved June 5, 2019.Zhou, R. (2012, May 15). Backdoor.Vasport. Retrieved February 22, 2018.Microsoft Threat Intelligence. (2023, May 24). Volt Typhoon targets US critical infrastructure with living-off-the-land techniques. Retrieved July 27, 2023.NSA et al. (2023, May 24). People's Republic of China State-Sponsored Cyber Actor Living off the Land to Evade Detection. Retrieved July 27, 2023.Harakhavik, Y. (2020, February 3). Warzone: Behind the enemy lines. Retrieved December 17, 2021.Bilodeau, O., Bureau, M., Calvet, J., Dorais-Joncas, A., Léveillé, M., Vanheuverzwijn, B. (2014, March 18). Operation Windigo – the vivisection of a large Linux server‑side credential‑stealing malware campaign. Retrieved February 10, 2021.Alperovitch, D.. (2016, June 15). Bears in the Midst: Intrusion into the Democratic National Committee. Retrieved August 3, 2016.McLellan, T. et al. (2024, January 12). Cutting Edge: Suspected APT Targets Ivanti Connect Secure VPN in New Zero-Day Exploitation. Retrieved February 27, 2024.Lin, M. et al. (2024, January 31). Cutting Edge, Part 2: Investigating Ivanti Connect Secure VPN Zero-Day Exploitation. Retrieved February 27, 2024.Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.