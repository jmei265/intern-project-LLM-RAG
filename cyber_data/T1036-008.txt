MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseMasqueradingMasquerade File TypeMasquerading:Masquerade File TypeOther sub-techniques of Masquerading (9)IDNameT1036.001Invalid Code SignatureT1036.002Right-to-Left OverrideT1036.003Rename System UtilitiesT1036.004Masquerade Task or ServiceT1036.005Match Legitimate Name or LocationT1036.006Space after FilenameT1036.007Double File ExtensionT1036.008Masquerade File TypeT1036.009Break Process TreesAdversaries may masquerade malicious payloads as legitimate files through changes to the payload's formatting, including the file’s signature, extension, and contents. Various file types have a typical standard format, including how they are encoded and organized. For example, a file’s signature (also known as header or magic bytes) is the beginning bytes of a file and is often used to identify the file’s type. For example, the header of a JPEG file,  is0xFF 0xD8and the file extension is either.JPE,.JPEGor.JPG.Adversaries may edit the header’s hex code and/or the file extension of a malicious payload in order to bypass file validation checks and/or input sanitization. This behavior is commonly used when payload files are transferred (e.g.,Ingress Tool Transfer) and stored (e.g.,Upload Malware) so that adversaries may move their malware without triggering detections.Common non-executable file types and extensions, such as text files (.txt) and image files (.jpg,.gif, etc.) may be typically treated as benign.  Based on this, adversaries may use a file extension to disguise malware, such as naming a PHP backdoor code with a file name oftest.gif. A user may not know that a file is malicious due to the benign appearance and file extension.Polygot files, which are files that have multiple different file types and that function differently based on the application that will execute them, may also be used to disguise malicious malware and capabilities.[1]ID:T1036.008Sub-technique of:T1036ⓘTactic:Defense EvasionⓘPlatforms:Linux, Windows, macOSContributors:Ben Smith, @ezaspy; CrowdStrike Falcon OverWatchVersion:1.0Created:08 March 2023Last Modified:14 June 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionC00252016 Ukraine Electric Power AttackDuring the2016 Ukraine Electric Power Attack,Sandworm Teammasqueraded executables as.txtfiles.[2]S1074ANDROMEDAANDROMEDAhas been delivered through a LNK file disguised as a folder.[3]S1053AvosLockerAvosLockerhas been disguised as a .jpg file.[4]S1063Brute Ratel C4Brute Ratel C4has used Microsoft Word icons to hide malicious LNK files.[5]C0022Operation Dream JobDuringOperation Dream Job,Lazarus Groupdisguised malicious template files as JPEG files to avoid detection.[6][7]S0352OSX_OCEANLOTUS.DOSX_OCEANLOTUS.Dhas disguised it's true file structure as an application bundle by adding special characters to the filename and using the icon for legitimate Word documents.[8]S0650QakBotTheQakBotpayload has been disguised as a PNG file and hidden within LNK files using a Microsoft File Explorer icon.[9][10]G1017Volt TyphoonVolt Typhoonhas appended copies of the ntds.dit database with a .gif file extension.[11]MitigationsIDMitigationDescriptionM1049Antivirus/AntimalwareAnti-virus can be used to automatically quarantine suspicious files.M1040Behavior Prevention on EndpointImplement security controls on the endpoint, such as a Host Intrusion Prevention System (HIPS), to identify and prevent execution of files with mismatching file signatures.M1038Execution PreventionEnsure that input sanitization is performed and that files are validated properly before execution; furthermore, implement a strict allow list to ensure that only authorized file types are processed.[12]Restrict and/or block execution of files where headers and extensions do not match.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor for abnormal command execution from otherwise non-executable file types (such as.txtand.jpg).DS0022FileFile ModificationCheck and ensure that file headers/signature and extensions match using magic bytes detection and/or file signature validation.[13]In Linux, thefilecommand may be used to check the file signature.[14]ReferencesLim, M. (2022, September 27). More Than Meets the Eye: Exposing a Polyglot File That Delivers IcedID. Retrieved September 29, 2022.Joe Slowik. (2018, October 12). Anatomy of an Attack: Detecting and Defeating CRASHOVERRIDE. Retrieved December 18, 2020.Hawley, S. et al. (2023, February 2). Turla: A Galaxy of Opportunity. Retrieved May 15, 2023.Trend Micro Research. (2022, April 4). Ransomware Spotlight AvosLocker. Retrieved January 11, 2023.Harbison, M. and Renals, P. (2022, July 5). When Pentest Tools Go Brutal: Red-Teaming Tool Being Abused by Malicious Actors. Retrieved February 1, 2023.Cashman, M. (2020, July 29). Operation North Star Campaign. Retrieved December 20, 2021.Breitenbacher, D and Osis, K. (2020, June 17). OPERATION IN(TER)CEPTION: Targeted Attacks Against European Aerospace and Military Companies. Retrieved December 20, 2021.Magisa, L. (2020, November 27). New MacOS Backdoor Connected to OceanLotus Surfaces. Retrieved December 2, 2020.Group IB. (2020, September). LOCK LIKE  A PRO. Retrieved September 27, 2021.Kenefick, I. et al. (2022, October 12). Black Basta Ransomware Gang Infiltrates Networks via QAKBOT, Brute Ratel, and Cobalt Strike. Retrieved February 6, 2023.Counter Threat Unit Research Team. (2023, May 24). Chinese Cyberespionage Group BRONZE SILHOUETTE Targets U.S. Government and Defense Organizations. Retrieved July 27, 2023.YesWeRHackers. (2021, June 16). File Upload Attacks (Part 2). Retrieved August 23, 2022.Li, V. (2019, October 2). Polyglot Files: a Hacker’s best friend. Retrieved September 27, 2022.Kessler, G. (2022, December 9). GCK'S FILE SIGNATURES TABLE. Retrieved August 23, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.