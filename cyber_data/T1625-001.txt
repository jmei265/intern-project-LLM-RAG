MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesMobileHijack Execution FlowSystem Runtime API HijackingHijack Execution Flow:System Runtime API HijackingAdversaries may execute their own malicious payloads by hijacking the way an operating system runs applications. Hijacking execution flow can be for the purposes of persistence since this hijacked execution may reoccur at later points in time.On Android, adversaries may overwrite the standard OS API library with a malicious alternative to hook into core functions to achieve persistence. By doing this, the adversary’s code will be executed every time the overwritten API function is called by an app on the infected device.ID:T1625.001Sub-technique of:T1625Tactic Type:Post-Adversary Device AccessⓘTactic:PersistenceⓘPlatforms:AndroidⓘMTC ID:APP-27Version:1.1Created:30 March 2022Last Modified:08 September 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0420DvmapDvmapreplaces/system/bin/ipwith a malicious version.Dvmapcan inject code by patchinglibdmv.soorlibandroid_runtime.so, depending on the Android OS version. Both libraries are related to the Dalvik and ART runtime environments. The patched functions can only call/system/bin/ip, which was replaced with the malicious version.[1]S0408FlexiSpyFlexiSpyinstalls boot hooks into/system/su.d.[2]S0494ZenZencan install itself on the system partition to achieve persistence.Zencan also replaceframework.jar, which allows it to intercept and modify the behavior of the standard Android API.[3]MitigationsIDMitigationDescriptionM1002AttestationDevice attestation could detect unauthorized operating system modifications.M1004System Partition IntegrityAndroid Verified Boot can detect unauthorized modifications made to the system partition, which could lead to execution flow hijacking.[4]DetectionIDData SourceData ComponentDetectsDS0013Sensor HealthHost StatusMobile threat defense agents could detect unauthorized operating system modifications by using attestation.ReferencesR. Unuchek. (2017, June 8). Dvmap: the first Android malware with code injection. Retrieved December 10, 2019.K. Lu. (n.d.). Deep Technical Analysis of the Spyware FlexiSpy for Android. Retrieved September 10, 2019.Siewierski, L. (2019, January 11). PHA Family Highlights: Zen and its cousins . Retrieved July 27, 2020.Android. (n.d.). Verified Boot. Retrieved December 21, 2016.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.