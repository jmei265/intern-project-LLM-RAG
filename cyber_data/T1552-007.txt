MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseUnsecured CredentialsContainer APIUnsecured Credentials:Container APIOther sub-techniques of Unsecured Credentials (8)IDNameT1552.001Credentials In FilesT1552.002Credentials in RegistryT1552.003Bash HistoryT1552.004Private KeysT1552.005Cloud Instance Metadata APIT1552.006Group Policy PreferencesT1552.007Container APIT1552.008Chat MessagesAdversaries may gather credentials via APIs within a containers environment. APIs in these environments, such as the Docker API and Kubernetes APIs, allow a user to remotely manage their container resources and cluster components.[1][2]An adversary may access the Docker API to collect logs that contain credentials to cloud, container, and various other resources in the environment.[3]An adversary with sufficient permissions, such as via a pod's service account, may also use the Kubernetes API to retrieve credentials from the Kubernetes API server. These credentials may include those needed for Docker API authentication or secrets from Kubernetes cluster components.ID:T1552.007Sub-technique of:T1552ⓘTactic:Credential AccessⓘPlatforms:ContainersContributors:Center for Threat-Informed Defense (CTID); Jay Chen, Palo Alto Networks; Yossi Weizman, Azure Defender Research TeamVersion:1.2Created:31 March 2021Last Modified:15 April 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0683PeiratesPeiratescan query the Kubernetes API for secrets.[4]MitigationsIDMitigationDescriptionM1035Limit Access to Resource Over NetworkLimit communications with the container service to managed and secured channels, such as local Unix sockets or remote access via SSH. Require secure port access to communicate with the APIs over TLS by disabling unauthenticated access to the Docker API and Kubernetes API Server.[5][6]In Kubernetes clusters deployed in cloud environments, use native cloud platform features to restrict the IP ranges that are permitted to access to API server.[7]Where possible, consider enabling just-in-time (JIT) access to the Kubernetes API to place additional restrictions on access.[8]M1030Network SegmentationDeny direct remote access to internal systems through the use of network proxies, gateways, and firewalls.M1026Privileged Account ManagementUse the principle of least privilege for privileged accounts such as the service account in Kubernetes. For example, if a pod is not required to access the Kubernetes API, consider disabling the service account altogether.[9]M1018User Account ManagementEnforce authentication and role-based access control on the container API to restrict users to the least privileges required.[10]When using Kubernetes, avoid giving users wildcard permissions or adding users to thesystem:mastersgroup, and useRoleBindingsrather thanClusterRoleBindingsto limit user privileges to specific namespaces.[11]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionEstablish centralized logging for the activity of container and Kubernetes cluster components. Monitor logs for actions that could be taken to gather credentials to container and cloud infrastructure, including the use of discovery API calls by new or unexpected users and APIs that access Docker logs.DS0002User AccountUser Account AuthenticationIt may be possible to detect adversary use of credentials they have obtained such as inValid Accounts.ReferencesDocker. (n.d.). Docker Engine API v1.41 Reference. Retrieved March 31, 2021.The Kubernetes Authors. (n.d.). The Kubernetes API. Retrieved March 29, 2021.Chen, J.. (2020, January 29). Attacker's Tactics and Techniques in Unsecured Docker Daemons Revealed. Retrieved March 31, 2021.InGuardians. (2022, January 5). Peirates GitHub. Retrieved February 8, 2022.Docker. (n.d.). Protect the Docker Daemon Socket. Retrieved March 29, 2021.The Kubernetes Authors. (n.d.). Controlling Access to The Kubernetes API. Retrieved March 29, 2021.Kubernetes. (n.d.). Overview of Cloud Native Security. Retrieved March 8, 2023.Microsoft. (2023, February 27). AKS-managed Azure Active Directory integration. Retrieved March 8, 2023.Kubernetes. (2022, February 26). Configure Service Accounts for Pods. Retrieved April 1, 2022.National Security Agency, Cybersecurity and Infrastructure Security Agency. (2022, March). Kubernetes Hardening Guide. Retrieved April 1, 2022.Kubernetes. (n.d.). Role Based Access Control Good Practices. Retrieved March 8, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.