MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseCommand and Scripting InterpreterCommand and Scripting InterpreterSub-techniques (10)IDNameT1059.001PowerShellT1059.002AppleScriptT1059.003Windows Command ShellT1059.004Unix ShellT1059.005Visual BasicT1059.006PythonT1059.007JavaScriptT1059.008Network Device CLIT1059.009Cloud APIT1059.010AutoHotKey & AutoITAdversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor ofUnix Shellwhile Windows installations include theWindows Command ShellandPowerShell.There are also cross-platform interpreters such asPython, as well as those commonly associated with client applications such asJavaScriptandVisual Basic.Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded inInitial Accesspayloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize variousRemote Servicesin order to achieve remote Execution.[1][2][3]ID:T1059Sub-techniques:T1059.001,T1059.002,T1059.003,T1059.004,T1059.005,T1059.006,T1059.007,T1059.008,T1059.009,T1059.010ⓘTactic:ExecutionⓘPlatforms:Azure AD, Google Workspace, IaaS, Linux, Network, Office 365, Windows, macOSⓘSupports Remote:YesVersion:2.4Created:31 May 2017Last Modified:27 March 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0073APT19APT19downloaded and launched code within a SCT file.[4]G0050APT32APT32has used COM scriptlets to download Cobalt Strike beacons.[5]G0067APT37APT37has used Ruby scripts to execute payloads.[6]G0087APT39APT39has utilized custom scripts to perform internal reconnaissance.[7][8]S0234BandookBandookcan support commands to execute Java-based payloads.[9]S0486BonadanBonadancan create bind and reverse shells on the infected system.[10]S0023CHOPSTICKCHOPSTICKis capable of performing remote command execution.[11][12]C0029Cutting EdgeDuringCutting Edge, threat actors used Perl scripts to enable the deployment of the THINSPOOL shell script dropper and for enumerating host data.[13][14]S0334DarkCometDarkCometcan execute various types of scripts on the victim’s machine.[15]S0695DonutDonutcan generate shellcode outputs that execute via Ruby.[16]G0035DragonflyDragonflyhas used the command line for execution.[17]S0363EmpireEmpireuses a command-line interface to interact with systems.[18]G0053FIN5FIN5scans processes on all victim systems in the environment and uses automated scripts to pull back the results.[19]G0037FIN6FIN6has used scripting to iterate through a list of compromised PoS systems, copy data to a log file, and remove the original data files.[20][21]G0046FIN7FIN7used SQL scripts to help perform tasks on the victim's machine.[22][23][22]S0618FIVEHANDSFIVEHANDScan receive a command line argument to limit file encryption to specified directories.[24][25]G0117Fox KittenFox Kittenhas used a Perl reverse shell to communicate with C2.[26]S0460Get2Get2has the ability to run executables with command-line arguments.[27]S0032gh0st RATgh0st RATis able to open a remote shell to execute commands.[28][29]S0434Imminent MonitorImminent Monitorhas a CommandPromptPacket and ScriptPacket module(s) for creating a remote shell and executing scripts.[30]G0004Ke3changMalware used byKe3changcan run commands on the command-line interface.[31][32]S0487KesselKesselcan create a reverse shell between the infected host and a specified system.[10]S0167MatryoshkaMatryoshkais capable of providing Meterpreter shell access.[33]G0049OilRigOilRighas used various types of scripting for execution.[34][35][36][37][38]C0005Operation SpalaxForOperation Spalax, the threat actors used Nullsoft Scriptable Install System (NSIS) scripts to install malware.[39]S0598P.A.S. WebshellP.A.S. Webshellhas the ability to create reverse shells with Perl scripts.[40]S0428PoetRATPoetRAThas executed a Lua script through a Lua interpreter for Windows.[41]S1110SLIGHTPULSESLIGHTPULSEcontains functionality to execute arbitrary commands passed to it.[42]S0374SpeakUpSpeakUpuses Perl scripts.[43]G0038Stealth FalconStealth Falconmalware uses WMI to script data collection and command execution on the victim.[44]G0107WhiteflyWhiteflyhas used a simple remote shell tool that will call back to the C2 server and wait for commands.[45]G0124WindigoWindigohas used a Perl script for information gathering.[10]S0219WINERACKWINERACKcan create a reverse shell that utilizes statically-linked Wine cmd.exe code to emulate Windows command prompt commands.[46]S0330Zeus PandaZeus Pandacan launch remote scripts on the victim’s machine.[47]MitigationsIDMitigationDescriptionM1049Antivirus/AntimalwareAnti-virus can be used to automatically quarantine suspicious files.M1040Behavior Prevention on EndpointOn Windows 10, enable Attack Surface Reduction (ASR) rules to preventVisual BasicandJavaScriptscripts from executing potentially malicious downloaded content[48].M1045Code SigningWhere possible, only permit execution of signed scripts.M1042Disable or Remove Feature or ProgramDisable or remove any unnecessary or unused shells or interpreters.M1038Execution PreventionUse application control where appropriate. For example, PowerShell Constrained Language mode can be used to restrict access to sensitive or otherwise dangerous language elements such as those used to execute arbitrary Windows APIs or files (e.g.,Add-Type).[49]M1026Privileged Account ManagementWhen PowerShell is necessary, consider restricting PowerShell execution policy to administrators. Be aware that there are methods of bypassing the PowerShell execution policy, depending on environment configuration.[50]PowerShell JEA (Just Enough Administration) may also be used to sandbox administration and limit what commands admins/users can execute through remote PowerShell sessions.[51]M1021Restrict Web-Based ContentScript blocking extensions can help prevent the execution of scripts and HTA files that may commonly be used during the exploitation process. For malicious code served up through ads, adblockers can help prevent that code from executing in the first place.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor command-line arguments for script execution and subsequent behavior. Actions may be related to network and system information Discovery, Collection, or other scriptable post-compromise behaviors and could be used as indicators of detection leading back to the source script. Scripts are likely to perform actions with various effects on a system that may generate events, depending on the types of monitoring used.DS0011ModuleModule LoadMonitor for events associated with scripting execution, such as the loading of modules associated with scripting languages (ex: JScript.dll or vbscript.dll).DS0009ProcessProcess CreationMonitor log files for process execution through command-line and scripting activities. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools. Also monitor for loading of modules associated with specific languages.Process MetadataMonitor contextual data about a running process, which may include information such as environment variables, image name, user/owner, or other information that may reveal abuse of system features. For example, consider monitoring for Windows Event ID (EID) 400, which shows the version of PowerShell executing in theEngineVersionfield (which may also be relevant to detecting a potentialDowngrade Attack) as well as if PowerShell is running locally or remotely in theHostNamefield. Furthermore, EID 400 may indicate the start time and EID 403 indicates the end time of a PowerShell session.[52]DS0012ScriptScript ExecutionMonitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.ReferencesMicrosoft. (2020, August 21). Running Remote Commands. Retrieved July 26, 2021.Cisco. (n.d.). Cisco IOS Software Integrity Assurance - Command History. Retrieved October 21, 2020.Abdou Rockikz. (2020, July). How to Execute Shell Commands in a Remote Machine in Python. Retrieved July 26, 2021.Ahl, I. (2017, June 06). Privileges and Credentials: Phished at the Request of Counsel. Retrieved May 17, 2018.Dahan, A. (2017). Operation Cobalt Kitty. Retrieved December 27, 2018.Cash, D., Grunzweig, J., Adair, S., Lancaster, T. (2021, August 25). North Korean BLUELIGHT Special: InkySquid Deploys RokRAT. Retrieved October 1, 2021.Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019.FBI. (2020, September 17). Indicators of Compromise Associated with Rana Intelligence Computing, also known as Advanced Persistent Threat 39, Chafer, Cadelspy, Remexi, and ITG07. Retrieved December 10, 2020.Check Point. (2020, November 26). Bandook: Signed & Delivered. Retrieved May 31, 2021.Dumont, R., M.Léveillé, M., Porcher, H. (2018, December 1). THE DARK SIDE OF THE FORSSHE A landscape of OpenSSH backdoors. Retrieved July 16, 2020.Alperovitch, D.. (2016, June 15). Bears in the Midst: Intrusion into the Democratic National Committee. Retrieved August 3, 2016.ESET. (2016, October). En Route with Sednit - Part 2: Observing the Comings and Goings. Retrieved November 21, 2016.Lin, M. et al. (2024, January 31). Cutting Edge, Part 2: Investigating Ivanti Connect Secure VPN Zero-Day Exploitation. Retrieved February 27, 2024.McLellan, T. et al. (2024, January 12). Cutting Edge: Suspected APT Targets Ivanti Connect Secure VPN in New Zero-Day Exploitation. Retrieved February 27, 2024.Kujawa, A. (2018, March 27). You dirty RAT! Part 1: DarkComet. Retrieved November 6, 2018.TheWover. (2019, May 9). donut. Retrieved March 25, 2022.US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.Bromiley, M. and Lewis, P. (2016, October 7). Attacking the Hospitality and Gaming Industries: Tracking an Attacker Around the World in 7 Years. Retrieved October 6, 2017.FireEye Threat Intelligence. (2016, April). Follow the Money: Dissecting the Operations of the Cyber Crime Group FIN6. Retrieved June 1, 2016.McKeague, B. et al. (2019, April 5). Pick-Six: Intercepting a FIN6 Intrusion, an Actor Recently Tied to Ryuk and LockerGoga Ransomware. Retrieved April 17, 2019.Carr, N., et al. (2018, August 01). On the Hunt for FIN7: Pursuing an Enigmatic and Evasive Global Criminal Operation. Retrieved August 23, 2018.Platt, J. and Reeves, J.. (2019, March). FIN7 Revisited: Inside Astra Panel and SQLRat Malware. Retrieved June 18, 2019.McLellan, T.  and Moore, J. et al. (2021, April 29). UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial Threat. Retrieved June 2, 2021.Matthews, M. and Backhouse, W. (2021, June 15). Handy guide to a new Fivehands ransomware variant. Retrieved June 24, 2021.ClearSky. (2020, December 17). Pay2Key Ransomware – A New Campaign by Fox Kitten. Retrieved December 21, 2020.Schwarz, D. et al. (2019, October 16). TA505 Distributes New SDBbot Remote Access Trojan with Get2 Downloader. Retrieved May 29, 2020.FireEye Threat Intelligence. (2015, July 13). Demonstrating Hustle, Chinese APT Groups Quickly Use Zero-Day Vulnerability (CVE-2015-5119) Following Hacking Team Leak. Retrieved January 25, 2016.Pantazopoulos, N. (2018, April 17). Decoding network data from a Gh0st RAT variant. Retrieved November 2, 2018.QiAnXin Threat Intelligence Center. (2019, February 18). APT-C-36: Continuous Attacks Targeting Colombian Government Institutions and Corporations. Retrieved May 5, 2020.Villeneuve, N., Bennett, J. T., Moran, N., Haq, T., Scott, M., & Geers, K. (2014). OPERATION “KE3CHANG”: Targeted Attacks Against Ministries of Foreign Affairs. Retrieved November 12, 2014.Smallridge, R. (2018, March 10). APT15 is alive and strong: An analysis of RoyalCli and RoyalDNS. Retrieved April 4, 2018.ClearSky Cyber Security and Trend Micro. (2017, July). Operation Wilted Tulip: Exposing a cyber espionage apparatus. Retrieved August 21, 2017.Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.Falcone, R. and Lee, B. (2017, July 27). OilRig Uses ISMDoor Variant; Possibly Linked to Greenbug Threat Group. Retrieved January 8, 2018.Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.Falcone, R., Wilhoit, K.. (2018, November 16). Analyzing OilRig’s Ops Tempo from Testing to Weaponization to Delivery. Retrieved April 23, 2019.M. Porolli. (2021, January 21). Operation Spalax: Targeted malware attacks in Colombia. Retrieved September 16, 2022.ANSSI. (2021, January 27). SANDWORM INTRUSION SET CAMPAIGN TARGETING CENTREON SYSTEMS. Retrieved March 30, 2021.Mercer, W. Rascagneres, P. Ventura, V. (2020, October 6). PoetRAT: Malware targeting public and private sector in Azerbaijan evolves . Retrieved April 9, 2021.Perez, D. et al. (2021, April 20). Check Your Pulse: Suspected APT Actors Leverage Authentication Bypass Techniques and Pulse Secure Zero-Day. Retrieved February 5, 2024.Check Point Research. (2019, February 4). SpeakUp: A New Undetected Backdoor Linux Trojan. Retrieved April 17, 2019.Marczak, B. and Scott-Railton, J.. (2016, May 29). Keep Calm and (Don’t) Enable Macros: A New Threat Actor Targets UAE Dissidents. Retrieved June 8, 2016.Symantec. (2019, March 6). Whitefly: Espionage Group has Singapore in Its Sights. Retrieved May 26, 2020.FireEye. (2018, February 20). APT37 (Reaper): The Overlooked North Korean Actor. Retrieved March 1, 2018.Ebach, L. (2017, June 22). Analysis Results of Zeus.Variant.Panda. Retrieved November 5, 2018.Microsoft. (2021, July 2). Use attack surface reduction rules to prevent malware infection. Retrieved June 24, 2021.PowerShell Team. (2017, November 2). PowerShell Constrained Language Mode. Retrieved March 27, 2023.Sutherland, S. (2014, September 9). 15 Ways to Bypass the PowerShell Execution Policy. Retrieved July 23, 2015.Microsoft. (2022, November 17). Just Enough Administration. Retrieved March 27, 2023.Hastings, M. (2014, July 16). Investigating PowerShell Attacks. Retrieved December 1, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.