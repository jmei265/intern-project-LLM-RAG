MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseIndicator RemovalClear Windows Event LogsIndicator Removal:Clear Windows Event LogsOther sub-techniques of Indicator Removal (9)IDNameT1070.001Clear Windows Event LogsT1070.002Clear Linux or Mac System LogsT1070.003Clear Command HistoryT1070.004File DeletionT1070.005Network Share Connection RemovalT1070.006TimestompT1070.007Clear Network Connection History and ConfigurationsT1070.008Clear Mailbox DataT1070.009Clear PersistenceAdversaries may clear Windows Event Logs to hide the activity of an intrusion. Windows Event Logs are a record of a computer's alerts and notifications. There are three system-defined sources of events: System, Application, and Security, with five event types: Error, Warning, Information, Success Audit, and Failure Audit.With administrator privileges, the event logs can be cleared with the following utility commands:wevtutil cl systemwevtutil cl applicationwevtutil cl securityThese logs may also be cleared through other mechanisms, such as the event viewer GUI orPowerShell. For example, adversaries may use the PowerShell commandRemove-EventLog -LogName Securityto delete the Security EventLog and after reboot, disable future logging.  Note: events may still be generated and logged in the .evtx file between the time the command is run and the reboot.[1]Adversaries may also attempt to clear logs by directly deleting the stored log files withinC:\Windows\System32\winevt\logs\.ID:T1070.001Sub-technique of:T1070ⓘTactic:Defense EvasionⓘPlatforms:WindowsⓘDefense Bypassed:Anti Virus, Host Intrusion Prevention Systems, Log AnalysisContributors:Lucas HeiligensteinVersion:1.4Created:28 January 2020Last Modified:16 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0007APT28APT28has cleared event logs, including by using the commandswevtutil cl Systemandwevtutil cl Security.[2][3]G0050APT32APT32has cleared select event log entries.[4]G0082APT38APT38clears Window Event logs and Sysmon logs from the system.[5]G0096APT41APT41attempted to remove evidence of some of its activity by clearing Windows security and system events.[6]S1068BlackCatBlackCatcan clear Windows event logs usingwevtutil.exe.[7]S0089BlackEnergyTheBlackEnergycomponent KillDisk is capable of deleting Windows Event Logs.[8]G0114ChimeraChimerahas cleared event logs on compromised hosts.[9]G0035DragonflyDragonflyhas cleared Windows event logs and other logs produced by tools they used, including system, security, terminal services, remote services, and audit logs. The actors also deleted specific Registry keys.[10]G0053FIN5FIN5has cleared event logs from victims.[11]G0061FIN8FIN8has cleared logs during post compromise cleanup activities.[12]S0182FinFisherFinFisherclears the system event logs usingOpenEventLog/ClearEventLog APIs.[13][14]S0032gh0st RATgh0st RATis able to wipe event logs.[15][16]S0697HermeticWiperHermeticWipercan overwrite theC:\Windows\System32\winevt\Logsfile on a targeted system.[17]S0698HermeticWizardHermeticWizardhas the ability to usewevtutil cl systemto clear event logs.[17]S0203HydraqHydraqcreates a backdoor through which remote attackers can clear all system event logs.[18][19]G0119Indrik SpiderIndrik Spiderhas usedCobalt Striketo empty log files.[20]S0607KillDiskKillDiskdeletes Application, Security, Setup, and System Windows Event Logs.[8]S0532LuciferLucifercan clear and remove event logs.[21]S1060MafaldaMafaldacan delete Windows Event logs by invoking theOpenEventLogWandClearEventLogWfunctions.[22]S0688MeteorMeteorcan useWevtutilto remove Security, System and Application Event Viewer logs.[23]S0368NotPetyaNotPetyauseswevtutilto clear the Windows event logs.[24][25]S0365Olympic DestroyerOlympic Destroyerwill attempt to clear the System and Security event logs usingwevtutil.[26]C0014Operation WocaoDuringOperation Wocao, the threat actors deleted all Windows system and security event logs using/Q /c wevtutil cl systemand/Q /c wevtutil cl security.[27]S0192PupyPupyhas a module to clear event logs with PowerShell.[28]S0253RunningRATRunningRATcontains code to clear event logs.[29]S0242SynAckSynAckclears event logs.[30]S0645WevtutilWevtutilcan be used to clear system and security event logs from the system.[31][2]S0412ZxShellZxShellhas a command to clear system event logs.[32]MitigationsIDMitigationDescriptionM1041Encrypt Sensitive InformationObfuscate/encrypt event files locally and in transit to avoid giving feedback to an adversary.M1029Remote Data StorageAutomatically forward events to a log server or data repository to prevent conditions in which the adversary can locate and manipulate data on the local system. When possible, minimize time delay on event reporting to avoid prolonged storage on the local system.M1022Restrict File and Directory PermissionsProtect generated event files that are stored locally with proper permissions and authentication and limit opportunities for adversaries to increase privileges by preventing Privilege Escalation opportunities.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments for actions that would delete Windows event logs (via PowerShell) such asRemove-EventLog -LogName Security.Note: Event ID 4104 (from the Microsoft-Windows-Powershell/Operational log) captures Powershell script blocks, which can be analyzed and used to detect on attempts to Clear Windows Event Logs. In particular, Powershell has a built-in Clear-EventLog cmdlet that allows for a specified log to be cleared.DS0022FileFile DeletionMonitor for unexpected deletion of Windows event logs (via native binaries) and may also generate an alterable event (Event ID 1102: "The audit log was cleared"). When an eventlog is cleared, a new event is created that alerts that the eventlog was cleared. For Security logs, its event code 1100 and 1102. For System logs, it is event code 104.It is unlikely that event log data would be cleared during normal operations, and it is likely that malicious attackers may try to cover their tracks by clearing an event log. When an event log gets cleared, it is suspicious.This is often done using wevtutil, a legitimate tool provided by Microsoft. This action interferes with event collection and notification, and may lead to a security event going undetected, thereby potentially leading to further compromise of the network.Alerting when a Clear Event Log is generated could point to this intruder technique. Centrally collecting events has the added benefit of making it much harder for attackers to cover their tracks. Event Forwarding permits sources to forward multiple copies of a collected event to multiple collectors, thus enabling redundant event collection. Using a redundant event collection model can minimize the single point of failure risk.Attackers may set the option of the sources of events withLimit-EventLog -LogName Security -OverflowAction DoNotOverwriteto not delete old Evenlog when the .evtx is full. By default the Security Log size is configured with the minimum value of 20 480KB (~23 000 EventLog). So if this option is enabled, all the new EventLogs will be automatically deleted. We can detect this behavior with the Security EventLog 1104.Attackers may delete .evtx withdel C:\Windows\System32\winevt\logs\Security.evtxorRemove-Item C:\Windows\System32\winevt\logs\Security.evtxafter having disabled and stopped the Eventlog service. As the EventLog service is disabled and stopped, the .evtx files are no longer used by this service and can be deleted. The new EventLog will be Unavailable until the configuration is reset.Attackers may use the powershell commandRemove-EventLog -LogName Securityto unregister source of events that are part of Windows (Application, Security…). This command deletes the security EventLog (which also generates EventId 1102) but the new Eventlogs are still recorded until the system is rebooted . After the System is rebooted, the Security log is unregistered and doesn’t log any new Eventlog. However logs generated between the command and the reboot are still available in the .evtx file.Analytic 1 - User Activity from Clearing Event Logs(source="WinEventLog:Security" EventCode IN (1100, 1102, 1104)) OR (source="WinEventLog:System" EventCode IN (104))DS0009ProcessOS API ExecutionMonitor for Windows API calls that may clear Windows Event Logs to hide the activity of an intrusion.Process CreationMonitor for newly executed processes that may clear Windows Event Logs to hide the activity of an intrusion. In an attempt to clear traces after compromising a machine, threat actors often try to clear Windows Event logs. This is often done using "wevtutil", a legitimate tool provided by Microsoft. This action interferes with event collection and notification, and may lead to a security event going undetected, thereby potentially leading to further compromise of the network.Note: This search query looks for wevtutil, Clear-EventLog, Limit-EventLog, Remove-Item or Remove-EventLog inside a command that may cause the system to remove Windows Event logs.Analytic 1 - Clearing Windows Logs with Wevtutil(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") (Image=wevtutilCommandLine=cl(CommandLine=SystemOR CommandLine=SecurityOR CommandLine=SetupOR CommandLine=Application) OR Clear-EventLog OR Limit-EventLog OR (Remove-Item AND .evtx) OR Remove-EventLog)ReferencesHeiligenstein, L. (n.d.). REP-25: Disable Windows Event Logging. Retrieved April 7, 2022.Alperovitch, D.. (2016, June 15). Bears in the Midst: Intrusion into the Democratic National Committee. Retrieved August 3, 2016.Mueller, R. (2018, July 13). Indictment - United States of America vs. VIKTOR BORISOVICH NETYKSHO, et al. Retrieved September 13, 2018.Carr, N.. (2017, May 14). Cyber Espionage is Alive and Well: APT32 and the Threat to Global Corporations. Retrieved June 18, 2017.FireEye. (2018, October 03). APT38: Un-usual Suspects. Retrieved November 6, 2018.Fraser, N., et al. (2019, August 7). Double DragonAPT41, a dual espionage and cyber crime operation APT41. Retrieved September 23, 2019.Microsoft Defender Threat Intelligence. (2022, June 13). The many lives of BlackCat ransomware. Retrieved December 20, 2022.Cherepanov, A.. (2016, January 3). BlackEnergy by the SSHBearDoor: attacks against Ukrainian news media and electric industry. Retrieved May 18, 2016.Jansen, W . (2021, January 12). Abusing cloud services to fly under the radar. Retrieved January 19, 2021.US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.Bromiley, M. and Lewis, P. (2016, October 7). Attacking the Hospitality and Gaming Industries: Tracking an Attacker Around the World in 7 Years. Retrieved October 6, 2017.Elovitz, S. & Ahl, I. (2016, August 18). Know Your Enemy:  New Financially-Motivated & Spear-Phishing Group. Retrieved February 26, 2018.FinFisher. (n.d.). Retrieved December 20, 2017.Allievi, A.,Flori, E. (2018, March 01). FinFisher exposed: A researcher’s tale of defeating traps, tricks, and complex virtual machines. Retrieved July 9, 2018.FireEye Threat Intelligence. (2015, July 13). Demonstrating Hustle, Chinese APT Groups Quickly Use Zero-Day Vulnerability (CVE-2015-5119) Following Hacking Team Leak. Retrieved January 25, 2016.Quinn, J. (2019, March 25). The odd case of a Gh0stRAT variant. Retrieved July 15, 2020.ESET. (2022, March 1). IsaacWiper and HermeticWizard: New wiper and worm targetingUkraine. Retrieved April 10, 2022.Symantec Security Response. (2010, January 18). The Trojan.Hydraq Incident. Retrieved February 20, 2018.Lelli, A. (2010, January 11). Trojan.Hydraq. Retrieved February 20, 2018.Symantec Threat Intelligence. (2020, June 25). WastedLocker: Symantec Identifies Wave of Attacks Against U.S. Organizations. Retrieved May 20, 2021.Hsu, K. et al. (2020, June 24). Lucifer: New Cryptojacking and DDoS Hybrid Malware Exploiting High and Critical Vulnerabilities to Infect Windows Devices. Retrieved November 16, 2020.Ehrlich, A., et al. (2022, September). THE MYSTERY OF METADOR | AN UNATTRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES. Retrieved January 23, 2023.Check Point Research Team. (2021, August 14). Indra - Hackers Behind Recent Attacks on Iran. Retrieved February 17, 2022.Chiu, A. (2016, June 27). New Ransomware Variant "Nyetya" Compromises Systems Worldwide. Retrieved March 26, 2019.Scott W. Brady. (2020, October 15). United States vs. Yuriy Sergeyevich Andrienko et al.. Retrieved November 25, 2020.Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer Takes Aim At Winter Olympics. Retrieved March 14, 2019.Dantzig, M. v., Schamper, E. (2019, December 19). Operation Wocao: Shining a light on one of China’s hidden hacking groups. Retrieved October 8, 2020.Nicolas Verdier. (n.d.). Retrieved January 29, 2018.Sherstobitoff, R., Saavedra-Morales, J. (2018, February 02). Gold Dragon Widens Olympics Malware Attacks, Gains Permanent Presence on Victims’ Systems. Retrieved June 6, 2018.Ivanov, A. et al. (2018, May 7). SynAck targeted ransomware uses the Doppelgänging technique. Retrieved May 22, 2018.Microsoft. (n.d.). wevtutil. Retrieved September 14, 2021.Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.