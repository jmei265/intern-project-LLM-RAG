MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseProxyMulti-hop ProxyProxy:Multi-hop ProxyOther sub-techniques of Proxy (4)IDNameT1090.001Internal ProxyT1090.002External ProxyT1090.003Multi-hop ProxyT1090.004Domain FrontingAdversaries may chain together multiple proxies to disguise the source of malicious traffic. Typically, a defender will be able to identify the last proxy traffic traversed before it enters their network; the defender may or may not be able to identify any previous proxies before the last-hop proxy. This technique makes identifying the original source of the malicious traffic even more difficult by requiring the defender to trace malicious traffic through several proxies to identify its source.For example, adversaries may construct or use onion routing networks – such as the publicly availableTornetwork – to transport encrypted C2 traffic through a compromised population, allowing communication with any device within the network.[1]In the case of network infrastructure, it is possible for an adversary to leverage multiple compromised devices to create a multi-hop proxy chain (i.e.,Network Devices). By leveragingPatch System Imageon routers, adversaries can add custom code to the affected network devices that will implement onion routing between those nodes. This method is dependent upon theNetwork Boundary Bridgingmethod allowing the adversaries to cross the protected network boundary of the Internet perimeter and into the organization’s Wide-Area Network (WAN).  Protocols such as ICMP may be used as a transport.Similarly, adversaries may abuse peer-to-peer (P2P) and blockchain-oriented infrastructure to implement routing between a decentralized network of peers.[2]ID:T1090.003Sub-technique of:T1090ⓘTactic:Command and ControlⓘPlatforms:Linux, Network, Windows, macOSContributors:Eduardo Chavarro OvalleVersion:2.1Created:14 March 2020Last Modified:19 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0007APT28APT28has routed traffic overTorand VPN servers to obfuscate their activities.[3]G0016APT29A backdoor used byAPT29created aTorhidden service to forward traffic from theTorclient to local ports 3389 (RDP), 139 (Netbios), and 445 (SMB) enabling full remote access from outside the network and has also used TOR.[4][5]S0438AttorAttorhas usedTorfor C2 communication.[6]C0004CostaRictoDuringCostaRicto, the threat actors used a layer of proxies to manage C2 communications.[7]S0687Cyclops BlinkCyclops Blinkhas usedTornodes for C2 traffic.[8]S0281DokDokdownloads and installsTorvia homebrew.[9]S0384DridexDridexcan use multiple layers of proxy servers to hide terminal nodes in its infrastructure.[10]G0085FIN4FIN4has usedTorto log in to victims' email accounts.[11]S0342GreyEnergyGreyEnergyhas usedTorrelays for Command and Control servers.[12]G0100InceptionInceptionused chains of compromised routers to proxy C2 communications between them and cloud service providers.[13]S0604IndustroyerIndustroyerusedTornodes for C2.[14]S0276KeydnapKeydnapuses a copy of tor2web proxy for HTTPS communications.[15]S0641KobalosKobaloscan chain together multiple compromised machines as proxies to reach their final targets.[16][17]G0065LeviathanLeviathanhas used multi-hop proxies to disguise the source of their malicious traffic.[18]S0282MacSpyMacSpyusesTorfor command and control.[9]S1106NGLiteNGLitehas abused NKN infrastructure for its C2 communication.[2]S1100NinjaNinjahas the ability to use a proxy chain with up to 255 hops when using TCP.[19]S1107NKAbuseNKAbusehas abused the NKN public blockchain protocol for its C2 communications.[20][21]C0014Operation WocaoDuringOperation Wocao, threat actors executed commands through the installed web shell viaTorexit nodes.[22]S0623SiloscapeSiloscapeusesTorto communicate with C2.[23]S0491StrongPityStrongPitycan use multiple layers of proxy servers to hide terminal nodes in its infrastructure.[24]S0183TorTraffic traversing theTornetwork will be forwarded to multiple nodes before exiting theTornetwork and continuing on to its intended destination.[25]S0022UroburosUroburoscan use implants on multiple compromised machines to proxy communications through its worldwide P2P network.[26]S0386UrsnifUrsnifhas usedTorfor C2.[27][28]S0366WannaCryWannaCryusesTorfor command and control traffic.[29]MitigationsIDMitigationDescriptionM1037Filter Network TrafficTraffic to known anonymity networks and C2 infrastructure can be blocked through the use of network allow and block lists. It should be noted that this kind of blocking may be circumvented by other techniques likeDomain Fronting.DetectionIDData SourceData ComponentDetectsDS0029Network TrafficNetwork Connection CreationMonitor for newly constructed network connections that are sent or received by untrusted hosts.Network Traffic ContentMonitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).Network Traffic FlowMonitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.ReferencesWikipedia. (n.d.). Onion Routing. Retrieved October 20, 2020.Robert Falcone, Jeff White, and Peter Renals. (2021, November 7). Targeted Attack Campaign Against ManageEngine ADSelfService Plus Delivers Godzilla Webshells, NGLite Trojan and KdcSponge Stealer. Retrieved February 8, 2024.Hacquebord, F., Remorin, L. (2020, December 17). Pawn Storm’s Lack of Sophistication as a Strategy. Retrieved January 13, 2021.Dunwoody, M. and Carr, N.. (2016, September 27). No Easy Breach DerbyCon 2016. Retrieved October 4, 2016.Microsoft Threat Intelligence Center. (2021, October 25). NOBELIUM targeting delegated administrative privileges to facilitate broader attacks. Retrieved March 25, 2022.Hromcova, Z. (2019, October). AT COMMANDS, TOR-BASED COMMUNICATIONS: MEET ATTOR, A FANTASY CREATURE AND ALSO A SPY PLATFORM. Retrieved May 6, 2020.The BlackBerry Research and Intelligence Team. (2020, November 12). The CostaRicto Campaign: Cyber-Espionage Outsourced. Retrieved May 24, 2021.NCSC, CISA, FBI, NSA. (2022, February 23). New Sandworm malware Cyclops Blink replaces VPNFilter. Retrieved March 3, 2022.Patrick Wardle. (n.d.). Mac Malware of 2017. Retrieved September 21, 2018.Check Point Research. (2021, January 4). Stopping Serial Killer: Catching the Next Strike. Retrieved September 7, 2021.Vengerik, B. et al.. (2014, December 5). Hacking the Street? FIN4 Likely Playing the Market. Retrieved December 17, 2018.Cherepanov, A. (2018, October). GREYENERGY A successor to BlackEnergy. Retrieved November 15, 2018.Symantec. (2018, March 14). Inception Framework: Alive and Well, and Hiding Behind Proxies. Retrieved May 8, 2020.Dragos Inc.. (2017, June 13). CRASHOVERRIDE Analysis of the Threat to Electric Grid Operations. Retrieved December 18, 2020.Patrick Wardle. (2017, January 1). Mac Malware of 2016. Retrieved September 21, 2018.M.Leveille, M., Sanmillan, I. (2021, February 2). Kobalos – A complex Linux threat to high performance computing infrastructure. Retrieved August 24, 2021.M.Leveille, M., Sanmillan, I. (2021, January). A WILD KOBALOS APPEARS Tricksy Linux malware goes after HPCs. Retrieved August 24, 2021.CISA. (2021, July 19). (AA21-200A) Joint Cybersecurity Advisory – Tactics, Techniques, and Procedures of Indicted APT40 Actors Associated with China’s MSS Hainan State Security Department. Retrieved August 12, 2021.Dedola, G. (2022, June 21). APT ToddyCat. Retrieved January 3, 2024.Bill Toulas. (2023, December 14). New NKAbuse malware abuses NKN blockchain for stealthy comms. Retrieved February 8, 2024.KASPERSKY GERT. (2023, December 14). Unveiling NKAbuse: a new multiplatform threat abusing the NKN protocol. Retrieved February 8, 2024.Dantzig, M. v., Schamper, E. (2019, December 19). Operation Wocao: Shining a light on one of China’s hidden hacking groups. Retrieved October 8, 2020.Prizmant, D. (2021, June 7). Siloscape: First Known Malware Targeting Windows Containers to Compromise Cloud Environments. Retrieved June 9, 2021.Tudorica, R. et al. (2020, June 30). StrongPity APT - Revealing Trojanized Tools, Working Hours and Infrastructure. Retrieved July 20, 2020.Roger Dingledine, Nick Mathewson and Paul Syverson. (2004). Tor: The Second-Generation Onion Router. Retrieved December 21, 2017.FBI et al. (2023, May 9). Hunting Russian Intelligence “Snake” Malware. Retrieved June 8, 2023.NJCCIC. (2016, September 27). Ursnif. Retrieved June 4, 2019.Proofpoint Staff. (2016, August 25). Nightmare on Tor Street: Ursnif variant Dreambot adds Tor functionality. Retrieved June 5, 2019.Counter Threat Unit Research Team. (2017, May 18). WCry Ransomware Analysis. Retrieved March 26, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.