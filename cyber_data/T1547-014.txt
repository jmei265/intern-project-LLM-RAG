MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseBoot or Logon Autostart ExecutionActive SetupBoot or Logon Autostart Execution:Active SetupOther sub-techniques of Boot or Logon Autostart Execution (14)IDNameT1547.001Registry Run Keys / Startup FolderT1547.002Authentication PackageT1547.003Time ProvidersT1547.004Winlogon Helper DLLT1547.005Security Support ProviderT1547.006Kernel Modules and ExtensionsT1547.007Re-opened ApplicationsT1547.008LSASS DriverT1547.009Shortcut ModificationT1547.010Port MonitorsT1547.012Print ProcessorsT1547.013XDG Autostart EntriesT1547.014Active SetupT1547.015Login ItemsAdversaries may achieve persistence by adding a Registry key to the Active Setup of the local machine. Active Setup is a Windows mechanism that is used to execute programs when a user logs in. The value stored in the Registry key will be executed after a user logs into the computer.[1]These programs will be executed under the context of the user and will have the account's associated permissions level.Adversaries may abuse Active Setup by creating a key underHKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\and setting a malicious value forStubPath. This value will serve as the program that will be executed when a user logs into the computer.[2][3][4][5][6]Adversaries can abuse these components to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also useMasqueradingto make the Registry entries look as if they are associated with legitimate programs.ID:T1547.014Sub-technique of:T1547ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:WindowsⓘPermissions Required:AdministratorContributors:Bencherchali Nasreddine, @nas_bench, ELIT Security Team (DSSD)Version:1.0Created:18 December 2020Last Modified:22 March 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0012PoisonIvyPoisonIvycreates a Registry key in the Active Setup pointing to a malicious executable.[7][6][8]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may achieve persistence by adding a Registry key to the Active Setup of the local machine.DS0009ProcessProcess CreationMonitor newly executed processes that may achieve persistence by adding a Registry key to the Active Setup of the local machine.DS0024Windows RegistryWindows Registry Key CreationMonitor Registry key additions toHKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Active Setup\Installed Components\.Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the Active Setup Registry locations and startup folders.[9]Suspicious program execution as startup programs may show up as outlier processes that have not been seen before when compared against historical data.Windows Registry Key ModificationMonitor Registry key modifications toHKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Active Setup\Installed Components\.Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the Active Setup Registry locations and startup folders.[9]Suspicious program execution as startup programs may show up as outlier processes that have not been seen before when compared against historical data.ReferencesKlein, H. (2010, April 22). Active Setup Explained. Retrieved December 18, 2020.Glyer, C. (2010). Examples of Recent APT Persistence Mechanism. Retrieved December 18, 2020.Scott-Railton, J., et al. (2015, December 8). Packrat. Retrieved December 18, 2020.Kindlund, D. (2012, December 30). CFR Watering Hole Attack Details. Retrieved December 18, 2020.Baumgartner, K., Guerrero-Saade, J. (2015, March 4). Who’s Really Spreading through the Bright Star?. Retrieved December 18, 2020.Ray, V., et al. (2016, November 22). Tropic Trooper Targets Taiwanese Government and Fossil Fuel Provider With Poison Ivy. Retrieved December 18, 2020.McCormack, M. (2017, September 15). Backdoor:Win32/Poisonivy.E. Retrieved December 21, 2020.Anubhav, A., Kizhakkinan, D. (2017, February 22). Spear Phishing Techniques Used in Attacks Targeting the Mongolian Government. Retrieved February 24, 2017.Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.