MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseSteal or Forge Kerberos TicketsKerberoastingSteal or Forge Kerberos Tickets:KerberoastingOther sub-techniques of Steal or Forge Kerberos Tickets (4)IDNameT1558.001Golden TicketT1558.002Silver TicketT1558.003KerberoastingT1558.004AS-REP RoastingAdversaries may abuse a valid Kerberos ticket-granting ticket (TGT) or sniff network traffic to obtain a ticket-granting service (TGS) ticket that may be vulnerable toBrute Force.[1][2]Service principal names (SPNs) are used to uniquely identify each instance of a Windows service. To enable authentication, Kerberos requires that SPNs be associated with at least one service logon account (an account specifically tasked with running a service[3]).[4][5][6][7]Adversaries possessing a valid Kerberos ticket-granting ticket (TGT) may request one or more Kerberos ticket-granting service (TGS) service tickets for any SPN from a domain controller (DC).[1][2]Portions of these tickets may be encrypted with the RC4 algorithm, meaning the Kerberos 5 TGS-REP etype 23 hash of the service account associated with the SPN is used as the private key and is thus vulnerable to offlineBrute Forceattacks that may expose plaintext credentials.[2][1][7]This same behavior could be executed using service tickets captured from network traffic.[2]Cracked hashes may enablePersistence,Privilege Escalation, andLateral Movementvia access toValid Accounts.[6]ID:T1558.003Sub-technique of:T1558ⓘTactic:Credential AccessⓘPlatforms:WindowsⓘSystem Requirements:Valid domain account or the ability to sniff traffic within a domainContributors:PraetorianVersion:1.2Created:11 February 2020Last Modified:30 March 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS1063Brute Ratel C4Brute Ratel C4can decode Kerberos 5 tickets and convert it to hashcat format for subsequent cracking.[8]S0363EmpireEmpireusesPowerSploit'sInvoke-Kerberoastto request service tickets and return crackable ticket hashes.[9]G0046FIN7FIN7has used Kerberoasting PowerShell commands such as,Invoke-Kerberoastfor credential access and to enable lateral movement.[10][11]S0357ImpacketImpacketmodules like GetUserSPNs can be used to get Service Principal Names (SPNs) for user accounts. The output is formatted to be compatible with cracking tools like John the Ripper and Hashcat.[12]C0014Operation WocaoDuringOperation Wocao, threat actors usedPowerSploit'sInvoke-Kerberoastmodule to request encrypted service tickets and bruteforce the passwords of Windows service accounts offline.[13]S0194PowerSploitPowerSploit'sInvoke-Kerberoastmodule can request service tickets and return crackable ticket hashes.[14][7]S1071RubeusRubeuscan use theKerberosRequestorSecurityToken.GetRequestmethod to request kerberoastable service tickets.[15]S0692SILENTTRINITYSILENTTRINITYcontains a module to conduct Kerberoasting.[16]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29obtained Ticket Granting Service (TGS) tickets for Active Directory Service Principle Names to crack offline.[17]G0102Wizard SpiderWizard Spiderhas used Rubeus, MimiKatz Kerberos module, and the Invoke-Kerberoast cmdlet to steal AES hashes.[18][19][20][21][22]MitigationsIDMitigationDescriptionM1041Encrypt Sensitive InformationEnable AES Kerberos encryption (or another stronger encryption algorithm), rather than RC4, where possible.[2]M1027Password PoliciesEnsure strong password length (ideally 25+ characters) and complexity for service accounts and that these passwords periodically expire.[2]Also consider using Group Managed Service Accounts or another third party product such as password vaulting.[2]M1026Privileged Account ManagementLimit service accounts to minimal required privileges, including membership in privileged groups such as Domain Administrators.[2]DetectionIDData SourceData ComponentDetectsDS0026Active DirectoryActive Directory Credential RequestMonitor for anomalous Kerberos activity, such as enabling Audit Kerberos Service Ticket Operations to log Kerberos TGS service ticket requests. Particularly investigate irregular patterns of activity (ex: accounts making numerous requests, Event ID 4769, within a small time frame, especially if they also request RC4 encryption [Type 0x17]).ReferencesEmpireProject. (2016, October 31). Invoke-Kerberoast.ps1. Retrieved March 22, 2018.Metcalf, S. (2015, December 31). Cracking Kerberos TGS Tickets Using Kerberoast – Exploiting Kerberos to Compromise the Active Directory Domain. Retrieved March 22, 2018.Bani, M. (2018, February 23). Detecting Kerberoasting activity using Azure Security Center. Retrieved March 23, 2018.Microsoft. (n.d.). Service Principal Names. Retrieved March 22, 2018.Microsoft. (2010, April 13). Service Principal Names (SPNs) SetSPN Syntax (Setspn.exe). Retrieved March 22, 2018.Medin, T. (2014, November). Attacking Kerberos - Kicking the Guard Dog of Hades. Retrieved March 22, 2018.Schroeder, W. (2016, November 1). Kerberoasting Without Mimikatz. Retrieved March 23, 2018.Harbison, M. and Renals, P. (2022, July 5). When Pentest Tools Go Brutal: Red-Teaming Tool Being Abused by Malicious Actors. Retrieved February 1, 2023.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.Loui, E. and Reynolds, J. (2021, August 30). CARBON SPIDER Embraces Big Game Hunting, Part 1. Retrieved September 20, 2021.Abdo, B., et al. (2022, April 4). FIN7 Power Hour: Adversary Archaeology and the Evolution of FIN7. Retrieved April 5, 2022.SecureAuth. (n.d.).  Retrieved January 15, 2019.Dantzig, M. v., Schamper, E. (2019, December 19). Operation Wocao: Shining a light on one of China’s hidden hacking groups. Retrieved October 8, 2020.Schroeder, W. & Hart M. (2016, October 31). Invoke-Kerberoast. Retrieved March 23, 2018.Harmj0y. (n.d.). Rubeus. Retrieved March 29, 2023.Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.MSTIC, CDOC, 365 Defender Research Team. (2021, January 20). Deep dive into the Solorigate second-stage activation: From SUNBURST to TEARDROP and Raindrop . Retrieved January 22, 2021.The DFIR Report. (2020, October 8). Ryuk’s Return. Retrieved October 9, 2020.Kimberly Goody, Jeremy Kennelly, Joshua Shilko, Steve Elovitz, Douglas Bienstock. (2020, October 28). Unhappy Hour Special: KEGTAP and SINGLEMALT With a Ransomware Chaser. Retrieved October 28, 2020.DHS/CISA. (2020, October 28). Ransomware Activity Targeting the Healthcare and Public Health Sector. Retrieved October 28, 2020.The DFIR Report. (2020, November 5). Ryuk Speed Run, 2 Hours to Ransom. Retrieved November 6, 2020.Shilko, J., et al. (2021, October 7). FIN12: The Prolific Ransomware Intrusion Threat Actor That Has Aggressively Pursued Healthcare Targets. Retrieved June 15, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.