MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseMasqueradingDouble File ExtensionMasquerading:Double File ExtensionOther sub-techniques of Masquerading (9)IDNameT1036.001Invalid Code SignatureT1036.002Right-to-Left OverrideT1036.003Rename System UtilitiesT1036.004Masquerade Task or ServiceT1036.005Match Legitimate Name or LocationT1036.006Space after FilenameT1036.007Double File ExtensionT1036.008Masquerade File TypeT1036.009Break Process TreesAdversaries may abuse a double extension in the filename as a means of masquerading the true file type. A file name may include a secondary file type extension that may cause only the first extension to be displayed (ex:File.txt.exemay render in some views as justFile.txt). However, the second extension is the true file type that determines how the file is opened and executed. The real file extension may be hidden by the operating system in the file browser (ex: explorer.exe), as well as in any software configured using or similar to the system’s policies.[1][2]Adversaries may abuse double extensions to attempt to conceal dangerous file types of payloads. A very common usage involves tricking a user into opening what they think is a benign file type but is actually executable code. Such files often pose as email attachments and allow an adversary to gainInitial Accessinto a user’s system viaSpearphishing AttachmentthenUser Execution. For example, an executable file attachment namedEvil.txt.exemay display asEvil.txtto a user. The user may then view it as a benign text file and open it, inadvertently executing the hidden malware.[2]Common file types, such as text files (.txt, .doc, etc.) and image files (.jpg, .gif, etc.) are typically used as the first extension to appear benign. Executable extensions commonly regarded as dangerous, such as .exe, .lnk, .hta, and .scr, often appear as the second extension and true file type.ID:T1036.007Sub-technique of:T1036ⓘTactic:Defense EvasionⓘPlatforms:WindowsVersion:1.0Created:04 August 2021Last Modified:14 October 2021Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0534BazarTheBazarloader has used dual-extension executable files such as PreviewReport.DOC.exe.[3]S1111DarkGateDarkGatemasquerades malicious LNK files as PDF objects using the double extension.pdf.lnk.[4]S1015MilanMilanhas used an executable namedcompanycatalog.exe.configto appear benign.[5]G0129Mustang PandaMustang Pandahas used an additional filename extension to hide the true file type.[6][7]MitigationsIDMitigationDescriptionM1028Operating System ConfigurationDisable the default to "hide file extensions for known file types" in Windows OS.[8][9]M1017User TrainingTrain users to look for double extensions in filenames, and in general use training as a way to bring awareness to common phishing and spearphishing techniques and how to raise suspicion for potentially malicious events.DetectionIDData SourceData ComponentDetectsDS0022FileFile CreationMonitor for files written to disk that contain two file extensions, particularly when the second is an executable.File MetadataMonitor for contextual data about a file, which may include information such as name, the content (ex: signature, headers, or data/media), user/owner, permissions, etc.ReferencesPCMag. (n.d.). Encyclopedia: double extension. Retrieved August 4, 2021.Eugene Tkachenko. (2020, May 1). Rule of the Week: Possible Malicious File Double Extension. Retrieved July 27, 2021.Cybereason Nocturnus. (2020, July 16). A BAZAR OF TRICKS: FOLLOWING TEAM9’S DEVELOPMENT CYCLES. Retrieved November 18, 2020.Ernesto Fernández Provecho, Pham Duy Phuc, Ciana Driscoll & Vinoo Thomas. (2023, November 21). The Continued Evolution of the DarkGate Malware-as-a-Service. Retrieved February 9, 2024.ClearSky Cyber Security . (2021, August). New Iranian Espionage Campaign By “Siamesekitten” - Lyceum. Retrieved June 6, 2022.Meyers, A. (2018, June 15). Meet CrowdStrike’s Adversary of the Month for June: MUSTANG PANDA. Retrieved April 12, 2021.Anomali Threat Research. (2019, October 7). China-Based APT Mustang Panda Targets Minority Groups, Public and Private Sector Organizations. Retrieved April 12, 2021.Seqrite. (n.d.). How to avoid dual attack and vulnerable files with double extension?. Retrieved July 27, 2021.Chris Hoffman. (2017, March 8). How to Make Windows Show File Extensions. Retrieved August 4, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.