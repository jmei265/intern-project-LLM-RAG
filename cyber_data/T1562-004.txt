MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseImpair DefensesDisable or Modify System FirewallImpair Defenses:Disable or Modify System FirewallOther sub-techniques of Impair Defenses (11)IDNameT1562.001Disable or Modify ToolsT1562.002Disable Windows Event LoggingT1562.003Impair Command History LoggingT1562.004Disable or Modify System FirewallT1562.006Indicator BlockingT1562.007Disable or Modify Cloud FirewallT1562.008Disable or Modify Cloud LogsT1562.009Safe Mode BootT1562.010Downgrade AttackT1562.011Spoof Security AlertingT1562.012Disable or Modify Linux Audit SystemAdversaries may disable or modify system firewalls in order to bypass controls limiting network usage. Changes could be disabling the entire mechanism as well as adding, deleting, or modifying particular rules. This can be done numerous ways depending on the operating system, including via command-line, editing Windows Registry keys, and Windows Control Panel.Modifying or disabling a system firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed. For example, adversaries may add a new firewall rule for a well-known protocol (such as RDP) using a non-traditional and potentially less securitized port (i.e.Non-Standard Port).[1]Adversaries may also modify host networking settings that indirectly manipulate system firewalls, such as interface bandwidth or network connection request thresholds.[2]Settings related to enabling abuse of variousRemote Servicesmay also indirectly modify firewall rules.ID:T1562.004Sub-technique of:T1562ⓘTactic:Defense EvasionⓘPlatforms:Linux, Network, Windows, macOSⓘDefense Bypassed:FirewallVersion:1.2Created:21 February 2020Last Modified:28 March 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0082APT38APT38have created firewall exemptions on specific ports, including ports 443, 6443, 8443, and 9443.[3]S0031BACKSPACEThe "ZR" variant ofBACKSPACEwill check to see if known host-based firewalls are installed on the infected systems.BACKSPACEwill attempt to establish a C2 channel, then will examine open windows to identify a pop-up from the firewall software and will simulate a mouse-click to allow the connection to proceed.[4]S0245BADCALLBADCALLdisables the Windows firewall before binding to a port.[5]G0008CarbanakCarbanakmay usenetshto add local firewall rule exceptions.[6]S0492CookieMinerCookieMinerhas checked for the presence of "Little Snitch", macOS network monitoring and application firewall software, stopping and exiting if it is found.[7]S0687Cyclops BlinkCyclops Blinkcan modify the Linux iptables firewall to enable C2 communication on network devices via a stored list of port numbers.[8][9]S0334DarkCometDarkCometcan disable Security Center functions like the Windows Firewall.[10][11]G0035DragonflyDragonflyhas disabled host-based firewalls. The group has also globally opened port 3389.[12]S0531GrandoreiroGrandoreirocan block the Deibold Warsaw GAS Tecnologia security tool at the firewall level.[13]S0132H1N1H1N1kills and disables services for Windows Firewall.[14]S0246HARDRAINHARDRAINopens the Windows Firewall to modify incoming connections.[15]S0376HOPLIGHTHOPLIGHThas modified the firewall usingnetsh.[16]S0260InvisiMoleInvisiMolehas a command to disable routing and the Firewall on the victim’s machine.[17]S0088KasidetKasidethas the ability to change firewall settings to allow a plug-in to be downloaded.[18]G0094KimsukyKimsukyhas been observed disabling the system firewall.[19]G0032Lazarus GroupVariousLazarus Groupmalware modifies the Windows firewall to allow incoming connections or disable it entirely usingnetsh.[20][21][22]G0059Magic HoundMagic Houndhas added the following rule to a victim's Windows firewall to allow RDP traffic -"netsh" advfirewall firewall add rule name="Terminal Server" dir=in action=allow protocol=TCP localport=3389.[23][24]G1009Moses StaffMoses Staffhas used batch scripts that can disable the Windows firewall on specific remote machines.[25]S0336NanoCoreNanoCorecan modify the victim's firewall.[26][27]S0108netshnetshcan be used to disable local firewall settings.[28][29]S0385njRATnjRAThas modified the Windows firewall to allow itself to communicate through the firewall.[30][31]C0014Operation WocaoDuringOperation Wocao, threat actors used PowerShell to add and delete rules in the Windows firewall.[32]S1032PyDCryptPyDCrypthas modified firewall rules to allow incoming SMB, NetBIOS, and RPC connections usingnetsh.exeon remote machines.[25]S0125RemsecRemseccan add or remove applications or ports on the Windows firewall or disable it entirely.[33]G0106RockeRockeused scripts which killed processes and added firewall rules to block traffic related to other cryptominers.[34]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29usednetshto configure firewall rules that limited certain UDP outbound packets.[35]G0139TeamTNTTeamTNThas disablediptables.[36]G1022ToddyCatPrior to executing a backdoorToddyCathas runcmd /c start /b netsh advfirewall firewall add rule name="SGAccessInboundRule" dir=in protocol=udp action=allow localport=49683to allow the targeted system to receive UDP packets on port 49683.[37]S0263TYPEFRAMETYPEFRAMEcan open the Windows Firewall on the victim’s machine to allow incoming connections.[38]S0412ZxShellZxShellcan disable the firewall by modifying the registry keyHKLM\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy\StandardProfile.[39]MitigationsIDMitigationDescriptionM1047AuditRoutinely check account role permissions to ensure only expected users and roles have permission to modify system firewalls.M1022Restrict File and Directory PermissionsEnsure proper process and file permissions are in place to prevent adversaries from disabling or modifying firewall settings.M1024Restrict Registry PermissionsEnsure proper Registry permissions are in place to prevent adversaries from disabling or modifying firewall settings.M1018User Account ManagementEnsure proper user permissions are in place to prevent adversaries from disabling or modifying firewall settings.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments associated with disabling or the modification of system firewalls such asnetsh advfirewall firewall set rule group="file and printer sharing" new enable=Yes,ufw disable, andufw logging off.DS0018FirewallFirewall DisableMonitor for changes in the status of the system firewall such as Windows Security Auditing events 5025 (The Windows firewall service has been stopped) and 5034 (The Windows firewall driver was stopped).Firewall Rule ModificationMonitor for changes made to firewall rules that might allow remote communication over protocols such as SMD and RDP. Modification of firewall rules might also consider opening local ports and services for different network profiles such as public and domain.DS0024Windows RegistryWindows Registry Key ModificationMonitor for changes made to windows Registry keys and/or values that adversaries might use to disable or modify System Firewall settings such asHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SharedAccess\Parameters\FirewallPolicy.ReferencesThe DFIR Report. (2022, March 1). "Change RDP port" #ContiLeaks. Retrieved March 1, 2022.Carvey, H. (2024, February 28). BlackCat Ransomware Affiliate TTPs. Retrieved March 27, 2024.DHS/CISA. (2020, August 26). FASTCash 2.0: North Korea's BeagleBoyz Robbing Banks. Retrieved September 29, 2021.FireEye Labs. (2015, April). APT30 AND THE MECHANICS OF A LONG-RUNNING CYBER ESPIONAGE OPERATION. Retrieved May 1, 2015.US-CERT. (2018, February 06). Malware Analysis Report (MAR) - 10135536-G. Retrieved June 7, 2018.Group-IB and Fox-IT. (2014, December). Anunak: APT against financial institutions. Retrieved April 20, 2016.Chen, y., et al. (2019, January 31). Mac Malware Steals Cryptocurrency Exchanges’ Cookies. Retrieved July 22, 2020.NCSC. (2022, February 23). Cyclops Blink Malware Analysis Report. Retrieved March 3, 2022.Haquebord, F. et al. (2022, March 17). Cyclops Blink Sets Sights on Asus Routers. Retrieved March 17, 2022.TrendMicro. (2014, September 03). DARKCOMET. Retrieved November 6, 2018.Kujawa, A. (2018, March 27). You dirty RAT! Part 1: DarkComet. Retrieved November 6, 2018.US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.ESET. (2020, April 28). Grandoreiro: How engorged can an EXE get?. Retrieved November 13, 2020.Reynolds, J.. (2016, September 14). H1N1: Technical analysis reveals new capabilities – part 2. Retrieved September 26, 2016.US-CERT. (2018, February 05). Malware Analysis Report (MAR) - 10135536-F. Retrieved June 11, 2018.US-CERT. (2019, April 10). MAR-10135536-8 – North Korean Trojan: HOPLIGHT. Retrieved April 19, 2019.Hromcová, Z. (2018, June 07). InvisiMole: Surprisingly equipped spyware, undercover since 2013. Retrieved July 10, 2018.Yadav, A., et al. (2016, January 29). Malicious Office files dropping Kasidet and Dridex. Retrieved March 24, 2016.Tarakanov , D.. (2013, September 11). The “Kimsuky” Operation: A North Korean APT?. Retrieved August 13, 2019.Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February 25, 2016.Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Loaders, Installers and Uninstallers Report. Retrieved March 2, 2016.Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Tools Report. Retrieved March 10, 2016.DFIR Report. (2022, March 21). APT35 Automates Initial Access Using ProxyShell. Retrieved May 25, 2022.DFIR Report. (2021, November 15). Exchange Exploit Leads to Domain Wide Ransomware. Retrieved January 5, 2023.Checkpoint Research. (2021, November 15). Uncovering MosesStaff techniques: Ideology over Money. Retrieved August 11, 2022.The DigiTrust Group. (2017, January 01). NanoCore Is Not Your Average RAT. Retrieved November 9, 2018.Kasza, A., Halfpop, T. (2016, February 09). NanoCoreRAT Behind an Increase in Tax-Themed Phishing E-mails. Retrieved November 9, 2018.Microsoft. (n.d.). Using Netsh. Retrieved February 13, 2017.Microsoft. (2009, June 3). Netsh Commands for Windows Firewall. Retrieved April 20, 2016.Fidelis Cybersecurity. (2013, June 28). Fidelis Threat Advisory #1009: "njRAT" Uncovered. Retrieved June 4, 2019.Pascual, C. (2018, November 27). AutoIt-Compiled Worm Affecting Removable Media Delivers Fileless Version of BLADABINDI/njRAT Backdoor. Retrieved June 4, 2019.Dantzig, M. v., Schamper, E. (2019, December 19). Operation Wocao: Shining a light on one of China’s hidden hacking groups. Retrieved October 8, 2020.Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Technical Analysis. Retrieved August 17, 2016.Liebenberg, D.. (2018, August 30). Rocke: The Champion of Monero Miners. Retrieved May 26, 2020.MSTIC, CDOC, 365 Defender Research Team. (2021, January 20). Deep dive into the Solorigate second-stage activation: From SUNBURST to TEARDROP and Raindrop . Retrieved January 22, 2021.Kol, Roi. Morag, A. (2020, August 25). Deep Analysis of TeamTNT Techniques Using Container Images to Attack. Retrieved September 22, 2021.Dedola, G. et al. (2023, October 12). ToddyCat: Keep calm and check logs. Retrieved January 3, 2024.US-CERT. (2018, June 14). MAR-10135536-12 – North Korean Trojan: TYPEFRAME. Retrieved July 13, 2018.Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.