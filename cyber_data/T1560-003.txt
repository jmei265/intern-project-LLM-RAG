MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseArchive Collected DataArchive via Custom MethodArchive Collected Data:Archive via Custom MethodOther sub-techniques of Archive Collected Data (3)IDNameT1560.001Archive via UtilityT1560.002Archive via LibraryT1560.003Archive via Custom MethodAn adversary may compress or encrypt data that is collected prior to exfiltration using a custom method. Adversaries may choose to use custom archival methods, such as encryption with XOR or stream ciphers implemented with no external library or utility references. Custom implementations of well-known compression algorithms have also been used.[1]ID:T1560.003Sub-technique of:T1560ⓘTactic:CollectionⓘPlatforms:Linux, Windows, macOSVersion:1.0Created:20 February 2020Last Modified:25 March 2020Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0045ADVSTORESHELLADVSTORESHELLcompresses output data generated by command execution with a custom implementation of the Lempel–Ziv–Welch (LZW) algorithm.[1]S0092Agent.btzAgent.btzsaves system information into an XML file that is then XOR-encoded.[2]S0438AttorAttorencrypts collected data with a custom implementation of Blowfish and RSA ciphers.[3]S0657BLUELIGHTBLUELIGHThas encoded data into a binary blob using XOR.[4]C0017C0017DuringC0017,APT41hex-encoded PII data prior to exfiltration.[5]G0052CopyKittensCopyKittensencrypts data with a substitute cipher prior to exfiltration.[6]S0038DuquModules can be pushed to and executed byDuquthat copy data to a staging area, compress it, and XOR encrypt it.[7]G0037FIN6FIN6has encoded data gathered from the victim with a simple substitution cipher and single-byte XOR using the 0xAA key, and Base64 with character permutation.[8][9]S0036FLASHFLOODFLASHFLOODemploys the same encoding scheme asSPACESHIPfor data it stages. Data is compressed with zlib, and bytes are rotated four times before being XOR'ed with 0x23.[10]S0661FoggyWebFoggyWebcan use a dynamic XOR key and a custom XOR methodology to encode data before exfiltration. Also,FoggyWebcan encode C2 command output within a legitimate WebP file.[11]S0503FrameworkPOSFrameworkPOScan XOR credit card information before exfiltration.[12]S1044FunnyDreamFunnyDreamhas compressed collected files with zLib and encrypted them using an XOR operation with the string key from the command line orqwerasdfif the command line argument doesn’t contain the key. File names are obfuscated using XOR with the same key as the compressed file content.[13]S0391HAWKBALLHAWKBALLhas encrypted data with XOR before sending it over the C2 channel.[14]S0260InvisiMoleInvisiMoleuses a variation of the XOR cipher to encrypt files before exfiltration.[15]G0094KimsukyKimsukyhas used RC4 encryption before exfil.[16]G0032Lazarus GroupALazarus Groupmalware sample encrypts data using a simple byte based XOR operation prior to exfiltration.[17][18][19][20]S0409MacheteMachete's collected data is encrypted with AES before exfiltration.[21]S0443MESSAGETAPMESSAGETAPhas XOR-encrypted and stored contents of SMS messages that matched its target list.[22]S1059metaMainmetaMainhas used XOR-based encryption for collected files before exfiltration.[23]G0129Mustang PandaMustang Pandahas encrypted documents with RC4 prior to exfiltration.[24]S0198NETWIRENETWIREhas used a custom encryption algorithm to encrypt collected data.[25]S0439OkrumOkrumhas used a custom implementation of AES encryption to encrypt collected data.[26]S0264OopsIEOopsIEcompresses collected files with a simple character replacement scheme before sending them to its C2 server.[27]S0352OSX_OCEANLOTUS.DOSX_OCEANLOTUS.Dhas used AES in CBC mode to encrypt collected data when saving that data to disk.[28]S0072OwaAuthOwaAuthDES-encrypts captured credentials using the key 12345678 before writing the credentials to a log file.[29]S0458RamsayRamsaycan store collected documents in a custom container after encrypting and compressing them using RC4 and WinRAR.[30]S0169RawPOSRawPOSencodes credit card data it collected from the victim with XOR.[31][32][33]S0172ReaverReaverencrypts collected data with an incremental XOR key prior to exfiltration.[34]S0258RGDoorRGDoorencrypts files with XOR before sending them back to the C2 server.[35]S0448Rising SunRising Suncan archive data using RC4 encryption and Base64 encoding prior to exfiltration.[36]S0615SombRATSombRAThas encrypted collected data with AES-256 using a hardcoded key.[37]S0035SPACESHIPDataSPACESHIPcopies to the staging area is compressed with zlib. Bytes are rotated by four positions and XOR'ed with 0x23.[10]S1030SquirrelwaffleSquirrelwafflehas encrypted collected data using a XOR-based algorithm.[38]S0491StrongPityStrongPitycan compress and encrypt archived files into multiple .sft files with a repeated xor encryption scheme.[39][40]S0603StuxnetStuxnetencrypts exfiltrated data via C2 with static 31-byte long XOR keys.[41]S1042SUGARDUMPSUGARDUMPhas encrypted collected data using AES CBC mode and encoded it using Base64.[42]S0098T9000T9000encrypts collected data using a single byte XOR key.[43]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0022FileFile CreationMonitor newly constructed files being written with extensions and/or headers associated with compressed or encrypted file types. Detection efforts may focus on follow-on exfiltration activity, where compressed or encrypted files can be detected in transit with a network intrusion detection or data loss prevention system analyzing file headers.DS0012ScriptScript ExecutionMonitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.ReferencesESET. (2016, October). En Route with Sednit - Part 2: Observing the Comings and Goings. Retrieved November 21, 2016.Shevchenko, S.. (2008, November 30). Agent.btz - A Threat That Hit Pentagon. Retrieved April 8, 2016.Hromcova, Z. (2019, October). AT COMMANDS, TOR-BASED COMMUNICATIONS: MEET ATTOR, A FANTASY CREATURE AND ALSO A SPY PLATFORM. Retrieved May 6, 2020.Cash, D., Grunzweig, J., Meltzer, M., Adair, S., Lancaster, T. (2021, August 17). North Korean APT InkySquid Infects Victims Using Browser Exploits. Retrieved September 30, 2021.Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.Minerva Labs LTD and ClearSky Cyber Security. (2015, November 23). CopyKittens Attack Group. Retrieved September 11, 2017.Symantec Security Response. (2011, November). W32.Duqu: The precursor to the next Stuxnet. Retrieved September 17, 2015.FireEye Threat Intelligence. (2016, April). Follow the Money: Dissecting the Operations of the Cyber Crime Group FIN6. Retrieved June 1, 2016.Chen, J. (2019, October 10). Magecart Card Skimmers Injected Into Online Shops. Retrieved September 9, 2020.FireEye Labs. (2015, April). APT30 AND THE MECHANICS OF A LONG-RUNNING CYBER ESPIONAGE OPERATION. Retrieved May 1, 2015.Ramin Nafisi. (2021, September 27). FoggyWeb: Targeted NOBELIUM malware leads to persistent backdoor. Retrieved October 4, 2021.Kremez, V. (2019, September 19). FIN6 “FrameworkPOS”: Point-of-Sale Malware Analysis & Internals. Retrieved September 8, 2020.Vrabie, V. (2020, November). Dissecting a Chinese APT Targeting South Eastern Asian Government Institutions. Retrieved September 19, 2022.Patil, S. and Williams, M.. (2019, June 5). Government Sector in Central Asia Targeted With New HAWKBALL Backdoor Delivered via Microsoft Office Vulnerabilities. Retrieved June 20, 2019.Hromcová, Z. (2018, June 07). InvisiMole: Surprisingly equipped spyware, undercover since 2013. Retrieved July 10, 2018.Tarakanov , D.. (2013, September 11). The “Kimsuky” Operation: A North Korean APT?. Retrieved August 13, 2019.Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February 25, 2016.Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Loaders, Installers and Uninstallers Report. Retrieved March 2, 2016.Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Remote Administration Tools & Content Staging Malware Report. Retrieved March 16, 2016.Sherstobitoff, R. (2018, February 12). Lazarus Resurfaces, Targets Global Banks and Bitcoin Users. Retrieved February 19, 2018.ESET. (2019, July). MACHETE JUST GOT SHARPER Venezuelan government institutions under attack. Retrieved September 13, 2019.Leong, R., Perez, D., Dean, T. (2019, October 31). MESSAGETAP: Who’s Reading Your Text Messages?. Retrieved May 11, 2020.Ehrlich, A., et al. (2022, September). THE MYSTERY OF METADOR | AN UNATTRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES. Retrieved January 23, 2023.Hamzeloofard, S. (2020, January 31). New wave of PlugX targets Hong Kong | Avira Blog. Retrieved April 13, 2021.Maniath, S. and Kadam P. (2019, March 19). Dissecting a NETWIRE Phishing Campaign's Usage of Process Hollowing. Retrieved January 7, 2021.Hromcova, Z. (2019, July). OKRUM AND KETRICAN: AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITY. Retrieved May 6, 2020.Lee, B., Falcone, R. (2018, February 23). OopsIE! OilRig Uses ThreeDollars to Deliver New Trojan. Retrieved July 16, 2018.Erye Hernandez and Danny Tsechansky. (2017, June 22). The New and Improved macOS Backdoor from OceanLotus. Retrieved September 8, 2023.Dell SecureWorks Counter Threat Unit Threat Intelligence. (2015, August 5). Threat Group-3390 Targets Organizations for Cyberespionage. Retrieved August 18, 2018.Sanmillan, I.. (2020, May 13). Ramsay: A cyber‑espionage toolkit tailored for air‑gapped networks. Retrieved May 27, 2020.TrendLabs Security Intelligence Blog. (2015, April). RawPOS Technical Brief. Retrieved October 4, 2017.Bromiley, M. and Lewis, P. (2016, October 7). Attacking the Hospitality and Gaming Industries: Tracking an Attacker Around the World in 7 Years. Retrieved October 6, 2017.Visa. (2015, March). Visa Security Alert: "RawPOS" Malware Targeting Lodging Merchants. Retrieved October 6, 2017.Grunzweig, J. and Miller-Osborn, J. (2017, November 10). New Malware with Ties to SunOrcal Discovered. Retrieved November 16, 2017.Falcone, R. (2018, January 25). OilRig uses RGDoor IIS Backdoor on Targets in the Middle East. Retrieved July 6, 2018.Sherstobitoff, R., Malhotra, A., et. al.. (2018, December 18). Operation Sharpshooter Campaign Targets Global Defense, Critical Infrastructure. Retrieved May 14, 2020.The BlackBerry Research and Intelligence Team. (2020, November 12). The CostaRicto Campaign: Cyber-Espionage Outsourced. Retrieved May 24, 2021.Kumar, A., Stone-Gross, Brett. (2021, September 28). Squirrelwaffle: New Loader Delivering Cobalt Strike. Retrieved August 9, 2022.Mercer, W. et al. (2020, June 29). PROMETHIUM extends global reach with StrongPity3 APT. Retrieved July 20, 2020.Tudorica, R. et al. (2020, June 30). StrongPity APT - Revealing Trojanized Tools, Working Hours and Infrastructure. Retrieved July 20, 2020.Nicolas Falliere, Liam O Murchu, Eric Chien 2011, February W32.Stuxnet Dossier (Version 1.4) Retrieved. 2017/09/22Mandiant Israel Research Team. (2022, August 17). Suspected Iranian Actor Targeting Israeli Shipping, Healthcare, Government and Energy Sectors. Retrieved September 21, 2022.Grunzweig, J. and Miller-Osborn, J.. (2016, February 4). T9000: Advanced Modular Backdoor Uses Complex Anti-Analysis Techniques. Retrieved April 15, 2016.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.