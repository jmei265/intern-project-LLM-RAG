MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseValid AccountsCloud AccountsValid Accounts:Cloud AccountsOther sub-techniques of Valid Accounts (4)IDNameT1078.001Default AccountsT1078.002Domain AccountsT1078.003Local AccountsT1078.004Cloud AccountsValid accounts in cloud environments may allow adversaries to perform actions to achieve Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application. Cloud Accounts can exist solely in the cloud; alternatively, they may be hybrid-joined between on-premises systems and the cloud through syncing or federation with other identity sources such as Windows Active Directory.[1][2][3]Service or user accounts may be targeted by adversaries throughBrute Force,Phishing, or various other means to gain access to the environment. Federated or synced accounts may be a pathway for the adversary to affect both on-premises systems and cloud environments - for example, by leveraging shared credentials to log ontoRemote Services. High privileged cloud accounts, whether federated, synced, or cloud-only, may also allow pivoting to on-premises environments by leveraging SaaS-basedSoftware Deployment Toolsto run commands on hybrid-joined devices.An adversary may create long lastingAdditional Cloud Credentialson a compromised cloud account to maintain persistence in the environment. Such credentials may also be used to bypass security controls such as multi-factor authentication.Cloud accounts may also be able to assumeTemporary Elevated Cloud Accessor other privileges through various means within the environment. Misconfigurations in role assignments or role assumption policies may allow an adversary to use these mechanisms to leverage permissions outside the intended scope of the account. Such over privileged accounts may be used to harvest sensitive data from online storage accounts and databases throughCloud APIor other methods.ID:T1078.004Sub-technique of:T1078ⓘTactics:Defense Evasion,Persistence,Privilege Escalation,Initial AccessⓘPlatforms:Azure AD, Google Workspace, IaaS, Office 365, SaaSⓘPermissions Required:Administrator, UserContributors:Jon Sternstein, Stern SecurityVersion:1.7Created:13 March 2020Last Modified:29 March 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0007APT28APT28has used compromised Office 365 service accounts with Global Administrator privileges to collect email from user inboxes.[4]G0016APT29APT29has gained access to a global administrator account in Azure AD and has usedService Principalcredentials in Exchange.[5][6]G0064APT33APT33has used compromised Office 365 accounts in tandem withRulerin an attempt to gain control of endpoints.[7]G1023APT5APT5has accessed Microsoft M365 cloud environments using stolen credentials.[8]C0027C0027DuringC0027,Scattered Spiderleveraged compromised credentials from victim users  to authenticate to Azure tenants.[9]G0004Ke3changKe3changhas used compromised credentials to sign into victims’ Microsoft 365 accounts.[10]G1004LAPSUS$LAPSUS$has used compromised credentials to access cloud assets within a target organization.[11]S1091PacuPaculeverages valid cloud accounts to perform most of its operations.[12]S0683PeiratesPeiratescan use stolen service account tokens to perform its operations.[13]S0684ROADToolsROADToolsleverages valid cloud credentials to perform enumeration operations using the internal Azure AD Graph API.[14]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29used a compromised O365 administrator account to create a new Service Principal.[15]MitigationsIDMitigationDescriptionM1036Account Use PoliciesUse conditional access policies to block logins from non-compliant devices or from outside defined organization IP ranges.[16]M1015Active Directory ConfigurationDisable legacy authentication, which does not support MFA, and require the use of modern authentication protocols instead.M1032Multi-factor AuthenticationUse multi-factor authentication for cloud accounts, especially privileged accounts. This can be implemented in a variety of forms (e.g. hardware, virtual, SMS), and can also be audited using administrative reporting features.[17]M1027Password PoliciesEnsure that cloud accounts, particularly privileged accounts, have complex, unique passwords across all systems on the network. Passwords and access keys should be rotated regularly. This limits the amount of time credentials can be used to access resources if a credential is compromised without your knowledge. Cloud service providers may track access key age to help audit and identify keys that may need to be rotated.[17]M1026Privileged Account ManagementReview privileged cloud account permission levels routinely to look for those that could allow an adversary to gain wide access, such as Global Administrator and Privileged Role Administrator in Azure AD.[18][19][20]These reviews should also check if new privileged cloud accounts have been created that were not authorized. For example, in Azure AD environments configure alerts to notify when accounts have gone many days without using privileged roles, as these roles may be able to be removed.[21]Consider using temporary, just-in-time (JIT) privileged access to Azure AD resources rather than permanently assigning privileged roles.[20]M1018User Account ManagementPeriodically review user accounts and remove those that are inactive or unnecessary. Limit the ability for user accounts to create additional accounts.M1017User TrainingApplications may send push notifications to verify a login as a form of multi-factor authentication (MFA). Train users to only accept valid push notifications and to report suspicious push notifications.DetectionIDData SourceData ComponentDetectsDS0028Logon SessionLogon Session CreationMonitor for suspicious account behavior across cloud services that share account.Logon Session MetadataCorrelate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access).DS0002User AccountUser Account AuthenticationMonitor the activity of cloud accounts to detect abnormal or malicious behavior, such as accessing information outside of the normal function of the account, account usage at atypical hours, or account authentication from unexpected locations or IP addresses. Service accounts should only be accessible from IP addresses from within the cloud environment.[22]For example, in Azure AD environments, consider using Identity Protection to flag risky sign-ins based on location, device compliance, and other factors. In Okta environments, configure Suspicious Activity Reporting to allow users to report suspicious logins and other behavior they do not recognize.[23]ReferencesAmazon. (n.d.). Identity Federation in AWS. Retrieved March 13, 2020.Google. (n.d.). Federating Google Cloud with Active Directory. Retrieved March 13, 2020.Microsoft. (n.d.). Deploying Active Directory Federation Services in Azure. Retrieved March 13, 2020.NSA, CISA, FBI, NCSC. (2021, July). Russian GRU Conducting Global Brute Force Campaign to Compromise Enterprise and Cloud Environments. Retrieved July 26, 2021.Douglas Bienstock. (2022, August 18). You Can’t Audit Me: APT29 Continues Targeting Microsoft 365. Retrieved February 23, 2023.Mandiant. (2022, May 2). UNC3524: Eye Spy on Your Email. Retrieved August 17, 2023.Microsoft Threat Protection Intelligence Team. (2020, June 18). Inside Microsoft Threat Protection: Mapping attack chains from cloud to endpoint. Retrieved June 22, 2020.Perez, D. et al. (2021, May 27). Re-Checking Your Pulse: Updates on Chinese APT Actors Compromising Pulse Secure VPN Devices. Retrieved February 5, 2024.Parisi, T. (2022, December 2). Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies. Retrieved June 30, 2023.MSTIC. (2021, December 6). NICKEL targeting government organizations across Latin America and Europe. Retrieved March 18, 2022.MSTIC, DART, M365 Defender. (2022, March 24). DEV-0537 Criminal Actor Targeting Organizations for Data Exfiltration and Destruction. Retrieved May 17, 2022.Rhino Security Labs. (2019, August 22). Pacu. Retrieved October 17, 2019.InGuardians. (2022, January 5). Peirates GitHub. Retrieved February 8, 2022.Dirk-jan Mollema. (2020, April 16). Introducing ROADtools - The Azure AD exploration framework. Retrieved January 31, 2022.CrowdStrike. (2022, January 27). Early Bird Catches the Wormhole: Observations from the StellarParticle Campaign. Retrieved February 7, 2022.Microsoft. (2022, December 14). Conditional Access templates. Retrieved February 21, 2023.Moncur, Rob. (2020, July 5). New Information in the AWS IAM Console Helps You Follow IAM Best Practices. Retrieved August 4, 2020.Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016.Microsoft. (2016, April 16). Implementing Least-Privilege Administrative Models. Retrieved June 3, 2016.Microsoft. (2022, November 14). Azure security baseline for Azure Active Directory. Retrieved February 21, 2023.Microsoft. (2022, November 14). Configure security alerts for Azure AD roles in Privileged Identity Management. Retrieved February 21, 2023.Dror Alon. (2022, December 8). Compromised Cloud Compute Credentials: Case Studies From the Wild. Retrieved March 9, 2023.Okta Defensive Cyber Operations. (2023, August 31). Cross-Tenant Impersonation: Prevention and Detection. Retrieved March 4, 2024.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.