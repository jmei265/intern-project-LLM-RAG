MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseApplication Layer ProtocolDNSApplication Layer Protocol:DNSOther sub-techniques of Application Layer Protocol (4)IDNameT1071.001Web ProtocolsT1071.002File Transfer ProtocolsT1071.003Mail ProtocolsT1071.004DNSAdversaries may communicate using the Domain Name System (DNS) application layer protocol to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.The DNS protocol serves an administrative function in computer networking and thus may be very common in environments. DNS traffic may also be allowed even before network authentication is completed. DNS packets contain many fields and headers in which data can be concealed. Often known as DNS tunneling, adversaries may abuse DNS to communicate with systems under their control within a victim network while also mimicking normal, expected traffic.[1][2]ID:T1071.004Sub-technique of:T1071ⓘTactic:Command and ControlⓘPlatforms:Linux, Network, Windows, macOSContributors:Chris Heald; Jan Petrov, CitiVersion:1.2Created:15 March 2020Last Modified:26 December 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0504AnchorVariants ofAnchorcan use DNS tunneling to communicate with C2.[3][4]G0026APT18APT18uses DNS for C2 communications.[5]G0087APT39APT39has used remote access tools that leverage DNS in communications with C2.[6]G0096APT41APT41used DNS for C2 communications.[7][8]S0360BONDUPDATERBONDUPDATERcan use DNS and TXT records within its DNS tunneling protocol for command and control.[9]S1063Brute Ratel C4Brute Ratel C4can use DNS over HTTPS for C2.[10][11]G0114ChimeraChimerahas usedCobalt Striketo encapsulate C2 in DNS traffic.[12]G0080Cobalt GroupCobalt Grouphas used DNS tunneling for C2.[13][14][15]S0154Cobalt StrikeCobalt Strikecan use a custom command and control protocol that can be encapsulated in DNS. All protocols use their standard assigned ports.[16][17][18]S0338Cobian RATCobian RATuses DNS for C2.[19]C0029Cutting EdgeDuringCutting Edge, threat actors used DNS to tunnel IPv4 C2 traffic.[20]S1014DanBotDanBotcan use use IPv4 A records and IPv6 AAAA DNS records in C2 communications.[21]S1111DarkGateDarkGatecan cloak command and control traffic in DNS records from legitimate services to avoid reputation-based detection techniques.[22]S0354DenisDenishas used DNS tunneling for C2 communications.[23][24][25]S1021DnsSystemDnsSystemcan direct queries to custom DNS servers and return C2 commands using TXT records.[26]S0377EburyEburyhas used DNS requests over UDP port 53 for C2.[27]G0046FIN7FIN7has performed C2 using DNS via A, OPT, and TXT records.[28]S0666GelsemiumGelsemiumhas the ability to use DNS in communication with C2.[29]S0477GoopyGoopyhas the ability to communicate with its C2 over DNS.[25]S0690Green LambertGreen Lambertcan use DNS for C2 communications.[30][31]S0170HelminthHelminthcan use DNS for C2.[32]S1027Heyoka BackdoorHeyoka Backdoorcan use DNS tunneling for C2 communications.[33]S0070HTTPBrowserHTTPBrowserhas used DNS for command and control.[34][35]S0260InvisiMoleInvisiMolehas used a custom implementation of DNS tunneling to embed C2 communications in DNS requests and replies.[36]G0004Ke3changKe3changmalware RoyalDNS has used DNS for C2.[37]S1020KevinVariants ofKevincan communicate over DNS through queries to the server for constructed domain names with embedded information.[38]G0140LazyScripterLazyScripterhas leveraged dynamic DNS providers for C2 communications.[39]S0167MatryoshkaMatryoshkauses DNS for C2.[40][41]S1015MilanMilanhas the ability to use DNS for C2 communications.[42][38][43]S1047MoriMorican use DNS tunneling to communicate with C2.[44][45]S0699MythicMythicsupports DNS-based C2 profiles.[46]S0228NanHaiShuNanHaiShuuses DNS for the C2 communications.[47]S1090NightClubNightClubcan use a DNS tunneling plugin to exfiltrate data by adding it to the subdomain portion of a DNS request.[48]G0049OilRigOilRighas used DNS for C2 including the publicly availablerequestbin.nettunneling service.[49][50][51][52]S0124PisloaderPisloaderuses DNS as its C2 protocol.[53]S0013PlugXPlugXcan be configured to use DNS for command and control.[34]S0145POWERSOURCEPOWERSOURCEuses DNS TXT records for C2.[54][55]S0184POWRUNERPOWRUNERcan use DNS for C2 communications.[56][50]S0269QUADAGENTQUADAGENTuses DNS for C2 communications.[57]S0495RDATRDAThas used DNS to communicate with the C2.[58]S0125RemsecRemsecis capable of using DNS for C2.[59][60][61]S0596ShadowPadShadowPadhas used DNS tunneling for C2 communications.[62]S1019SharkSharkcan use DNS in C2 communications.[42][43]S0633SliverSlivercan support C2 communications over DNS.[63][64][65]S0615SombRATSombRATcan communicate over DNS with the C2 server.[66][67]S0157SOUNDBITESOUNDBITEcommunicates via DNS for C2.[68]S0559SUNBURSTSUNBURSTused DNS for C2 traffic designed to mimic normal SolarWinds API communications.[69]S0663SysUpdateSysUpdatehas used DNS TXT requests as for its C2 communication.[70]S0146TEXTMATETEXTMATEuses DNS TXT records for C2.[54]G0081Tropic TrooperTropic Trooper's backdoor has communicated to the C2 over the DNS protocol.[71]S0022UroburosUroburoshas encoded outbound C2 communications in DNS requests consisting of character strings made to resemble standard domain names. The actual information transmitted byUroburosis contained in the part of the character string prior to the first ‘.’ character.[72]S0514WellMessWellMesshas the ability to use DNS tunneling for C2 communications.[73][74]MitigationsIDMitigationDescriptionM1037Filter Network TrafficConsider filtering DNS requests to unknown, untrusted, or known bad domains and resources. Resolving DNS requests with on-premise/proxy servers may also disrupt adversary attempts to conceal data within DNS packets.M1031Network Intrusion PreventionNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.DetectionIDData SourceData ComponentDetectsDS0029Network TrafficNetwork Traffic ContentMonitor and analyze traffic patterns and packet inspection associated to protocol(s), leveraging SSL/TLS inspection for DNS over TLS (DoT) and DNS over HTTPS (DoH), that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).Network Traffic FlowMonitor for DNS traffic to/from known-bad or suspicious domains and analyze traffic flows that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, or gratuitous or anomalous traffic patterns). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).ReferencesPalo Alto Networks. (n.d.). What Is DNS Tunneling?. Retrieved March 15, 2020.Galobardes, R. (2018, October 30). Learn how easy is to bypass firewalls using DNS tunneling (and also how to block it). Retrieved March 15, 2020.Dahan, A. et al. (2019, December 11). DROPPING ANCHOR: FROM A TRICKBOT INFECTION TO THE DISCOVERY OF THE ANCHOR MALWARE. Retrieved September 10, 2020.Grange, W. (2020, July 13). Anchor_dns malware goes cross platform. Retrieved September 10, 2020.Grunzweig, J., et al. (2016, May 24). New Wekby Attacks Use DNS Requests As Command and Control Mechanism. Retrieved November 15, 2018.Rusu, B. (2020, May 21). Iranian Chafer APT Targeted Air Transportation and Government in Kuwait and Saudi Arabia. Retrieved May 22, 2020.Fraser, N., et al. (2019, August 7). Double DragonAPT41, a dual espionage and cyber crime operation APT41. Retrieved September 23, 2019.Rostovcev, N. (2021, June 10). Big airline heist APT41 likely behind a third-party attack on Air India. Retrieved August 26, 2021.Wilhoit, K. and Falcone, R. (2018, September 12). OilRig Uses Updated BONDUPDATER to Target Middle Eastern Government. Retrieved February 18, 2019.Harbison, M. and Renals, P. (2022, July 5). When Pentest Tools Go Brutal: Red-Teaming Tool Being Abused by Malicious Actors. Retrieved February 1, 2023.Kenefick, I. et al. (2022, October 12). Black Basta Ransomware Gang Infiltrates Networks via QAKBOT, Brute Ratel, and Cobalt Strike. Retrieved February 6, 2023.Jansen, W . (2021, January 12). Abusing cloud services to fly under the radar. Retrieved January 19, 2021.Svajcer, V. (2018, July 31). Multiple Cobalt Personality Disorder. Retrieved September 5, 2018.Positive Technologies. (2016, December 16). Cobalt Snatch. Retrieved October 9, 2018.Matveeva, V. (2017, August 15). Secrets of Cobalt. Retrieved October 10, 2018.Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.Mavis, N. (2020, September 21). The Art and Science of Detecting Cobalt Strike. Retrieved April 6, 2021.Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.Yadav, A., et al. (2017, August 31). Cobian RAT – A backdoored RAT. Retrieved November 13, 2018.Lin, M. et al. (2024, January 31). Cutting Edge, Part 2: Investigating Ivanti Connect Secure VPN Zero-Day Exploitation. Retrieved February 27, 2024.SecureWorks 2019, August 27 LYCEUM Takes Center Stage in Middle East Campaign Retrieved. 2019/11/19Adi Zeligson & Rotem Kerner. (2018, November 13). Enter The DarkGate - New Cryptocurrency Mining and Ransomware Campaign. Retrieved February 9, 2024.Dahan, A. (2017, May 24). OPERATION COBALT KITTY: A LARGE-SCALE APT IN ASIA CARRIED OUT BY THE OCEANLOTUS GROUP. Retrieved November 5, 2018.Shulmin, A., Yunakovsky, S. (2017, April 28). Use of DNS Tunneling for C&C Communications. Retrieved November 5, 2018.Dahan, A. (2017). Operation Cobalt Kitty. Retrieved December 27, 2018.Shivtarkar, N. and Kumar, A. (2022, June 9). Lyceum .NET DNS Backdoor. Retrieved June 23, 2022.M.Léveillé, M.. (2014, February 21). An In-depth Analysis of Linux/Ebury. Retrieved April 19, 2019.Carr, N., et al. (2018, August 01). On the Hunt for FIN7: Pursuing an Enigmatic and Evasive Global Criminal Operation. Retrieved August 23, 2018.Dupuy, T. and Faou, M. (2021, June). Gelsemium. Retrieved November 30, 2021.Sandvik, Runa. (2021, October 1). Made In America: Green Lambert for OS X. Retrieved March 21, 2022.Sandvik, Runa. (2021, October 18). Green Lambert and ATT&CK. Retrieved March 21, 2022.Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.Chen, Joey. (2022, June 9). Aoqin Dragon | Newly-Discovered Chinese-linked APT Has Been Quietly Spying On Organizations For 10 Years. Retrieved July 14, 2022.Dell SecureWorks Counter Threat Unit Threat Intelligence. (2015, August 5). Threat Group-3390 Targets Organizations for Cyberespionage. Retrieved August 18, 2018.Shelmire, A.. (2015, July 6). Evasive Maneuvers. Retrieved January 22, 2016.Hromcova, Z. and Cherpanov, A. (2020, June). INVISIMOLE: THE HIDDEN PART OF THE STORY. Retrieved July 16, 2020.Smallridge, R. (2018, March 10). APT15 is alive and strong: An analysis of RoyalCli and RoyalDNS. Retrieved April 4, 2018.Kayal, A. et al. (2021, October). LYCEUM REBORN: COUNTERINTELLIGENCE IN THE MIDDLE EAST. Retrieved June 14, 2022.Jazi, H. (2021, February). LazyScripter: From Empire to double RAT. Retrieved November 24, 2021.ClearSky Cyber Security and Trend Micro. (2017, July). Operation Wilted Tulip: Exposing a cyber espionage apparatus. Retrieved August 21, 2017.Minerva Labs LTD and ClearSky Cyber Security. (2015, November 23). CopyKittens Attack Group. Retrieved September 11, 2017.ClearSky Cyber Security . (2021, August). New Iranian Espionage Campaign By “Siamesekitten” - Lyceum. Retrieved June 6, 2022.Accenture. (2021, November 9). Who are latest targets of cyber group Lyceum?. Retrieved June 16, 2022.FBI, CISA, CNMF, NCSC-UK. (2022, February 24). Iranian Government-Sponsored Actors Conduct Cyber Operations Against Global Government and Commercial Networks. Retrieved September 27, 2022.Cyber National Mission Force. (2022, January 12). Iranian intel cyber suite of malware uses open source tools. Retrieved September 30, 2022.Thomas, C. (n.d.). Mythc Documentation. Retrieved March 25, 2022.F-Secure Labs. (2016, July). NANHAISHU RATing the South China Sea. Retrieved July 6, 2018.Faou, M. (2023, August 10). MoustachedBouncer: Espionage against foreign diplomats in Belarus. Retrieved September 25, 2023.Unit42. (2016, May 1). Evasive Serpens Unit 42 Playbook Viewer. Retrieved February 6, 2023.Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34’s Invite to Join Their Professional Network. Retrieved August 26, 2019.Check Point. (2021, April 8). Iran’s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.Grunzweig, J., et al. (2016, May 24). New Wekby Attacks Use DNS Requests As Command and Control Mechanism. Retrieved August 17, 2016.Miller, S., et al. (2017, March 7). FIN7 Spear Phishing Campaign Targets Personnel Involved in SEC Filings. Retrieved March 8, 2017.Brumaghin, E. and Grady, C.. (2017, March 2). Covert Channels and Poor Decisions: The Tale of DNSMessenger. Retrieved March 8, 2017.Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.Lee, B., Falcone, R. (2018, July 25). OilRig Targets Technology Service Provider and Government Agency with QUADAGENT. Retrieved August 9, 2018.Falcone, R. (2020, July 22). OilRig Targets Middle Eastern Telecommunications Organization and Adds Novel C2 Channel with Steganography to Its Inventory. Retrieved July 28, 2020.Symantec Security Response. (2016, August 8). Backdoor.Remsec indicators of compromise. Retrieved August 17, 2016.Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Retrieved August 17, 2016.Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Technical Analysis. Retrieved August 17, 2016.Kaspersky Lab. (2017, August). ShadowPad: popular server management software hit in supply chain attack. Retrieved March 22, 2021.NCSC, CISA, FBI, NSA. (2021, May 7). Further TTPs associated with SVR cyber actors. Retrieved July 29, 2021.Kervella, R. (2019, August 4). Cross-platform General Purpose Implant Framework Written in Golang. Retrieved July 30, 2021.BishopFox. (n.d.). Sliver DNS C2 . Retrieved September 15, 2021.The BlackBerry Research and Intelligence Team. (2020, November 12). The CostaRicto Campaign: Cyber-Espionage Outsourced. Retrieved May 24, 2021.McLellan, T.  and Moore, J. et al. (2021, April 29). UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial Threat. Retrieved June 2, 2021.Carr, N.. (2017, May 14). Cyber Espionage is Alive and Well: APT32 and the Threat to Global Corporations. Retrieved June 18, 2017.FireEye. (2020, December 13). Highly Evasive Attacker Leverages SolarWinds Supply Chain to Compromise Multiple Global Victims With SUNBURST Backdoor. Retrieved January 4, 2021.Daniel Lunghi. (2023, March 1). Iron Tiger’s SysUpdate Reappears, Adds Linux Targeting. Retrieved March 20, 2023.Chen, J.. (2020, May 12). Tropic Trooper’s Back: USBferry Attack Targets Air gapped Environments. Retrieved May 20, 2020.FBI et al. (2023, May 9). Hunting Russian Intelligence “Snake” Malware. Retrieved June 8, 2023.PWC. (2020, July 16). How WellMess malware has been used to target COVID-19 vaccines. Retrieved September 24, 2020.National Cyber Security Centre. (2020, July 16). Advisory: APT29 targets COVID-19 vaccine development. Retrieved September 29, 2020.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.