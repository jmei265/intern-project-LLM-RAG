MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseSystem ServicesService ExecutionSystem Services:Service ExecutionOther sub-techniques of System Services (2)IDNameT1569.001LaunchctlT1569.002Service ExecutionAdversaries may abuse the Windows service control manager to execute malicious commands or payloads. The Windows service control manager (services.exe) is an interface to manage and manipulate services.[1]The service control manager is accessible to users via GUI components as well as system utilities such assc.exeandNet.PsExeccan also be used to execute commands or payloads via a temporary Windows service created through the service control manager API.[2]Tools such asPsExecandsc.execan accept remote servers as arguments and may be used to conduct remote execution.Adversaries may leverage these mechanisms to execute malicious content. This can be done by either executing a new or modified service. This technique is the execution used in conjunction withWindows Serviceduring service persistence or privilege escalation.ID:T1569.002Sub-technique of:T1569ⓘTactic:ExecutionⓘPlatforms:WindowsⓘSupports Remote:YesVersion:1.2Created:10 March 2020Last Modified:14 August 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0504AnchorAnchorcan create and execute services to load its payload.[3][4]G0050APT32APT32's backdoor has used Windows services as a way to execute its malicious payload.[5]G0082APT38APT38has created new services or modified existing ones to run executables, commands, or scripts.[6]G0087APT39APT39has used post-exploitation tools including RemCom and the Non-sucking Service Manager (NSSM) to execute processes.[7][8]G0096APT41APT41used  svchost.exe andNetto execute a system service installed to launch aCobalt StrikeBEACON loader.[9][10]S0438AttorAttor's dispatcher can be executed as a service.[11]S0606Bad RabbitBad Rabbitdrops a file namedinfpub.datinto the Windows directory and is executed through SCManager andrundll.exe.S0127BBSRATBBSRATcan start, stop, or delete services.[12]G0108Blue MockingbirdBlue Mockingbirdhas executed custom-compiled XMRIG miner DLLs by configuring them to execute via the "wercplsupport" service.[13]S1063Brute Ratel C4Brute Ratel C4can create Windows system services for execution.[14]G0114ChimeraChimerahas usedPsExecto deploy beacons on compromised systems.[15]S0660ClamblingClamblingcan create and start services on a compromised host.[16]S0154Cobalt StrikeCobalt Strikecan usePsExecto execute a payload on a remote host. It can also use Service Control Manager to start new services.[17][18][19]S1111DarkGateDarkGatetries to elevate privileges toSYSTEMusing PsExec to locally execute as a service, such ascmd /c c:\temp\PsExec.exe -accepteula -j -d -s [Target Binary].[20]S0363EmpireEmpirecan usePsExecto execute a payload on a remote host.[21]G0037FIN6FIN6has created Windows services to execute encoded PowerShell commands.[22]S0032gh0st RATgh0st RATcan execute its service if the Service key exists. If the key does not exist,gh0st RATwill create and run the service.[23]S0697HermeticWiperHermeticWipercan create system services to aid in executing the payload.[24][25][26]S0698HermeticWizardHermeticWizardcan useOpenRemoteServiceManagerto create a service.[27]S0376HOPLIGHTHOPLIGHThas used svchost.exe to execute a malicious DLL .[28]S0203HydraqHydraquses svchost.exe to execute a malicious DLL included in a new service group.[29]S0398HyperBroHyperBrohas the ability to start and stop a specified service.[30]S0357ImpacketImpacketcontains various modules emulating other service execution tools such asPsExec.[31]S0260InvisiMoleInvisiMolehas used Windows services as a way to execute its malicious payload.[32]G0004Ke3changKe3changhas used a tool known as RemoteExec (similar toPsExec) to remotely execute batch scripts and binaries.[33]S0250KoadicKoadiccan run a command on another machine usingPsExec.[34]S0451LoudMinerLoudMinerstarted the cryptomining virtual machine as a service on the infected machine.[35]S1060MafaldaMafaldacan create a remote service, let it run once, and then delete it.[36]S0039NetThenet startandnet stopcommands can be used inNetto execute or stop Windows services.[37]S0056Net CrawlerNet CrawlerusesPsExecto perform remote service manipulation to execute a copy of itself as part of lateral movement.[38]S0457NetwalkerOperators deployingNetwalkerhave used psexec and certutil to retrieve theNetwalkerpayload.[39]S0368NotPetyaNotPetyacan usePsExecto help propagate itself across a network.[40][41]S0439OkrumOkrum's loader can create a new service named NtmsSvc to execute the payload.[42]S0365Olympic DestroyerOlympic DestroyerutilizesPsExecto help propagate itself across a network.[43]C0006Operation HoneybeeDuringOperation Honeybee, threat actors ransc startto start the COMSysApp as part of the service hijacking andsc stopto stop and reconfigure the COMSysApp.[44]C0014Operation WocaoDuringOperation Wocao, threat actors created services on remote systems for execution purposes.[45]S0664PandoraPandorahas the ability to install itself as a Windows service.[46]S0378PoshC2PoshC2contains an implementation ofPsExecfor remote execution.[47]S0238ProxysvcProxysvcregisters itself as a service on the victim’s machine to run as a standalone process.[48]S0029PsExecMicrosoft SysinternalsPsExecis a popular administration tool that can be used to execute binaries on remote systems using a temporary Windows service.[2]S0192PupyPupyusesPsExecto execute a payload or commands on a remote host.[49]S0583PysaPysahas usedPsExecto copy and execute the ransomware.[50]S0481Ragnar LockerRagnar Lockerhas used sc.exe to execute a service that it creates.[51]S0166RemoteCMDRemoteCMDcan execute commands remotely by creating a new service on the remote system.[52]S0140ShamoonShamooncreates a new service named "ntssrv" to execute the payload.Shamooncan also spread viaPsExec.[53][54]G0091SilenceSilencehas usedWinexeto install a service on the remote system.[55][56]S0533SLOTHFULMEDIASLOTHFULMEDIAhas the capability to start services.[57]S0491StrongPityStrongPitycan install a service to execute itself as a service.[58][59]S0663SysUpdateSysUpdatecan manage services and processes.[46]S0668TinyTurlaTinyTurlacan install itself as a service on compromised machines.[60]S0612WastedLockerWastedLockercan execute itself as a service.[61]S0689WhisperGateWhisperGatecan download and execute AdvancedRun.exe viasc.exe.[62][63]S0191WinexeWinexeinstalls a service on the remote system, executes the command, then uninstalls the service.[64]S0176WingbirdWingbirduses services.exe to register a new autostart service named "Audit Service" using a copy of the local lsass.exe file.[65][66]S0141Winnti for WindowsWinnti for Windowscan run as a service using svchost.exe.[67]G0102Wizard SpiderWizard Spiderhas usedservices.exeto execute scripts and executables during lateral movement within a victim's network.Wizard Spiderhas also used batch scripts that leveragePsExecto execute a previously transferred ransomware payload on a victim's network.[68][69][70]S0123xCmdxCmdcan be used to execute binaries on remote systems by creating and starting a service.[71]S0412ZxShellZxShellcan create a new service for execution.[72]MitigationsIDMitigationDescriptionM1040Behavior Prevention on EndpointOn Windows 10, enable Attack Surface Reduction (ASR) rules to block processes created byPsExecfrom running.[73]M1026Privileged Account ManagementEnsure that permissions disallow services that run at a higher permissions level from being created or interacted with by a user with a lower permission level.M1022Restrict File and Directory PermissionsEnsure that high permission level service binaries cannot be replaced or modified by users with a lower permission level.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may abuse the Windows service control manager to execute malicious commands or payloads.DS0029Network TrafficNetwork Traffic FlowMonitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.DS0009ProcessProcess CreationMonitor for newly executed processes that may abuse the Windows service control manager to execute malicious commands or payloads.Events 4688 (Microsoft Windows Security Auditing) and 1 (Microsoft Windows Sysmon) provide context of Windows processes creation that can be used to implement this detection.This detection is based on uncommon process and parent process relationships. Service Control Manager spawning command shell is a good starting point. Add more suspicious relationships based on the reality of your network environment.In order to reduce false positives, you can also filter the CommandLine event field using parameters such as /c which carries out the command specified by the parent process.Analytic 1 - Service Execution(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") | WHERE Image LIKE "services.exe" AND Image LIKE "cmd.exe"DS0019ServiceService CreationMonitor newly constructed services that abuse control manager to execute malicious commands or payloads.DS0024Windows RegistryWindows Registry Key ModificationMonitor for changes made to windows registry keys and/or values that may abuse the Windows service control manager to execute malicious commands or payloads.ReferencesMicrosoft. (2018, May 31). Service Control Manager. Retrieved March 28, 2020.Russinovich, M. (2014, May 2). Windows Sysinternals PsExec v2.11. Retrieved May 13, 2015.Dahan, A. et al. (2019, December 11). DROPPING ANCHOR: FROM A TRICKBOT INFECTION TO THE DISCOVERY OF THE ANCHOR MALWARE. Retrieved September 10, 2020.Grange, W. (2020, July 13). Anchor_dns malware goes cross platform. Retrieved September 10, 2020.Dumont, R. (2019, March 20). Fake or Fake: Keeping up with OceanLotus decoys. Retrieved April 1, 2019.DHS/CISA. (2020, August 26). FASTCash 2.0: North Korea's BeagleBoyz Robbing Banks. Retrieved September 29, 2021.Rusu, B. (2020, May 21). Iranian Chafer APT Targeted Air Transportation and Government in Kuwait and Saudi Arabia. Retrieved May 22, 2020.Symantec. (2018, February 28). Chafer: Latest Attacks Reveal Heightened Ambitions. Retrieved May 22, 2020.Glyer, C, et al. (2020, March). This Is Not a Test: APT41 Initiates Global Intrusion Campaign Using Multiple Exploits. Retrieved April 28, 2020.Rostovcev, N. (2021, June 10). Big airline heist APT41 likely behind a third-party attack on Air India. Retrieved August 26, 2021.Hromcova, Z. (2019, October). AT COMMANDS, TOR-BASED COMMUNICATIONS: MEET ATTOR, A FANTASY CREATURE AND ALSO A SPY PLATFORM. Retrieved May 6, 2020.Lee, B. Grunzweig, J. (2015, December 22). BBSRAT Attacks Targeting Russian Organizations Linked to Roaming Tiger. Retrieved August 19, 2016.Lambert, T. (2020, May 7). Introducing Blue Mockingbird. Retrieved May 26, 2020.Harbison, M. and Renals, P. (2022, July 5). When Pentest Tools Go Brutal: Red-Teaming Tool Being Abused by Malicious Actors. Retrieved February 1, 2023.Jansen, W . (2021, January 12). Abusing cloud services to fly under the radar. Retrieved January 19, 2021.Lunghi, D. et al. (2020, February). Uncovering DRBControl. Retrieved November 12, 2021.Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.Ernesto Fernández Provecho, Pham Duy Phuc, Ciana Driscoll & Vinoo Thomas. (2023, November 21). The Continued Evolution of the DarkGate Malware-as-a-Service. Retrieved February 9, 2024.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.McKeague, B. et al. (2019, April 5). Pick-Six: Intercepting a FIN6 Intrusion, an Actor Recently Tied to Ryuk and LockerGoga Ransomware. Retrieved April 17, 2019.Quinn, J. (2019, March 25). The odd case of a Gh0stRAT variant. Retrieved July 15, 2020.Guerrero-Saade, J. (2022, February 23). HermeticWiper | New Destructive Malware Used In Cyber Attacks on Ukraine. Retrieved March 25, 2022.Thomas, W. et al. (2022, February 25). CrowdStrike Falcon Protects from New Wiper Malware Used in Ukraine Cyberattacks. Retrieved March 25, 2022.Dani, M. (2022, March 1). Ukrainian Targets Hit by HermeticWiper, New Datawiper Malware. Retrieved March 25, 2022.ESET. (2022, March 1). IsaacWiper and HermeticWizard: New wiper and worm targetingUkraine. Retrieved April 10, 2022.US-CERT. (2019, April 10). MAR-10135536-8 – North Korean Trojan: HOPLIGHT. Retrieved April 19, 2019.Fitzgerald, P. (2010, January 26). How Trojan.Hydraq Stays On Your Computer. Retrieved February 22, 2018.Falcone, R. and Lancaster, T. (2019, May 28). Emissary Panda Attacks Middle East Government Sharepoint Servers. Retrieved July 9, 2019.SecureAuth. (n.d.).  Retrieved January 15, 2019.Hromcova, Z. and Cherpanov, A. (2020, June). INVISIMOLE: THE HIDDEN PART OF THE STORY. Retrieved July 16, 2020.Smallridge, R. (2018, March 10). APT15 is alive and strong: An analysis of RoyalCli and RoyalDNS. Retrieved April 4, 2018.Magius, J., et al. (2017, July 19). Koadic. Retrieved June 18, 2018.Malik, M. (2019, June 20). LoudMiner: Cross-platform mining in cracked VST software. Retrieved May 18, 2020.SentinelLabs. (2022, September 22). Metador Technical Appendix. Retrieved April 4, 2023.Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015.Cylance. (2014, December). Operation Cleaver. Retrieved September 14, 2017.Szappanos, G., Brandt, A.. (2020, May 27). Netwalker ransomware tools give insight into threat actor. Retrieved May 27, 2020.Chiu, A. (2016, June 27). New Ransomware Variant "Nyetya" Compromises Systems Worldwide. Retrieved March 26, 2019.US-CERT. (2017, July 1). Alert (TA17-181A): Petya Ransomware. Retrieved March 15, 2019.Hromcova, Z. (2019, July). OKRUM AND KETRICAN: AN OVERVIEW OF RECENT KE3CHANG GROUP ACTIVITY. Retrieved May 6, 2020.Mercer, W. and Rascagneres, P. (2018, February 12). Olympic Destroyer Takes Aim At Winter Olympics. Retrieved March 14, 2019.Sherstobitoff, R. (2018, March 02). McAfee Uncovers Operation Honeybee, a Malicious Document Campaign Targeting Humanitarian Aid Groups. Retrieved May 16, 2018.Dantzig, M. v., Schamper, E. (2019, December 19). Operation Wocao: Shining a light on one of China’s hidden hacking groups. Retrieved October 8, 2020.Lunghi, D. and Lu, K. (2021, April 9). Iron Tiger APT Updates Toolkit With Evolved SysUpdate Malware. Retrieved November 12, 2021.Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.Sherstobitoff, R., Malhotra, A. (2018, April 24). Analyzing Operation GhostSecret: Attack Seeks to Steal Data Worldwide. Retrieved May 16, 2018.Nicolas Verdier. (n.d.). Retrieved January 29, 2018.CERT-FR. (2020, April 1). ATTACKS INVOLVING THE MESPINOZA/PYSA RANSOMWARE. Retrieved March 1, 2021.SophosLabs. (2020, May 21). Ragnar Locker ransomware deploys virtual machine to dodge security. Retrieved June 29, 2020.Symantec Security Response. (2016, September 6). Buckeye cyberespionage group shifts gaze from US to Hong Kong. Retrieved September 26, 2016.Falcone, R.. (2016, November 30). Shamoon 2: Return of the Disttrack Wiper. Retrieved January 11, 2017.Roccia, T., Saavedra-Morales, J., Beek, C.. (2018, December 19). Shamoon Attackers Employ New Tool Kit to Wipe Infected Systems. Retrieved May 29, 2020.GReAT. (2017, November 1). Silence – a new Trojan attacking financial organizations. Retrieved May 24, 2019.Group-IB. (2018, September). Silence: Moving Into the Darkside. Retrieved May 5, 2020.DHS/CISA, Cyber National Mission Force. (2020, October 1). Malware Analysis Report (MAR) MAR-10303705-1.v1 – Remote Access Trojan: SLOTHFULMEDIA. Retrieved October 2, 2020.Mercer, W. et al. (2020, June 29). PROMETHIUM extends global reach with StrongPity3 APT. Retrieved July 20, 2020.Tudorica, R. et al. (2020, June 30). StrongPity APT - Revealing Trojanized Tools, Working Hours and Infrastructure. Retrieved July 20, 2020.Cisco Talos. (2021, September 21). TinyTurla - Turla deploys new malware to keep a secret backdoor on victim machines. Retrieved December 2, 2021.Antenucci, S., Pantazopoulos, N., Sandee, M. (2020, June 23). WastedLocker: A New Ransomware Variant Developed By The Evil Corp Group. Retrieved September 14, 2021.S2W. (2022, January 18). Analysis of Destructive Malware (WhisperGate) targeting Ukraine. Retrieved March 14, 2022.Falcone, R. et al.. (2022, January 20). Threat Brief: Ongoing Russia and Ukraine Cyber Conflict. Retrieved March 10, 2022.Prakash, T. (2017, June 21). Run commands on Windows system remotely using Winexe. Retrieved January 22, 2018.Anthe, C. et al. (2016, December 14). Microsoft Security Intelligence Report Volume 21. Retrieved November 27, 2017.Microsoft. (2017, November 9). Backdoor:Win32/Wingbird.A!dha. Retrieved November 27, 2017.Novetta Threat Research Group. (2015, April 7). Winnti Analysis. Retrieved February 8, 2017.The DFIR Report. (2020, October 8). Ryuk’s Return. Retrieved October 9, 2020.The DFIR Report. (2020, October 18). Ryuk in 5 Hours. Retrieved October 19, 2020.Shilko, J., et al. (2021, October 7). FIN12: The Prolific Ransomware Intrusion Threat Actor That Has Aggressively Pursued Healthcare Targets. Retrieved June 15, 2023.Rayaprolu, A.. (2011, April 12). xCmd an Alternative to PsExec. Retrieved August 10, 2016.Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.Microsoft. (2021, July 2). Use attack surface reduction rules to prevent malware infection. Retrieved June 24, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.