MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseExfiltration Over Alternative ProtocolExfiltration Over Alternative ProtocolSub-techniques (3)IDNameT1048.001Exfiltration Over Symmetric Encrypted Non-C2 ProtocolT1048.002Exfiltration Over Asymmetric Encrypted Non-C2 ProtocolT1048.003Exfiltration Over Unencrypted Non-C2 ProtocolAdversaries may steal data by exfiltrating it over a different protocol than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server.Alternate protocols include FTP, SMTP, HTTP/S, DNS, SMB, or any other network protocol not being used as the main command and control channel. Adversaries may also opt to encrypt and/or obfuscate these alternate channels.Exfiltration Over Alternative Protocolcan be done using various common operating system utilities such asNet/SMB or FTP.[1]On macOS and Linuxcurlmay be used to invoke protocols such as HTTP/S or FTP/S to exfiltrate data from a system.[2]Many IaaS and SaaS platforms (such as Microsoft Exchange, Microsoft SharePoint, GitHub, and AWS S3) support the direct download of files, emails, source code, and other sensitive information via the web console orCloud API.ID:T1048Sub-techniques:T1048.001,T1048.002,T1048.003ⓘTactic:ExfiltrationⓘPlatforms:Google Workspace, IaaS, Linux, Network, Office 365, SaaS, Windows, macOSContributors:Alfredo Abarca; William CainVersion:1.4Created:31 May 2017Last Modified:15 April 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0677AADInternalsAADInternalscan directly download cloud user data such as OneDrive files.[3]S0482BundloreBundloreuses thecurl -s -L -ocommand to exfiltrate archived data to a URL.[2]S0631ChaesChaeshas exfiltrated its collected data from the infected machine to the C2, sometimes using the MIME protocol.[4]S0503FrameworkPOSFrameworkPOScan use DNS tunneling for exfiltration of credit card data.[5]S0203HydraqHydraqconnects to a predefined domain on port 443 to exfil gathered information.[6]S0641KobalosKobaloscan exfiltrate credentials over the network via UDP.[7]S0428PoetRATPoetRAThas used a .NET tool named dog.exe to exiltrate information over an e-mail account.[8]G0139TeamTNTTeamTNThas sent locally staged files with collected credentials to C2 servers using cURL.[9]MitigationsIDMitigationDescriptionM1057Data Loss PreventionData loss prevention can detect and block sensitive data being uploaded via web browsers.M1037Filter Network TrafficEnforce proxies and use dedicated servers for services such as DNS and only allow those systems to communicate over respective ports/protocols, instead of all systems within a network. Cloud service providers support IP-based restrictions when accessing cloud resources. Consider using IP allowlisting along with user account management to ensure that data access is restricted not only to valid users but only from expected IP ranges to mitigate the use of stolen credentials to access data.M1031Network Intrusion PreventionNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary command and control infrastructure and malware can be used to mitigate activity at the network level.M1030Network SegmentationFollow best practices for network firewall configurations to allow only necessary ports and traffic to enter and exit the network.[10]M1022Restrict File and Directory PermissionsUse access control lists on cloud storage systems and objects.M1018User Account ManagementConfigure user permissions groups and roles for access to cloud storage.[11]Implement strict Identity and Access Management (IAM) controls to prevent access to storage solutions except for the applications, users, and services that require access.[12]Ensure that temporary access tokens are issued rather than permanent credentials, especially when access is being granted to entities outside of the internal security boundary.[13]DetectionIDData SourceData ComponentDetectsDS0015Application LogApplication Log ContentMonitor cloud-based file hosting services, such as Google Drive and Microsoft OneDrive, for unusual instances of file downloads – for example, many downloads by a single user in a short period of time. In environments with high-maturity, it may be possible to leverage User-Behavioral Analytics (UBA) platforms to detect and alert on user-based anomalies. Additionally, data loss prevention policies can be defined to detect and alert on exfiltration events on particularly sensitive data.DS0010Cloud StorageCloud Storage AccessMonitor for unusual queries to the cloud provider's storage service. Activity originating from unexpected sources may indicate improper permissions are set and are allowing access to data. Additionally, detecting failed attempts by a user for a certain object, followed by escalation of privileges by the same user, and access to the same object may be an indication of suspicious activity.DS0017CommandCommand ExecutionMonitor executed commands and arguments that may steal data by exfiltrating it over a different protocol than that of the existing command and control channel.DS0022FileFile AccessMonitor for suspicious files (i.e. .pdf, .docx, .jpg, etc.) viewed in isolation that may steal data by exfiltrating it over a different protocol than that of the existing command and control channel.DS0029Network TrafficNetwork Connection CreationMonitor for newly constructed network connections that are sent or received by untrusted hosts.Network Traffic ContentMonitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).Network Traffic FlowMonitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.ReferencesGrunzweig, J. and Falcone, R.. (2016, October 4). OilRig Malware Campaign Updates Toolset and Expands Targets. Retrieved May 3, 2017.Phil Stokes. (2021, February 16). 20 Common Tools & Techniques Used by macOS Threat Actors & Malware. Retrieved August 23, 2021.Dr. Nestori Syynimaa. (2018, October 25). AADInternals. Retrieved February 18, 2022.Salem, E. (2020, November 17). CHAES: Novel Malware Targeting Latin American E-Commerce. Retrieved June 30, 2021.Kremez, V. (2019, September 19). FIN6 “FrameworkPOS”: Point-of-Sale Malware Analysis & Internals. Retrieved September 8, 2020.Lelli, A. (2010, January 11). Trojan.Hydraq. Retrieved February 20, 2018.M.Leveille, M., Sanmillan, I. (2021, February 2). Kobalos – A complex Linux threat to high performance computing infrastructure. Retrieved August 24, 2021.Mercer, W, et al. (2020, April 16). PoetRAT: Python RAT uses COVID-19 lures to target Azerbaijan public and private sectors. Retrieved April 27, 2020.Darin Smith. (2022, April 21). TeamTNT targeting AWS, Alibaba. Retrieved August 4, 2022.Microsoft. (2004, February 6). Perimeter Firewall Design. Retrieved April 25, 2016.Amlekar, M., Brooks, C., Claman, L., et. al.. (2019, March 20). Azure Storage security guide. Retrieved October 4, 2019.Amazon. (2019, May 17). How can I secure the files in my Amazon S3 bucket?. Retrieved October 4, 2019.Amazon. (n.d.). Temporary Security Credentials. Retrieved October 18, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.