MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseIndicator RemovalClear Network Connection History and ConfigurationsIndicator Removal:Clear Network Connection History and ConfigurationsOther sub-techniques of Indicator Removal (9)IDNameT1070.001Clear Windows Event LogsT1070.002Clear Linux or Mac System LogsT1070.003Clear Command HistoryT1070.004File DeletionT1070.005Network Share Connection RemovalT1070.006TimestompT1070.007Clear Network Connection History and ConfigurationsT1070.008Clear Mailbox DataT1070.009Clear PersistenceAdversaries may clear or remove evidence of malicious network connections in order to clean up traces of their operations. Configuration settings as well as various artifacts that highlight connection history may be created on a system and/or in application logs from behaviors that require network connections, such asRemote ServicesorExternal Remote Services. Defenders may use these artifacts to monitor or otherwise analyze network connections created by adversaries.Network connection history may be stored in various locations. For example, RDP connection history may be stored in Windows Registry values under[1]:HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\DefaultHKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\ServersWindows may also store information about recent RDP connections in files such asC:\Users\%username%\Documents\Default.rdpandC:\Users\%username%\AppData\Local\Microsoft\TerminalServer Client\Cache\.[2]Similarly, macOS and Linux hosts may store information highlighting connection history in system logs (such as those stored in/Library/Logsand/or/var/log/).[3][4][5]Malicious network connections may also require changes to third-party applications or network configuration settings, such asDisable or Modify System Firewallor tampering to enableProxy. Adversaries may delete or modify this data to conceal indicators and/or impede defensive analysis.ID:T1070.007Sub-technique of:T1070ⓘTactic:Defense EvasionⓘPlatforms:Linux, Network, Windows, macOSContributors:CrowdStrike Falcon OverWatchVersion:1.1Created:15 June 2022Last Modified:08 September 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0559SUNBURSTSUNBURSTalso removed the firewall rules it created during execution.[6]G1017Volt TyphoonVolt Typhoonhave inspected server logs to remove their IPs.[7]MitigationsIDMitigationDescriptionM1029Remote Data StorageAutomatically forward events to a log server or data repository to prevent conditions in which the adversary can locate and manipulate data on the local system. When possible, minimize time delay on event reporting to avoid prolonged storage on the local system.M1024Restrict Registry PermissionsProtect generated event files and logs that are stored locally with proper permissions and authentication and limit opportunities for adversaries to increase privileges by preventing Privilege Escalation opportunities.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may delete or alter malicious network configuration settings as well as generated artifacts on a host system, including logs and files such asDefault.rdpor/var/log/.DS0022FileFile ModificationMonitor changes to files that may be indicators of deleting or altering malicious network configuration settings as well as generated artifacts on a host system that highlight network connection history, such asDefault.rdpor/var/log/.DS0018FirewallFirewall Rule ModificationMonitor for changes made to firewall rules, especially unexpected modifications that may potentially be related to allowing and/or cleaning up previous tampering that enabled malicious network traffic.DS0009ProcessProcess CreationMonitor created processes with arguments that may delete or alter malicious network configuration settings as well as generated artifacts that highlight network connection history on a host system -- which may include logs, files, or Registry values.DS0024Windows RegistryWindows Registry Key ModificationMonitor for changes to Registry keys (ex:HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default) and associated values that may be malicious attempts to conceal adversary network connection history.ReferencesMicrosoft. (2021, September 24). How to remove entries from the Remote Desktop Connection Computer box. Retrieved June 15, 2022.Moran, B. (2020, November 18). Putting Together the RDPieces. Retrieved October 17, 2022.rjben. (2012, May 30). How do you find the culprit when unauthorized access to a computer is a problem?. Retrieved August 3, 2022.freedesktop.org. (n.d.). systemd-journald.service. Retrieved June 15, 2022.Sarah Edwards. (2020, April 30). Analysis of Apple Unified Logs: Quarantine Edition [Entry 6] – Working From Home? Remote Logins. Retrieved August 19, 2021.MSTIC, CDOC, 365 Defender Research Team. (2021, January 20). Deep dive into the Solorigate second-stage activation: From SUNBURST to TEARDROP and Raindrop . Retrieved January 22, 2021.Counter Threat Unit Research Team. (2023, May 24). Chinese Cyberespionage Group BRONZE SILHOUETTE Targets U.S. Government and Defense Organizations. Retrieved July 27, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.