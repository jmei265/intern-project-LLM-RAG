MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseRemote ServicesRemote Desktop ProtocolRemote Services:Remote Desktop ProtocolOther sub-techniques of Remote Services (8)IDNameT1021.001Remote Desktop ProtocolT1021.002SMB/Windows Admin SharesT1021.003Distributed Component Object ModelT1021.004SSHT1021.005VNCT1021.006Windows Remote ManagementT1021.007Cloud ServicesT1021.008Direct Cloud VM ConnectionsAdversaries may useValid Accountsto log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).[1]Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with theAccessibility FeaturesorTerminal Services DLLfor Persistence.[2]ID:T1021.001Sub-technique of:T1021ⓘTactic:Lateral MovementⓘPlatforms:WindowsⓘSystem Requirements:RDP service enabled, account in the Remote Desktop Users groupContributors:Matthew Demaske, AdaptforwardVersion:1.2Created:11 February 2020Last Modified:07 August 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0006APT1TheAPT1group is known to have used RDP during operations.[3]G0022APT3APT3enables the Remote Desktop Protocol for persistence.[4]APT3has also interacted with compromised systems to browse and copy files through RDP sessions.[5]G0087APT39APT39has been seen using RDP for lateral movement and persistence, in some cases employing the rdpwinst tool for mangement of multiple sessions.[6][7]G0096APT41APT41used RDP for lateral movement.[8][9]G1023APT5APT5has moved laterally throughout victim environments using RDP.[10]G0001AxiomAxiomhas used RDP during operations.[11]G0108Blue MockingbirdBlue Mockingbirdhas used Remote Desktop to log on to servers interactively and manually copy files to remote hosts.[12]C0015C0015DuringC0015, the threat actors used RDP to access specific network hosts of interest.[13]C0018C0018DuringC0018, the threat actors opened a variety of ports to establish RDP connections, including ports 28035, 32467, 41578, and 46892.[14]C0032C0032During theC0032campaign,TEMP.Velesutilized RDP throughout an operation.[15]S0030CarbanakCarbanakenables concurrent Remote Desktop Protocol (RDP) sessions.[16]G0114ChimeraChimerahas used RDP to access targeted systems.[17]G0080Cobalt GroupCobalt Grouphas used Remote Desktop Protocol to conduct lateral movement.[18]S0154Cobalt StrikeCobalt Strikecan start a VNC-based remote desktop server and tunnel the connection through the already established C2 channel.[19][20]C0029Cutting EdgeDuringCutting Edge, threat actors used RDP with compromised credentials for lateral movement.[21]S0334DarkCometDarkCometcan open an active screen of the victim’s machine and take control of the mouse and keyboard.[22]G0035DragonflyDragonflyhas moved laterally via RDP.[23]G0051FIN10FIN10has used RDP to move laterally to systems in the victim environment.[24]G1016FIN13FIN13has remotely accessed compromised environments via Remote Desktop Services (RDS) for lateral movement.[25]G0037FIN6FIN6used RDP to move laterally in victim networks.[26][27]G0046FIN7FIN7has used RDP to move laterally in victim environments.[28]G0061FIN8FIN8has used RDP for lateral movement.[29]G0117Fox KittenFox Kittenhas used RDP to log in and move laterally in the target environment.[30][31]G1001HEXANEHEXANEhas used remote desktop sessions for lateral movement.[32]S0434Imminent MonitorImminent Monitorhas a module for performing remote desktop access.[33]S0283jRATjRATcan support RDP control.[34]G0094KimsukyKimsukyhas used RDP for direct remote point-and-click access.[35]S0250KoadicKoadiccan enable remote desktop on the victim's machine.[36]G0032Lazarus GroupLazarus Groupmalware SierraCharlie uses RDP for propagation.[37][38]G0065LeviathanLeviathanhas targeted RDP credentials and used it to move through the victim environment.[39]G0059Magic HoundMagic Houndhas used Remote Desktop Services to copy tools on targeted systems.[40][41]G0045menuPassmenuPasshas used RDP connections to move across the victim network.[42][43]S0385njRATnjRAThas a module for performing remote desktop access.[44]G0049OilRigOilRighas used Remote Desktop Protocol for lateral movement. The group has also used tunneling tools to tunnel RDP into the environment.[45][46][9]G0040PatchworkPatchworkattempted to use RDP to move laterally.[47]S0192PupyPupycan enable/disable RDP connection and can start a remote desktop session using a browser web socket client.[48]S0583PysaPysahas laterally moved using RDP connections.[49]S0262QuasarRATQuasarRAThas a module for performing remote desktop access.[50][51]S0379Revenge RATRevenge RAThas a plugin to perform RDP access.[52]S0461SDBbotSDBbothas the ability to use RDP to connect to victim's machines.[53]S0382ServHelperServHelperhas commands for adding a remote desktop user and sending RDP traffic to the attacker through a reverse SSH tunnel.[54]G0091SilenceSilencehas used RDP for lateral movement.[55]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29used RDP sessions from public-facing systems to internal servers.[56]S0670WarzoneRATWarzoneRAThas the ability to control an infected PC using RDP.[57]G0102Wizard SpiderWizard Spiderhas used RDP for lateral movement and to deploy ransomware interactively.[58][59][60][61]S0350zwShellzwShellhas used RDP for lateral movement.[62]S0412ZxShellZxShellhas remote desktop functionality.[63]MitigationsIDMitigationDescriptionM1047AuditAudit the Remote Desktop Users group membership regularly. Remove unnecessary accounts and groups from Remote Desktop Users groups.M1042Disable or Remove Feature or ProgramDisable the RDP service if it is unnecessary.M1035Limit Access to Resource Over NetworkUse remote desktop gateways.M1032Multi-factor AuthenticationUse multi-factor authentication for remote logins.[64]M1030Network SegmentationDo not leave RDP accessible from the internet. Enable firewall rules to block RDP traffic between network security zones within a network.M1028Operating System ConfigurationChange GPOs to define shorter timeouts sessions and maximum amount of time any single session can be active. Change GPOs to specify the maximum amount of time that a disconnected session stays active on the RD session host server.[65]M1026Privileged Account ManagementConsider removing the local Administrators group from the list of groups allowed to log in through RDP.M1018User Account ManagementLimit remote user permissions if remote access is necessary.DetectionIDData SourceData ComponentDetectsDS0028Logon SessionLogon Session CreationMonitor for user accounts logged into systems associated with RDP (ex: Windows EID 4624 Logon Type 10). Other factors, such as access patterns (ex: multiple systems over a relatively short period of time) and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP.Monitoring logon and logoff events for hosts on the network is very important for situational awareness. This information can be used as an indicator of unusual activity as well as to corroborate activity seen elsewhere.Could be applied to a number of different types of monitoring depending on what information is desired. Some use cases include monitoring for all remote connections and building login timelines for users. Logon events are Windows Event Code 4624 for Windows Vista and above, 518 for pre-Vista. Logoff events are 4634 for Windows Vista and above, 538 for pre-Vista.Note: This analytic looks for user logon events and filters out the top 30 account names to reduce the occurrence of noisy service accounts and the like. It is meant as a starting point for situational awareness around such events. This is liable to be quite noisy and will need tweaking, especially in terms of the number of top users filtered out.Analytic 1source="*WinEventLog:Security" EventCode IN (4624, 4634, 4647, 4778)|search user NOT IN top limit=30Logon Session MetadataMonitor authentication logs and analyze for unusual access patterns. A remote desktop logon, through RDP, may be typical of a system administrator or IT support, but only from select workstations. Monitoring remote desktop logons and comparing to known/approved originating systems can detect lateral movement of an adversary.Analytic 1source="WinEventLog:Security" EventCode="4624" AND LogonType="10" AND AuthenticationPackageName="Negotiate" AND TargetUserName="Admin")DS0029Network TrafficNetwork Connection CreationMonitor for newly constructed network connections (typically over port 3389) that may useValid Accountsto log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP.Network Traffic FlowMonitor network traffic for uncommon data flows that may useValid Accountsto log into a computer using the Remote Desktop Protocol (RDP).The Remote Desktop Protocol (RDP), built in to Microsoft operating systems, allows a user to remotely log in to the desktop of another host. It allows for interactive access of the running windows, and forwards key presses, mouse clicks, etc. Network administrators, power users, and end-users may use RDP for day-to-day operations. From an adversary’s perspective, RDP provides a means to laterally move to a new host. Determining which RDP connections correspond to adversary activity can be a difficult problem in highly dynamic environments, but will be useful in identifying the scope of a compromise.Remote Desktop can be detected in several waysNetwork connections to port 3389/tcp (assuming use of the default port)Packet capture analysisDetecting network connections frommstsc.exeExecution of the processrdpclip.exeRuns as the clipboard manager on the RDP target if clipboard sharing is enabledAnalytic 1source="Zeek:" AND (port="3389") AND LogonType="10"DS0009ProcessProcess CreationMonitor for newly executed processes (such asmstsc.exe) that may useValid Accountsto log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions that spawn additional processes as the logged-on user.ReferencesMicrosoft. (n.d.). Remote Desktop Services. Retrieved June 1, 2016.Alperovitch, D. (2014, October 31). Malware-Free Intrusions. Retrieved November 4, 2014.FireEye Labs. (2014, May 20). The PLA and the 8:00am-5:00pm Work Day: FireEye Confirms DOJ’s Findings on APT1 Intrusion Activity. Retrieved November 4, 2014.valsmith. (2012, September 21). More on APTSim. Retrieved September 28, 2017.Glyer, C. (2018, April 14). @cglyer Status Update. Retrieved October 11, 2018.Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019.Rusu, B. (2020, May 21). Iranian Chafer APT Targeted Air Transportation and Government in Kuwait and Saudi Arabia. Retrieved May 22, 2020.Fraser, N., et al. (2019, August 7). Double DragonAPT41, a dual espionage and cyber crime operation APT41. Retrieved September 23, 2019.Crowdstrike. (2020, March 2). 2020 Global Threat Report. Retrieved December 11, 2020.Perez, D. et al. (2021, May 27). Re-Checking Your Pulse: Updates on Chinese APT Actors Compromising Pulse Secure VPN Devices. Retrieved February 5, 2024.Novetta. (n.d.). Operation SMN: Axiom Threat Actor Group Report. Retrieved November 12, 2014.Lambert, T. (2020, May 7). Introducing Blue Mockingbird. Retrieved May 26, 2020.DFIR Report. (2021, November 29). CONTInuing the Bazar Ransomware Story. Retrieved September 29, 2022.Costa, F. (2022, May 1). RaaS AvosLocker Incident Response Analysis. Retrieved January 11, 2023.Miller, S, et al. (2019, April 10). TRITON Actor TTP Profile, Custom Attack Tools, Detections, and ATT&CK Mapping. Retrieved April 16, 2019.Bennett, J., Vengerik, B. (2017, June 12). Behind the CARBANAK Backdoor. Retrieved June 11, 2018.Cycraft. (2020, April 15). APT Group Chimera - APT Operation Skeleton key Targets Taiwan Semiconductor Vendors. Retrieved August 24, 2020.Matveeva, V. (2017, August 15). Secrets of Cobalt. Retrieved October 10, 2018.Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.Cybereason. (2022, August 17). Bumblebee Loader – The High Road to Enterprise Domain Control. Retrieved August 29, 2022.Meltzer, M. et al. (2024, January 10). Active Exploitation of Two Zero-Day Vulnerabilities in Ivanti Connect Secure VPN. Retrieved February 27, 2024.Kujawa, A. (2018, March 27). You dirty RAT! Part 1: DarkComet. Retrieved November 6, 2018.US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.FireEye iSIGHT Intelligence. (2017, June 16). FIN10: Anatomy of a Cyber Extortion Operation. Retrieved June 25, 2017.Ta, V., et al. (2022, August 8). FIN13: A Cybercriminal Threat Actor Focused on Mexico. Retrieved February 9, 2023.FireEye Threat Intelligence. (2016, April). Follow the Money: Dissecting the Operations of the Cyber Crime Group FIN6. Retrieved June 1, 2016.McKeague, B. et al. (2019, April 5). Pick-Six: Intercepting a FIN6 Intrusion, an Actor Recently Tied to Ryuk and LockerGoga Ransomware. Retrieved April 17, 2019.Loui, E. and Reynolds, J. (2021, August 30). CARBON SPIDER Embraces Big Game Hunting, Part 1. Retrieved September 20, 2021.Elovitz, S. & Ahl, I. (2016, August 18). Know Your Enemy:  New Financially-Motivated & Spear-Phishing Group. Retrieved February 26, 2018.CISA. (2020, September 15). Iran-Based Threat Actor Exploits VPN Vulnerabilities. Retrieved December 21, 2020.ClearSky. (2020, December 17). Pay2Key Ransomware – A New Campaign by Fox Kitten. Retrieved December 21, 2020.SecureWorks 2019, August 27 LYCEUM Takes Center Stage in Middle East Campaign Retrieved. 2019/11/19QiAnXin Threat Intelligence Center. (2019, February 18). APT-C-36: Continuous Attacks Targeting Colombian Government Institutions and Corporations. Retrieved May 5, 2020.Kamluk, V. & Gostev, A. (2016, February). Adwind - A Cross-Platform RAT. Retrieved April 23, 2019.ASERT team. (2018, December 5). STOLEN PENCIL Campaign Targets Academia. Retrieved February 5, 2019.Magius, J., et al. (2017, July 19). Koadic. Retrieved June 18, 2018.Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February 25, 2016.Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Remote Administration Tools & Content Staging Malware Report. Retrieved March 16, 2016.Plan, F., et al. (2019, March 4). APT40: Examining a China-Nexus Espionage Actor. Retrieved March 18, 2019.DFIR Report. (2022, March 21). APT35 Automates Initial Access Using ProxyShell. Retrieved May 25, 2022.DFIR Report. (2021, November 15). Exchange Exploit Leads to Domain Wide Ransomware. Retrieved January 5, 2023.PwC and BAE Systems. (2017, April). Operation Cloud Hopper. Retrieved April 5, 2017.US District Court Southern District of New York. (2018, December 17). United States v. Zhu Hua Indictment. Retrieved December 17, 2020.Fidelis Cybersecurity. (2013, June 28). Fidelis Threat Advisory #1009: "njRAT" Uncovered. Retrieved June 4, 2019.Unit42. (2016, May 1). Evasive Serpens Unit 42 Playbook Viewer. Retrieved February 6, 2023.Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.Cymmetria. (2016). Unveiling Patchwork - The Copy-Paste APT. Retrieved August 3, 2016.Nicolas Verdier. (n.d.). Retrieved January 29, 2018.CERT-FR. (2020, April 1). ATTACKS INVOLVING THE MESPINOZA/PYSA RANSOMWARE. Retrieved March 1, 2021.MaxXor. (n.d.). QuasarRAT. Retrieved July 10, 2018.Meltzer, M, et al. (2018, June 07). Patchwork APT Group Targets US Think Tanks. Retrieved July 16, 2018.Livelli, K, et al. (2018, November 12). Operation Shaheen. Retrieved May 1, 2019.Schwarz, D. et al. (2019, October 16). TA505 Distributes New SDBbot Remote Access Trojan with Get2 Downloader. Retrieved May 29, 2020.Schwarz, D. and Proofpoint Staff. (2019, January 9). ServHelper and FlawedGrace - New malware introduced by TA505. Retrieved May 28, 2019.Group-IB. (2018, September). Silence: Moving Into the Darkside. Retrieved May 5, 2020.CrowdStrike. (2022, January 27). Early Bird Catches the Wormhole: Observations from the StellarParticle Campaign. Retrieved February 7, 2022.Harakhavik, Y. (2020, February 3). Warzone: Behind the enemy lines. Retrieved December 17, 2021.John, E. and Carvey, H. (2019, May 30). Unraveling the Spiderweb: Timelining ATT&CK Artifacts Used by GRIM SPIDER. Retrieved May 12, 2020.DHS/CISA. (2020, October 28). Ransomware Activity Targeting the Healthcare and Public Health Sector. Retrieved October 28, 2020.The DFIR Report. (2020, November 5). Ryuk Speed Run, 2 Hours to Ransom. Retrieved November 6, 2020.Shilko, J., et al. (2021, October 7). FIN12: The Prolific Ransomware Intrusion Threat Actor That Has Aggressively Pursued Healthcare Targets. Retrieved June 15, 2023.McAfee® Foundstone® Professional Services and McAfee Labs™. (2011, February 10). Global Energy Cyberattacks: “Night Dragon”. Retrieved February 19, 2018.Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.Berkeley Security, University of California. (n.d.). Securing Remote Desktop for System Administrators. Retrieved November 4, 2014.Microsoft. (n.d.). Configure Timeout and Reconnection Settings for Remote Desktop Services Sessions. Retrieved December 11, 2017.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.