MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseAccount ManipulationAccount ManipulationSub-techniques (6)IDNameT1098.001Additional Cloud CredentialsT1098.002Additional Email Delegate PermissionsT1098.003Additional Cloud RolesT1098.004SSH Authorized KeysT1098.005Device RegistrationT1098.006Additional Container Cluster RolesAdversaries may manipulate accounts to maintain and/or elevate access to victim systems. Account manipulation may consist of any action that preserves or modifies adversary access to a compromised account, such as modifying credentials or permission groups.[1]These actions could also include account activity designed to subvert security policies, such as performing iterative password updates to bypass password duration policies and preserve the life of compromised credentials.In order to create or manipulate accounts, the adversary must already have sufficient permissions on systems or the domain. However, account manipulation may also lead to privilege escalation where modifications grant access to additional roles, permissions, or higher-privilegedValid Accounts.ID:T1098Sub-techniques:T1098.001,T1098.002,T1098.003,T1098.004,T1098.005,T1098.006ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:Azure AD, Containers, Google Workspace, IaaS, Linux, Network, Office 365, SaaS, Windows, macOSContributors:Arad Inbar, Fidelis Security; Jannie Li, Microsoft Threat Intelligence Center (MSTIC); Praetorian; Tim MalcomVetter; Wojciech LesickiVersion:2.6Created:31 May 2017Last Modified:16 January 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionC00252016 Ukraine Electric Power AttackDuring the2016 Ukraine Electric Power Attack,Sandworm Teamused thesp_addlinkedsrvlogincommand in MS-SQL to create a link between a created account and other servers in the network.[2]G0022APT3APT3has been known to add created accounts to local admin groups to maintain elevated access.[3]G0096APT41APT41has added user accounts to the User and Admin groups.[4]G1023APT5APT5has created their own accounts with Local Administrator privileges to maintain access to systems with short-cycle credential rotation.[5]S0274CalistoCalistoadds permissions and remote logins to all users.[6]S1111DarkGateDarkGateelevates accounts created through the malware to the local administration group during execution.[7]G0035DragonflyDragonflyhas added newly created accounts to the administrators group to maintain elevated access.[8]G1016FIN13FIN13has assigned newly created accounts the sysadmin role to maintain persistence.[9]G0125HAFNIUMHAFNIUMhas granted privileges to domain accounts.[10]G0094KimsukyKimsukyhas added accounts to specific groups withnet localgroup.[11]G0032Lazarus GroupLazarus Groupmalware WhiskeyDelta-Two contains a function that attempts to rename the administrator’s account.[12][13]G0059Magic HoundMagic Houndhas added a user named DefaultAccount to the Administrators and Remote Desktop Users groups.[14]S0002MimikatzTheMimikatzcredential dumper has been extended to include Skeleton Key domain controller authentication bypass functionality. TheLSADUMP::ChangeNTLMandLSADUMP::SetNTLMmodules can also manipulate the password hash of an account without knowing the clear text value.[15][16]S0382ServHelperServHelperhas added a user named "supportaccount" to the Remote Desktop Users and Administrators groups.[17]S0649SMOKEDHAMSMOKEDHAMhas added user accounts to local Admin groups.[1]MitigationsIDMitigationDescriptionM1032Multi-factor AuthenticationUse multi-factor authentication for user and privileged accounts.M1030Network SegmentationConfigure access controls and firewalls to limit access to critical systems and domain controllers. Most cloud environments support separate virtual private cloud (VPC) instances that enable further segmentation of cloud systems.M1028Operating System ConfigurationProtect domain controllers by ensuring proper security configuration for critical servers to limit access by potentially unnecessary protocols and services, such as SMB file sharing.M1026Privileged Account ManagementDo not allow domain administrator accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems.M1018User Account ManagementEnsure that low-privileged user accounts do not have permissions to modify accounts or account-related policies.DetectionIDData SourceData ComponentDetectsDS0026Active DirectoryActive Directory Object ModificationMonitor for the registration or joining of new device objects in Active Directory. Raise alerts when new devices are registered or joined without using MFA.[18]DS0017CommandCommand ExecutionMonitor executed commands and arguments for suspicious commands to modify accounts or account settings (including files such as theauthorized_keysor/etc/ssh/sshd_config).Monitor executed commands and arguments of suspicious commands (such asAdd-MailboxPermission) that may be indicative of modifying the permissions of Exchange and other related service settings.DS0022FileFile ModificationMonitor for changes made to files related to account settings, such as/etc/ssh/sshd_configand the authorized_keys file for each user on a system.DS0036GroupGroup ModificationMonitor events for changes to account objects and/or permissions on systems and the domain, such as event IDs 4738, 4728 and 4670.DS0009ProcessProcess CreationMonitor for newly constructed processes indicative of modifying account settings, such as those that modifyauthorized_keysor/etc/ssh/sshd_configfiles.DS0002User AccountUser Account ModificationMonitor events for changes to account objects and/or permissions on systems and the domain, such as event IDs 4738, 4728 and 4670. Monitor for modification of accounts in correlation with other suspicious activity. Changes may occur at unusual times or from unusual systems. Especially flag events where the subject and target accounts differ or that include additional flags such as changing a password without knowledge of the old password.Monitor for unusual permissions changes that may indicate excessively broad permissions being granted to compromised accounts.ReferencesFireEye. (2021, June 16). Smoking Out a DARKSIDE Affiliate’s Supply Chain Software Compromise. Retrieved September 22, 2021.Joe Slowik. (2018, October 12). Anatomy of an Attack: Detecting and Defeating CRASHOVERRIDE. Retrieved December 18, 2020.valsmith. (2012, September 21). More on APTSim. Retrieved September 28, 2017.Fraser, N., et al. (2019, August 7). Double DragonAPT41, a dual espionage and cyber crime operation APT41. Retrieved September 23, 2019.Perez, D. et al. (2021, May 27). Re-Checking Your Pulse: Updates on Chinese APT Actors Compromising Pulse Secure VPN Devices. Retrieved February 5, 2024.Pantig, J. (2018, July 30). OSX.Calisto. Retrieved September 7, 2018.Adi Zeligson & Rotem Kerner. (2018, November 13). Enter The DarkGate - New Cryptocurrency Mining and Ransomware Campaign. Retrieved February 9, 2024.US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.Sygnia Incident Response Team. (2022, January 5). TG2003: ELEPHANT BEETLE UNCOVERING AN ORGANIZED FINANCIAL-THEFT OPERATION. Retrieved February 9, 2023.Gruzweig, J. et al. (2021, March 2). Operation Exchange Marauder: Active Exploitation of Multiple Zero-Day Microsoft Exchange Vulnerabilities. Retrieved March 3, 2021.KISA. (n.d.). Phishing Target Reconnaissance and Attack Resource Analysis Operation Muzabi. Retrieved March 7, 2022.Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February 25, 2016.Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Destructive Malware Report. Retrieved March 2, 2016.DFIR Report. (2022, March 21). APT35 Automates Initial Access Using ProxyShell. Retrieved May 25, 2022.Metcalf, S. (2015, November 13). Unofficial Guide to Mimikatz & Command Reference. Retrieved December 23, 2015.Metcalf, S. (2015, January 19). Attackers Can Now Use Mimikatz to Implant Skeleton Key on Domain Controllers & BackDoor Your Active Directory Forest. Retrieved February 3, 2015.Schwarz, D. and Proofpoint Staff. (2019, January 9). ServHelper and FlawedGrace - New malware introduced by TA505. Retrieved May 28, 2019.Microsoft. (2020, September 16). Azure Active Directory security operations for devices. Retrieved February 21, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.