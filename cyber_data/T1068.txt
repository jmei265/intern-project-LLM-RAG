MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseExploitation for Privilege EscalationExploitation for Privilege EscalationAdversaries may exploit software vulnerabilities in an attempt to elevate privileges. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Security constructs such as permission levels will often hinder access to information and use of certain techniques, so adversaries will likely need to perform privilege escalation to include use of software exploitation to circumvent those restrictions.When initially gaining access to a system, an adversary may be operating within a lower privileged process which will prevent them from accessing certain resources on the system. Vulnerabilities may exist, usually in operating system components and software commonly running at higher permissions, that can be exploited to gain higher levels of access on the system. This could enable someone to move from unprivileged or user level permissions to SYSTEM or root permissions depending on the component that is vulnerable. This could also enable an adversary to move from a virtualized environment, such as within a virtual machine or container, onto the underlying host. This may be a necessary step for an adversary compromising an endpoint system that has been properly configured and limits other privilege escalation methods.Adversaries may bring a signed vulnerable driver onto a compromised machine so that they can exploit the vulnerability to execute code in kernel mode. This process is sometimes referred to as Bring Your Own Vulnerable Driver (BYOVD).[1][2]Adversaries may include the vulnerable driver with files delivered during Initial Access or download it to a compromised system viaIngress Tool TransferorLateral Tool Transfer.ID:T1068Sub-techniques:No sub-techniquesⓘTactic:Privilege EscalationⓘPlatforms:Containers, Linux, Windows, macOSⓘPermissions Required:UserⓘEffective Permissions:UserContributors:David Tayouri; Idan Revivo, @idanr86, Team Nautilus Aqua Security; Joas Antonio dos Santos, @C0d3Cr4zy, Inmetrics; Yaniv Agman, @AgmanYaniv, Team Nautilus Aqua SecurityVersion:1.5Created:31 May 2017Last Modified:07 April 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0007APT28APT28has exploited CVE-2014-4076, CVE-2015-2387, CVE-2015-1701, CVE-2017-0263 to escalate privileges.[3][4][5]G0016APT29APT29has exploited CVE-2021-36934 to escalate privileges on a compromised host.[6]G0050APT32APT32has used CVE-2016-7255 to escalate privileges.[7]G0064APT33APT33has used a publicly available exploit for CVE-2017-0213 to escalate privileges on a local system.[8]G1002BITTERBITTERhas exploited CVE-2021-1732 for privilege escalation.[9][10]C0017C0017DuringC0017,APT41abused named pipe impersonation for privilege escalation.[11]S0484CarberpCarberphas exploited multiple Windows vulnerabilities (CVE-2010-2743, CVE-2010-3338, CVE-2010-4398, CVE-2008-1084) and a .NET Runtime Optimization vulnerability for privilege escalation.[12][13]G0080Cobalt GroupCobalt Grouphas used exploits to increase their levels of rights and privileges.[14]S0154Cobalt StrikeCobalt Strikecan exploit vulnerabilities such as MS14-058.[15][16]S0050CosmicDukeCosmicDukeattempts to exploit privilege escalation vulnerabilities CVE-2010-0232 or CVE-2010-4398.[17]S0363EmpireEmpirecan exploit vulnerabilities such as MS16-032 and MS16-135.[18]G0037FIN6FIN6has used tools to exploit Windows vulnerabilities in order to escalate privileges. The tools targeted CVE-2013-3660, CVE-2011-2005, and CVE-2010-4398, all of which could allow local users to access kernel-level privileges.[19]G0061FIN8FIN8has exploited the CVE-2016-0167 local vulnerability.[20][21]S0601HildegardHildegardhas used the BOtB tool which exploits CVE-2019-5736.[22]S0260InvisiMoleInvisiMolehas exploited CVE-2007-5633 vulnerability in the speedfan.sys driver to obtain kernel mode privileges.[1]S0044JHUHUGITJHUHUGIThas exploited CVE-2015-1701 and CVE-2015-2387 to escalate privileges.[23][24]G1004LAPSUS$LAPSUS$has exploited unpatched vulnerabilities on internally accessible servers including JIRA, GitLab, and Confluence for privilege escalation.[25]G1019MoustachedBouncerMoustachedBouncerhas exploited CVE-2021-1732 to execute malware components with elevated rights.[26]S0664PandoraPandoracan use CVE-2017-15303 to bypass Windows Driver Signature Enforcement (DSE) protection and load its driver.[27]G0068PLATINUMPLATINUMhas leveraged a zero-day vulnerability to escalate privileges.[28]S0378PoshC2PoshC2contains modules for local privilege escalation exploits such as CVE-2016-9192 and CVE-2016-0099.[29]S0654ProLockProLockcan use CVE-2019-0859 to escalate privileges on a compromised host.[30]S0125RemsecRemsechas a plugin to drop and execute vulnerable Outpost Sandbox or avast! Virtualization drivers in order to gain kernel mode privileges.[31]G1015Scattered SpiderScattered Spiderhas deployed a malicious kernel driver through exploitation of CVE-2015-2291 in the Intel Ethernet diagnostics driver for Windows (iqvw64.sys).[32]S0623SiloscapeSiloscapehas leveraged a vulnerability in Windows containers to perform anEscape to Host.[33]S0603StuxnetStuxnetused MS10-073 and an undisclosed Task Scheduler vulnerability to escalate privileges on local Windows machines.[34]G0027Threat Group-3390Threat Group-3390has used CVE-2014-6324 and CVE-2017-0213 to escalate privileges.[35][36]G0131Tonto TeamTonto Teamhas exploited CVE-2019-0803 and MS16-032 to escalate privileges.[37]G0010TurlaTurlahas exploited vulnerabilities in the VBoxDrv.sys driver to obtain kernel mode privileges.[2]G0107WhiteflyWhiteflyhas used an open-source tool to exploit a known Windows privilege escalation vulnerability (CVE-2016-0051) on unpatched computers.[38]S0176WingbirdWingbirdexploits CVE-2016-4117 to allow an executable to gain escalated privileges.[39]S0658XCSSETXCSSEThas used a zero-day exploit in the ssh launchdaemon to elevate privileges and bypass SIP.[40]G0128ZIRCONIUMZIRCONIUMhas exploited CVE-2017-0005 for local privilege escalation.[41]S0672ZoxZoxhas the ability to leverage local and remote exploits to escalate privileges.[42]MitigationsIDMitigationDescriptionM1048Application Isolation and SandboxingMake it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. Risks of additional exploits and weaknesses in these systems may still exist.[43]M1038Execution PreventionConsider blocking the execution of known vulnerable drivers that adversaries may exploit to execute code in kernel mode. Validate driver block rules in audit mode to ensure stability prior to production deployment.[44]M1050Exploit ProtectionSecurity applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior.[45]Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring.[46]Many of these protections depend on the architecture and target application binary for compatibility and may not work for software components targeted for privilege escalation.M1019Threat Intelligence ProgramDevelop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization.M1051Update SoftwareUpdate software regularly by employing patch management for internal enterprise endpoints and servers.DetectionIDData SourceData ComponentDetectsDS0027DriverDriver LoadDetecting software exploitation may be difficult depending on the tools available. Software exploits may not always succeed or may cause the exploited process to become unstable or crash. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of the processes. This could include suspicious files written to disk, evidence ofProcess Injectionfor attempts to hide execution or evidence of Discovery. Consider monitoring for the presence or loading (ex: Sysmon Event ID 6) of known vulnerable drivers that adversaries may drop and exploit to execute code in kernel mode.[44]Higher privileges are often necessary to perform additional actions such as some methods ofOS Credential Dumping. Look for additional activity that may indicate an adversary has gained higher privileges.DS0009ProcessProcess CreationMonitor for newly executed processes that may exploit software vulnerabilities in an attempt to elevate privileges. After gaining initial access to a system, threat actors attempt to escalate privileges as they may be operating within a lower privileged process which does not allow them to access protected information or carry out tasks which require higher permissions. A common way of escalating privileges in a system is by externally invoking and exploiting spoolsv or connhost executables, both of which are legitimate Windows applications. This query searches for an invocation of either of these executables by a user, thus alerting us of any potentially malicious activity.Note: Event IDs are for Sysmon (Event ID 1 - process create) and Windows Security Log (Event ID 4688 - a new process has been created). The Analytic is oriented around looking for an invocation of either spoolsv.exe or conhost.exe by a user, thus alerting us of any potentially malicious activity. A common way of escalating privileges in a system is by externally invoking and exploiting these executables, both of which are legitimate Windows applications.Analytic 1 - Unusual Child Process for spoolsv.exe or connhost.exe(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") (Image="C:\Windows\System32\spoolsv.exe" OR Image="C:\Windows\System32\conhost.exe") AND ParentImage= "C:\Windows\System32\cmd.exe")ReferencesHromcova, Z. and Cherpanov, A. (2020, June). INVISIMOLE: THE HIDDEN PART OF THE STORY. Retrieved July 16, 2020.Reichel, D. and Idrizovic, E. (2020, June 17). AcidBox: Rare Malware Repurposing Turla Group Exploit Targeted Russian Organizations. Retrieved March 16, 2021.Bitdefender. (2015, December). APT28 Under the Scope. Retrieved February 23, 2017.Anthe, C. et al. (2015, October 19). Microsoft Security Intelligence Report Volume 19. Retrieved December 23, 2015.Kaspersky Lab's Global Research & Analysis Team. (2018, February 20). A Slice of 2017 Sofacy Activity. Retrieved November 27, 2018.ESET. (2022, February). THREAT REPORT T3 2021. Retrieved February 10, 2022.Carr, N.. (2017, May 14). Cyber Espionage is Alive and Well: APT32 and the Threat to Global Corporations. Retrieved June 18, 2017.Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019.JinQuan, MaDongZe, TuXiaoYi, and LiHao. (2021, February 10). Windows kernel zero-day exploit (CVE-2021-1732) is used by BITTER APT in targeted attack. Retrieved June 1, 2022.Microsoft. (2018, February 9). Windows Win32k Elevation of Privilege Vulnerability CVE-2021-1732. Retrieved June 1, 2022.Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.Matrosov, A., Rodionov, E., Volkov, D., Harley, D. (2012, March 2). Win32/Carberp When You’re in a Black Hole, Stop Digging. Retrieved July 15, 2020.Giuliani, M., Allievi, A. (2011, February 28). Carberp - a modular information stealing trojan. Retrieved July 15, 2020.Matveeva, V. (2017, August 15). Secrets of Cobalt. Retrieved October 10, 2018.Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.F-Secure Labs. (2015, September 17). The Dukes: 7 years of Russian cyberespionage. Retrieved December 10, 2015.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.FireEye Threat Intelligence. (2016, April). Follow the Money: Dissecting the Operations of the Cyber Crime Group FIN6. Retrieved June 1, 2016.Kizhakkinan, D., et al. (2016, May 11). Threat Actor Leverages Windows Zero-day Exploit in Payment Card Data Attacks. Retrieved February 12, 2018.Elovitz, S. & Ahl, I. (2016, August 18). Know Your Enemy:  New Financially-Motivated & Spear-Phishing Group. Retrieved February 26, 2018.Chen, J. et al. (2021, February 3). Hildegard: New TeamTNT Cryptojacking Malware Targeting Kubernetes. Retrieved April 5, 2021.ESET. (2016, October). En Route with Sednit - Part 1: Approaching the Target. Retrieved November 8, 2016.ESET Research. (2015, July 10). Sednit APT Group Meets Hacking Team. Retrieved March 1, 2017.MSTIC, DART, M365 Defender. (2022, March 24). DEV-0537 Criminal Actor Targeting Organizations for Data Exfiltration and Destruction. Retrieved May 17, 2022.Faou, M. (2023, August 10). MoustachedBouncer: Espionage against foreign diplomats in Belarus. Retrieved September 25, 2023.Lunghi, D. and Lu, K. (2021, April 9). Iron Tiger APT Updates Toolkit With Evolved SysUpdate Malware. Retrieved November 12, 2021.Windows Defender Advanced Threat Hunting Team. (2016, April 29). PLATINUM: Targeted attacks in South and Southeast Asia. Retrieved February 15, 2018.Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.Group IB. (2020, September). LOCK LIKE  A PRO. Retrieved September 27, 2021.Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Technical Analysis. Retrieved August 17, 2016.CrowdStrike. (2023, January 10). SCATTERED SPIDER Exploits Windows Security Deficiencies with Bring-Your-Own-Vulnerable-Driver Tactic in Attempt to Bypass Endpoint Security. Retrieved July 5, 2023.Prizmant, D. (2021, June 7). Siloscape: First Known Malware Targeting Windows Containers to Compromise Cloud Environments. Retrieved June 9, 2021.Nicolas Falliere, Liam O Murchu, Eric Chien 2011, February W32.Stuxnet Dossier (Version 1.4) Retrieved. 2017/09/22Counter Threat Unit Research Team. (2017, June 27). BRONZE UNION Cyberespionage Persists Despite Disclosures. Retrieved July 13, 2017.Global Threat Center, Intelligence Team. (2020, December). APT27 Turns to Ransomware. Retrieved November 12, 2021.Daniel Lughi, Jaromir Horejsi. (2020, October 2). Tonto Team - Exploring the TTPs of an advanced threat actor operating a large infrastructure. Retrieved October 17, 2021.Symantec. (2019, March 6). Whitefly: Espionage Group has Singapore in Its Sights. Retrieved May 26, 2020.Anthe, C. et al. (2016, December 14). Microsoft Security Intelligence Report Volume 21. Retrieved November 27, 2017.Mac Threat Response, Mobile Research Team. (2020, August 13). The XCSSET Malware: Inserts Malicious Code Into Xcode Projects, Performs UXSS Backdoor Planting in Safari, and Leverages Two Zero-day Exploits. Retrieved October 5, 2021.Itkin, E. and Cohen, I. (2021, February 22). The Story of Jian – How APT31 Stole and Used an Unknown Equation Group 0-Day. Retrieved March 24, 2021.Novetta. (n.d.). Operation SMN: Axiom Threat Actor Group Report. Retrieved November 12, 2014.Goodin, D. (2017, March 17). Virtual machine escape fetches $105,000 at Pwn2Own hacking contest - updated. Retrieved March 12, 2018.Microsoft. (2020, October 15). Microsoft recommended driver block rules. Retrieved March 16, 2021.Nunez, N. (2017, August 9). Moving Beyond EMET II – Windows Defender Exploit Guard. Retrieved March 12, 2018.Wikipedia. (2018, January 11). Control-flow integrity. Retrieved March 12, 2018.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.