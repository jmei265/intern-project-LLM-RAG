MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseIndicator RemovalNetwork Share Connection RemovalIndicator Removal:Network Share Connection RemovalOther sub-techniques of Indicator Removal (9)IDNameT1070.001Clear Windows Event LogsT1070.002Clear Linux or Mac System LogsT1070.003Clear Command HistoryT1070.004File DeletionT1070.005Network Share Connection RemovalT1070.006TimestompT1070.007Clear Network Connection History and ConfigurationsT1070.008Clear Mailbox DataT1070.009Clear PersistenceAdversaries may remove share connections that are no longer useful in order to clean up traces of their operation. Windows shared drive andSMB/Windows Admin Sharesconnections can be removed when no longer needed.Netis an example utility that can be used to remove network share connections with thenet use \system\share /deletecommand.[1]ID:T1070.005Sub-technique of:T1070ⓘTactic:Defense EvasionⓘPlatforms:WindowsⓘSystem Requirements:Established network share connection to a remote system. Level of access depends on permissions of the account used.ⓘDefense Bypassed:Host forensic analysisVersion:1.1Created:31 January 2020Last Modified:13 April 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0260InvisiMoleInvisiMolecan disconnect previously connected remote drives.[2]S0039NetThenet use \system\share /deletecommand can be used inNetto remove an established connection to a network share.[1]S0400RobbinHoodRobbinHooddisconnects all network shares from the computer with the commandnet use * /DELETE /Y.[3]G0027Threat Group-3390Threat Group-3390has detached network shares after exfiltrating files, likely to evade detection.[4]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments of net use commands associated with establishing and removing remote shares over SMB, including following best practices for detection of Windows Admin Shares.DS0029Network TrafficNetwork Traffic ContentMonitoring for SMB traffic between systems may also be captured and decoded to look for related network share session and file transfer activity.DS0009ProcessProcess CreationMonitor for newly constructed processes and/or command line execution that can be used to remove network share connections via the net.exe process.Note: Event IDs are for Sysmon (Event ID 1 - process create) and Windows Security Log (Event ID 4688 - a new process has been created). The Analytic is oriented around looking for various methods of removing network shares via the command line, which is otherwise a rare event.Analytic 1- Network Share Connection Removal(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") (Image= "C:\Windows\System32\net.exe" AND CommandLine= "delete") OR CommandLine="Remove-SmbShare" OR CommandLine="Remove-FileShare" )DS0002User AccountUser Account AuthenticationMonitoring for Windows authentication logs are also useful in determining when authenticated network shares are established and by which account, and can be used to correlate network share activity to other events to investigate potentially malicious activity.ReferencesMicrosoft. (n.d.). Net Use. Retrieved November 25, 2016.Hromcová, Z. (2018, June 07). InvisiMole: Surprisingly equipped spyware, undercover since 2013. Retrieved July 10, 2018.Lee, S. (2019, May 17). CB TAU Threat Intelligence Notification: RobbinHood Ransomware Stops 181 Windows Services Before Encryption. Retrieved July 29, 2019.Counter Threat Unit Research Team. (2017, June 27). BRONZE UNION Cyberespionage Persists Despite Disclosures. Retrieved July 13, 2017.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.