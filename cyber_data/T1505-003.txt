MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseServer Software ComponentWeb ShellServer Software Component:Web ShellOther sub-techniques of Server Software Component (5)IDNameT1505.001SQL Stored ProceduresT1505.002Transport AgentT1505.003Web ShellT1505.004IIS ComponentsT1505.005Terminal Services DLLAdversaries may backdoor web servers with web shells to establish persistent access to systems. A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to access the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server.[1]In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (e.g.China ChopperWeb shell client).[2]ID:T1505.003Sub-technique of:T1505ⓘTactic:PersistenceⓘPlatforms:Linux, Network, Windows, macOSContributors:Arnim Rupp, Deutsche Lufthansa AGVersion:1.4Created:13 December 2019Last Modified:16 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionC00342022 Ukraine Electric Power AttackDuring the2022 Ukraine Electric Power Attack,Sandworm Teamdeployed the Neo-REGEORG webshell on an internet-facing server.[3]G0007APT28APT28has used a modified and obfuscated version of the reGeorg web shell to maintain persistence on a target's Outlook Web Access (OWA) server.[4]G0016APT29APT29has installed web shells on exploited Microsoft Exchange servers.[5][6]G0050APT32APT32has used Web shells to maintain access to victim websites.[7]G0082APT38APT38has used web shells for persistence or to ensure redundant access.[8]G0087APT39APT39has installed ANTAK and ASPXSPY web shells.[9]G1023APT5APT5has installed multiple web shells on compromised servers including on Pulse Secure VPN appliances.[10][11]S0073ASPXSpyASPXSpyis a Web shell. The ASPXTool version used byThreat Group-3390has been deployed to accessible servers running Internet Information Services (IIS).[12]G0135BackdoorDiplomacyBackdoorDiplomacyhas used web shells to establish an initial foothold and for lateral movement within a victim's system.[13]S1118BUSHWALKBUSHWALKis a web shell that has the ability to execute arbitrary commands or write files.[14]C0017C0017DuringC0017,APT41deployed JScript web shells through the creation of malicious ViewState objects.[15]C0032C0032During theC0032campaign,TEMP.Velesplanted Web shells on Outlook Exchange servers.[16]S0020China ChopperChina Chopper's server component is a Web Shell payload.[2]C0029Cutting EdgeDuringCutting Edge, threat actors used multiple web shells to maintain presence on compromised Connect Secure appliances such asWIREFIRE,GLASSTOKEN,BUSHWALK,LIGHTWIRE, andFRAMESTING.[17][18]G0009Deep PandaDeep Pandauses Web shells on publicly accessible Web servers to access victim networks.[19]G0035DragonflyDragonflyhas commonly created Web shells on victims' publicly accessible email and web servers, which they used to maintain access to a victim network and download additional malicious files.[20]G1016FIN13FIN13has utilized obfuscated and open-source web shells such as JspSpy, reGeorg, MiniWebCmdShell, and Vonloesch Jsp File Browser 1.2 to enable remote code execution and to execute commands on compromised web server.[21]G0117Fox KittenFox Kittenhas installed web shells on compromised hosts to maintain access.[22][23]S1120FRAMESTINGFRAMESTINGis a web shell capable of enabling arbitrary command execution on compromised Ivanti Connect Secure VPNs.[14]G0093GALLIUMGALLIUMused Web shells to persist in victim environments and assist in execution and exfiltration.[24][25]S1117GLASSTOKENGLASSTOKENis a web shell capable of tunneling C2 connections and code execution on compromised Ivanti Secure Connect VPNs.[18]G0125HAFNIUMHAFNIUMhas deployed multiple web shells on compromised servers including SIMPLESEESHARP, SPORTSBALL,China Chopper, andASPXSpy.[26][27][28][29][30]G0094KimsukyKimsukyhas used modified versions of open source PHP web shells to maintain access, often adding "Dinosaur" references within the code.[31]G0065LeviathanLeviathanrelies on web shells for an initial foothold as well as persistence into the victim's systems.[32][33]S1119LIGHTWIRELIGHTWIREis a web shell capable of command execution and establishing persistence on compromised Ivanti Secure Connect VPNs.[14]G0059Magic HoundMagic Houndhas used multiple web shells to gain execution.[34][35]G1009Moses StaffMoses Staffhas dropped a web shell onto a compromised system.[36]G0049OilRigOilRighas used web shells, often to maintain access to a victim network.[37][38][39]C0012Operation CuckooBeesDuringOperation CuckooBees, the threat actors generated a web shell within a vulnerable Enterprise Resource Planning Web Application Server as a persistence mechanism.[40]C0014Operation WocaoDuringOperation Wocao, threat actors used their own web shells, as well as those previously placed on target systems by other threat actors, for reconnaissance and lateral movement.[41]S0072OwaAuthOwaAuthis a Web shell that appears to be exclusively used byThreat Group-3390. It is installed as an ISAPI filter on Exchange servers and shares characteristics with theChina ChopperWeb shell.[12]S0598P.A.S. WebshellP.A.S. Webshellcan gain remote access and execution on target web servers.[42]S1108PULSECHECKPULSECHECKis a web shell that can enable command execution on compromised servers.[10]S1113RAPIDPULSERAPIDPULSEis a web shell that is capable of arbitrary file read on targeted web servers to exfiltrate items of interest on the victim device.[11]G0034Sandworm TeamSandworm Teamhas used webshells includingP.A.S. Webshellto maintain access to victim networks.[42]S0185SEASHARPEESEASHARPEEis a Web shell.[38]S1110SLIGHTPULSESLIGHTPULSEis a web shell that can read, write, and execute files on compromised servers.[10]S1112STEADYPULSESTEADYPULSEis a web shell that can enable the execution of arbitrary commands on compromised web servers.[10]S0578SUPERNOVASUPERNOVAis a Web shell.[43][44][45]G0027Threat Group-3390Threat Group-3390has used a variety of Web shells.[46]G0131Tonto TeamTonto Teamhas used a first stage web shell after compromising a vulnerable Exchange server.[47]G0081Tropic TrooperTropic Trooperhas started a web service in the target host and wait for the adversary to connect, acting as a web shell.[48]G0123Volatile CedarVolatile Cedarcan inject web shell code into a server.[49][50]G1017Volt TyphoonVolt Typhoonhas used webshells, including ones named AuditReport.jspx and iisstart.aspx, in compromised environments.[51]S1115WIREFIREWIREFIREis a web shell that can download files to and execute arbitrary commands from compromised Ivanti Connect Secure VPNs.[17]MitigationsIDMitigationDescriptionM1042Disable or Remove Feature or ProgramConsider disabling functions from web technologies such as PHP’sevaI()that may be abused for web shells.[52]M1018User Account ManagementEnforce the principle of least privilege by limiting privileges of user accounts so only authorized accounts can modify the web directory.[53]DetectionIDData SourceData ComponentDetectsDS0015Application LogApplication Log ContentMonitor for third-party application logging, messaging, and/or other artifacts that may backdoor web servers with web shells to establish persistent access to systems. Log authentication attempts to the server and any unusual traffic patterns to or from the server and internal network.[54]DS0022FileFile CreationFile monitoring may be used to detect changes to files in the Web directory of a Web server that do not match with updates to the Web server's content and may indicate implantation of a Web shell script.[55]File ModificationMonitor for changes made to files that may backdoor web servers with web shells to establish persistent access to systems.DS0029Network TrafficNetwork Traffic ContentMonitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).Network Traffic FlowMonitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.DS0009ProcessProcess CreationWeb shells can be difficult to detect. Unlike other forms of persistent remote access, they do not initiate connections. The portion of the Web shell that is on the server may be small and innocuous looking. The PHP version of the China Chopper Web shell, for example, is very similar to the following short payload:[2]<?php @evaI($_P0ST['password']);>Nevertheless, detection mechanisms exist. Process monitoring may be used to detect Web servers that perform suspicious actions such as spawning cmd.exe or accessing files that are not in the Web directory.[55]A web shell is a web script placed on an openly accessible web server to allow an adversary to use the server as a gatway in a network. As the shell operates, commands will be issued from within the web application into the broader server operating system. This analytic looks for host enumeration executables initiated by any web service that would not normally be executed within that environment.Analytic 1 - Webshell-Indicative Process Tree(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") (ParentImage="C:\Windows\System32\w3wp.exe" OR ParentImage="httpd.exe" OR ParentImage="tomcat.exe" OR ParentImage="nginx.exe")(Image="C:\Windows\System32\cmd.exe OR Image="C:\Windows\SysWOW64\cmd.exe" OR Image="C:\Windows\System32\\powershell.exe OR Image="C:\Windows\SysWOW64\\powershell.exe OR Image="C:\Windows\System32\net.exe" OR Image="C:\Windows\System32\hostname.exe" OR Image="C:\Windows\System32\whoami.exe" OR Image="systeminfo.exe OR Image="C:\Windows\System32\ipconfig.exe")ReferencesAdair, S., Lancaster, T., Volexity Threat Research. (2022, June 15). DriftingCloud: Zero-Day Sophos Firewall Exploitation and an Insidious Breach. Retrieved July 1, 2022.Lee, T., Hanzlik, D., Ahl, I. (2013, August 7). Breaking Down the China Chopper Web Shell - Part I. Retrieved March 27, 2015.Ken Proska, John Wolfram, Jared Wilson, Dan Black, Keith Lunden, Daniel Kapellmann Zafra, Nathan Brubaker, Tyler Mclellan, Chris Sistrunk. (2023, November 9). Sandworm Disrupts Power in Ukraine Using a Novel Attack Against Operational Technology. Retrieved March 28, 2024.NSA, CISA, FBI, NCSC. (2021, July). Russian GRU Conducting Global Brute Force Campaign to Compromise Enterprise and Cloud Environments. Retrieved July 26, 2021.NCSC, CISA, FBI, NSA. (2021, May 7). Further TTPs associated with SVR cyber actors. Retrieved July 29, 2021.Mandiant. (2022, May 2). UNC3524: Eye Spy on Your Email. Retrieved August 17, 2023.Lassalle, D., et al. (2017, November 6). OceanLotus Blossoms: Mass Digital Surveillance and Attacks Targeting ASEAN, Asian Nations, the Media, Human Rights Groups, and Civil Society. Retrieved November 6, 2017.DHS/CISA. (2020, August 26). FASTCash 2.0: North Korea's BeagleBoyz Robbing Banks. Retrieved September 29, 2021.Hawley et al. (2019, January 29). APT39: An Iranian Cyber Espionage Group Focused on Personal Information. Retrieved February 19, 2019.Perez, D. et al. (2021, April 20). Check Your Pulse: Suspected APT Actors Leverage Authentication Bypass Techniques and Pulse Secure Zero-Day. Retrieved February 5, 2024.Perez, D. et al. (2021, May 27). Re-Checking Your Pulse: Updates on Chinese APT Actors Compromising Pulse Secure VPN Devices. Retrieved February 5, 2024.Dell SecureWorks Counter Threat Unit Threat Intelligence. (2015, August 5). Threat Group-3390 Targets Organizations for Cyberespionage. Retrieved August 18, 2018.Adam Burgher. (2021, June 10). BackdoorDiplomacy: Upgrading from Quarian to Turian. Retrieved September 1, 2021Lin, M. et al. (2024, January 31). Cutting Edge, Part 2: Investigating Ivanti Connect Secure VPN Zero-Day Exploitation. Retrieved February 27, 2024.Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.Miller, S, et al. (2019, April 10). TRITON Actor TTP Profile, Custom Attack Tools, Detections, and ATT&CK Mapping. Retrieved April 16, 2019.McLellan, T. et al. (2024, January 12). Cutting Edge: Suspected APT Targets Ivanti Connect Secure VPN in New Zero-Day Exploitation. Retrieved February 27, 2024.Meltzer, M. et al. (2024, January 10). Active Exploitation of Two Zero-Day Vulnerabilities in Ivanti Connect Secure VPN. Retrieved February 27, 2024.RYANJ. (2014, February 20). Mo’ Shells Mo’ Problems – Deep Panda Web Shells. Retrieved September 16, 2015.US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.Sygnia Incident Response Team. (2022, January 5). TG2003: ELEPHANT BEETLE UNCOVERING AN ORGANIZED FINANCIAL-THEFT OPERATION. Retrieved February 9, 2023.CISA. (2020, September 15). Iran-Based Threat Actor Exploits VPN Vulnerabilities. Retrieved December 21, 2020.ClearSky. (2020, December 17). Pay2Key Ransomware – A New Campaign by Fox Kitten. Retrieved December 21, 2020.Cybereason Nocturnus. (2019, June 25). Operation Soft Cell: A Worldwide Campaign Against Telecommunications Providers. Retrieved July 18, 2019.MSTIC. (2019, December 12). GALLIUM: Targeting global telecom. Retrieved January 13, 2021.MSTIC. (2021, March 2). HAFNIUM targeting Exchange Servers with 0-day exploits. Retrieved March 3, 2021.Gruzweig, J. et al. (2021, March 2). Operation Exchange Marauder: Active Exploitation of Multiple Zero-Day Microsoft Exchange Vulnerabilities. Retrieved March 3, 2021.Bromiley, M. et al. (2021, March 4). Detection and Response to Exploitation of Microsoft Exchange Zero-Day Vulnerabilities. Retrieved March 9, 2021.Microsoft Threat Intelligence Team & Detection and Response Team . (2022, April 12). Tarrask malware uses scheduled tasks for defense evasion. Retrieved June 1, 2022.Eoin Miller. (2021, March 23). Defending Against the Zero Day: Analyzing Attacker Behavior Post-Exploitation of Microsoft Exchange. Retrieved October 27, 2022.CISA, FBI, CNMF. (2020, October 27). https://us-cert.cisa.gov/ncas/alerts/aa20-301a. Retrieved November 4, 2020.Plan, F., et al. (2019, March 4). APT40: Examining a China-Nexus Espionage Actor. Retrieved March 18, 2019.CISA. (2021, July 19). (AA21-200A) Joint Cybersecurity Advisory – Tactics, Techniques, and Procedures of Indicted APT40 Actors Associated with China’s MSS Hainan State Security Department. Retrieved August 12, 2021.DFIR Report. (2022, March 21). APT35 Automates Initial Access Using ProxyShell. Retrieved May 25, 2022.DFIR Report. (2021, November 15). Exchange Exploit Leads to Domain Wide Ransomware. Retrieved January 5, 2023.Checkpoint Research. (2021, November 15). Uncovering MosesStaff techniques: Ideology over Money. Retrieved August 11, 2022.Unit42. (2016, May 1). Evasive Serpens Unit 42 Playbook Viewer. Retrieved February 6, 2023.Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.Crowdstrike. (2020, March 2). 2020 Global Threat Report. Retrieved December 11, 2020.Cybereason Nocturnus. (2022, May 4). Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques. Retrieved September 22, 2022.Dantzig, M. v., Schamper, E. (2019, December 19). Operation Wocao: Shining a light on one of China’s hidden hacking groups. Retrieved October 8, 2020.ANSSI. (2021, January 27). SANDWORM INTRUSION SET CAMPAIGN TARGETING CENTREON SYSTEMS. Retrieved March 30, 2021.Tennis, M. (2020, December 17). SUPERNOVA: A Novel .NET Webshell. Retrieved February 22, 2021.Riley, W. (2020, December 1). SUPERNOVA SolarWinds .NET Webshell Analysis. Retrieved February 18, 2021.CISA. (2021, January 27). Malware Analysis Report (AR21-027A). Retrieved February 22, 2021.Falcone, R. and Lancaster, T. (2019, May 28). Emissary Panda Attacks Middle East Government Sharepoint Servers. Retrieved July 9, 2019.Faou, M., Tartare, M., Dupuy, T. (2021, March 10). Exchange servers under siege from at least 10 APT groups. Retrieved May 21, 2021.Chen, J.. (2020, May 12). Tropic Trooper’s Back: USBferry Attack Targets Air gapped Environments. Retrieved May 20, 2020.Threat Intelligence and Research. (2015, March 30). VOLATILE CEDAR. Retrieved February 8, 2021.ClearSky Cyber Security. (2021, January). “Lebanese Cedar” APT Global Lebanese Espionage Campaign Leveraging Web Servers. Retrieved February 10, 2021.Counter Threat Unit Research Team. (2023, May 24). Chinese Cyberespionage Group BRONZE SILHOUETTE Targets U.S. Government and Defense Organizations. Retrieved July 27, 2023.Kondratiev, A. (n.d.). Disabling dangerous PHP functions. Retrieved July 26, 2021.NSA and ASD. (2020, April 3). Detect and Prevent Web Shell Malware. Retrieved July 23, 2021.US-CERT. (2015, November 13). Compromised Web Servers and Web Shells - Threat Awareness and Guidance. Retrieved June 8, 2016.NSA Cybersecurity Directorate. (n.d.). Mitigating Web Shells. Retrieved July 22, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.