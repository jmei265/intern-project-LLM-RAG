MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseCloud Administration CommandCloud Administration CommandAdversaries may abuse cloud management services to execute commands within virtual machines. Resources such as AWS Systems Manager, Azure RunCommand, and Runbooks allow users to remotely run scripts in virtual machines by leveraging installed virtual machine agents.[1][2]If an adversary gains administrative access to a cloud environment, they may be able to abuse cloud management services to execute commands in the environment’s virtual machines. Additionally, an adversary that compromises a service provider or delegated administrator account may similarly be able to leverage aTrusted Relationshipto execute commands in connected virtual machines.[3]ID:T1651Sub-techniques:No sub-techniquesⓘTactic:ExecutionⓘPlatforms:IaaSContributors:Adrien Bataille; Anders Vejlby; Caio Silva; Cisco; Jared Wilson; Nader Zaveri; Nichols Jasper; Tamir YehudaVersion:2.0Created:13 March 2023Last Modified:12 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0677AADInternalsAADInternalscan execute commands on Azure virtual machines using the VM agent.[4]G0016APT29APT29has used Azure Run Command and Azure Admin-on-Behalf-of (AOBO) to execute code on virtual machines.[3]S1091PacuPacucan run commands on EC2 instances using AWS Systems Manager Run Command.[5]MitigationsIDMitigationDescriptionM1026Privileged Account ManagementLimit the number of cloud accounts with permissions to remotely execute commands on virtual machines, and ensure that these are not used for day-to-day operations. In Azure, limit the number of accounts with the roles Azure Virtual Machine Contributer and above, and consider using temporary Just-in-Time (JIT) roles to avoid permanently assigning privileged access to virtual machines.[6]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor commands and scripts executed on virtual machines. In Azure, usage of Azure RunCommand can be identified via the Azure Activity Logs, and additional details on the result of  executed jobs are available in theC:\Packages\Plugins\Microsoft.CPlat.Core.RunCommandWindowsdirectory on Windows virtual machines.[6]DS0009ProcessProcess CreationMonitor virtual machines for the creation of processes associated with cloud virtual machine agents. In Windows-based Azure machines, monitor for the WindowsAzureGuestAgent.exe process.[6]DS0012ScriptScript ExecutionMonitor commands and scripts executed on virtual machines. In Azure, usage of Azure RunCommand can be identified via the Azure Activity Logs, and additional details on the result of  executed jobs are available in theC:\Packages\Plugins\Microsoft.CPlat.Core.RunCommandWindowsdirectory on Windows virtual machines.[6]ReferencesAWS. (n.d.). AWS Systems Manager Run Command. Retrieved March 13, 2023.Microsoft. (2023, March 10). Run scripts in your VM by using Run Command. Retrieved March 13, 2023.Microsoft Threat Intelligence Center. (2021, October 25). NOBELIUM targeting delegated administrative privileges to facilitate broader attacks. Retrieved March 25, 2022.Dr. Nestori Syynimaa. (2020, June 4). Getting root access to Azure VMs as a Azure AD Global Administrator. Retrieved March 13, 2023.Rhino Security Labs. (2019, August 22). Pacu. Retrieved October 17, 2019.Adrien Bataille, Anders Vejlby, Jared Scott Wilson, and Nader Zaveri. (2021, December 14). Azure Run Command for Dummies. Retrieved March 13, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.