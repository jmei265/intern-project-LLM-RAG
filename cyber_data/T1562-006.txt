MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseImpair DefensesIndicator BlockingImpair Defenses:Indicator BlockingOther sub-techniques of Impair Defenses (11)IDNameT1562.001Disable or Modify ToolsT1562.002Disable Windows Event LoggingT1562.003Impair Command History LoggingT1562.004Disable or Modify System FirewallT1562.006Indicator BlockingT1562.007Disable or Modify Cloud FirewallT1562.008Disable or Modify Cloud LogsT1562.009Safe Mode BootT1562.010Downgrade AttackT1562.011Spoof Security AlertingT1562.012Disable or Modify Linux Audit SystemAn adversary may attempt to block indicators or events typically captured by sensors from being gathered and analyzed. This could include maliciously redirecting[1]or even disabling host-based sensors, such as Event Tracing for Windows (ETW)[2], by tampering settings that control the collection and flow of event telemetry.[3]These settings may be stored on the system in configuration files and/or in the Registry as well as being accessible via administrative utilities such asPowerShellorWindows Management Instrumentation.For example, adversaries may modify theFilevalue inHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\EventLog\Securityto hide their malicious actions in a new or different .evtx log file. This action does not require a system reboot and takes effect immediately.[4]ETW interruption can be achieved multiple ways, however most directly by defining conditions using thePowerShellSet-EtwTraceProvidercmdlet or by interfacing directly with the Registry to make alterations.In the case of network-based reporting of indicators, an adversary may block traffic associated with reporting to prevent central analysis. This may be accomplished by many means, such as stopping a local process responsible for forwarding telemetry and/or creating a host-based firewall rule to block traffic to specific hosts responsible for aggregating events, such as security information and event management (SIEM) products.In Linux environments, adversaries may disable or reconfigure log processing tools such as syslog or nxlog to inhibit detection and monitoring capabilities to facilitate follow on behaviors[5].ID:T1562.006Sub-technique of:T1562ⓘTactic:Defense EvasionⓘPlatforms:Linux, Windows, macOSⓘDefense Bypassed:Anti-virus, Host intrusion prevention systemsContributors:Lucas Heiligenstein; Rob SmithVersion:1.4Created:19 March 2020Last Modified:14 February 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0096APT41APT41developed a custom injector that enables an Event Tracing for Windows (ETW) bypass, making malicious processes invisible to Windows logging.[6]G1023APT5APT5has used the CLEANPULSE utility to insert command line strings into a targeted process to prevent certain log events from occurring.[7]S1063Brute Ratel C4Brute Ratel C4has the ability to hide memory artifacts and to patch Event Tracing for Windows (ETW) and the Anti Malware Scan Interface (AMSI).[8][9]S0377EburyEburycan hook logging functions so that nothing from the backdoor gets sent to the logging facility.[10]S0697HermeticWiperHermeticWiperhas the ability to set theHKLM:\SYSTEM\\CurrentControlSet\\Control\\CrashControl\CrashDumpEnabledRegistry key to0in order to disable crash dumps.[11][12][13]S1097HUI LoaderHUI Loaderhas the ability to disable Windows Event Tracing for Windows (ETW) and Antimalware Scan Interface (AMSI) functions.[14]S0579WaterbearWaterbearcan hook theZwOpenProcessandGetExtendedTcpTableAPIs called by the process of a security product to hide PIDs and TCP records from detection.[15]S1065Woody RATWoody RAThas suppressed all error reporting by callingSetErrorModewith 0x8007 as a parameter.[16]MitigationsIDMitigationDescriptionM1022Restrict File and Directory PermissionsEnsure event tracers/forwarders[17], firewall policies, and other associated mechanisms are secured with appropriate permissions and access controls.M1054Software ConfigurationConsider automatically relaunching forwarding mechanisms at recurring intervals (ex: temporal, on-logon, etc.) as well as applying appropriate change management to firewall rules and other related system configurations.M1018User Account ManagementEnsure event tracers/forwarders[17], firewall policies, and other associated mechanisms are secured with appropriate permissions and access controls and cannot be manipulated by user accounts.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may attempt to block indicators or events typically captured by sensors from being gathered and analyzed. Adversaries may attempt to evade system defenses by unloading minifilter drivers used by host-based sensors such as Sysmon through the use of the fltmc command-line utility. Accordingly, this analytic looks for command-line invocations of this utility when used to unload minifilter drivers.DS0009ProcessProcess CreationMonitor for executed processes that may attempt to block indicators or events typically captured by sensors from being gathered and analyzed.Analytic 1 - Indicator Blocking - Driver Unloaded(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") Image= "fltmc.exe" AND CommandLine= "unload"DS0013Sensor HealthHost StatusDetect lack of reported activity from a host sensor. Different methods of blocking may cause different disruptions in reporting. Systems may suddenly stop reporting all data or only certain kinds of data. Depending on the types of host information collected, an analyst may be able to detect the event that triggered a process to stop or connection to be blocked. For example, Sysmon will log when its configuration state has changed (Event ID 16) and Windows Management Instrumentation (WMI) may be used to subscribe ETW providers that log any provider removal from a specific trace session.[3]DS0024Windows RegistryWindows Registry Key ModificationTo detect changes in ETW you can also monitor the registry key which contains configurations for all ETW event providers:HKLM\SYSTEM\CurrentControlSet\Control\WMI\Autologger\AUTOLOGGER_NAME{PROVIDER_GUID}ReferencesMicrosoft. (2009, May 17). Backdoor:Win32/Lamin.A. Retrieved September 6, 2018.Microsoft. (2018, May 30). About Event Tracing. Retrieved June 7, 2019.Palantir. (2018, December 24). Tampering with Windows Event Tracing: Background, Offense, and Defense. Retrieved June 7, 2019.Heiligenstein, L. (n.d.). REP-25: Disable Windows Event Logging. Retrieved April 7, 2022.Manoj Ahuje. (2022, April 21). LemonDuck Targets Docker for Cryptomining Operations. Retrieved June 30, 2022.Nikita Rostovcev. (2022, August 18). APT41 World Tour 2021 on a tight schedule. Retrieved February 22, 2024.Perez, D. et al. (2021, May 27). Re-Checking Your Pulse: Updates on Chinese APT Actors Compromising Pulse Secure VPN Devices. Retrieved February 5, 2024.Harbison, M. and Renals, P. (2022, July 5). When Pentest Tools Go Brutal: Red-Teaming Tool Being Abused by Malicious Actors. Retrieved February 1, 2023.Chell, D.  PART 3: How I Met Your Beacon – Brute Ratel. Retrieved February 6, 2023.M.Léveillé, M.. (2014, February 21). An In-depth Analysis of Linux/Ebury. Retrieved April 19, 2019.Guerrero-Saade, J. (2022, February 23). HermeticWiper | New Destructive Malware Used In Cyber Attacks on Ukraine. Retrieved March 25, 2022.Thomas, W. et al. (2022, February 25). CrowdStrike Falcon Protects from New Wiper Malware Used in Ukraine Cyberattacks. Retrieved March 25, 2022.Dani, M. (2022, March 1). Ukrainian Targets Hit by HermeticWiper, New Datawiper Malware. Retrieved March 25, 2022.Counter Threat Unit Research Team . (2022, June 23). BRONZE STARLIGHT RANSOMWARE OPERATIONS USE HUI LOADER. Retrieved December 7, 2023.Su, V. et al. (2019, December 11). Waterbear Returns, Uses API Hooking to Evade Security. Retrieved February 22, 2021.MalwareBytes Threat Intelligence Team. (2022, August 3). Woody RAT: A new feature-rich malware spotted in the wild. Retrieved December 6, 2022.Microsoft. (2018, May 30). Event Tracing. Retrieved September 6, 2018.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.