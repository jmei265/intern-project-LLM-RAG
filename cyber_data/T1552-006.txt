MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseUnsecured CredentialsGroup Policy PreferencesUnsecured Credentials:Group Policy PreferencesOther sub-techniques of Unsecured Credentials (8)IDNameT1552.001Credentials In FilesT1552.002Credentials in RegistryT1552.003Bash HistoryT1552.004Private KeysT1552.005Cloud Instance Metadata APIT1552.006Group Policy PreferencesT1552.007Container APIT1552.008Chat MessagesAdversaries may attempt to find unsecured credentials in Group Policy Preferences (GPP). GPP are tools that allow administrators to create domain policies with embedded credentials. These policies allow administrators to set local accounts.[1]These group policies are stored in SYSVOL on a domain controller. This means that any domain user can view the SYSVOL share and decrypt the password (using the AES key that has been made public).[2]The following tools and scripts can be used to gather and decrypt the password file from Group Policy Preference XML files:Metasploit’s post exploitation module:post/windows/gather/credentials/gppGet-GPPPassword[3]gpprefdecrypt.pyOn the SYSVOL share, adversaries may use the following command to enumerate potential GPP XML files:dir /s * .xmlID:T1552.006Sub-technique of:T1552ⓘTactic:Credential AccessⓘPlatforms:WindowsⓘPermissions Required:UserVersion:1.0Created:11 February 2020Last Modified:17 June 2020Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0064APT33APT33has used a variety of publicly available tools like Gpppassword to gather credentials.[4][5]S0194PowerSploitPowerSploitcontains a collection of Exfiltration modules that can harvest credentials from Group Policy Preferences.[6][7]S0692SILENTTRINITYSILENTTRINITYhas a module that can extract cached GPP passwords.[8]G0102Wizard SpiderWizard Spiderhas used PowerShell cmdletsGet-GPPPasswordandFind-GPOPasswordto find unsecured credentials in a compromised network group policy.[9]MitigationsIDMitigationDescriptionM1015Active Directory ConfigurationRemove vulnerable Group Policy Preferences.[10]M1047AuditSearch SYSVOL for any existing GGPs that may contain credentials and remove them.[11]M1051Update SoftwareApply patch KB2962486 which prevents credentials from being stored in GPPs.[11][12]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may search for SYSVOL data and/or GPP XML files, especially on compromised domain controllers.DS0022FileFile AccessMonitor for attempts to access SYSVOL that involve searching for XML files.ReferencesMicrosoft. (2016, August 31). Group Policy Preferences. Retrieved March 9, 2020.Microsoft. (n.d.). 2.2.1.1.4 Password Encryption. Retrieved April 11, 2018.Campbell, C. (2012, May 24). GPP Password Retrieval with PowerShell. Retrieved April 11, 2018.Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019.Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019.PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018.PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018.Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.Shilko, J., et al. (2021, October 7). FIN12: The Prolific Ransomware Intrusion Threat Actor That Has Aggressively Pursued Healthcare Targets. Retrieved June 15, 2023.Microsoft. (2014, May 13). MS14-025: Vulnerability in Group Policy Preferences could allow elevation of privilege. Retrieved January 28, 2015.Sean Metcalf. (2015, December 28). Finding Passwords in SYSVOL & Exploiting Group Policy Preferences. Retrieved February 17, 2020.Microsoft. (2014, May 13). MS14-025: Vulnerability in Group Policy Preferences could allow elevation of privilege. Retrieved February 17, 2020.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.