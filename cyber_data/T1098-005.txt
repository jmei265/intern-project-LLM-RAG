MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseAccount ManipulationDevice RegistrationAccount Manipulation:Device RegistrationOther sub-techniques of Account Manipulation (6)IDNameT1098.001Additional Cloud CredentialsT1098.002Additional Email Delegate PermissionsT1098.003Additional Cloud RolesT1098.004SSH Authorized KeysT1098.005Device RegistrationT1098.006Additional Container Cluster RolesAdversaries may register a device to an adversary-controlled account. Devices may be registered in a multifactor authentication (MFA) system, which handles authentication to the network, or in a device management system, which handles device access and compliance.MFA systems, such as Duo or Okta, allow users to associate devices with their accounts in order to complete MFA requirements. An adversary that compromises a user’s credentials may enroll a new device in order to bypass initial MFA requirements and gain persistent access to a network.[1][2]In some cases, the MFA self-enrollment process may require only a username and password to enroll the account's first device or to enroll a device to an inactive account.[3]Similarly, an adversary with existing access to a network may register a device to Azure AD and/or its device management system, Microsoft Intune, in order to access sensitive data or resources while bypassing conditional access policies.[4][5][6]Devices registered in Azure AD may be able to conductInternal Spearphishingcampaigns via intra-organizational emails, which are less likely to be treated as suspicious by the email client.[7]Additionally, an adversary may be able to perform aService Exhaustion Floodon an Azure AD tenant by registering a large number of devices.[8]ID:T1098.005Sub-technique of:T1098ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:Azure AD, SaaS, WindowsContributors:Arad Inbar, Fidelis Security; Joe Gumke, U.S. Bank; Mike Moran; Pawel Partyka, Microsoft 365 DefenderVersion:1.2Created:04 March 2022Last Modified:03 October 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0677AADInternalsAADInternalscan register a device to Azure AD.[9]G0016APT29APT29has enrolled their own devices into compromised cloud tenants, including enrolling a device in MFA to an Azure AD environment following a successful password guessing attack against a dormant account.[3][10]C0027C0027DuringC0027,Scattered Spiderregistered devices for MFA to maintain persistence through victims' VPN.[11]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29registered devices in order to enable mailbox syncing via theSet-CASMailboxcommand.[12]MitigationsIDMitigationDescriptionM1032Multi-factor AuthenticationRequire multi-factor authentication to register devices in Azure AD.[7]Configure multi-factor authentication systems to disallow enrolling new devices for inactive accounts.[1]When first enrolling MFA, use conditional access policies to restrict device enrollment to trusted locations or devices, and consider using temporary access passes as an initial MFA solution to enroll a device.[3]DetectionIDData SourceData ComponentDetectsDS0026Active DirectoryActive Directory Object CreationMonitor for the registration or joining of new device objects in Active Directory. Raise alerts when new devices are registered or joined without using MFA.[13]DS0015Application LogApplication Log ContentAzure AD creates several log entries when new devices are enrolled, which can be monitored for unexpected device registrations.[8]Additionally, joined devices can be viewed via the Azure AD portal.[14]DS0002User AccountUser Account ModificationMonitor user accounts for new and suspicious device associations, such as those originating from unusual sources, occurring at unusual times, or following a suspicious login.[6]ReferencesCybersecurity and Infrastructure Security Agency. (2022, March 15). Russian State-Sponsored Cyber Actors Gain Network Access by Exploiting Default Multifactor Authentication Protocols and “PrintNightmare” Vulnerability. Retrieved March 16, 2022.Kelly Jackson Higgins. (2021, January 7). FireEye's Mandia: 'Severity-Zero Alert' Led to Discovery of SolarWinds Attack. Retrieved April 18, 2022.Douglas Bienstock. (2022, August 18). You Can’t Audit Me: APT29 Continues Targeting Microsoft 365. Retrieved February 23, 2023.Dr. Nestori Syynimaa. (2021, March 3). Deep-dive to Azure AD device join. Retrieved March 9, 2022.Dr. Nestori Syynimaa. (2020, September 6). Bypassing conditional access by faking device compliance. Retrieved March 4, 2022.Microsoft. (2022, March 22). DEV-0537 criminal actor targeting organizations for data exfiltration and destruction. Retrieved March 23, 2022.Microsoft 365 Defender Threat Intelligence Team. (2022, January 26). Evolved phishing: Device registration trick adds to phishers’ toolbox for victims without MFA. Retrieved March 4, 2022.Dr. Nestori Syynimaa. (2021, January 31). BPRT unleashed: Joining multiple devices to Azure AD and Intune. Retrieved March 4, 2022.Dr. Nestori Syynimaa. (2018, October 25). AADInternals. Retrieved February 18, 2022.UK National Cyber Security Center et al. (2024, February). SVR cyber actors adapt tactics for initial cloud access. Retrieved March 1, 2024.Parisi, T. (2022, December 2). Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies. Retrieved June 30, 2023.Cash, D. et al. (2020, December 14). Dark Halo Leverages SolarWinds Compromise to Breach Organizations. Retrieved December 29, 2020.Microsoft. (2020, September 16). Azure Active Directory security operations for devices. Retrieved February 21, 2023.Microsoft. (2022, February 18). Manage device identities by using the Azure portal. Retrieved April 13, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.