MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseData from Network Shared DriveData from Network Shared DriveAdversaries may search network shares on computers they have compromised to find files of interest. Sensitive data can be collected from remote systems via shared network drives (host shared directory, network file server, etc.) that are accessible from the current system prior to Exfiltration. Interactive command shells may be in use, and common functionality withincmdmay be used to gather information.ID:T1039Sub-techniques:No sub-techniquesⓘTactic:CollectionⓘPlatforms:Linux, Windows, macOSⓘSystem Requirements:Privileges to access network shared driveContributors:David TayouriVersion:1.4Created:31 May 2017Last Modified:11 August 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0007APT28APT28has collected files from network shared drives.[1]S0128BADNEWSWhen it first starts,BADNEWScrawls the victim's mapped drives and collects documents with the following extensions: .doc, .docx, .pdf, .ppt, .pptx, and .txt.[2]G0060BRONZE BUTLERBRONZE BUTLERhas exfiltrated files stolen from file shares.[3]C0015C0015DuringC0015, the threat actors collected files from network shared drives prior to network encryption.[4]G0114ChimeraChimerahas collected data of interest from network shares.[5]S0050CosmicDukeCosmicDukesteals user files from network shared drives with file extensions and keywords that match a predefined list.[6]S0554EgregorEgregorcan collect any files found in the enumerated drivers before sending it to its C2 channel.[7]G0117Fox KittenFox Kittenhas searched network shares to access sensitive documents.[8]G0047Gamaredon GroupGamaredon Groupmalware has collected Microsoft Office documents from mapped network drives.[9]G0045menuPassmenuPasshas collected data from remote systems by mounting network shares withnet useand using Robocopy to transfer data.[10]S0458RamsayRamsaycan collect data from network drives and stage it for exfiltration.[11]G0054SowbugSowbugextracted Word documents from a file server on a victim network.[12]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments for actions that could be taken to collect files from a network share. Remote access tools with built-in features may interact directly with the Windows API to gather and copy to a location. Data may also be acquired and staged through Windows system management tools such as Windows Management Instrumentation and PowerShell.DS0022FileFile AccessMonitor for unexpected files (i.e. .pdf, .docx, .jpg, etc.)  interacting with network shares.DS0033Network ShareNetwork Share AccessMonitor for unexpected and abnormal accesses to network shares.DS0029Network TrafficNetwork Connection CreationMonitor for newly constructed network connections that may search network shares on computers they have compromised to find files of interest. Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on network protocols such as SMB that revolve around network shares.Network Traffic ContentMonitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).Network Traffic FlowMonitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Network Analysis frameworks such as Zeek can be used to capture, decode, and alert on network protocols such as SMB that revolve around network shares. Although there may be more native ways to detect detailed SMB events on the host, they can be extracted out of network traffic. With the right protocol decoders, port 445 traffic can be filtered and even the file path (relative to the share) can be retrieved.Looking at this activity more closely to obtain an adequate sense of situational awareness may make it possible to detect adversaries moving between hosts in a way that deviates from normal activity. Because SMB traffic is heavy in many environments, this analytic may be difficult to turn into something that can be used to quickly detect an APT. In some cases, it may make more sense to run this analytic in a forensic fashion. Looking through and filtering its output after an intrusion has been discovered may be helpful in identifying the scope of compromise.ReferencesNSA, CISA, FBI, NCSC. (2021, July). Russian GRU Conducting Global Brute Force Campaign to Compromise Enterprise and Cloud Environments. Retrieved July 26, 2021.Settle, A., et al. (2016, August 8). MONSOON - Analysis Of An APT Campaign. Retrieved September 22, 2016.Counter Threat Unit Research Team. (2017, October 12). BRONZE BUTLER Targets Japanese Enterprises. Retrieved January 4, 2018.DFIR Report. (2021, November 29). CONTInuing the Bazar Ransomware Story. Retrieved September 29, 2022.Jansen, W . (2021, January 12). Abusing cloud services to fly under the radar. Retrieved January 19, 2021.F-Secure Labs. (2014, July). COSMICDUKE Cosmu with a twist of MiniDuke. Retrieved July 3, 2014.NHS Digital. (2020, November 26). Egregor Ransomware The RaaS successor to Maze. Retrieved December 29, 2020.CISA. (2020, September 15). Iran-Based Threat Actor Exploits VPN Vulnerabilities. Retrieved December 21, 2020.Boutin, J. (2020, June 11). Gamaredon group grows its game. Retrieved June 16, 2020.PwC and BAE Systems. (2017, April). Operation Cloud Hopper. Retrieved April 5, 2017.Sanmillan, I.. (2020, May 13). Ramsay: A cyber‑espionage toolkit tailored for air‑gapped networks. Retrieved May 27, 2020.Symantec Security Response. (2017, November 7). Sowbug: Cyber espionage group targets South American and Southeast Asian governments. Retrieved November 16, 2017.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.