MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseOS Credential DumpingLSA SecretsOS Credential Dumping:LSA SecretsOther sub-techniques of OS Credential Dumping (8)IDNameT1003.001LSASS MemoryT1003.002Security Account ManagerT1003.003NTDST1003.004LSA SecretsT1003.005Cached Domain CredentialsT1003.006DCSyncT1003.007Proc FilesystemT1003.008/etc/passwd and /etc/shadowAdversaries with SYSTEM access to a host may attempt to access Local Security Authority (LSA) secrets, which can contain a variety of different credential materials, such as credentials for service accounts.[1][2][3]LSA secrets are stored in the registry atHKEY_LOCAL_MACHINE\SECURITY\Policy\Secrets. LSA secrets can also be dumped from memory.[4]Regcan be used to extract from the Registry.Mimikatzcan be used to extract secrets from memory.[4]ID:T1003.004Sub-technique of:T1003ⓘTactic:Credential AccessⓘPlatforms:WindowsⓘPermissions Required:SYSTEMContributors:Ed Williams, Trustwave, SpiderLabsVersion:1.0Created:21 February 2020Last Modified:21 April 2021Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0677AADInternalsAADInternalscan dump secrets from the Local Security Authority.[5]G0016APT29APT29has used thereg savecommand to extract LSA secrets offline.[6]G0064APT33APT33has used a variety of publicly available tools likeLaZagneto gather credentials.[7][8]S0050CosmicDukeCosmicDukecollects LSA secrets.[9]S0488CrackMapExecCrackMapExeccan dump hashed passwords from LSA secrets for the targeted system.[10]G0035DragonflyDragonflyhas dropped and executed SecretsDump to dump password hashes.[11][12]S0008gsecdumpgsecdumpcan dump LSA secrets.[13]S1022IceAppleIceApple's Credential Dumper module can dump LSA secrets from registry keys, including:HKLM\SECURITY\Policy\PolEKList\default,HKLM\SECURITY\Policy\Secrets\*\CurrVal, andHKLM\SECURITY\Policy\Secrets\*\OldVal.[14]S0357ImpacketSecretsDump andMimikatzmodules withinImpacketcan perform credential dumping to obtain account and password information.[15]G0004Ke3changKe3changhas dumped credentials, including by using gsecdump.[16][17]S0349LaZagneLaZagnecan perform credential dumping from LSA secrets to obtain account and password information.[18]G0077LeafminerLeafminerused several tools for retrieving login and password information, including LaZagne.[19]G0045menuPassmenuPasshas used a modified version of pentesting tools wmiexec.vbs and secretsdump.py to dump credentials.[20][21]S0002MimikatzMimikatzperforms credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from the LSA.[22][23][24][25]G0069MuddyWaterMuddyWaterhas performed credential dumping withLaZagne.[26][27]G0049OilRigOilRighas used credential dumping tools such asLaZagneto steal credentials to accounts logged into the compromised system and to Outlook Web Access.[28][29][30][31]S0192PupyPupycan use Lazagne for harvesting credentials.[32]G0027Threat Group-3390Threat Group-3390actors have usedgsecdumpto dump credentials. They have also dumped credentials from domain controllers.[33][34]MitigationsIDMitigationDescriptionM1027Password PoliciesEnsure that local administrator accounts have complex, unique passwords across all systems on the network.M1026Privileged Account ManagementFollow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.[3]M1017User TrainingLimit credential overlap across accounts and systems by training users and administrators not to use the same password for multiple accounts.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may access to a host may attempt to access Local Security Authority (LSA) secrets. Remote access tools may contain built-in features or incorporate existing tools like Mimikatz. PowerShell scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module,[35]which may require additional logging features to be configured in the operating system to collect necessary information for analysis.DS0024Windows RegistryWindows Registry Key AccessMonitor for the LSA secrets are stored in the registry atHKEY_LOCAL_MACHINE\SECURITY\Policy\Secretsbeing accessedReferencesPasscape. (n.d.). Windows LSA secrets. Retrieved February 21, 2020.Microsoft. (2019, February 14). Active Directory administrative tier model. Retrieved February 21, 2020.Chad Tilbury. (2017, August 8). 1Windows Credentials: Attack, Mitigation, Defense. Retrieved February 21, 2020.Mantvydas Baranauskas. (2019, November 16). Dumping LSA Secrets. Retrieved February 21, 2020.Dr. Nestori Syynimaa. (2018, October 25). AADInternals. Retrieved February 18, 2022.Mandiant. (2022, May 2). UNC3524: Eye Spy on Your Email. Retrieved August 17, 2023.Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019.Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019.F-Secure Labs. (2015, September 17). The Dukes: 7 years of Russian cyberespionage. Retrieved December 10, 2015.byt3bl33d3r. (2018, September 8). SMB: Command Reference. Retrieved July 17, 2020.US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.Core Security. (n.d.). Impacket. Retrieved November 2, 2017.TrueSec. (n.d.). gsecdump v2.0b5. Retrieved September 29, 2015.CrowdStrike. (2022, May). ICEAPPLE: A NOVEL INTERNET INFORMATION SERVICES (IIS) POST-EXPLOITATION FRAMEWORK. Retrieved June 27, 2022.SecureAuth. (n.d.).  Retrieved January 15, 2019.Villeneuve, N., Bennett, J. T., Moran, N., Haq, T., Scott, M., & Geers, K. (2014). OPERATION “KE3CHANG”: Targeted Attacks Against Ministries of Foreign Affairs. Retrieved November 12, 2014.Smallridge, R. (2018, March 10). APT15 is alive and strong: An analysis of RoyalCli and RoyalDNS. Retrieved April 4, 2018.Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018.Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.PwC and BAE Systems. (2017, April). Operation Cloud Hopper: Technical Annex. Retrieved April 13, 2017.Twi1ight. (2015, July 11). AD-Pentest-Script - wmiexec.vbs. Retrieved June 29, 2017.Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015.Deply, B., Le Toux, V. (2016, June 5). module ~ lsadump. Retrieved August 7, 2017.Grafnetter, M. (2015, October 26). Retrieving DPAPI Backup Keys from Active Directory. Retrieved December 19, 2017.The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019.Lancaster, T.. (2017, November 14). Muddying the Water: Targeted Attacks in the Middle East. Retrieved March 15, 2018.Symantec DeepSight Adversary Intelligence Team. (2018, December 10). Seedworm: Group Compromises Government Agencies, Oil & Gas, NGOs, Telecoms, and IT Firms. Retrieved December 14, 2018.Unit42. (2016, May 1). Evasive Serpens Unit 42 Playbook Viewer. Retrieved February 6, 2023.Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018.Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34’s Invite to Join Their Professional Network. Retrieved August 26, 2019.Nicolas Verdier. (n.d.). Retrieved January 29, 2018.Dell SecureWorks Counter Threat Unit Threat Intelligence. (2015, August 5). Threat Group-3390 Targets Organizations for Cyberespionage. Retrieved August 18, 2018.Counter Threat Unit Research Team. (2017, June 27). BRONZE UNION Cyberespionage Persists Despite Disclosures. Retrieved July 13, 2017.PowerSploit. (n.d.). Retrieved December 4, 2014.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.