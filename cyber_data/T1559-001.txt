MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseInter-Process CommunicationComponent Object ModelInter-Process Communication:Component Object ModelOther sub-techniques of Inter-Process Communication (3)IDNameT1559.001Component Object ModelT1559.002Dynamic Data ExchangeT1559.003XPC ServicesAdversaries may use the Windows Component Object Model (COM) for local code execution. COM is an inter-process communication (IPC) component of the native Windows application programming interface (API) that enables interaction between software objects, or executable code that implements one or more interfaces.[1]Through COM, a client object can call methods of server objects, which are typically binary Dynamic Link Libraries (DLL) or executables (EXE).[2]Remote COM execution is facilitated byRemote Servicessuch asDistributed Component Object Model(DCOM).[1]Various COM interfaces are exposed that can be abused to invoke arbitrary execution via a variety of programming languages such as C, C++, Java, andVisual Basic.[2]Specific COM objects also exist to directly perform functions beyond code execution, such as creating aScheduled Task/Job, fileless download/execution, and other adversary behaviors related to privilege escalation and persistence.[1][3]ID:T1559.001Sub-technique of:T1559ⓘTactic:ExecutionⓘPlatforms:WindowsⓘSupports Remote:YesVersion:1.1Created:12 February 2020Last Modified:26 July 2021Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS1039BumblebeeBumblebeecan use a COM object to execute queries to gather system information.[4]S1066DarkTortillaDarkTortillahas used theWshShortcutCOM object to create a .lnk shortcut file in the Windows startup folder.[5]S1044FunnyDreamFunnyDreamcan use com objects identified withCLSID_ShellLink(IShellLinkandIPersistFile) andWScript.Shell(RegWritemethod) to enable persistence mechanisms.[6]G0047Gamaredon GroupGamaredon Groupmalware can insert malicious macros into documents using aMicrosoft.Office.Interopobject.[7]S0666GelsemiumGelsemiumcan use theIARPUinstallerStringLauncherCOM interface are part of its UAC bypass process.[8]S0698HermeticWizardHermeticWizardcan execute files on remote machines using DCOM.[9]S0260InvisiMoleInvisiMolecan use theITaskService,ITaskDefinitionandITaskSettingsCOM interfaces to schedule a task.[10]S1015MilanMilancan use a COM component to generate scheduled tasks.[11]G0069MuddyWaterMuddyWaterhas used malware that has the capability to execute malicious code via COM, DCOM, and Outlook.[12][13][14]S0691NeoichorNeoichorcan use the Internet Explorer (IE) COM interface to connect and receive commands from C2.[15]S0223POWERSTATSPOWERSTATScan use DCOM (targeting the 127.0.0.1 loopback address) to execute additional payloads on compromised hosts.[16]S0458RamsayRamsaycan use the Windows COM API to schedule tasks and maintain persistence.[17]S0266TrickBotTrickBotused COM to setup scheduled task for persistence.[18]S0386UrsnifUrsnifdroppers have used COM objects to execute the malware's full executable payload.[19]MitigationsIDMitigationDescriptionM1048Application Isolation and SandboxingEnsure all COM alerts and Protected View are enabled.[20]M1026Privileged Account ManagementModify Registry settings (directly or using Dcomcnfg.exe) inHKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\AppID\\{AppID_GUID}associated with the process-wide security of individual COM applications.[21]Modify Registry settings (directly or using Dcomcnfg.exe) inHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Oleassociated with system-wide security defaults for all COM applications that do no set their own process-wide security.[22][23]DetectionIDData SourceData ComponentDetectsDS0011ModuleModule LoadMonitor for COM objects loading DLLs and other modules not typically associated with the application.[24]DS0009ProcessProcess CreationMonitor for newly executed processes that are associated with COM objects, especially those invoked by a user different than the one currently logged on.DS0012ScriptScript ExecutionMonitor for any attempts to enable scripts running on a system would be considered suspicious. Enumeration of COM objects, viaQuery RegistryorPowerShell, may also proceed malicious use.[1][24]ReferencesHamilton, C. (2019, June 4). Hunting COM Objects. Retrieved June 10, 2019.Microsoft. (n.d.). Component Object Model (COM). Retrieved November 22, 2017.Forshaw, J. (2018, April 18). Windows Exploitation Tricks: Exploiting Arbitrary File Writes for Local Elevation of Privilege. Retrieved May 3, 2018.Merriman, K. and Trouerbach, P. (2022, April 28). This isn't Optimus Prime's Bumblebee but it's Still Transforming. Retrieved August 22, 2022.Secureworks Counter Threat Unit Research Team. (2022, August 17). DarkTortilla Malware Analysis. Retrieved November 3, 2022.Vrabie, V. (2020, November). Dissecting a Chinese APT Targeting South Eastern Asian Government Institutions. Retrieved September 19, 2022.Boutin, J. (2020, June 11). Gamaredon group grows its game. Retrieved June 16, 2020.Dupuy, T. and Faou, M. (2021, June). Gelsemium. Retrieved November 30, 2021.ESET. (2022, March 1). IsaacWiper and HermeticWizard: New wiper and worm targetingUkraine. Retrieved April 10, 2022.Hromcova, Z. and Cherpanov, A. (2020, June). INVISIMOLE: THE HIDDEN PART OF THE STORY. Retrieved July 16, 2020.ClearSky Cyber Security . (2021, August). New Iranian Espionage Campaign By “Siamesekitten” - Lyceum. Retrieved June 6, 2022.Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018.ClearSky. (2019, June). Iranian APT group ‘MuddyWater’ Adds Exploits to Their Arsenal. Retrieved May 14, 2020.FBI, CISA, CNMF, NCSC-UK. (2022, February 24). Iranian Government-Sponsored Actors Conduct Cyber Operations Against Global Government and Commercial Networks. Retrieved September 27, 2022.MSTIC. (2021, December 6). NICKEL targeting government organizations across Latin America and Europe. Retrieved March 18, 2022.Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018.Sanmillan, I.. (2020, May 13). Ramsay: A cyber‑espionage toolkit tailored for air‑gapped networks. Retrieved May 27, 2020.Boutin, J. (2020, October 12). ESET takes part in global operation to disrupt Trickbot. Retrieved March 15, 2021.Holland, A. (2019, March 7). Tricks and COMfoolery: How Ursnif Evades Detection. Retrieved June 10, 2019.Microsoft. (n.d.). What is Protected View?. Retrieved November 22, 2017.Microsoft. (n.d.). Setting Process-Wide Security Through the Registry. Retrieved November 21, 2017.Microsoft. (n.d.). Registry Values for System-Wide Security. Retrieved November 21, 2017.Microsoft. (n.d.). DCOM Security Enhancements in Windows XP Service Pack 2 and Windows Server 2003 Service Pack 1. Retrieved November 22, 2017.Nelson, M. (2017, January 5). Lateral Movement using the MMC20 Application COM Object. Retrieved November 21, 2017.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.