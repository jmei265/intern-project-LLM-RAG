MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseUnsecured CredentialsCredentials In FilesUnsecured Credentials:Credentials In FilesOther sub-techniques of Unsecured Credentials (8)IDNameT1552.001Credentials In FilesT1552.002Credentials in RegistryT1552.003Bash HistoryT1552.004Private KeysT1552.005Cloud Instance Metadata APIT1552.006Group Policy PreferencesT1552.007Container APIT1552.008Chat MessagesAdversaries may search local file systems and remote file shares for files containing insecurely stored credentials. These can be files created by users to store their own credentials, shared credential stores for a group of individuals, configuration files containing passwords for a system or service, or source code/binary files containing embedded passwords.It is possible to extract passwords from backups or saved virtual machines throughOS Credential Dumping.[1]Passwords may also be obtained from Group Policy Preferences stored on the Windows Domain Controller.[2]In cloud and/or containerized environments, authenticated user and service account credentials are often stored in local configuration and credential files.[3]They may also be found as parameters to deployment commands in container logs.[4]In some cases, these files can be copied and reused on another machine or the contents can be read and then used to authenticate without needing to copy any files.[5]ID:T1552.001Sub-technique of:T1552ⓘTactic:Credential AccessⓘPlatforms:Containers, IaaS, Linux, Windows, macOSⓘSystem Requirements:Access to filesContributors:Jay Chen, Palo Alto Networks; Microsoft Threat Intelligence Center (MSTIC); Rory McCune, Aqua Security; Vishwas Manral, McAfee; Yossi Weizman, Azure Defender Research TeamVersion:1.2Created:04 February 2020Last Modified:15 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0677AADInternalsAADInternalscan gather unsecured credentials for Azure AD services, such as Azure AD Connect, from a local machine.[6]S0331Agent TeslaAgent Teslahas the ability to extract credentials from configuration or support files.[7]G0022APT3APT3has a tool that can locate credentials in files on the file system such as those from Firefox or Chrome.[8]G0064APT33APT33has used a variety of publicly available tools likeLaZagneto gather credentials.[9][10]S0344AzorultAzorultcan steal credentials in files belonging to common software such as Skype, Telegram, and Steam.[11]S0089BlackEnergyBlackEnergyhas used a plug-in to gather credentials stored in files on the host by various software programs, including The Bat! email client, Outlook, and Windows Credential Store.[12][13]S0367EmotetEmotethas been observed leveraging a module that retrieves passwords stored on a system for the current logged-on user.[14][15]S0363EmpireEmpirecan use various modules to search for files containing passwords.[16]G1016FIN13FIN13has obtained administrative credentials by browsing through local files on a compromised machine.[17]G0117Fox KittenFox Kittenhas accessed files to gain valid credentials.[18]S0601HildegardHildegardhas searched for SSH keys, Docker credentials, and Kubernetes service tokens.[3]S0283jRATjRATcan capture passwords from common chat applications such as MSN Messenger, AOL, Instant Messenger, and and Google Talk.[19]G0094KimsukyKimsukyhas used tools that are capable of obtaining credentials from saved mail.[20]S0349LaZagneLaZagnecan obtain credentials from chats, databases, mail, and WiFi.[21]G0077LeafminerLeafminerused several tools for retrieving login and password information, including LaZagne.[22]G0069MuddyWaterMuddyWaterhas run a tool that steals passwords saved in victim email.[23]G0049OilRigOilRighas used credential dumping tools such asLaZagneto steal credentials to accounts logged into the compromised system and to Outlook Web Access.[24][25][26][27]S0067pngdownerIf an initial connectivity check fails,pngdownerattempts to extract proxy details and credentials from Windows Protected Storage and from the IE Credentials Store. This allows the adversary to use the proxy credentials for subsequent requests if they enable outbound HTTP access.[28]S0378PoshC2PoshC2contains modules for searching for passwords in local and remote files.[29]S0192PupyPupycan use Lazagne for harvesting credentials.[30]S0583PysaPysahas extracted credentials from the password database before encrypting the files.[31]S0262QuasarRATQuasarRATcan obtain passwords from FTP clients.[32][33]G1015Scattered SpiderScattered SpiderSpider searches for credential storage documentation on a compromised host.[34]S0226Smoke LoaderSmoke Loadersearches for files named logins.json to parse for credentials.[35]G0092TA505TA505has used malware to gather credentials from FTP clients and Outlook.[36]G0139TeamTNTTeamTNThas searched for unsecured AWS credentials and Docker API credentials.[37][38][39]S0266TrickBotTrickBotcan obtain passwords stored in files from several applications such as Outlook, Filezilla, OpenSSH, OpenVPN and WinSCP.[40][41]Additionally, it searches for the ".vnc.lnk" affix to steal VNC credentials.[42]S0117XTunnelXTunnelis capable of accessing locally stored passwords on victims.[43]MitigationsIDMitigationDescriptionM1047AuditPreemptively search for files containing passwords and take actions to reduce the exposure risk when found.M1027Password PoliciesEstablish an organizational policy that prohibits password storage in files.M1022Restrict File and Directory PermissionsRestrict file shares to specific directories with access only to necessary users.M1017User TrainingEnsure that developers and system administrators are aware of the risk associated with having plaintext passwords in software configuration files that may be left on endpoint systems or servers.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionWhile detecting adversaries accessing these files may be difficult without knowing they exist in the first place, it may be possible to detect adversary use of credentials they have obtained. Monitor executed commands and arguments of executing processes for suspicious words or regular expressions that may indicate searching for a password (for example: password, pwd, login, secure, or credentials). SeeValid Accountsfor more information.DS0022FileFile AccessMonitor for files being accessed that may search local file systems and remote file shares for files containing insecurely stored credentials. While detecting adversaries accessing these files may be difficult without knowing they exist in the first place, it may be possible to detect adversary use of credentials they have obtained.DS0009ProcessProcess CreationMonitor newly executed processes for local file systems and remote file shares for files containing insecurely stored credentials.Note: Pseudocode Event IDs are for Sysmon (Event ID 1 - process create) and Windows Security Log (Event ID 4688 - a new process has been created). The Analytic looks for command-line instances of searching the Windows Registry for insecurely stored credentials. This can be accomplished using the query functionality of theRegsystem utility, by looking for keys and values that contain strings such as "password". In addition, adversaries may use toolkits such asPowerSploitin order to dump credentials from various applications such as IIS. Accordingly, this analytic looks for invocations of reg.exe in this capacity as well as that of several PowerSploit modules with similar functionality.Analytic 1 - Credentials in Files & Registry(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688")CommandLine="regquery HKLM /f password /t REG_SZ /s" ORCommandLine="regquery HKCU /f password /t REG_SZ /s" ORCommandLine="Get-UnattendedInstallFile" ORCommandLine="Get-Webconfig" ORCommandLine="Get-ApplicationHost" ORCommandLine="Get-SiteListPassword" ORCommandLine="Get-CachedGPPPassword" ORCommandLine="Get-RegistryAutoLogon*"ReferencesCG. (2014, May 20). Mimikatz Against Virtual Machine Memory Part 1. Retrieved November 12, 2014.Security Research and Defense. (2014, May 13). MS14-025: An Update for Group Policy Preferences. Retrieved January 28, 2015.Chen, J. et al. (2021, February 3). Hildegard: New TeamTNT Cryptojacking Malware Targeting Kubernetes. Retrieved April 5, 2021.Chen, J.. (2020, January 29). Attacker's Tactics and Techniques in Unsecured Docker Daemons Revealed. Retrieved March 31, 2021.Maddalena, C.. (2018, September 12). Head in the Clouds. Retrieved October 4, 2019.Dr. Nestori Syynimaa. (2018, October 25). AADInternals. Retrieved February 18, 2022.Walter, J. (2020, August 10). Agent Tesla | Old RAT Uses New Tricks to Stay on Top. Retrieved December 11, 2020.Symantec Security Response. (2016, September 6). Buckeye cyberespionage group shifts gaze from US to Hong Kong. Retrieved September 26, 2016.Security Response attack Investigation Team. (2019, March 27). Elfin: Relentless Espionage Group Targets Multiple Organizations in Saudi Arabia and U.S.. Retrieved April 10, 2019.Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019.Yan, T., et al. (2018, November 21). New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit. Retrieved November 29, 2018.F-Secure Labs. (2014). BlackEnergy & Quedagh: The convergence of crimeware and APT attacks. Retrieved March 24, 2016.Baumgartner, K. and Garnaeva, M.. (2014, November 3). BE2 custom plugins, router abuse, and target profiles. Retrieved March 24, 2016.US-CERT. (2018, July 20). Alert (TA18-201A) Emotet Malware. Retrieved March 25, 2019.CIS. (2018, December 12). MS-ISAC Security Primer- Emotet. Retrieved March 25, 2019.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.Sygnia Incident Response Team. (2022, January 5). TG2003: ELEPHANT BEETLE UNCOVERING AN ORGANIZED FINANCIAL-THEFT OPERATION. Retrieved February 9, 2023.CISA. (2020, September 15). Iran-Based Threat Actor Exploits VPN Vulnerabilities. Retrieved December 21, 2020.Kamluk, V. & Gostev, A. (2016, February). Adwind - A Cross-Platform RAT. Retrieved April 23, 2019.ASERT team. (2018, December 5). STOLEN PENCIL Campaign Targets Academia. Retrieved February 5, 2019.Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018.Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.Symantec DeepSight Adversary Intelligence Team. (2018, December 10). Seedworm: Group Compromises Government Agencies, Oil & Gas, NGOs, Telecoms, and IT Firms. Retrieved December 14, 2018.Unit42. (2016, May 1). Evasive Serpens Unit 42 Playbook Viewer. Retrieved February 6, 2023.Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018.Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34’s Invite to Join Their Professional Network. Retrieved August 26, 2019.Crowdstrike Global Intelligence Team. (2014, June 9). CrowdStrike Intelligence Report: Putter Panda. Retrieved January 22, 2016.Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.Nicolas Verdier. (n.d.). Retrieved January 29, 2018.CERT-FR. (2020, April 1). ATTACKS INVOLVING THE MESPINOZA/PYSA RANSOMWARE. Retrieved March 1, 2021.MaxXor. (n.d.). QuasarRAT. Retrieved July 10, 2018.Meltzer, M, et al. (2018, June 07). Patchwork APT Group Targets US Think Tanks. Retrieved July 16, 2018.CISA. (2023, November 16). Cybersecurity Advisory: Scattered Spider (AA23-320A). Retrieved March 18, 2024.Baker, B., Unterbrink H. (2018, July 03). Smoking Guns - Smoke Loader learned new tricks. Retrieved July 5, 2018.Proofpoint Staff. (2017, September 27). Threat Actor Profile: TA505, From Dridex to GlobeImposter. Retrieved May 28, 2019.Cado Security. (2020, August 16). Team TNT – The First Crypto-Mining Worm to Steal AWS Credentials. Retrieved September 22, 2021.Fiser, D. Oliveira, A. (n.d.). Tracking the Activities of TeamTNT A Closer Look at a Cloud-Focused Malicious Actor Group. Retrieved September 22, 2021.Darin Smith. (2022, April 21). TeamTNT targeting AWS, Alibaba. Retrieved August 4, 2022.Anthony, N., Pascual, C.. (2018, November 1). Trickbot Shows Off New Trick: Password Grabber Module. Retrieved November 16, 2018.Dahan, A. et al. (2019, December 11). DROPPING ANCHOR: FROM A TRICKBOT INFECTION TO THE DISCOVERY OF THE ANCHOR MALWARE. Retrieved September 10, 2020.Llimos, N., Pascual, C.. (2019, February 12). Trickbot Adds Remote Application Credential-Grabbing Capabilities to Its Repertoire. Retrieved March 12, 2019.Belcher, P.. (2016, July 28). Tunnel of Gov: DNC Hack and the Russian XTunnel. Retrieved August 3, 2016.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.