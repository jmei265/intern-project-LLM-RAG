MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseProtocol TunnelingProtocol TunnelingAdversaries may tunnel network communications to and from a victim system within a separate protocol to avoid detection/network filtering and/or enable access to otherwise unreachable systems. Tunneling involves explicitly encapsulating a protocol within another. This behavior may conceal malicious traffic by blending in with existing traffic and/or provide an outer layer of encryption (similar to a VPN). Tunneling could also enable routing of network packets that would otherwise not reach their intended destination, such as SMB, RDP, or other traffic that would be filtered by network appliances or not routed over the Internet.There are various means to encapsulate a protocol within another protocol. For example, adversaries may perform SSH tunneling (also known as SSH port forwarding), which involves forwarding arbitrary data over an encrypted SSH tunnel.[1]Protocol Tunnelingmay also be abused by adversaries duringDynamic Resolution. Known as DNS over HTTPS (DoH), queries to resolve C2 infrastructure may be encapsulated within encrypted HTTPS packets.[2]Adversaries may also leverageProtocol Tunnelingin conjunction withProxyand/orProtocol Impersonationto further conceal C2 communications and infrastructure.ID:T1572Sub-techniques:No sub-techniquesⓘTactic:Command and ControlⓘPlatforms:Linux, Windows, macOSVersion:1.0Created:15 March 2020Last Modified:27 March 2020Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionC00342022 Ukraine Electric Power AttackDuring the2022 Ukraine Electric Power Attack,Sandworm Teamdeployed the GOGETTER tunneler software to establish a "Yamux" TLS-based C2 channel with an external server(s).[3]S1063Brute Ratel C4Brute Ratel C4can use DNS over HTTPS for C2.[4][5]C0027C0027DuringC0027,Scattered Spiderused SSH tunneling in targeted environments.[6]C0032C0032During theC0032campaign,TEMP.Velesused encrypted SSH-based PLINK tunnels to transfer tools and enable RDP connections throughout the environment.[7]G0114ChimeraChimerahas encapsulatedCobalt Strike's C2 protocol in DNS and HTTPS.[8]G1021Cinnamon TempestCinnamon Tempesthas used the Iox and NPS proxy and tunneling tools in combination  create multiple connections through a single tunnel.[9]G0080Cobalt GroupCobalt Grouphas used the Plink utility to create SSH tunnels.[10][11][12]S0154Cobalt StrikeCobalt Strikeuses a custom command and control protocol that is encapsulated in HTTP, HTTPS, or DNS. In addition, it conducts peer-to-peer communication over Windows named pipes encapsulated in the SMB protocol. All protocols use their standard assigned ports.[13][14]C0004CostaRictoDuringCostaRicto, the threat actors set up remote SSH tunneling into the victim's environment from a malicious domain.[15]C0029Cutting EdgeDuringCutting Edge, threat actors used Iodine to tunnel IPv4 traffic over DNS.[16]S0687Cyclops BlinkCyclops Blinkcan use DNS over HTTPS (DoH) to resolve C2 nodes.[17]S0038DuquDuquuses a custom command and control protocol that communicates over commonly used ports, and is frequently encapsulated by application layer protocols.[18]G1016FIN13FIN13has utilized web shells and Java tools for tunneling capabilities to and from compromised assets.[19]G0037FIN6FIN6used the Plink command-line utility to create SSH tunnels to C2 servers.[20]S0173FLIPSIDEFLIPSIDEuses RDP to tunnel traffic from a victim environment.[21]G0117Fox KittenFox Kittenhas used protocol tunneling for communication and RDP activity on compromised hosts through the use of open source tools such asngrokand custom tool SSHMinion.[22][23][24]S1044FunnyDreamFunnyDreamcan connect to HTTP proxies via TCP to create a tunnel to C2.[25]S1027Heyoka BackdoorHeyoka Backdoorcan use spoofed DNS requests to create a bidirectional tunnel between a compromised host and its C2 servers.[26]S0604IndustroyerIndustroyerattempts to perform an HTTP CONNECT via an internal proxy to establish a tunnel.[27]S1020KevinKevincan use a custom protocol tunneled through DNS or HTTP.[28]G0065LeviathanLeviathanhas used protocol tunneling to further conceal C2 communications and infrastructure.[29]G0059Magic HoundMagic Houndhas used Plink to tunnel RDP over SSH.[30]S1015MilanMilancan use a custom protocol tunneled through DNS or HTTP.[28]S0699MythicMythiccan use SOCKS proxies to tunnel traffic through another protocol.[31]S0508ngrokngrokcan tunnel RDP and other services securely over internet connections.[32][33][34][35]G0049OilRigOilRighas used the Plink utility and other tools to create tunnels to C2 servers.[36][37][38]S0650QakBotTheQakBotproxy module can encapsulate SOCKS5 protocol within its own proxy protocol.[39]S0022UroburosUroburoshas the ability to communicate over custom communications methodologies that ride over common network protocols including raw TCP and UDP sockets, HTTP, SMTP, and DNS.[40]MitigationsIDMitigationDescriptionM1037Filter Network TrafficConsider filtering network traffic to untrusted or known bad domains and resources.M1031Network Intrusion PreventionNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.DetectionIDData SourceData ComponentDetectsDS0029Network TrafficNetwork Connection CreationMonitor for newly constructed network connections that are sent or received by untrusted hosts.Network Traffic ContentMonitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).Network Traffic FlowMonitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.ReferencesSSH.COM. (n.d.). SSH tunnel. Retrieved March 15, 2020.Gatlan, S. (2019, July 3). New Godlua Malware Evades Traffic Monitoring via DNS over HTTPS. Retrieved March 15, 2020.Ken Proska, John Wolfram, Jared Wilson, Dan Black, Keith Lunden, Daniel Kapellmann Zafra, Nathan Brubaker, Tyler Mclellan, Chris Sistrunk. (2023, November 9). Sandworm Disrupts Power in Ukraine Using a Novel Attack Against Operational Technology. Retrieved March 28, 2024.Harbison, M. and Renals, P. (2022, July 5). When Pentest Tools Go Brutal: Red-Teaming Tool Being Abused by Malicious Actors. Retrieved February 1, 2023.Kenefick, I. et al. (2022, October 12). Black Basta Ransomware Gang Infiltrates Networks via QAKBOT, Brute Ratel, and Cobalt Strike. Retrieved February 6, 2023.Parisi, T. (2022, December 2). Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies. Retrieved June 30, 2023.Miller, S, et al. (2019, April 10). TRITON Actor TTP Profile, Custom Attack Tools, Detections, and ATT&CK Mapping. Retrieved April 16, 2019.Jansen, W . (2021, January 12). Abusing cloud services to fly under the radar. Retrieved January 19, 2021.Biderman, O. et al. (2022, October 3). REVEALING EMPEROR DRAGONFLY: NIGHT SKY AND CHEERSCRYPT - A SINGLE RANSOMWARE GROUP. Retrieved December 6, 2023.Svajcer, V. (2018, July 31). Multiple Cobalt Personality Disorder. Retrieved September 5, 2018.Positive Technologies. (2016, December 16). Cobalt Snatch. Retrieved October 9, 2018.Matveeva, V. (2017, August 15). Secrets of Cobalt. Retrieved October 10, 2018.Strategic Cyber LLC. (2017, March 14). Cobalt Strike Manual. Retrieved May 24, 2017.Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.The BlackBerry Research and Intelligence Team. (2020, November 12). The CostaRicto Campaign: Cyber-Espionage Outsourced. Retrieved May 24, 2021.Lin, M. et al. (2024, January 31). Cutting Edge, Part 2: Investigating Ivanti Connect Secure VPN Zero-Day Exploitation. Retrieved February 27, 2024.Haquebord, F. et al. (2022, March 17). Cyclops Blink Sets Sights on Asus Routers. Retrieved March 17, 2022.Symantec Security Response. (2011, November). W32.Duqu: The precursor to the next Stuxnet. Retrieved September 17, 2015.Sygnia Incident Response Team. (2022, January 5). TG2003: ELEPHANT BEETLE UNCOVERING AN ORGANIZED FINANCIAL-THEFT OPERATION. Retrieved February 9, 2023.FireEye Threat Intelligence. (2016, April). Follow the Money: Dissecting the Operations of the Cyber Crime Group FIN6. Retrieved June 1, 2016.Bromiley, M. and Lewis, P. (2016, October 7). Attacking the Hospitality and Gaming Industries: Tracking an Attacker Around the World in 7 Years. Retrieved October 6, 2017.Orleans, A. (2020, August 31). Who Is PIONEER KITTEN?. Retrieved December 21, 2020.CISA. (2020, September 15). Iran-Based Threat Actor Exploits VPN Vulnerabilities. Retrieved December 21, 2020.ClearSky. (2020, December 17). Pay2Key Ransomware – A New Campaign by Fox Kitten. Retrieved December 21, 2020.Vrabie, V. (2020, November). Dissecting a Chinese APT Targeting South Eastern Asian Government Institutions. Retrieved September 19, 2022.Chen, Joey. (2022, June 9). Aoqin Dragon | Newly-Discovered Chinese-linked APT Has Been Quietly Spying On Organizations For 10 Years. Retrieved July 14, 2022.Dragos Inc.. (2017, June 13). CRASHOVERRIDE Analysis of the Threat to Electric Grid Operations. Retrieved December 18, 2020.Kayal, A. et al. (2021, October). LYCEUM REBORN: COUNTERINTELLIGENCE IN THE MIDDLE EAST. Retrieved June 14, 2022.CISA. (2021, July 19). (AA21-200A) Joint Cybersecurity Advisory – Tactics, Techniques, and Procedures of Indicted APT40 Actors Associated with China’s MSS Hainan State Security Department. Retrieved August 12, 2021.DFIR Report. (2021, November 15). Exchange Exploit Leads to Domain Wide Ransomware. Retrieved January 5, 2023.Thomas, C. (n.d.). Mythc Documentation. Retrieved March 25, 2022.Kennelly, J., Goody, K., Shilko, J. (2020, May 7). Navigating the MAZE: Tactics, Techniques and Procedures Associated With MAZE Ransomware Incidents. Retrieved May 18, 2020.Cyware. (2019, May 29). Cyber attackers leverage tunneling service to drop Lokibot onto victims’ systems. Retrieved September 15, 2020.Segura, J. (2020, February 26). Fraudsters cloak credit card skimmer with fake content delivery network, ngrok server. Retrieved September 15, 2020.Borja, A. Camba, A. et al (2020, September 14). Analysis of a Convoluted Attack Chain Involving Ngrok. Retrieved September 15, 2020.Unit42. (2016, May 1). Evasive Serpens Unit 42 Playbook Viewer. Retrieved February 6, 2023.Davis, S. and Caban, D. (2017, December 19). APT34 - New Targeted Attack in the Middle East. Retrieved December 20, 2017.Bromiley, M., et al.. (2019, July 18). Hard Pass: Declining APT34’s Invite to Join Their Professional Network. Retrieved August 26, 2019.Kuzmenko, A. et al. (2021, September 2). QakBot technical analysis. Retrieved September 27, 2021.FBI et al. (2023, May 9). Hunting Russian Intelligence “Snake” Malware. Retrieved June 8, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.