MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterprisePassword Policy DiscoveryPassword Policy DiscoveryAdversaries may attempt to access detailed information about the password policy used within an enterprise network or cloud environment. Password policies are a way to enforce complex passwords that are difficult to guess or crack throughBrute Force. This information may help the adversary to create a list of common passwords and launch dictionary and/or brute force attacks which adheres to the policy (e.g. if the minimum password length should be 8, then not trying passwords such as 'pass123'; not checking for more than 3-4 passwords per account if the lockout is set to 6 as to not lock out accounts).Password policies can be set and discovered on Windows, Linux, and macOS systems via various command shell utilities such asnet accounts (/domain),Get-ADDefaultDomainPasswordPolicy,chage -l,cat /etc/pam.d/common-password, andpwpolicy getaccountpolicies[1][2]. Adversaries may also leverage aNetwork Device CLIon network devices to discover password policy information (e.g.show aaa,show aaa common-criteria policy all).[3]Password policies can be discovered in cloud environments using available APIs such asGetAccountPasswordPolicyin AWS[4].ID:T1201Sub-techniques:No sub-techniquesⓘTactic:DiscoveryⓘPlatforms:IaaS, Linux, Network, Windows, macOSContributors:Austin Clark, @c2defense; Isif Ibrahima, Mandiant; Regina Elwell; Sudhanshu Chauhan, @Sudhanshu_CVersion:1.5Created:18 April 2018Last Modified:06 September 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0521BloodHoundBloodHoundcan collect password policy information on the target environment.[5]G0114ChimeraChimerahas used the NtdsAudit utility to collect information related to accounts and passwords.[6]S0488CrackMapExecCrackMapExeccan discover the password policies applied to the target system.[7]S0236KwampirsKwampirscollects password policy information with the commandnet accounts.[8]S0039NetThenet accountsandnet accounts /domaincommands withNetcan be used to obtain password policy information.[9]G0049OilRigOilRighas used net.exe in a script withnet accounts /domainto find the password policy of a domain.[10]C0012Operation CuckooBeesDuringOperation CuckooBees, the threat actors used thenet accountscommand as part of their advanced reconnaissance.[11]S0378PoshC2PoshC2can useGet-PassPolto enumerate the domain password policy.[12]G0010TurlaTurlahas usednet accountsandnet accounts /domainto acquire password policy information.[13]MitigationsIDMitigationDescriptionM1027Password PoliciesEnsure only valid password filters are registered. Filter DLLs must be present in Windows installation directory (C:\Windows\System32\by default) of a domain controller and/or local computer with a corresponding entry inHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages.[14]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments for actions that may attempt to access detailed information about the password policy used within an enterprise network or cloud environment. For network devices, monitor executed commands in AAA logs, especially those run by unexpected or unauthorized users.DS0009ProcessProcess CreationMonitor for newly executed processes that may attempt to access detailed information about the password policy used within an enterprise network or cloud environment.DS0002User AccountUser Account MetadataMonitor for contextual data about an account that may attempt to access detailed information about the password policy used within an enterprise network or cloud environment.ReferencesMatutiae, M. (2014, August 6). How to display password policy information for a user (Ubuntu)?. Retrieved April 5, 2018.Holland, J. (2016, January 25). User password policies on non AD machines. Retrieved April 5, 2018.US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.Amazon Web Services. (n.d.). AWS API GetAccountPasswordPolicy. Retrieved June 8, 2021.Red Team Labs. (2018, April 24). Hidden Administrative Accounts: BloodHound to the Rescue. Retrieved October 28, 2020.Jansen, W . (2021, January 12). Abusing cloud services to fly under the radar. Retrieved January 19, 2021.byt3bl33d3r. (2018, September 8). SMB: Command Reference. Retrieved July 17, 2020.Symantec Security Response Attack Investigation Team. (2018, April 23). New Orangeworm attack group targets the healthcare sector in the U.S., Europe, and Asia. Retrieved May 8, 2018.Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015.Singh, S., Yin, H. (2016, May 22). https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.html. Retrieved April 5, 2018.Cybereason Nocturnus. (2022, May 4). Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques. Retrieved September 22, 2022.Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.Faou, M. (2020, May). From Agent.btz to ComRAT v4: A ten-year journey. Retrieved June 15, 2020.Microsoft. (n.d.). Installing and Registering a Password Filter DLL. Retrieved November 21, 2017.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.