MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseReplication Through Removable MediaReplication Through Removable MediaAdversaries may move onto systems, possibly those on disconnected or air-gapped networks, by copying malware to removable media and taking advantage of Autorun features when the media is inserted into a system and executes. In the case of Lateral Movement, this may occur through modification of executable files stored on removable media or by copying malware and renaming it to look like a legitimate file to trick users into executing it on a separate system. In the case of Initial Access, this may occur through manual manipulation of the media, modification of systems used to initially format the media, or modification to the media's firmware itself.Mobile devices may also be used to infect PCs with malware if connected via USB.[1]This infection may be achieved using devices (Android, iOS, etc.) and, in some instances, USB charging cables.[2][3]For example, when a smartphone is connected to a system, it may appear to be mounted similar to a USB-connected disk drive. If malware that is compatible with the connected system is on the mobile device, the malware could infect the machine (especially if Autorun features are enabled).ID:T1091Sub-techniques:No sub-techniquesⓘTactics:Lateral Movement,Initial AccessⓘPlatforms:WindowsⓘSystem Requirements:Removable media allowed, Autorun enabled or vulnerability present that allows for code executionContributors:Joas Antonio dos Santos, @C0d3Cr4zyVersion:1.2Created:31 May 2017Last Modified:17 October 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0092Agent.btzAgent.btzdrops itself onto removable media devices and creates an autorun.inf file with an instruction to run that file. When the device is inserted into another system, it opens autorun.inf and loads the malware.[4]S1074ANDROMEDAANDROMEDAhas been spread via infected USB keys.[5]G1007Aoqin DragonAoqin Dragonhas used a dropper that employs a worm infection strategy using a removable device to breach a secure network environment.[6]G0007APT28APT28uses a tool to infect connected USB devices and transmit itself to air-gapped computers when the infected USB device is inserted.[7]S0023CHOPSTICKPart ofAPT28's operation involved usingCHOPSTICKmodules to copy itself to air-gapped machines and using files written to USB sticks to transfer data and command traffic.[8][7][9]S0608ConfickerConfickervariants used the Windows AUTORUN feature to spread through USB propagation.[10][11]S0115CrimsonCrimsoncan spread across systems by infecting removable media.[12]G0012DarkhotelDarkhotel's selective infector modifies executables stored on removable media as a method of spreading across computers.[13]S0062DustySkyDustySkysearches for removable media and duplicates itself onto it.[14]G0046FIN7FIN7actors have mailed USB drives to potential victims containing malware that downloads and installs various backdoors, including in some cases for ransomware operations.[15]S0143FlameFlamecontains modules to infect USB sticks and spread laterally to other Windows systems the stick is plugged into using Autorun functionality.[16]S0132H1N1H1N1has functionality to copy itself to removable media.[17]G1014LuminousMothLuminousMothhas used malicious DLLs to spread malware to connected removable USB drives on infected machines.[18][19]G0129Mustang PandaMustang Pandahas used a customizedPlugXvariant which could spread through USB connections.[20]S0385njRATnjRATcan be configured to spread via removable drives.[21][22]S0650QakBotQakBothas the ability to use removable drives to spread through compromised networks.[23]S0458RamsayRamsaycan spread itself by infecting other portable executable files on removable drives.[24]S0028SHIPSHAPEAPT30may have used theSHIPSHAPEmalware to move onto air-gapped networks.SHIPSHAPEtargets removable drives to spread to other systems by modifying the drive to use Autorun to execute or by hiding legitimate document files and copying an executable to the folder with the same name as the legitimate document.[25]S0603StuxnetStuxnetcan propagate via removable media using an autorun.inf file or the CVE-2010-2568 LNK vulnerability.[26]G0081Tropic TrooperTropic Trooperhas attempted to transferUSBferryfrom an infected USB device by copying an Autorun function to the target machine.[27]S0130Unknown LoggerUnknown Loggeris capable of spreading to USB devices.[28]S0386UrsnifUrsnifhas copied itself to and infected removable drives for propagation.[29][30]S0452USBferryUSBferrycan copy its installer to attached USB storage devices.[27]S0136USBStealerUSBStealerdrops itself onto removable media and relies on Autorun to execute the malicious file when a user opens the removable media on another system.[31]MitigationsIDMitigationDescriptionM1040Behavior Prevention on EndpointOn Windows 10, enable Attack Surface Reduction (ASR) rules to block unsigned/untrusted executable files (such as .exe, .dll, or .scr) from running from USB removable drives.[32]M1042Disable or Remove Feature or ProgramDisable Autorun if it is unnecessary.[33]Disallow or restrict removable media at an organizational policy level if it is not required for business operations.[34]M1034Limit Hardware InstallationLimit the use of USB devices and removable media within a network.DetectionIDData SourceData ComponentDetectsDS0016DriveDrive CreationMonitor for newly constructed drive letters or mount points to removable mediaDS0022FileFile AccessMonitor for unexpected files accessed on removable media.File CreationMonitor for newly constructed files on removable mediaDS0009ProcessProcess CreationMonitor for newly executed processes that execute from removable media after it is mounted or when initiated by a user. If a remote access tool is used in this manner to move laterally, then additional actions are likely to occur after execution, such as opening network connections for Command and Control and system and network information Discovery.ReferencesZhaohui Wang & Angelos Stavrou. (n.d.). Exploiting Smart-Phone USB Connectivity For Fun And Profit. Retrieved May 25, 2022.Lucian Constantin. (2014, January 23). Windows malware tries to infect Android devices connected to PCs. Retrieved May 25, 2022.Zack Whittaker. (2019, August 12). This hacker’s iPhone charging cable can hijack your computer. Retrieved May 25, 2022.Shevchenko, S.. (2008, November 30). Agent.btz - A Threat That Hit Pentagon. Retrieved April 8, 2016.Hawley, S. et al. (2023, February 2). Turla: A Galaxy of Opportunity. Retrieved May 15, 2023.Chen, Joey. (2022, June 9). Aoqin Dragon | Newly-Discovered Chinese-linked APT Has Been Quietly Spying On Organizations For 10 Years. Retrieved July 14, 2022.Anthe, C. et al. (2015, October 19). Microsoft Security Intelligence Report Volume 19. Retrieved December 23, 2015.FireEye. (2015). APT28: A WINDOW INTO RUSSIA’S CYBER ESPIONAGE OPERATIONS?. Retrieved August 19, 2015.Secureworks CTU. (2017, March 30). IRON TWILIGHT Supports Active Measures. Retrieved February 28, 2022.Burton, K. (n.d.). The Conficker Worm. Retrieved February 18, 2021.Trend Micro. (2014, March 18). Conficker. Retrieved February 18, 2021.Dedola, G. (2020, August 20). Transparent Tribe: Evolution analysis, part 1. Retrieved September 2, 2021.Kaspersky Lab's Global Research and Analysis Team. (2014, November). The Darkhotel APT A Story of Unusual Hospitality. Retrieved November 12, 2014.ClearSky. (2016, January 7). Operation DustySky. Retrieved January 8, 2016.The Record. (2022, January 7). FBI: FIN7 hackers target US companies with BadUSB devices to install ransomware. Retrieved January 14, 2022.Gostev, A. (2012, May 28). The Flame: Questions and Answers. Retrieved March 1, 2017.Reynolds, J.. (2016, September 14). H1N1: Technical analysis reveals new capabilities – part 2. Retrieved September 26, 2016.Lechtik, M, and etl. (2021, July 14). LuminousMoth APT: Sweeping attacks for the chosen few. Retrieved October 20, 2022.Botezatu, B and etl. (2021, July 21). LuminousMoth - PlugX, File Exfiltration and Persistence Revisited. Retrieved October 20, 2022.Hamzeloofard, S. (2020, January 31). New wave of PlugX targets Hong Kong | Avira Blog. Retrieved April 13, 2021.Fidelis Cybersecurity. (2013, June 28). Fidelis Threat Advisory #1009: "njRAT" Uncovered. Retrieved June 4, 2019.Pascual, C. (2018, November 27). AutoIt-Compiled Worm Affecting Removable Media Delivers Fileless Version of BLADABINDI/njRAT Backdoor. Retrieved June 4, 2019.Mendoza, E. et al. (2020, May 25). Qakbot Resurges, Spreads through VBS Files. Retrieved September 27, 2021.Sanmillan, I.. (2020, May 13). Ramsay: A cyber‑espionage toolkit tailored for air‑gapped networks. Retrieved May 27, 2020.FireEye Labs. (2015, April). APT30 AND THE MECHANICS OF A LONG-RUNNING CYBER ESPIONAGE OPERATION. Retrieved May 1, 2015.Nicolas Falliere, Liam O Murchu, Eric Chien 2011, February W32.Stuxnet Dossier (Version 1.4) Retrieved. 2017/09/22Chen, J.. (2020, May 12). Tropic Trooper’s Back: USBferry Attack Targets Air gapped Environments. Retrieved May 20, 2020.Settle, A., et al. (2016, August 8). MONSOON - Analysis Of An APT Campaign. Retrieved September 22, 2016.Caragay, R. (2015, March 26). URSNIF: The Multifaceted Malware. Retrieved June 5, 2019.Caragay, R. (2014, December 11). Info-Stealing File Infector Hits US, UK. Retrieved June 5, 2019.Calvet, J. (2014, November 11). Sednit Espionage Group Attacking Air-Gapped Networks. Retrieved January 4, 2017.Microsoft. (2021, July 2). Use attack surface reduction rules to prevent malware infection. Retrieved June 24, 2021.Microsoft. (n.d.). How to disable the Autorun functionality in Windows. Retrieved April 20, 2016.Microsoft. (2007, August 31). https://technet.microsoft.com/en-us/library/cc771759(v=ws.10).aspx. Retrieved April 20, 2016.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.