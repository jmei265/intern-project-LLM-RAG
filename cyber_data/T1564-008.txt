MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseHide ArtifactsEmail Hiding RulesHide Artifacts:Email Hiding RulesOther sub-techniques of Hide Artifacts (12)IDNameT1564.001Hidden Files and DirectoriesT1564.002Hidden UsersT1564.003Hidden WindowT1564.004NTFS File AttributesT1564.005Hidden File SystemT1564.006Run Virtual InstanceT1564.007VBA StompingT1564.008Email Hiding RulesT1564.009Resource ForkingT1564.010Process Argument SpoofingT1564.011Ignore Process InterruptsT1564.012File/Path ExclusionsAdversaries may use email rules to hide inbound emails in a compromised user's mailbox. Many email clients allow users to create inbox rules for various email functions, including moving emails to other folders, marking emails as read, or deleting emails. Rules may be created or modified within email clients or through external features such as theNew-InboxRuleorSet-InboxRulePowerShellcmdlets on Windows systems.[1][2][3][4]Adversaries may utilize email rules within a compromised user's mailbox to delete and/or move emails to less noticeable folders. Adversaries may do this to hide security alerts, C2 communication, or responses toInternal Spearphishingemails sent from the compromised account.Any user or administrator within the organization (or adversary with valid credentials) may be able to create rules to automatically move or delete emails. These rules can be abused to impair/delay detection had the email content been immediately seen by a user or defender. Malicious rules commonly filter out emails based on key words (such asmalware,suspicious,phish, andhack) found in message bodies and subject lines.[5]In some environments, administrators may be able to enable email rules that operate organization-wide rather than on individual inboxes. For example, Microsoft Exchange supports transport rules that evaluate all mail an organization receives against user-specified conditions, then performs a user-specified action on mail that adheres to those conditions.[6]Adversaries that abuse such features may be able to automatically modify or delete all emails related to specific topics (such as internal security incident notifications).ID:T1564.008Sub-technique of:T1564ⓘTactic:Defense EvasionⓘPlatforms:Google Workspace, Linux, Office 365, Windows, macOSContributors:Dor Edry, Microsoft; Liran Ravich, CardinalOpsVersion:1.3Created:07 June 2021Last Modified:16 October 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0085FIN4FIN4has created rules in victims' Microsoft Outlook accounts to automatically delete emails containing words such as "hacked," "phish," and "malware" in a likely attempt to prevent organizations from communicating about their activities.[7]G1015Scattered SpiderScattered Spidercreates inbound rules on the compromised email accounts of security personnel to automatically delete emails from vendor security products.[8]MitigationsIDMitigationDescriptionM1047AuditEnterprise email solutions may have monitoring mechanisms that may include the ability to audit inbox rules on a regular basis.In an Exchange environment, Administrators can useGet-InboxRule/Remove-InboxRuleandGet-TransportRule/Remove-TransportRuleto discover and remove potentially malicious inbox and transport rules.[9][10]DetectionIDData SourceData ComponentDetectsDS0015Application LogApplication Log ContentMonitor for third-party application logging, messaging, and/or other artifacts that may use email rules to hide inbound emails in a compromised user's mailbox. Monitor email clients and applications for suspicious activity, such as missing messages or abnormal configuration and/or log entries. In environments using Exchange, monitor logs for the creation or modification of mail transport rules.DS0017CommandCommand ExecutionOn Windows and Exchange systems, monitor for creation or modification of suspicious inbox rules through the use of theNew-InboxRule,Set-InboxRule,New-TransportRule, andSet-TransportRulePowerShell cmdlets.[11][10][12]DS0022FileFile ModificationOn MacOS systems, monitor for modifications to theRulesActiveState.plist,SyncedRules.plist,UnsyncedRules.plist, andMessageRules.plistfiles.[2]ReferencesMicrosoft. (n.d.). Manage email messages by using rules. Retrieved June 11, 2021.Apple. (n.d.). Use rules to manage emails you receive in Mail on Mac. Retrieved June 14, 2021.Microsoft. (n.d.). New-InboxRule. Retrieved June 7, 2021.Microsoft. (n.d.). Set-InboxRule. Retrieved June 7, 2021.Niv Goldenberg. (2018, December 12). Rule your inbox with Microsoft Cloud App Security. Retrieved June 7, 2021.Microsoft. (2023, February 22). Mail flow rules (transport rules) in Exchange Online. Retrieved March 13, 2023.Vengerik, B. et al.. (2014, December 5). Hacking the Street? FIN4 Likely Playing the Market. Retrieved December 17, 2018.Microsoft. (2023, October 25). Octo Tempest crosses boundaries to facilitate extortion, encryption, and destruction. Retrieved March 18, 2024.Microsoft. (n.d.). Get-InboxRule. Retrieved June 10, 2021.Microsoft. (2023, February 22). Manage mail flow rules in Exchange Online. Retrieved March 13, 2023.Carr, N., Sellmer, S. (2021, June 14). Behind the scenes of business email compromise: Using cross-domain threat data to disrupt a large BEC campaign. Retrieved June 15, 2021.Pany, D. & Hanley, C. (2023, May 3). Cloudy with a Chance of Bad Logs: Cloud Platform Log Configurations to Consider in Investigations. Retrieved October 16, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.