MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseAccount ManipulationAdditional Email Delegate PermissionsAccount Manipulation:Additional Email Delegate PermissionsOther sub-techniques of Account Manipulation (6)IDNameT1098.001Additional Cloud CredentialsT1098.002Additional Email Delegate PermissionsT1098.003Additional Cloud RolesT1098.004SSH Authorized KeysT1098.005Device RegistrationT1098.006Additional Container Cluster RolesAdversaries may grant additional permission levels to maintain persistent access to an adversary-controlled email account.For example, theAdd-MailboxPermissionPowerShellcmdlet, available in on-premises Exchange and in the cloud-based service Office 365, adds permissions to a mailbox.[1][2][3]In Google Workspace, delegation can be enabled via the Google Admin console and users can delegate accounts via their Gmail settings.[4][5]Adversaries may also assign mailbox folder permissions through individual folder permissions or roles. In Office 365 environments, adversaries may assign the Default or Anonymous user permissions or roles to the Top of Information Store (root), Inbox, or other mailbox folders. By assigning one or both user permissions to a folder, the adversary can utilize any other account in the tenant to maintain persistence to the target user’s mail folders.[6]This may be used in persistent threat incidents as well as BEC (Business Email Compromise) incidents where an adversary can addAdditional Cloud Rolesto the accounts they wish to compromise. This may further enable use of additional techniques for gaining access to systems. For example, compromised business accounts are often used to send messages to other accounts in the network of the target business while creating inbox rules (ex:Internal Spearphishing), so the messages evade spam/phishing detection mechanisms.[7]ID:T1098.002Sub-technique of:T1098ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:Google Workspace, Office 365, WindowsContributors:Arad Inbar, Fidelis Security; Jannie Li, Microsoft Threat Intelligence Center (MSTIC); Microsoft Detection and Response Team (DART); Mike Burns, Mandiant; Naveen Vijayaraghavan, Nilesh Dherange (Gurucul)Version:2.1Created:19 January 2020Last Modified:03 January 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0007APT28APT28has used a Powershell cmdlet to grant theApplicationImpersonationrole to a compromised account.[8]G0016APT29APT29has used a compromised global administrator account in Azure AD to backdoor a service principal withApplicationImpersonationrights to start collecting emails from targeted mailboxes;APT29has also used compromised accounts holdingApplicationImpersonationrights in Exchange to collect emails.[9][10]G0059Magic HoundMagic Houndgranted compromised email accounts read access to the email boxes of additional targeted accounts. The group then was able to authenticate to the intended victim's OWA (Outlook Web Access) portal and read hundreds of email communications for information on Middle East organizations.[2]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29added their own devices as allowed IDs for active sync usingSet-CASMailbox, allowing it to obtain copies of victim mailboxes. It also added additional permissions (such as Mail.Read and Mail.ReadWrite) to compromised Application or Service Principals.[11][12][13]MitigationsIDMitigationDescriptionM1042Disable or Remove Feature or ProgramIf email delegation is not required, disable it. In Google Workspace this can be accomplished through the Google Admin console.[4]M1032Multi-factor AuthenticationUse multi-factor authentication for user and privileged accounts.M1026Privileged Account ManagementDo not allow domain administrator accounts to be used for day-to-day operations that may expose them to potential adversaries on unprivileged systems.DetectionIDData SourceData ComponentDetectsDS0015Application LogApplication Log ContentEnable the UpdateFolderPermissions action for all logon types. The mailbox audit log will forward folder permission modification events to the Unified Audit Log. Create rules to alert on ModifyFolderPermissions operations where the Anonymous or Default user is assigned permissions other than None.A larger than normal volume of emails sent from an account and similar phishing emails sent from real accounts within a network may be a sign that an account was compromised and attempts to leverage access with modified email permissions is occurring.DS0036GroupGroup ModificationMonitor for unusual Exchange and Office 365 email account permissions changes that may indicate excessively broad permissions (including memberships in privileged groups) being granted to compromised accounts.DS0002User AccountUser Account ModificationMonitor for unusual Exchange and Office 365 email account permissions changes that may indicate excessively broad permissions being granted to compromised accounts.ReferencesMicrosoft. (n.d.). Add-Mailbox Permission. Retrieved September 13, 2019.Mandiant. (2018). Mandiant M-Trends 2018. Retrieved July 9, 2018.Crowdstrike. (2018, July 18). Hiding in Plain Sight: Using the Office 365 Activities API to Investigate Business Email Compromises. Retrieved January 19, 2020.Google. (n.d.). Turn Gmail delegation on or off. Retrieved April 1, 2022.Google. (2011, June 1). Ensuring your information is safe online. Retrieved April 1, 2022.Mandiant. (2021, January 19). Remediation and Hardening Strategies for Microsoft 365 to Defend Against UNC2452. Retrieved January 22, 2021.Bienstock, D.. (2019). BECS and Beyond: Investigating and Defending O365. Retrieved September 13, 2019.NSA, CISA, FBI, NCSC. (2021, July). Russian GRU Conducting Global Brute Force Campaign to Compromise Enterprise and Cloud Environments. Retrieved July 26, 2021.Douglas Bienstock. (2022, August 18). You Can’t Audit Me: APT29 Continues Targeting Microsoft 365. Retrieved February 23, 2023.Mandiant. (2022, May 2). UNC3524: Eye Spy on Your Email. Retrieved August 17, 2023.Cash, D. et al. (2020, December 14). Dark Halo Leverages SolarWinds Compromise to Breach Organizations. Retrieved December 29, 2020.MSRC. (2020, December 13). Customer Guidance on Recent Nation-State Cyber Attacks. Retrieved December 30, 2020.Microsoft Threat Intelligence Center. (2021, October 25). NOBELIUM targeting delegated administrative privileges to facilitate broader attacks. Retrieved March 25, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.