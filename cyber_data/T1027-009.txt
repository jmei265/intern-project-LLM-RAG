MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseObfuscated Files or InformationEmbedded PayloadsObfuscated Files or Information:Embedded PayloadsOther sub-techniques of Obfuscated Files or Information (13)IDNameT1027.001Binary PaddingT1027.002Software PackingT1027.003SteganographyT1027.004Compile After DeliveryT1027.005Indicator Removal from ToolsT1027.006HTML SmugglingT1027.007Dynamic API ResolutionT1027.008Stripped PayloadsT1027.009Embedded PayloadsT1027.010Command ObfuscationT1027.011Fileless StorageT1027.012LNK Icon SmugglingT1027.013Encrypted/Encoded FileAdversaries may embed payloads within other files to conceal malicious content from defenses. Otherwise seemingly benign files (such as scripts and executables) may be abused to carry and obfuscate malicious payloads and content. In some cases, embedded payloads may also enable adversaries toSubvert Trust Controlsby not impacting execution controls such as digital signatures and notarization tickets.[1]Adversaries may embed payloads in various file formats to hide payloads.[2]This is similar toSteganography, though does not involve weaving malicious content into specific bytes and patterns related to legitimate digital media formats.[3]For example, adversaries have been observed embedding payloads within or as an overlay of an otherwise benign binary.[4]Adversaries have also been observed nesting payloads (such as executables and run-only scripts) inside a file of the same format.[5]Embedded content may also be used asProcess Injectionpayloads used to infect benign system processes.[6]These embedded then injected payloads may be used as part of the modules of malware designed to provide specific features such as encrypting C2 communications in support of an orchestrator module. For example, an embedded module may be injected into default browsers, allowing adversaries to then communicate via the network.[7]ID:T1027.009Sub-technique of:T1027ⓘTactic:Defense EvasionⓘPlatforms:Linux, Windows, macOSⓘSystem Requirements:UserContributors:Nick Cairns, @grotezinfosecVersion:1.1Created:30 September 2022Last Modified:29 September 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS1081BADHATCHBADHATCHhas an embedded second stage DLL payload within the first stage of the malware.[8]C0021C0021ForC0021, the threat actors embedded a base64-encoded payload within a LNK file.[9]S0126ComRATComRAThas embedded a XOR encrypted communications module inside the orchestrator module.[10][11]S1052DEADEYEThe DEADEYE.EMBED variant ofDEADEYEhas the ability to embed payloads inside of a compiled binary.[12]S0567DtrackDtrackhas used a dropper that embeds an encrypted payload as extra data.[13]S0367EmotetEmotethas dropped an embedded executable at%Temp%\setup.exe.[14]S0231Invoke-PSImageInvoke-PSImagecan be used to embed payload data within a new image file.[3]S1048macOS.OSAMinermacOS.OSAMinerhas embeddedStripped Payloadswithin another run-onlyStripped Payloads.[5]S0457NetwalkerNetwalker's DLL has been embedded within the PowerShell script in hex format.[15]S0649SMOKEDHAMTheSMOKEDHAMsource code is embedded in the dropper as an encrypted string.[16]S0022UroburosTheUroburosQueue file contains embedded executable files along with key material, communication channels, and modes of operation.[17]MitigationsIDMitigationDescriptionM1049Antivirus/AntimalwareAnti-virus can be used to automatically detect and quarantine suspicious files.M1040Behavior Prevention on EndpointOn Windows 10, enable Attack Surface Reduction (ASR) rules to prevent execution of potentially obfuscated scripts.[18]DetectionIDData SourceData ComponentDetectsDS0022FileFile CreationMonitor for newly constructed files containing large amounts of data. Abnormal file sizes may be an indicator of embedded content.File MetadataMonitor contextual data about a file that may highlight embedded payloads, which may include information such as name, the content (ex: signature, headers, or data/media), file size, etc.; correlate with other suspicious behavior to reduce false positives.ReferencesPhil Stokes. (2021, January 11). FADE DEAD | Adventures in Reversing Malicious Run-Only AppleScripts. Retrieved September 30, 2022.Microsoft. (2021, April 6). 2.5 ExtraData. Retrieved September 30, 2022.Barrett Adams . (n.d.). Invoke-PSImage . Retrieved September 30, 2022.KONSTANTIN ZYKOV. (2019, September 23). Hello! My name is Dtrack. Retrieved September 30, 2022.Phil Stokes. (2021, January 11). FADE DEAD | Adventures in Reversing Malicious Run-Only AppleScripts. Retrieved September 29, 2022.Karen Victor. (2020, May 18). Reflective Loading Runs Netwalker Fileless Ransomware. Retrieved September 30, 2022.CISA. (2020, October 29). Malware Analysis Report (AR20-303A) MAR-10310246-2.v1 – PowerShell Script: ComRAT. Retrieved September 30, 2022.Savelesky, K., et al. (2019, July 23). ABADBABE 8BADFOOD: Discovering BADHATCH and a Detailed Look at FIN8's Tooling. Retrieved September 8, 2021.Microsoft Defender Research Team. (2018, December 3). Analysis of cyberattack on U.S. think tanks, non-profits, public sector by unidentified attackers. Retrieved April 15, 2019.Faou, M. (2020, May). From Agent.btz to ComRAT v4: A ten-year journey. Retrieved June 15, 2020.CISA. (2020, October 29). Malware Analysis Report (AR20-303A). Retrieved December 9, 2020.Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.Konstantin Zykov. (2019, September 23). Hello! My name is Dtrack. Retrieved January 20, 2021.Binary Defense. (n.d.). Emotet Evolves With new Wi-Fi Spreader. Retrieved September 8, 2023.Victor, K.. (2020, May 18). Netwalker Fileless Ransomware Injected via Reflective Loading . Retrieved May 26, 2020.FireEye. (2021, June 16). Smoking Out a DARKSIDE Affiliate’s Supply Chain Software Compromise. Retrieved September 22, 2021.FBI et al. (2023, May 9). Hunting Russian Intelligence “Snake” Malware. Retrieved June 8, 2023.Microsoft. (2021, July 2). Use attack surface reduction rules to prevent malware infection. Retrieved June 24, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.