MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseDomain or Tenant Policy ModificationDomain or Tenant Policy ModificationSub-techniques (2)IDNameT1484.001Group Policy ModificationT1484.002Trust ModificationAdversaries may modify the configuration settings of a domain or identity tenant to evade defenses and/or escalate privileges in centrally managed environments. Such services provide a centralized means of managing identity resources such as devices and accounts, and often include configuration settings that may apply between domains or tenants such as trust relationships, identity syncing, or identity federation.Modifications to domain or tenant settings may include altering domain Group Policy Objects (GPOs) in Microsoft Active Directory (AD) or changing trust settings for domains, including federation trusts relationships between domains or tenants.With sufficient permissions, adversaries can modify domain or tenant policy settings. Since configuration settings for these services apply to a large number of identity resources, there are a great number of potential attacks malicious outcomes that can stem from this abuse. Examples of such abuse include:modifying GPOs to push a maliciousScheduled Taskto computers throughout the domain environment[1][2][3]modifying domain trusts to include an adversary-controlled domain, allowing adversaries to  forge access tokens that will subsequently be accepted by victim domain resources[4]changing configuration settings within the AD environment to implement aRogue Domain Controller.adding new, adversary-controlled federated identity providers to identity tenants, allowing adversaries to authenticate as any user managed by the victim tenant[5]Adversaries may temporarily modify domain or tenant policy, carry out a malicious action(s), and then revert the change to remove suspicious indicators.ID:T1484Sub-techniques:T1484.001,T1484.002ⓘTactics:Defense Evasion,Privilege EscalationⓘPlatforms:Azure AD, SaaS, WindowsⓘPermissions Required:Administrator, UserⓘDefense Bypassed:File system access controls, System access controlsContributors:Obsidian SecurityVersion:3.0Created:07 March 2019Last Modified:19 April 2024Version PermalinkLive VersionMitigationsIDMitigationDescriptionM1047AuditIdentify and correct GPO permissions abuse opportunities (ex: GPO modification privileges) using auditing tools such asBloodHound(version 1.5.1 and later)[6].M1026Privileged Account ManagementUse least privilege and protect administrative access to the Domain Controller and Active Directory Federation Services (AD FS) server. Do not create service accounts with administrative privileges.M1018User Account ManagementConsider implementing WMI and security filtering to further tailor which users and computers a GPO will apply to.[2][7][8]DetectionIDData SourceData ComponentDetectsDS0026Active DirectoryActive Directory Object CreationMonitor for newly constructed active directory objects, such as Windows EID 5137.Active Directory Object DeletionMonitor for unexpected deletion of an active directory object, such as Windows EID 5141.Active Directory Object ModificationMonitor for changes made to AD settings for unexpected modifications to user accounts, such as deletions or potentially malicious changes to user attributes (credentials, status, etc.).DS0015Application LogApplication Log ContentMonitor changes to cloud-based directory services and identity tenants, especially regarding the addition of new federated identity providers. In Okta environments, the eventsystem.idp.lifecycle.createwill trigger on the creation of an identity provider, while sign-ins from a third-party identity provider will create the eventuser.authentication.auth_via_IDP.[9]DS0017CommandCommand ExecutionMonitor executed commands and arguments for modifications to domain trust settings, such as when a user or application modifies the federation settings on the domain or updates domain authentication from Managed to Federated via ActionTypesSet federation settings on domainandSet domain authentication.[10][11]ReferencesMetcalf, S. (2016, March 14). Sneaky Active Directory Persistence #17: Group Policy. Retrieved March 5, 2019.Robbins, A. (2018, April 2). A Red Teamer’s Guide to GPOs and OUs. Retrieved March 5, 2019.Schroeder, W. (2016, March 17). Abusing GPO Permissions. Retrieved March 5, 2019.MSRC. (2020, December 13). Customer Guidance on Recent Nation-State Cyber Attacks. Retrieved December 30, 2020.Okta Defensive Cyber Operations. (2023, August 31). Cross-Tenant Impersonation: Prevention and Detection. Retrieved February 15, 2024.Robbins, A., Vazarkar, R., and Schroeder, W. (2016, April 17). Bloodhound: Six Degrees of Domain Admin. Retrieved March 5, 2019.Microsoft. (2008, September 11). Fun with WMI Filters in Group Policy. Retrieved March 13, 2019.Microsoft. (2018, May 30). Filtering the Scope of a GPO. Retrieved March 13, 2019.Okta Defensive Cyber Operations. (2023, August 31). Cross-Tenant Impersonation: Prevention and Detection. Retrieved March 4, 2024.Microsoft. (2020, December). Azure Sentinel Detections. Retrieved December 30, 2020.Microsoft 365 Defender Team. (2020, December 28). Using Microsoft 365 Defender to protect against Solorigate. Retrieved January 7, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.