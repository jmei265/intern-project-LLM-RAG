MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseBoot or Logon Initialization ScriptsRC ScriptsBoot or Logon Initialization Scripts:RC ScriptsOther sub-techniques of Boot or Logon Initialization Scripts (5)IDNameT1037.001Logon Script (Windows)T1037.002Login HookT1037.003Network Logon ScriptT1037.004RC ScriptsT1037.005Startup ItemsAdversaries may establish persistence by modifying RC scripts which are executed during a Unix-like system’s startup. These files allow system administrators to map and start custom services at startup for different run levels. RC scripts require root privileges to modify.Adversaries can establish persistence by adding a malicious binary path or shell commands torc.local,rc.common, and other RC scripts specific to the Unix-like distribution.[1][2]Upon reboot, the system executes the script's contents as root, resulting in persistence.Adversary abuse of RC scripts is especially effective for lightweight Unix-like distributions using the root user as default, such as IoT or embedded systems.[3]Several Unix-like systems have moved to Systemd and deprecated the use of RC scripts. This is now a deprecated mechanism in macOS in favor ofLaunchd.[4][5]This technique can be used on Mac OS X Panther v10.3 and earlier versions which still execute the RC scripts.[6]To maintain backwards compatibility some systems, such as Ubuntu, will execute the RC scripts if they exist with the correct file permissions.[7]ID:T1037.004Sub-technique of:T1037ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:Linux, Network, macOSⓘPermissions Required:rootVersion:2.1Created:15 January 2020Last Modified:16 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0016APT29APT29has installed a run command on a compromised system to enable malware execution on system startup.[8]S0687Cyclops BlinkCyclops Blinkhas the ability to execute on device startup, using a modified RC script named S51armled.[9]S0690Green LambertGreen Lambertcan addinit.dandrc.dfiles in the/etcfolder to establish persistence.[10][11]S0394HiddenWaspHiddenWaspinstalls reboot persistence by adding itself to/etc/rc.local.[2]S0278iKitteniKittenadds an entry to the rc.common file for persistence.[12]MitigationsIDMitigationDescriptionM1022Restrict File and Directory PermissionsLimit privileges of user accounts so only authorized users can edit the rc.common file.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments resulting from RC scripts for unusual or unknown applications or behaviorDS0022FileFile CreationMonitor for newly constructed /etc/rc.local fileFile ModificationMonitor for changes made to files for unexpected modifications to RC scripts in the /etc/ directoryDS0009ProcessProcess CreationMonitor for newly constructed processes and/or command-lines that  execute /etc/rc.local if present.ReferencesIran Threats . (2017, December 5). Flying Kitten to Rocket Kitten, A Case of Ambiguity and Shared Code. Retrieved May 28, 2020.Sanmillan, I. (2019, May 29). HiddenWasp Malware Stings Targeted Linux Systems. Retrieved June 24, 2019.Paul Litvak. (2020, May 4). Kaiji: New Chinese Linux malware turning to Golang. Retrieved December 17, 2020.Apple. (2016, September 13). Daemons and Services Programming Guide - Creating Launch Daemons and Agents. Retrieved February 24, 2021.Apple. (2016, September 13). Startup Items. Retrieved July 11, 2017.Patrick Wardle. (2014, September). Methods of Malware Persistence on Mac OS X. Retrieved July 5, 2017.Canonical Ltd.. (n.d.). systemd-rc-local-generator - Compatibility generator for starting /etc/rc.local and        /usr/sbin/halt.local during boot and shutdown. Retrieved February 23, 2021.Mandiant. (2022, May 2). UNC3524: Eye Spy on Your Email. Retrieved August 17, 2023.NCSC. (2022, February 23). Cyclops Blink Malware Analysis Report. Retrieved March 3, 2022.Sandvik, Runa. (2021, October 1). Made In America: Green Lambert for OS X. Retrieved March 21, 2022.Sandvik, Runa. (2021, October 18). Green Lambert and ATT&CK. Retrieved March 21, 2022.Patrick Wardle. (n.d.). Mac Malware of 2017. Retrieved September 21, 2018.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.