MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseMasqueradingRename System UtilitiesMasquerading:Rename System UtilitiesOther sub-techniques of Masquerading (9)IDNameT1036.001Invalid Code SignatureT1036.002Right-to-Left OverrideT1036.003Rename System UtilitiesT1036.004Masquerade Task or ServiceT1036.005Match Legitimate Name or LocationT1036.006Space after FilenameT1036.007Double File ExtensionT1036.008Masquerade File TypeT1036.009Break Process TreesAdversaries may rename legitimate system utilities to try to evade security mechanisms concerning the usage of those utilities. Security monitoring and control mechanisms may be in place for system utilities adversaries are capable of abusing.[1]It may be possible to bypass those security mechanisms by renaming the utility prior to utilization (ex: renamerundll32.exe).[2]An alternative case occurs when a legitimate utility is copied or moved to a different directory and renamed to avoid detections based on system utilities executing from non-standard paths.[3]ID:T1036.003Sub-technique of:T1036ⓘTactic:Defense EvasionⓘPlatforms:Linux, Windows, macOSVersion:1.1Created:10 February 2020Last Modified:14 September 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0050APT32APT32has moved and renamed pubprn.vbs to a .txt file to avoid detection.[4]S0046CozyCarTheCozyCardropper has masqueraded a copy of the infected system's rundll32.exe executable that was moved to the malware's install directory and renamed according to a predefined configuration file.[3]S1111DarkGateDarkGateexecutes a Windows Batch script during installation that creases a randomly-named directory in theC:\root directory that copies and renames the legitimate Windowscurlcommand to this new location.[5]G0093GALLIUMGALLIUMused a renamed cmd.exe file to evade detection.[6]S1020KevinKevinhas renamed an image ofcmd.exewith a random name followed by a.tmplextension.[7]G0032Lazarus GroupLazarus Grouphas renamed system utilities such aswscript.exeandmshta.exe.[8]G0045menuPassmenuPasshas renamedcertutiland moved it to a different location on the system to avoid detection based on use of the tool.[9]MitigationsIDMitigationDescriptionM1022Restrict File and Directory PermissionsUse file system access controls to protect folders such as C:\Windows\System32.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may rename legitimate system utilities to try to evade security mechanisms concerning the usage of those utilities.DS0022FileFile MetadataCollecting and comparing disk and resource filenames for binaries by looking to see if the InternalName, OriginalFilename, and/or ProductName match what is expected could provide useful leads, but may not always be indicative of malicious activity.File ModificationMonitor for changes made to files for unexpected modifications to file names that are mismatched between the file name on disk and that of the binary's PE metadata. This is a likely indicator that a binary was renamed after it was compiled.Note: There are no standard Windows events for file modification. However, Event ID 4663 (An attempt was made to access an object) can be used to audit and alert on attempts to access system utility binaries; the "Accesses" field can be used to filter by type of access (e.g., MODIFY vs DELETE).DS0009ProcessProcess MetadataMonitor for file names that are mismatched between the file name on disk and that of the binary's PE metadata, this is a likely indicator that a binary was renamed after it was compiled.ReferencesLOLBAS. (n.d.). Living Off The Land Binaries and Scripts (and also Libraries). Retrieved February 10, 2020.Ewing, P. (2016, October 31). How to Hunt: The Masquerade Ball. Retrieved October 31, 2016.F-Secure Labs. (2015, April 22). CozyDuke: Malware Analysis. Retrieved December 10, 2015.Carr, N.. (2017, December 26). Nick Carr Status Update APT32 pubprn. Retrieved April 22, 2019.Ernesto Fernández Provecho, Pham Duy Phuc, Ciana Driscoll & Vinoo Thomas. (2023, November 21). The Continued Evolution of the DarkGate Malware-as-a-Service. Retrieved February 9, 2024.Cybereason Nocturnus. (2019, June 25). Operation Soft Cell: A Worldwide Campaign Against Telecommunications Providers. Retrieved July 18, 2019.Kayal, A. et al. (2021, October). LYCEUM REBORN: COUNTERINTELLIGENCE IN THE MIDDLE EAST. Retrieved June 14, 2022.Pradhan, A. (2022, February 8). LolZarus: Lazarus Group Incorporating Lolbins into Campaigns. Retrieved March 22, 2022.Matsuda, A., Muhammad I. (2018, September 13). APT10 Targeting Japanese Corporations Using Updated TTPs. Retrieved September 17, 2018.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.