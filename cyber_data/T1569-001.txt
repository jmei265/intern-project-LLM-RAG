MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseSystem ServicesLaunchctlSystem Services:LaunchctlOther sub-techniques of System Services (2)IDNameT1569.001LaunchctlT1569.002Service ExecutionAdversaries may abuse launchctl to execute commands or programs. Launchctl interfaces with launchd, the service management framework for macOS. Launchctl supports taking subcommands on the command-line, interactively, or even redirected from standard input.[1]Adversaries use launchctl to execute commands and programs asLaunch Agents orLaunch Daemons. Common subcommands include:launchctl load,launchctl unload, andlaunchctl start. Adversaries can use scripts or manually run the commandslaunchctl load -w "%s/Library/LaunchAgents/%s"or/bin/launchctl loadto executeLaunch Agents orLaunch Daemons.[2][3]ID:T1569.001Sub-technique of:T1569ⓘTactic:ExecutionⓘPlatforms:macOSⓘPermissions Required:User, rootVersion:1.1Created:10 March 2020Last Modified:15 October 2021Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0584AppleJeusAppleJeushas loaded a plist file using thelaunchctlcommand.[4]S0274CalistoCalistouses launchctl to enable screen sharing on the victim’s machine.[5]S0451LoudMinerLoudMinerlaunched the QEMU services in the/Library/LaunchDaemons/folder usinglaunchctl. It also useslaunchctlto unload allLaunch Daemons when updating to a newer version ofLoudMiner.[6]S1048macOS.OSAMinermacOS.OSAMinerhas usedlaunchctlto restart theLaunch Agent.[7]S0658XCSSETXCSSETloads a system level launchdaemon using thelaunchctl load -wcommand from/System/Librarby/LaunchDaemons/ssh.plist.[8]MitigationsIDMitigationDescriptionM1018User Account ManagementPrevent users from installing their own launch agents or launch daemons.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor command-line execution of thelaunchctlcommand immediately followed by abnormal network connections.DS0022FileFile ModificationEvery Launch Agent and Launch Daemon must have a corresponding plist file on disk which can be monitored. Plist files are located in the root, system, and users/Library/LaunchAgentsor/Library/LaunchDaemonsfolders.Launch AgentorLaunch Daemonwith executable paths pointing to /tmp and /Shared folders locations are potentially suspicious.DS0009ProcessProcess CreationMonitor for newly executed daemons that may abuse launchctl to execute commands or programs.DS0019ServiceService CreationMonitor for newly constructed services/daemons to execute commands or programs.Notes: This detection is to identify a creation of "user mode service" where the service file path is located in non-common service folder in windows.Analytic 1 - Create Service In Suspicious File Path(source="WinEventLog:Security" EventCode="4697") OR (source="WinEventLog:System" EventCode="7045")  Service_File_Name = ".exe" NOT (Service_File_Name IN ("C:\Windows\", "%windir%\", "C:\Program File", "C:\Programdata\", "%systemroot%\")) Service_Type = "user mode service"ReferencesSS64. (n.d.). launchctl. Retrieved March 28, 2020.Dani Creus, Tyler Halfpop, Robert Falcone. (2016, September 26). Sofacy's 'Komplex' OS X Trojan. Retrieved July 8, 2017.Phil Stokes. (2021, February 16). 20 Common Tools & Techniques Used by macOS Threat Actors & Malware. Retrieved August 23, 2021.Cybersecurity and Infrastructure Security Agency. (2021, February 21). AppleJeus: Analysis of North Korea’s Cryptocurrency Malware. Retrieved March 1, 2021.Kuzin, M., Zelensky S. (2018, July 20). Calisto Trojan for macOS. Retrieved September 7, 2018.Malik, M. (2019, June 20). LoudMiner: Cross-platform mining in cracked VST software. Retrieved May 18, 2020.Phil Stokes. (2021, January 11). FADE DEAD | Adventures in Reversing Malicious Run-Only AppleScripts. Retrieved September 29, 2022.Mac Threat Response, Mobile Research Team. (2020, August 13). The XCSSET Malware: Inserts Malicious Code Into Xcode Projects, Performs UXSS Backdoor Planting in Safari, and Leverages Two Zero-day Exploits. Retrieved October 5, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.