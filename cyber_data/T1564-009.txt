MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseHide ArtifactsResource ForkingHide Artifacts:Resource ForkingOther sub-techniques of Hide Artifacts (12)IDNameT1564.001Hidden Files and DirectoriesT1564.002Hidden UsersT1564.003Hidden WindowT1564.004NTFS File AttributesT1564.005Hidden File SystemT1564.006Run Virtual InstanceT1564.007VBA StompingT1564.008Email Hiding RulesT1564.009Resource ForkingT1564.010Process Argument SpoofingT1564.011Ignore Process InterruptsT1564.012File/Path ExclusionsAdversaries may abuse resource forks to hide malicious code or executables to evade detection and bypass security applications. A resource fork provides applications a structured way to store resources such as thumbnail images, menu definitions, icons, dialog boxes, and code.[1]Usage of a resource fork is identifiable when displaying a file’s extended attributes, usingls -l@orxattr -lcommands. Resource forks have been deprecated and replaced with the application bundle structure. Non-localized resources are placed at the top level directory of an application bundle, while localized resources are placed in the/Resourcesfolder.[2][3]Adversaries can use resource forks to hide malicious data that may otherwise be stored directly in files. Adversaries can execute content with an attached resource fork, at a specified offset, that is moved to an executable location then invoked. Resource fork content may also be obfuscated/encrypted until execution.[4][5]ID:T1564.009Sub-technique of:T1564ⓘTactic:Defense EvasionⓘPlatforms:macOSⓘDefense Bypassed:Gatekeeper, NotarizationContributors:Ivan Sinyakov; Jaron Bradley @jbradley89Version:1.0Created:12 October 2021Last Modified:05 May 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0276KeydnapKeydnapuses a resource fork to present a macOS JPEG or text file icon rather than the executable's icon assigned by the operating system.[6]S0402OSX/ShlayerOSX/Shlayerhas used a resource fork to hide a compressed binary file of itself from the terminal, Finder, and potentially evade traditional scanners.[5][4]MitigationsIDMitigationDescriptionM1013Application Developer GuidanceConfigure applications to use the application bundle structure which leverages the/Resourcesfolder location.[7]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that are leveraging the use of resource forks, especially those immediately followed by potentially malicious activity such as creating network connections.DS0022FileFile CreationMonitor for newly constructed files that may abuse resource forks to hide malicious code or executables to evade detection and bypass security applications.File MetadataIdentify files with thecom.apple.ResourceForkextended attribute and large data amounts stored in resource forks.DS0009ProcessProcess CreationMonitor newly executed processes that may abuse resource forks to hide malicious code or executables to evade detection and bypass security applications.ReferencesTenon. (n.d.). Retrieved October 12, 2021.Flylib. (n.d.). Identifying Resource and Data Forks. Retrieved October 12, 2021.Howard Oakley. (2020, October 24). There's more to files than data: Extended Attributes. Retrieved October 12, 2021.Phil Stokes. (2020, November 5). Resourceful macOS Malware Hides in Named Fork. Retrieved October 12, 2021.Erika Noerenberg. (2020, June 29). TAU Threat Analysis: Bundlore (macOS) mm-install-macos. Retrieved October 12, 2021.Marc-Etienne M.Leveille. (2016, July 6). New OSX/Keydnap malware is hungry for credentials. Retrieved July 3, 2017.Apple Inc. (2021, February 18). App security overview. Retrieved October 12, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.