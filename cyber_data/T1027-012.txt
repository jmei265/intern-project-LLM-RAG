MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseObfuscated Files or InformationLNK Icon SmugglingObfuscated Files or Information:LNK Icon SmugglingOther sub-techniques of Obfuscated Files or Information (13)IDNameT1027.001Binary PaddingT1027.002Software PackingT1027.003SteganographyT1027.004Compile After DeliveryT1027.005Indicator Removal from ToolsT1027.006HTML SmugglingT1027.007Dynamic API ResolutionT1027.008Stripped PayloadsT1027.009Embedded PayloadsT1027.010Command ObfuscationT1027.011Fileless StorageT1027.012LNK Icon SmugglingT1027.013Encrypted/Encoded FileAdversaries may smuggle commands to download malicious payloads past content filters by hiding them within otherwise seemingly benign windows shortcut files. Windows shortcut files (.LNK) include many metadata fields, including an icon location field (also known as theIconEnvironmentDataBlock) designed to specify the path to an icon file that is to be displayed for the LNK file within a host directory.Adversaries may abuse this LNK metadata to download malicious payloads. For example, adversaries have been observed using LNK files as phishing payloads to deliver malware. Once invoked (e.g.,Malicious File), payloads referenced via external URLs within the LNK icon location field may be downloaded. These files may also then be invoked byCommand and Scripting Interpreter/System Binary Proxy Executionarguments within the target path field of the LNK.[1][2]LNK Icon Smuggling may also be utilized post compromise, such as malicious scripts executing an LNK on an infected host to download additional malicious payloads.ID:T1027.012Sub-technique of:T1027ⓘTactic:Defense EvasionⓘPlatforms:WindowsContributors:Andrew Northern, @ex_raritas; Gregory Lesnewich, @greglesnewich; Michael Raggi @aRtAGGIVersion:1.0Created:29 September 2023Last Modified:17 October 2023Version PermalinkLive VersionMitigationsIDMitigationDescriptionM1049Antivirus/AntimalwareUse signatures or heuristics to detect malicious LNK and subsequently downloaded files.M1040Behavior Prevention on EndpointOn Windows 10, enable Attack Surface Reduction (ASR) rules to prevent execution of potentially obfuscated scripts or payloads.DetectionIDData SourceData ComponentDetectsDS0022FileFile CreationMonitor for downloaded malicious files, though developing rules for the different variants, with a combination of different encoding and/or encryption schemes, may be very challenging. Consider monitoring files downloaded from the Internet, possibly by LNK Icon Smuggling, for suspicious activities. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities.File MetadataMonitor contextual data about a file that may highlight embedded malicious content, which may include information such as name, the content (ex: signature, headers, or data/media), file size, etc.; correlate with other suspicious behavior to reduce false positives.ReferencesUnprotect Project. (2019, March 18). Shortcut Hiding. Retrieved October 3, 2023.Weyne, F. (2017, April). Booby trap a shortcut with a backdoor. Retrieved October 3, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.