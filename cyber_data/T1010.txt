MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseApplication Window DiscoveryApplication Window DiscoveryAdversaries may attempt to get a listing of open application windows. Window listings could convey information about how the system is used.[1]For example, information about application windows could be used identify potential data to collect as well as identifying security tooling (Security Software Discovery) to evade.[2]Adversaries typically abuse system features for this type of enumeration. For example, they may gather information through native system features such asCommand and Scripting Interpretercommands andNative APIfunctions.ID:T1010Sub-techniques:No sub-techniquesⓘTactic:DiscoveryⓘPlatforms:Linux, Windows, macOSVersion:1.3Created:31 May 2017Last Modified:15 April 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0456Aria-bodyAria-bodyhas the ability to identify the titles of running windows on a compromised host.[3]S0438AttorAttorcan obtain application window titles and then determines which windows to perform Screen Capture on.[4]S0454CadelspyCadelspyhas the ability to identify open windows on the compromised host.[5]S0261CatchamasCatchamasobtains application windows titles and then determines which windows to performScreen Captureon.[6]S1111DarkGateDarkGatewill search for cryptocurrency wallets by examining application window names for specific strings.[7]DarkGateextracts information collected via NirSoft tools from the hosting process's memory by first identifying the window through theFindWindowAPI function.[7]S0673DarkWatchmanDarkWatchmanreports window names along with keylogger information to provide application context.[1]S0038DuquThe discovery modules used withDuqucan collect information on open windows.[8]S0696FlagproFlagprocan check the name of the window displayed on the system.[9]S1044FunnyDreamFunnyDreamhas the ability to discover application windows via execution ofEnumWindows.[10]S0531GrandoreiroGrandoreirocan identify installed security tools based on window names.[2]G1001HEXANEHEXANEhas used a PowerShell-based keylogging tool to capture the window title.[11]S0431HotCroissantHotCroissanthas the ability to list the names of all open windows on the infected host.[12]S0260InvisiMoleInvisiMolecan enumerate windows and child windows on a compromised host.[13][14]S0265KazuarKazuargathers information about opened windows.[15]G0032Lazarus GroupLazarus Groupmalware IndiaIndia obtains and sends to its C2 server the title of the window for each running process. The KilaAlfa keylogger also reports the title of the window in the foreground.[16][17][18]S0409MacheteMachetesaves the window names.[19]S0455MetamorfoMetamorfocan enumerate all windows on the victim’s machine.[20][21]S0033NetTravelerNetTravelerreports window names along with keylogger information to provide application context.[22]S0198NETWIRENETWIREcan discover and close windows on controlled systems.[23]S1090NightClubNightClubcan useGetForegroundWindowto enumerate the active window.[24]S0385njRATnjRATgathers information about opened windows during the initial infection.[25]S0435PLEADPLEADhas the ability to list open windows on the compromised host.[26][26]S0012PoisonIvyPoisonIvycaptures window titles.[27]S0139PowerDukePowerDukehas a command to get text of the current foreground window.[28]S0650QakBotQakBothas the ability to enumerate windows on a compromised host.[29]S0375RemexiRemexihas a command to capture active windows on the machine and retrieve window titles.[30]S0240ROKRATROKRATcan use  theGetForegroundWindowandGetWindowTextAPIs to discover where the user is typing.[31]S0692SILENTTRINITYSILENTTRINITYcan enumerate the active Window during keylogging through execution ofGetActiveWindowTitle.[32]S0157SOUNDBITESOUNDBITEis capable of enumerating application windows.[33]S0094Trojan.KaraganyTrojan.Karaganycan monitor the titles of open windows to identify specific keywords.[34]S0219WINERACKWINERACKcan enumerate active windows.[35]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments for actions that could be taken to gather system and network information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.Note: Commands can also be obtained from Payload event field for PowerShell event id 4103. For PowerShell Module logging event id 4103, enable logging for module Microsoft.PowerShell.Management.Analytic 1 - Suspicious Commandssource=WinEventLog:"*Microsoft-Windows-PowerShell/Operational" EventCode="4103" | where CommandLine LIKE "%Get-Process%" AND CommandLine LIKE "%mainWindowTitle%"DS0009ProcessOS API ExecutionMonitor for API calls (such asGetForegroundWindow()) that may attempt to get a listing of open application windows.GetForegroundWindowapi returns a handle to the foreground window (the window with which the user is currently working). Other API calls relevant to Local Group discovery includeGetProcessesandGetForegroundWindow.GetProcessesapi returns an array of type Process that represents all the process resources running on the local computer.Note: Most EDR tools do not support direct monitoring of API calls due to the sheer volume of calls produced by an endpoint but may have alerts or events that are based on abstractions of OS API calls. Dynamic malware analysis tools (i.e., sandboxes) can be used to trace the execution, including OS API calls, for a single PE binary.Process CreationMonitor for newly executed processes that may attempt to get a listing of open application windows. System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained.Note: Event IDs are for Sysmon (Event ID 1 - process create) and Windows Security Log (Event ID 4688 - a new process has been created).Analytic 1 - Suspicious Processes(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") | where CommandLine LIKE "%Get-Process%" AND CommandLine LIKE "%mainWindowTitle%"ReferencesSmith, S., Stafford, M. (2021, December 14). DarkWatchman: A new evolution in fileless techniques. Retrieved January 10, 2022.ESET. (2020, April 28). Grandoreiro: How engorged can an EXE get?. Retrieved November 13, 2020.CheckPoint. (2020, May 7). Naikon APT: Cyber Espionage Reloaded. Retrieved May 26, 2020.Hromcova, Z. (2019, October). AT COMMANDS, TOR-BASED COMMUNICATIONS: MEET ATTOR, A FANTASY CREATURE AND ALSO A SPY PLATFORM. Retrieved May 6, 2020.Symantec Security Response. (2015, December 7). Iran-based attackers use back door threats to spy on Middle Eastern targets. Retrieved April 17, 2019.Balanza, M. (2018, April 02). Infostealer.Catchamas. Retrieved July 10, 2018.Adi Zeligson & Rotem Kerner. (2018, November 13). Enter The DarkGate - New Cryptocurrency Mining and Ransomware Campaign. Retrieved February 9, 2024.Symantec Security Response. (2011, November). W32.Duqu: The precursor to the next Stuxnet. Retrieved September 17, 2015.Hada, H. (2021, December 28).  Flagpro The new malware used by BlackTech. Retrieved March 25, 2022.Vrabie, V. (2020, November). Dissecting a Chinese APT Targeting South Eastern Asian Government Institutions. Retrieved September 19, 2022.SecureWorks 2019, August 27 LYCEUM Takes Center Stage in Middle East Campaign Retrieved. 2019/11/19Knight, S.. (2020, April 16). VMware Carbon Black TAU Threat Analysis: The Evolution of Lazarus. Retrieved May 1, 2020.Hromcová, Z. (2018, June 07). InvisiMole: Surprisingly equipped spyware, undercover since 2013. Retrieved July 10, 2018.Hromcova, Z. and Cherpanov, A. (2020, June). INVISIMOLE: THE HIDDEN PART OF THE STORY. Retrieved July 16, 2020.Levene, B, et al. (2017, May 03). Kazuar: Multiplatform Espionage Backdoor with API Access. Retrieved July 17, 2018.Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Unraveling the Long Thread of the Sony Attack. Retrieved February 25, 2016.Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Loaders, Installers and Uninstallers Report. Retrieved March 2, 2016.Novetta Threat Research Group. (2016, February 24). Operation Blockbuster: Tools Report. Retrieved March 10, 2016.ESET. (2019, July). MACHETE JUST GOT SHARPER Venezuelan government institutions under attack. Retrieved September 13, 2019.Sierra, E., Iglesias, G.. (2018, April 24). Metamorfo Campaigns Targeting Brazilian Users. Retrieved July 30, 2020.Zhang, X. (2020, February 4). Another Metamorfo Variant Targeting Customers of Financial Institutions in More Countries. Retrieved July 30, 2020.Kaspersky Lab's Global Research and Analysis Team. (n.d.). The NetTraveler (aka ‘Travnet’). Retrieved November 12, 2014.Lambert, T. (2020, January 29). Intro to Netwire. Retrieved January 7, 2021.Faou, M. (2023, August 10). MoustachedBouncer: Espionage against foreign diplomats in Belarus. Retrieved September 25, 2023.Fidelis Cybersecurity. (2013, June 28). Fidelis Threat Advisory #1009: "njRAT" Uncovered. Retrieved June 4, 2019.Bermejo, L., et al. (2017, June 22). Following the Trail of BlackTech’s Cyber Espionage Campaigns. Retrieved May 5, 2020.Hayashi, K. (2005, August 18). Backdoor.Darkmoon. Retrieved February 23, 2018.Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017.Morrow, D. (2021, April 15). The rise of QakBot. Retrieved September 27, 2021.Legezo, D. (2019, January 30). Chafer used Remexi malware to spy on Iran-based foreign diplomatic entities. Retrieved April 17, 2019.Mercer, W., Rascagneres, P. (2017, April 03). Introducing ROKRAT. Retrieved May 21, 2018.Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.Carr, N.. (2017, May 14). Cyber Espionage is Alive and Well: APT32 and the Threat to Global Corporations. Retrieved June 18, 2017.Secureworks. (2019, July 24). Updated Karagany Malware Targets Energy Sector. Retrieved August 12, 2020.FireEye. (2018, February 20). APT37 (Reaper): The Overlooked North Korean Actor. Retrieved March 1, 2018.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.