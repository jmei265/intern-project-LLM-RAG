MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterprisePermission Groups DiscoveryCloud GroupsPermission Groups Discovery:Cloud GroupsOther sub-techniques of Permission Groups Discovery (3)IDNameT1069.001Local GroupsT1069.002Domain GroupsT1069.003Cloud GroupsAdversaries may attempt to find cloud groups and permission settings. The knowledge of cloud permission groups can help adversaries determine the particular roles of users and groups within an environment, as well as which users are associated with a particular group.With authenticated access there are several tools that can be used to find permissions groups. TheGet-MsolRolePowerShell cmdlet can be used to obtain roles and permissions groups for Exchange and Office 365 accounts[1][2].Azure CLI (AZ CLI) and the Google Cloud Identity Provider API also provide interfaces to obtain permissions groups. The commandaz ad user get-member-groupswill list groups associated to a user account for Azure while the API endpointGET https://cloudidentity.googleapis.com/v1/groupslists group resources available to a user for Google.[3][4][5]In AWS, the commandsListRolePoliciesandListAttachedRolePoliciesallow users to enumerate the policies attached to a role.[6]Adversaries may attempt to list ACLs for objects to determine the owner and other accounts with access to the object, for example, via the AWSGetBucketAclAPI[7]. Using this information an adversary can target accounts with permissions to a given object or leverage accounts they have already compromised to access the object.ID:T1069.003Sub-technique of:T1069ⓘTactic:DiscoveryⓘPlatforms:Azure AD, Google Workspace, IaaS, Office 365, SaaSContributors:Isif Ibrahima, Mandiant; Regina ElwellVersion:1.4Created:21 February 2020Last Modified:21 March 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0677AADInternalsAADInternalscan enumerate Azure AD groups.[8]C0027C0027DuringC0027,Scattered Spideraccessed Azure AD to download bulk lists of group members and their Active Directory attributes.[9]S1091PacuPacucan enumerate IAM permissions.[10]S0684ROADToolsROADToolscan enumerate Azure AD groups.[11]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0015Application LogApplication Log ContentMonitor for events collected that may attempt to find cloud groups and permission settings.DS0017CommandCommand ExecutionMonitor for executed commands and arguments that may attempt to find cloud groups and permission settings.DS0036GroupGroup EnumerationMonitor for an extracted list of available groups and/or their associated settingGroup MetadataContextual data about a group which describes group and activity around it that may attempt to find cloud groups and permission settings.DS0009ProcessProcess CreationMonitor newly executed processes that may attempt to find cloud groups and permission settings.ReferencesMicrosoft. (n.d.). Get-MsolRole. Retrieved October 6, 2019.Stringer, M.. (2018, November 21). RainDance. Retrieved October 6, 2019.Microsoft. (n.d.). az ad user. Retrieved October 6, 2019.Felch, M.. (2018, August 31). Red Teaming Microsoft Part 1 Active Directory Leaks via Azure. Retrieved October 6, 2019.Google. (n.d.). Retrieved March 16, 2021.Dror Alon. (2022, December 8). Compromised Cloud Compute Credentials: Case Studies From the Wild. Retrieved March 9, 2023.Amazon Web Services. (n.d.). Retrieved May 28, 2021.Dr. Nestori Syynimaa. (2018, October 25). AADInternals. Retrieved February 18, 2022.Parisi, T. (2022, December 2). Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies. Retrieved June 30, 2023.Rhino Security Labs. (2019, August 22). Pacu. Retrieved October 17, 2019.Dirk-jan Mollema. (2020, April 16). Introducing ROADtools - The Azure AD exploration framework. Retrieved January 31, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.