MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseDomain or Tenant Policy ModificationGroup Policy ModificationDomain or Tenant Policy Modification:Group Policy ModificationOther sub-techniques of Domain or Tenant Policy Modification (2)IDNameT1484.001Group Policy ModificationT1484.002Trust ModificationAdversaries may modify Group Policy Objects (GPOs) to subvert the intended discretionary access controls for a domain, usually with the intention of escalating privileges on the domain. Group policy allows for centralized management of user and computer settings in Active Directory (AD). GPOs are containers for group policy settings made up of files stored within a predictable network path\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\.[1][2]Like other objects in AD, GPOs have access controls associated with them. By default all user accounts in the domain have permission to read GPOs. It is possible to delegate GPO access control permissions, e.g. write access, to specific users or groups in the domain.Malicious GPO modifications can be used to implement many other malicious behaviors such asScheduled Task/Job,Disable or Modify Tools,Ingress Tool Transfer,Create Account,Service Execution,  and more.[2][3][4][5][6]Since GPOs can control so many user and machine settings in the AD environment, there are a great number of potential attacks that can stem from this GPO abuse.[3]For example, publicly available scripts such asNew-GPOImmediateTaskcan be leveraged to automate the creation of a maliciousScheduled Task/Jobby modifying GPO settings, in this case modifying<GPO_PATH>\Machine\Preferences\ScheduledTasks\ScheduledTasks.xml.[3][4]In some cases an adversary might modify specific user rights like SeEnableDelegationPrivilege, set in<GPO_PATH>\MACHINE\Microsoft\Windows NT\SecEdit\GptTmpl.inf, to achieve a subtle AD backdoor with complete control of the domain because the user account under the adversary's control would then be able to modify GPOs.[7]ID:T1484.001Sub-technique of:T1484ⓘTactics:Defense Evasion,Privilege EscalationⓘPlatforms:WindowsⓘPermissions Required:Administrator, UserContributors:Itamar Mizrahi, Cymptom; Tristan Bennett, Seamless IntelligenceVersion:1.0Created:28 December 2020Last Modified:06 January 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionC00342022 Ukraine Electric Power AttackDuring the2022 Ukraine Electric Power Attack,Sandworm Teamleveraged Group Policy Objects (GPOs) to deploy and execute malware.[8]G1021Cinnamon TempestCinnamon Tempesthas used Group Policy to deploy batch scripts for ransomware deployment.[9]S0554EgregorEgregorcan modify the GPO to evade detection.[10][11]S0363EmpireEmpirecan useNew-GPOImmediateTaskto modify a GPO that will install and execute a maliciousScheduled Task/Job.[12]S0697HermeticWiperHermeticWiperhas the ability to deploy through an infected system's default domain policy.[13]G0119Indrik SpiderIndrik Spiderhas used Group Policy Objects to deploy batch scripts.[14]S0688MeteorMeteorcan use group policy to push a scheduled task from the AD to all network machines.[15]S1058PrestigePrestigehas been deployed using the Default Domain Group Policy Object from an Active Directory Domain Controller.[16]MitigationsIDMitigationDescriptionM1047AuditIdentify and correct GPO permissions abuse opportunities (ex: GPO modification privileges) using auditing tools such asBloodHound(version 1.5.1 and later).[17]M1018User Account ManagementConsider implementing WMI and security filtering to further tailor which users and computers a GPO will apply to.[3][18][19]DetectionIDData SourceData ComponentDetectsDS0026Active DirectoryActive Directory Object CreationMonitor for newly constructed active directory objects, such as Windows EID 5137.Active Directory Object DeletionMonitor for unexpected deletion of an active directory object, such as Windows EID 5141.Active Directory Object ModificationMonitor for changes made to AD settings for unexpected modifications to user accounts, such as deletions or potentially malicious changes to user attributes (credentials, status, etc.).DS0017CommandCommand ExecutionMonitor executed commands and arguments that may modify Group Policy Objects (GPOs) to subvert the intended discretionary access controls for a domain, usually with the intention of escalating privileges on the domain.Referencessrachui. (2012, February 13). Group Policy Basics – Part 1: Understanding the Structure of a Group Policy Object. Retrieved March 5, 2019.Metcalf, S. (2016, March 14). Sneaky Active Directory Persistence #17: Group Policy. Retrieved March 5, 2019.Robbins, A. (2018, April 2). A Red Teamer’s Guide to GPOs and OUs. Retrieved March 5, 2019.Schroeder, W. (2016, March 17). Abusing GPO Permissions. Retrieved March 5, 2019.Mandiant. (2016, February 25). Mandiant M-Trends 2016. Retrieved March 5, 2019.Microsoft Secure Team. (2016, June 1). Hacking Team Breach: A Cyber Jurassic Park. Retrieved March 5, 2019.Schroeder, W. (2017, January 10). The Most Dangerous User Right You (Probably) Have Never Heard Of. Retrieved March 5, 2019.Ken Proska, John Wolfram, Jared Wilson, Dan Black, Keith Lunden, Daniel Kapellmann Zafra, Nathan Brubaker, Tyler Mclellan, Chris Sistrunk. (2023, November 9). Sandworm Disrupts Power in Ukraine Using a Novel Attack Against Operational Technology. Retrieved March 28, 2024.Microsoft. (2022, May 9). Ransomware as a service: Understanding the cybercrime gig economy and how to protect yourself. Retrieved March 10, 2023.Rochberger, L. (2020, November 26). Cybereason vs. Egregor Ransomware. Retrieved December 30, 2020.Bichet, J. (2020, November 12). Egregor – Prolock: Fraternal Twins ?. Retrieved January 6, 2021.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.ESET. (2022, March 1). IsaacWiper and HermeticWizard: New wiper and worm targetingUkraine. Retrieved April 10, 2022.Frankoff, S., Hartley, B. (2018, November 14). Big Game Hunting: The Evolution of INDRIK SPIDER From Dridex Wire Fraud to BitPaymer Targeted Ransomware. Retrieved January 6, 2021.Check Point Research Team. (2021, August 14). Indra - Hackers Behind Recent Attacks on Iran. Retrieved February 17, 2022.MSTIC. (2022, October 14). New “Prestige” ransomware impacts organizations in Ukraine and Poland. Retrieved January 19, 2023.Robbins, A., Vazarkar, R., and Schroeder, W. (2016, April 17). Bloodhound: Six Degrees of Domain Admin. Retrieved March 5, 2019.Microsoft. (2008, September 11). Fun with WMI Filters in Group Policy. Retrieved March 13, 2019.Microsoft. (2018, May 30). Filtering the Scope of a GPO. Retrieved March 13, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.