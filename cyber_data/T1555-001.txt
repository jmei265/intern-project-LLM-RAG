MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseCredentials from Password StoresKeychainCredentials from Password Stores:KeychainOther sub-techniques of Credentials from Password Stores (6)IDNameT1555.001KeychainT1555.002Securityd MemoryT1555.003Credentials from Web BrowsersT1555.004Windows Credential ManagerT1555.005Password ManagersT1555.006Cloud Secrets Management StoresAdversaries may acquire credentials from Keychain. Keychain (or Keychain Services) is the macOS credential management system that stores account names, passwords, private keys, certificates, sensitive application data, payment data, and secure notes. There are three types of Keychains: Login Keychain, System Keychain, and Local Items (iCloud) Keychain. The default Keychain is the Login Keychain, which stores user passwords and information. The System Keychain stores items accessed by the operating system, such as items shared among users on a host. The Local Items (iCloud) Keychain is used for items synced with Apple’s iCloud service.Keychains can be viewed and edited through the Keychain Access application or using the command-line utilitysecurity. Keychain files are located in~/Library/Keychains/,/Library/Keychains/, and/Network/Library/Keychains/.[1][2][3]Adversaries may gather user credentials from Keychain storage/memory. For example, the commandsecurity dump-keychain –dwill dump all Login Keychain credentials from~/Library/Keychains/login.keychain-db. Adversaries may also directly read Login Keychain credentials from the~/Library/Keychains/login.keychainfile. Both methods require a password, where the default password for the Login Keychain is the current user’s password to login to the macOS host.[4][5]ID:T1555.001Sub-technique of:T1555ⓘTactic:Credential AccessⓘPlatforms:macOSVersion:1.1Created:12 February 2020Last Modified:18 April 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0274CalistoCalistocollects Keychain storage data and copies those passwords/tokens to a file.[6][7]S0690Green LambertGreen Lambertcan use Keychain Services API functions to find and collect passwords, such asSecKeychainFindInternetPasswordandSecKeychainItemCopyAttributesAndData.[8][9]S0278iKitteniKittencollects the keychains on the system.[10]S0349LaZagneLaZagnecan obtain credentials from macOS Keychains.[11]S1016MacMaMacMacan dump credentials from the macOS keychain.[12]S0279ProtonProtongathers credentials in files for keychains.[10]MitigationsIDMitigationDescriptionM1027Password PoliciesThe password for the user's login keychain can be changed from the user's login password. This increases the complexity for an adversary because they need to know an additional password.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands with arguments that may be used to collect Keychain data from a system to acquire credentials.DS0022FileFile AccessMonitor for Keychain files being accessed that may be related to malicious credential collection.DS0009ProcessOS API ExecutionMonitor for Keychain Services API calls, specifically legacy extensions such asSecKeychainFindInternetPassword, that may collect Keychain data from a system to acquire credentials.[13]Process CreationMonitor processes spawned by command line utilities to manipulate keychains directly, such assecurity, combined with arguments to collect passwords, such asdump-keychain -d.ReferencesApple. (n.d.). Keychain Services. Retrieved April 11, 2022.Yana Gourenko. (n.d.). A Deep Dive into Apple Keychain Decryption. Retrieved April 13, 2022.Jan Schaumann. (2015, November 5). Using the OS X Keychain to store and retrieve passwords. Retrieved March 31, 2022.Alex Rymdeko-Harvey, Steve Borosh. (2016, May 14). External to DA, the OS X Way. Retrieved July 3, 2017.Empire. (2018, March 8). Empire keychaindump_decrypt Module. Retrieved April 14, 2022.Kuzin, M., Zelensky S. (2018, July 20). Calisto Trojan for macOS. Retrieved September 7, 2018.Pantig, J. (2018, July 30). OSX.Calisto. Retrieved September 7, 2018.Sandvik, Runa. (2021, October 1). Made In America: Green Lambert for OS X. Retrieved March 21, 2022.Sandvik, Runa. (2021, October 18). Green Lambert and ATT&CK. Retrieved March 21, 2022.Patrick Wardle. (n.d.). Mac Malware of 2017. Retrieved September 21, 2018.Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018.M.Léveillé, M., Cherepanov, A.. (2022, January 25). Watering hole deploys new macOS malware, DazzleSpy, in Asia. Retrieved May 6, 2022.Apple. (n.d.). Keychain Items. Retrieved April 12, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.