MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesMobileAdversary-in-the-MiddleAdversary-in-the-MiddleAdversaries may attempt to position themselves between two or more networked devices to support follow-on behaviors such asTransmitted Data ManipulationorEndpoint Denial of Service.Adversary-in-the-Middlecan be achieved through several mechanisms. For example, a malicious application may register itself as a VPN client, effectively redirecting device traffic to adversary-owned resources. Registering as a VPN client requires user consent on both Android and iOS; additionally, a special entitlement granted by Apple is needed for iOS devices. Alternatively, a malicious application with escalation privileges may utilize those privileges to gain access to network traffic.Specific to Android devices, adversary-in-the-disk is a type of AiTM attack where adversaries monitor and manipulate data that is exchanged between applications and external storage.[1][2][3]To accomplish this, a malicious application firsts requests for access to multimedia files on the device (READ_EXTERNAL STORAGEandWRITE_EXTERNAL_STORAGE), then the application reads data on the device and/or writes malware to the device. Though the request for access is common, when used maliciously, adversaries may access files and other sensitive data due to abusing the permission. Multiple applications were shown to be vulnerable against this attack; however, scrutiny of permissions and input validations may mitigate this attack.Outside of a mobile device, adversaries may be able to capture traffic by employing a rogue base station or Wi-Fi access point. These devices will allow adversaries to capture network traffic after it has left the device, while it is flowing to its destination. On a local network, enterprise techniques could be used, such asARP Cache PoisoningorDHCP Spoofing.If applications properly encrypt their network traffic, sensitive data may not be accessible to adversaries, depending on the point of capture. For example, properly implementing Apple’s Application Transport Security (ATS) and Android’s Network Security Configuration (NSC) may prevent sensitive data leaks.[4]ID:T1638Sub-techniques:No sub-techniquesTactic Type:Post-Adversary Device AccessⓘTactic:CollectionⓘPlatforms:Android, iOSⓘMTC ID:CEL-3,APP-0,APP-1,APP-8,ECO-12Version:2.2Created:05 April 2022Last Modified:07 February 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0288KeyRaiderMostKeyRaidersamples hook SSLRead and SSLWrite functions in the itunesstored process to intercept device communication with the Apple App Store.[5]S0407MonokleMonoklecan install attacker-specified certificates to the device's trusted certificate store, enabling an adversary to perform adversary-in-the-middle attacks.[6]S1062S.O.V.A.S.O.V.A.has included adversary-in-the-middle capabilities.[7]MitigationsIDMitigationDescriptionM1009Encrypt Network TrafficApplications that properly encrypt network traffic may evade some forms of AiTM behavior.M1006Use Recent OS VersionRecent OS versions have made it more difficult for applications to register as VPN providers.DetectionIDData SourceData ComponentDetectsDS0041Application VettingProtected ConfigurationApplication vetting services should look for applications that request VPN access. These applications should be heavily scrutinized since VPN functionality is not very common.DS0029Network TrafficNetwork Connection CreationMobile security products can potentially detect rogue Wi-Fi access points if the adversary is attempting to decrypt traffic using an untrusted SSL certificate.DS0042User InterfacePermissions RequestOn both Android and iOS, the user must grant consent to an application to act as a VPN. Both platforms also provide visual context to the user in the top status bar when a VPN connection is active. The user can see registered VPN services in the device settings.ReferencesDrozhzhin, A. (2018, August 27). Man-in-the-Disk: A new and dangerous way to hack Android. Retrieved October 31, 2023.Check Point Research Team. (2018, August 12). Man-in-the-Disk: A New Attack Surface for Android Apps. Retrieved October 31, 2023.Makkaveev, S. (2018, August 12). Man-in-the-Disk: Android Apps Exposed via External Storage. Retrieved October 31, 2023.Lee, A., Ramirez, T. (2018, August 15). A Security Analyst’s Guide to Network Security Configuration in Android P . Retrieved February 7, 2024.Yair Amit. (2013, March 12). Malicious Profiles - The Sleeping Giant of iOS Security. Retrieved December 22, 2016.Claud Xiao. (2015, August 30). KeyRaider: iOS Malware Steals Over 225,000 Apple Accounts to Create Free App Utopia. Retrieved December 12, 2016.ThreatFabric. (2021, September 9). S.O.V.A. - A new Android Banking trojan with fowl intentions. Retrieved February 6, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.