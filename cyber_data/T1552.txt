MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseUnsecured CredentialsUnsecured CredentialsSub-techniques (8)IDNameT1552.001Credentials In FilesT1552.002Credentials in RegistryT1552.003Bash HistoryT1552.004Private KeysT1552.005Cloud Instance Metadata APIT1552.006Group Policy PreferencesT1552.007Container APIT1552.008Chat MessagesAdversaries may search compromised systems to find and obtain insecurely stored credentials. These credentials can be stored and/or misplaced in many locations on a system, including plaintext files (e.g.Bash History), operating system or application-specific repositories (e.g.Credentials in Registry),  or other specialized files/artifacts (e.g.Private Keys).[1]ID:T1552Sub-techniques:T1552.001,T1552.002,T1552.003,T1552.004,T1552.005,T1552.006,T1552.007,T1552.008ⓘTactic:Credential AccessⓘPlatforms:Azure AD, Containers, Google Workspace, IaaS, Linux, Network, Office 365, SaaS, Windows, macOSContributors:Austin Clark, @c2defenseVersion:1.3Created:04 February 2020Last Modified:15 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0373AstarothAstarothuses an external software known as NetPass to recover passwords.[2]S1111DarkGateDarkGateuses NirSoft tools to steal user credentials from the infected machine.[3]NirSoft tools are executed via process hollowing in a newly-created instance of vbc.exe or regasm.exe.S1091PacuPacucan search for sensitive data: for example, in Code Build environment variables, EC2 user data, and Cloud Formation templates.[4]MitigationsIDMitigationDescriptionM1015Active Directory ConfigurationRemove vulnerable Group Policy Preferences.[5]M1047AuditPreemptively search for files containing passwords or other credentials and take actions to reduce the exposure risk when found.M1041Encrypt Sensitive InformationWhen possible, store keys on separate cryptographic hardware instead of on the local system.M1037Filter Network TrafficLimit access to the Instance Metadata API. A properly configured Web Application Firewall (WAF) may help prevent external adversaries from exploiting Server-side Request Forgery (SSRF) attacks that allow access to the Cloud Instance Metadata API.[6]M1035Limit Access to Resource Over NetworkLimit network access to sensitive services, such as the Instance Metadata API.M1028Operating System ConfigurationThere are multiple methods of preventing a user's command history from being flushed to their .bash_history file, including use of the following commands:set +o historyandset -o historyto start logging again;unset HISTFILEbeing added to a user's .bash_rc file; andln -s /dev/null ~/.bash_historyto write commands to/dev/nullinstead.M1027Password PoliciesUse strong passphrases for private keys to make cracking difficult. Do not store credentials within the Registry. Establish an organizational policy that prohibits password storage in files.M1026Privileged Account ManagementIf it is necessary that software must store credentials in the Registry, then ensure the associated accounts have limited permissions so they cannot be abused if obtained by an adversary.M1022Restrict File and Directory PermissionsRestrict file shares to specific directories with access only to necessary users.M1051Update SoftwareApply patch KB2962486 which prevents credentials from being stored in GPPs.[7][8]M1017User TrainingEnsure that developers and system administrators are aware of the risk associated with having plaintext passwords in software configuration files that may be left on endpoint systems or servers.DetectionIDData SourceData ComponentDetectsDS0015Application LogApplication Log ContentMonitor application logs for activity that may highlight malicious attempts to access application data, especially abnormal search activity targeting passwords and other artifacts related to credentials.[9]DS0017CommandCommand ExecutionWhile detecting adversaries accessing credentials may be difficult without knowing they exist in the environment, it may be possible to detect adversary use of credentials they have obtained. Monitor the command-line arguments of executing processes for suspicious words or regular expressions that may indicate searching for a password (for example: password, pwd, login, secure, or credentials). SeeValid Accountsfor more information.DS0022FileFile AccessMonitor for suspicious file access activity, specifically indications that a process is reading multiple files in a short amount of time and/or using command-line arguments indicative of searching for credential material (ex: regex patterns). These may be indicators of automated/scripted credential access behavior. Monitoring when the user's.bash_historyis read can help alert to suspicious activity. While users do typically rely on their history of commands, they often access this history through other utilities like "history" instead of commands likecat ~/.bash_history.DS0009ProcessProcess CreationMonitor newly executed processes that may search compromised systems to find and obtain insecurely stored credentials.DS0002User AccountUser Account AuthenticationMonitor for an attempt by a user to gain access to a network or computing resource, often by providing credentials that may search compromised systems to find and obtain insecurely stored credentials.DS0024Windows RegistryWindows Registry Key AccessMonitor for unexpected windows registry key being accessed that may search compromised systems to find and obtain insecurely stored credentials.ReferencesTim Wadhwa-Brown. (2018, November). Where 2 worlds collide Bringing Mimikatz et al to UNIX. Retrieved October 13, 2021.Salem, E. (2019, February 13). ASTAROTH MALWARE USES LEGITIMATE OS AND ANTIVIRUS PROCESSES TO STEAL PASSWORDS AND PERSONAL DATA. Retrieved April 17, 2019.Adi Zeligson & Rotem Kerner. (2018, November 13). Enter The DarkGate - New Cryptocurrency Mining and Ransomware Campaign. Retrieved February 9, 2024.Rhino Security Labs. (2019, August 22). Pacu. Retrieved October 17, 2019.Microsoft. (2014, May 13). MS14-025: Vulnerability in Group Policy Preferences could allow elevation of privilege. Retrieved January 28, 2015.Higashi, Michael. (2018, May 15). Instance Metadata API: A Modern Day Trojan Horse. Retrieved July 16, 2019.Sean Metcalf. (2015, December 28). Finding Passwords in SYSVOL & Exploiting Group Policy Preferences. Retrieved February 17, 2020.Microsoft. (2014, May 13). MS14-025: Vulnerability in Group Policy Preferences could allow elevation of privilege. Retrieved February 17, 2020.Slack Help Center. (n.d.). View Access Logs for your workspace. Retrieved April 10, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.