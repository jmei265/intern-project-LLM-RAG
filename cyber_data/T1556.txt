MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseModify Authentication ProcessModify Authentication ProcessSub-techniques (9)IDNameT1556.001Domain Controller AuthenticationT1556.002Password Filter DLLT1556.003Pluggable Authentication ModulesT1556.004Network Device AuthenticationT1556.005Reversible EncryptionT1556.006Multi-Factor AuthenticationT1556.007Hybrid IdentityT1556.008Network Provider DLLT1556.009Conditional Access PoliciesAdversaries may modify authentication mechanisms and processes to access user credentials or enable otherwise unwarranted access to accounts. The authentication process is handled by mechanisms, such as the Local Security Authentication Server (LSASS) process and the Security Accounts Manager (SAM) on Windows, pluggable authentication modules (PAM) on Unix-based systems, and authorization plugins on MacOS systems, responsible for gathering, storing, and validating credentials. By modifying an authentication process, an adversary may be able to authenticate to a service or system without usingValid Accounts.Adversaries may maliciously modify a part of this process to either reveal credentials or bypass authentication mechanisms. Compromised credentials or access may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop.ID:T1556Sub-techniques:T1556.001,T1556.002,T1556.003,T1556.004,T1556.005,T1556.006,T1556.007,T1556.008,T1556.009ⓘTactics:Credential Access,Defense Evasion,PersistenceⓘPlatforms:Azure AD, Google Workspace, IaaS, Linux, Network, Office 365, SaaS, Windows, macOSContributors:Chris Ross @xorriorVersion:2.4Created:11 February 2020Last Modified:11 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0377EburyEburycan intercept private keys using a trojanizedssh-addfunction.[1]G1016FIN13FIN13has replaced legitimate KeePass binaries with trojanized versions to collect passwords from numerous applications.[2]S0487KesselKesselhas trojanized thessh_loginanduser-auth_pubkeyfunctions to steal plaintext credentials.[3]S0692SILENTTRINITYSILENTTRINITYcan create a backdoor in KeePass using a malicious config file and in TortoiseSVN using a registry hook.[4]MitigationsIDMitigationDescriptionM1047AuditReview authentication logs to ensure that mechanisms such as enforcement of MFA are functioning as intended.Periodically review the hybrid identity solution in use for any discrepancies. For example, review all Pass Through Authentication (PTA) agents in the Azure Management Portal to identify any unwanted or unapproved ones.[5]If ADFS is in use, review DLLs and executable files in the AD FS and Global Assembly Cache directories to ensure that they are signed by Microsoft. Note that in some cases binaries may be catalog-signed, which may cause the file to appear unsigned when viewing file properties.[6]Periodically review for new and unknown network provider DLLs within the Registry (HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\<NetworkProviderName>\NetworkProvider\ProviderPath). Ensure only valid network provider DLLs are registered. The name of these can be found in the Registry key atHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order, and have corresponding service subkey pointing to a DLL atHKEY_LOCAL_MACHINE\SYSTEM\CurrentC ontrolSet\Services\<NetworkProviderName>\NetworkProvider.M1032Multi-factor AuthenticationIntegrating multi-factor authentication (MFA) as part of organizational policy can greatly reduce the risk of an adversary gaining control of valid credentials that may be used for additional tactics such as initial access, lateral movement, and collecting information. MFA can also be used to restrict access to cloud resources and APIs.M1028Operating System ConfigurationEnsure only valid password filters are registered. Filter DLLs must be present in Windows installation directory (C:\Windows\System32\by default) of a domain controller and/or local computer with a corresponding entry inHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages.Starting in Windows 11 22H2, theEnableMPRNotificationspolicy can be disabled through Group Policy or through a configuration service provider to prevent Winlogon from sending credentials to network providers.[7]M1027Password PoliciesEnsure thatAllowReversiblePasswordEncryptionproperty is set to disabled unless there are application requirements.[8]M1026Privileged Account ManagementAudit domain and local accounts as well as their permission levels routinely to look for situations that could allow an adversary to gain wide access by obtaining credentials of a privileged account.[9][10]These audits should also include if default accounts have been enabled, or if new local accounts are created that have not be authorized. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.[11]Limit access to the root account and prevent users from modifying protected components through proper privilege separation (ex SELinux, grsecurity, AppArmor, etc.) and limiting Privilege Escalation opportunities.Limit on-premises accounts with access to the hybrid identity solution in place. For example, limit Azure AD Global Administrator accounts to only those required, and ensure that these are dedicated cloud-only accounts rather than hybrid ones.[6]M1025Privileged Process IntegrityEnabled features, such as Protected Process Light (PPL), for LSA.[12]M1022Restrict File and Directory PermissionsRestrict write access to the/Library/Security/SecurityAgentPluginsdirectory.M1024Restrict Registry PermissionsRestrict Registry permissions to disallow the modification of sensitive Registry keys such asHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order.M1018User Account ManagementEnsure that proper policies are implemented to dictate the the secure enrollment and deactivation of authentication mechanisms, such as MFA, for user accounts.DetectionIDData SourceData ComponentDetectsDS0026Active DirectoryActive Directory Object ModificationMonitor for changes made to AD security settings related to MFA logon requirements, such as changes to Azure AD Conditional Access Policies or the registration of new MFA applications.Monitor for changes made to security settings related to Azure AD Conditional Access Policies. These can be found in the Azure AD audit log under the operation nameUpdate Conditional Access policy.[13]DS0015Application LogApplication Log ContentEnable security auditing to collect logs from hybrid identity solutions. For example, monitor sign-ins to the Azure AD Application Proxy Connector, which are typically generated only when a new Pass Through Authentication (PTA) Agent is added.[5]If AD FS is in use, review the logs for event ID 501, which specifies all EKU attributes on a claim, and raise alerts on any values that are not configured in your environment.[6]DS0025Cloud ServiceCloud Service ModificationMonitor for changes made to conditional access policies used by SaaS identity providers and internal IaaS identity and access management systems.DS0022FileFile CreationMonitor for suspicious additions to the/Library/Security/SecurityAgentPluginsdirectory.[14]Monitor for newly created files that may be used to register malicious network provider dynamic link libraries (DLLs).File ModificationMonitor for suspicious modification of files associated with authentication processes, such as configuration files and module paths (e.g./etc/pam.d/). Use system-integrity tools such as AIDE and monitoring tools such as auditd to monitor PAM files. Also monitor for access to certificates and cryptographic keys material.DS0028Logon SessionLogon Session CreationMonitor for newly constructed logon behavior across systems that share accounts, either user, admin, or service accounts. Examples: one account logged into multiple systems simultaneously; multiple accounts logged into the same machine simultaneously; accounts logged in at odd times (ex: when the user is not present) or outside of business hours. Activity may be from interactive login sessions or process ownership from accounts being used to execute binaries on a remote system as a particular account. Correlate other security systems with login information (e.g., a user has an active login session but has not entered the building or does not have VPN access). Configure robust, consistent account activity audit policies across the enterprise and with externally accessible services.[15]DS0011ModuleModule LoadMonitor for new, unfamiliar DLL files written to a domain controller and/or local computer. Password filters will also show up as an autorun and loaded DLL in lsass.exe.[16]If AD FS is in use, monitor the AD FS server for the creation of DLLs as well as the loading of unrecognized or unsigned DLLs into theMicrosoft.IdentityServer.Servicehostapplication.[6]DS0009ProcessOS API ExecutionMonitor for calls toOpenProcessthat can be used to manipulate lsass.exe running on a domain controller as well as for malicious modifications to functions exported from authentication-related system DLLs (such as cryptdll.dll and samsrv.dll).[17]Monitor for abnormal API calls toNPLogonNotify()that may highlight malicious network provider DLLs.[18]Process AccessMonitor for unexpected processes interacting with authentication mechanisms and processes to access user credentials or enable otherwise unwarranted access to accounts.DS0002User AccountUser Account AuthenticationMonitor for account authentications in which MFA credentials are not provided by the user account to the authenticating entity.User Account ModificationMonitor for the enrollment of devices and user accounts with alternative security settings that do not require MFA credentials for successful logon.DS0024Windows RegistryWindows Registry Key CreationMonitor for the addition of network provider Registry keys (e.g.,HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\<NetworkProviderName>\NetworkProvider).Windows Registry Key ModificationMonitor for changes to Registry entries for password filters (ex:HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages) and correlate then investigate the DLL files these files reference.Monitor for changes to Registry entries for network providers (e.g.,HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\NetworkProvider\Order) and correlate then investigate the DLL files these values reference.ReferencesM.Léveillé, M.. (2014, February 21). An In-depth Analysis of Linux/Ebury. Retrieved April 19, 2019.Ta, V., et al. (2022, August 8). FIN13: A Cybercriminal Threat Actor Focused on Mexico. Retrieved February 9, 2023.Dumont, R., M.Léveillé, M., Porcher, H. (2018, December 1). THE DARK SIDE OF THE FORSSHE A landscape of OpenSSH backdoors. Retrieved July 16, 2020.Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.Mike Burns. (2020, September 30). Detecting Microsoft 365 and Azure Active Directory Backdoors. Retrieved September 28, 2022.Microsoft Threat Intelligence Center, Microsoft Detection and Response Team, Microsoft 365 Defender Research Team . (2022, August 24). MagicWeb: NOBELIUM’s post-compromise trick to authenticate as anyone. Retrieved September 28, 2022.Microsoft. (2023, January 26). Policy CSP - WindowsLogon. Retrieved March 30, 2023.Microsoft. (2021, October 28). Store passwords using reversible encryption. Retrieved January 3, 2022.Microsoft. (2016, April 15). Attractive Accounts for Credential Theft. Retrieved June 3, 2016.Microsoft. (2016, April 16). Implementing Least-Privilege Administrative Models. Retrieved June 3, 2016.Plett, C., Poggemeyer, L. (12, October 26). Securing Privileged Access Reference Material. Retrieved April 25, 2017.Microsoft. (2013, July 31). Configuring Additional LSA Protection. Retrieved February 13, 2015.Microsoft. (2023, October 23). Troubleshooting Conditional Access policy changes. Retrieved January 2, 2024.Chris Ross. (2018, October 17). Persistent Credential Theft with Authorization Plugins. Retrieved April 22, 2021.Microsoft. (2016, April 15). Audit Policy Recommendations. Retrieved June 3, 2016.Bialek, J. (2013, September 15). Intercepting Password Changes With Function Hooking. Retrieved November 21, 2017.Dell SecureWorks. (2015, January 12). Skeleton Key Malware Analysis. Retrieved April 8, 2019.Microsoft. (2021, October 21). NPLogonNotify function (npapi.h). Retrieved March 30, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.