MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseDevice Driver DiscoveryDevice Driver DiscoveryAdversaries may attempt to enumerate local device drivers on a victim host. Information about device drivers may highlight various insights that shape follow-on behaviors, such as the function/purpose of the host, present security tools (i.e.Security Software Discovery) or other defenses (e.g.,Virtualization/Sandbox Evasion), as well as potential exploitable vulnerabilities (e.g.,Exploitation for Privilege Escalation).Many OS utilities may provide information about local device drivers, such asdriverquery.exeand theEnumDeviceDrivers()API function on Windows.[1][2]Information about device drivers (as well as associated services, i.e.,System Service Discovery) may also be available in the Registry.[3]On Linux/macOS, device drivers (in the form of kernel modules) may be visible within/devor using utilities such aslsmodandmodinfo.[4][5][6]ID:T1652Sub-techniques:No sub-techniquesⓘTactic:DiscoveryⓘPlatforms:Linux, Windows, macOSContributors:ESETVersion:1.0Created:28 March 2023Last Modified:04 May 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0376HOPLIGHTHOPLIGHTcan enumerate device drivers located in the registry atHKLM\Software\WBEM\WDM.[7]S0125RemsecRemsechas a plugin to detect active drivers of some security products.[8]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands (lsmod,driverquery, etc.) with arguments highlighting potentially malicious attempts to enumerate device drivers.DS0009ProcessOS API ExecutionMonitor for API calls (such asEnumDeviceDrivers()) that may attempt to gather information about local device drivers.Process CreationMonitor processes (lsmod,driverquery.exe, etc.) for events that may highlight potentially malicious attempts to enumerate device drivers.DS0024Windows RegistryWindows Registry Key AccessMonitor for attempts to access information stored in the Registry about devices and their associated drivers, such as values underHKLM\SYSTEM\CurrentControlSet\ServicesandHKLM\SYSTEM\CurrentControlSet\HardwareProfiles.[3]ReferencesMicrosoft. (n.d.). driverquery. Retrieved March 28, 2023.Microsoft. (2021, October 12). EnumDeviceDrivers function (psapi.h). Retrieved March 28, 2023.Microsoft. (2021, December 14). Registry Trees for Devices and Drivers. Retrieved March 28, 2023.Pomerantz, O., Salzman, P.. (2003, April 4). The Linux Kernel Module Programming Guide. Retrieved April 6, 2018.Kerrisk, M. (2022, December 18). lsmod(8) — Linux manual page. Retrieved March 28, 2023.Russell, R. (n.d.). modinfo(8) - Linux man page. Retrieved March 28, 2023.US-CERT. (2019, April 10). MAR-10135536-8 – North Korean Trojan: HOPLIGHT. Retrieved April 19, 2019.Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Technical Analysis. Retrieved August 17, 2016.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.