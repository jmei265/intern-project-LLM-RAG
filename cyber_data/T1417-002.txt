MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesMobileInput CaptureGUI Input CaptureInput Capture:GUI Input CaptureOther sub-techniques of Input Capture (2)IDNameT1417.001KeyloggingT1417.002GUI Input CaptureAdversaries may mimic common operating system GUI components to prompt users for sensitive information with a seemingly legitimate prompt. The operating system and installed applications often have legitimate needs to prompt the user for sensitive information such as account credentials, bank account information, or Personally Identifiable Information (PII). Compared to traditional PCs, the constrained display size of mobile devices may impair the ability to provide users with contextual information, making users more susceptible to this technique’s use.[1]There are several approaches adversaries may use to mimic this functionality. Adversaries may impersonate the identity of a legitimate application (e.g. use the same application name and/or icon) and, when installed on the device, may prompt the user for sensitive information.[2]Adversaries may also send fake device notifications to the user that may trigger the display of an input prompt when clicked.[3]Additionally, adversaries may display a prompt on top of a running, legitimate application to trick users into entering sensitive information into a malicious application rather than the legitimate application. Typically, adversaries need to know when the targeted application and the individual activity within the targeted application is running in the foreground to display the prompt at the proper time. Adversaries can abuse Android’s accessibility features to determine which application is currently in the foreground.[4]Two known approaches to displaying a prompt include:Adversaries start a new activity on top of a running legitimate application.[1][5]Android 10 places new restrictions on the ability for an application to start a new activity on top of another application, which may make it more difficult for adversaries to utilize this technique.[6]Adversaries create an application overlay window on top of a running legitimate application. Applications must hold theSYSTEM_ALERT_WINDOWpermission to create overlay windows. This permission is handled differently than typical Android permissions and, at least under certain conditions, is automatically granted to applications installed from the Google Play Store.[7][8][9]TheSYSTEM_ALERT_WINDOWpermission and its associated ability to create application overlay windows are expected to be deprecated in a future release of Android in favor of a new API.[10]ID:T1417.002Sub-technique of:T1417Tactic Type:Post-Adversary Device AccessⓘTactics:Credential Access,CollectionⓘPlatforms:Android, iOSⓘMTC ID:APP-31Version:1.1Created:05 April 2022Last Modified:20 March 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0422AnubisAnubiscan create overlays to capture user credentials for targeted applications.[11]S1094BRATABRATAcan use tailored overlay pages to steal PINs for banking applications.[12]S0480CerberusCerberuscan generate fake notifications and launch overlay attacks against attacker-specified applications.[13]S1083ChameleonChameleoncan perform overlay attacks against a device by injecting HTML phishing pages into a webview.[14]S0301DendroidDendroidcan open a dialog box to ask the user for passwords.[15]S1054DrinikDrinikcan use overlays to steal user banking credentials entered into legitimate sites.[16]S1092EscobarEscobarcan collect credentials using phishing overlays.[17]S0478EventBotEventBotcan display popups over running applications.[18]S0522ExobotExobotcan show phishing popups when a targeted application is running.[19]S1103FlixOnlineFlixOnlinerequests overlay permissions, which can allow it to create fake Login screens for other apps.[20]S1067FluBotFluBotcan add display overlays onto banking apps to capture credit card information.[21]S1093FlyTrapFlyTraphas used infected applications with Facebook login prompts to steal credentials.[22]S0423GinpGinpcan use a multi-step phishing overlay to capture banking credentials and then credit card numbers after login.[23]S0536GPlayedGPlayedcan show a phishing WebView pretending to be a Google service that collects credit card information.[24]S0406GustuffGustuffuses WebView overlays to prompt the user for their device unlock code, as well as banking and cryptocurrency application credentials.Gustuffcan also send push notifications pretending to be from a bank, triggering a phishing overlay.[25][3]S0485MandrakeMandrakecan manipulate visual components to trick the user into granting dangerous permissions, and can use phishing overlays and JavaScript injection to capture credentials.[26]S0317MarcherMarcherattempts to overlay itself on top of legitimate banking apps in an effort to capture user credentials.Marcheralso attempts to overlay itself on top of legitimate apps such as the Google Play Store in an effort to capture user credit card information.[27]S0399PallasPallasuses phishing popups to harvest user credentials.[28]S0539Red Alert 2.0Red Alert 2.0has used malicious overlays to collect banking credentials.[29]S0403RiltokRiltokcan open a fake Google Play screen requesting bank card credentials and mimic the screen of relevant mobile banking apps to request user/bank card details.[30]S0411RotexyRotexycan use phishing overlays to capture users' credit card information.[31]S1062S.O.V.A.S.O.V.A.can use overlays capture banking credentials and credit card information, and can open arbitrary WebViews from the C2.[32]S1055SharkBotSharkBotcan use a WebView with a fake log in site to capture banking credentials.[33]S1069TangleBotTangleBotcan use overlays to cover legitimate applications or screens.[34]S0545TERRACOTTATERRACOTTAhas displayed a form to collect user data after installation.[35]S1056TianySpyTianySpycan utilize WebViews to display fake authentication pages that capture user credentials.[36]S0558Tiktok ProTiktok Procan launch a fake Facebook login page.[37]S0298XbotXbotuses phishing pages mimicking Google Play's payment interface as well as bank login pages.[38]S0297XcodeGhostXcodeGhostcan prompt a fake alert dialog to phish user credentials.[39]MitigationsIDMitigationDescriptionM1012Enterprise PolicyAn EMM/MDM can use the AndroidDevicePolicyManager.setPermittedAccessibilityServicesmethod to set an explicit list of applications that are allowed to use Android's accessibility features.M1006Use Recent OS VersionTheHIDE_OVERLAY_WINDOWSpermission was introduced in Android 12 allowing apps to hide overlay windows of typeTYPE_APPLICATION_OVERLAYdrawn by other apps with theSYSTEM_ALERT_WINDOWpermission, preventing other applications from creating overlay windows on top of the current application.[40]DetectionIDData SourceData ComponentDetectsDS0041Application VettingPermissions RequestsApplication vetting services can look for applications requesting theandroid.permission.SYSTEM_ALERT_WINDOWpermission in the list of permissions in the app manifest.DS0042User InterfaceSystem SettingsAn Android user can view and manage which applications hold theSYSTEM_ALERT_WINDOWpermission through the device settings in Apps & notifications -> Special app access -> Display over other apps (the exact menu location may vary between Android versions).ReferencesA.P. Felt and D. Wagner. (2011, May 26). Phishing on Mobile Devices. Retrieved August 25, 2016.Lukáš Štefanko. (2016, July 7). Fake finance apps on Google Play target users from around the world. Retrieved September 24, 2018.Group-IB. (2019, March 28). Group-IB uncovers Android Trojan named «Gustuff» capable of targeting more than 100 global banking apps, cryptocurrency and marketplace applications. Retrieved September 3, 2019.ThreatFabric. (2019, August). Cerberus - A new banking Trojan from the underworld. Retrieved September 18, 2019.R. Hassell. (2011, October 12-13). Exploiting Androids for Fun and Profit. Retrieved October 10, 2019.Android Developers. (n.d.). Restrictions on starting activities from the background. Retrieved September 18, 2019.Fratantonio, Y., et al.. (2017). Cloak & Dagger. Retrieved September 18, 2019.Ramirez, T.. (2017, May 25). ‘SAW’-ing through the UI: Android overlay malware and the System Alert Window permission explained. Retrieved September 18, 2019.Yair Amit. (2016, March 3). “Accessibility Clickjacking” – The Next Evolution in Android Malware that Impacts More Than 500 Million Devices. Retrieved December 21, 2016.Rahman, M.. (2019, May 8). Bubbles in Android Q will fully replace the overlay API in a future Android version. Retrieved September 18, 2019.M. Feller. (2020, February 5). Infostealer, Keylogger, and Ransomware in One: Anubis Targets More than 250 Android Applications. Retrieved April 8, 2020.Federico Valentini, Francesco Lubatti. (2022, January 24). How BRATA is monitoring your bank account. Retrieved December 18, 2023.Threat Fabric. (2019, August). Cerberus - A new banking Trojan from the underworld. Retrieved June 26, 2020.Cyble Research & Intelligence Labs. (2023, April 13). Banking Trojan targeting mobile users in Australia and Poland. Retrieved August 16, 2023.Marc Rogers. (2014, March 6). Dendroid malware can take over your camera, record audio, and sneak into Google Play. Retrieved December 22, 2016.Cyble. (2022, October 27). Drinik Malware Returns With Advanced Capabilities Targeting Indian Taxpayers. Retrieved January 18, 2023.B. Toulas. (2022, March 12). Android malware Escobar steals your Google Authenticator MFA codes. Retrieved September 28, 2023.D. Frank, L. Rochberger, Y. Rimmer, A. Dahan. (2020, April 30). EventBot: A New Mobile Banking Trojan is Born. Retrieved June 26, 2020.Threat Fabric. (2017, February). Exobot - Android banking Trojan on the rise. Retrieved October 29, 2020.Aviran Hazum, Bodgan Melnykov, Israel Wenik. (2021, April 7). New Wormable Android Malware Spreads by Creating Auto-Replies to Messages in WhatsApp. Retrieved January 26, 2024.Crista Giering, F. Naves, Andrew Conway, Adam McNeil . (2021, April 27). FluBot Android Malware Spreading Rapidly Through Europe, May Hit U.S. Soon. Retrieved February 28, 2023.Trend Micro. (2021, August 17). FlyTrap Android Malware Is Taking Over Facebook Accounts — Protect Yourself With a Malware Scanner. Retrieved September 28, 2023.ThreatFabric. (2019, November). Ginp - A malware patchwork borrowing from Anubis. Retrieved April 8, 2020.V. Ventura. (2018, October 11).  GPlayed Trojan - .Net playing with Google Market . Retrieved November 24, 2020.Vitor Ventura. (2019, April 9).  Gustuff banking botnet targets Australia . Retrieved September 3, 2019.R. Gevers, M. Tivadar, R. Bleotu, A. M. Barbatei, et al.. (2020, May 14). Uprooting Mandrake: The Story of an Advanced Android Spyware Framework That Went Undetected for 4 Years. Retrieved July 15, 2020.Proofpoint. (2017, November 3). Credential phishing and an Android banking Trojan combine in Austrian mobile attacks. Retrieved July 6, 2018.Blaich, A., et al. (2018, January 18). Dark Caracal: Cyber-espionage at a Global Scale. Retrieved April 11, 2018.J. Chandraiah. (2018, July 23). Red Alert 2.0: Android Trojan targets security-seekers. Retrieved December 14, 2020.Tatyana Shishkova. (2019, June 25). Riltok mobile Trojan: A banker with global reach. Retrieved August 7, 2019.T. Shishkova, L. Pikman. (2018, November 22).  The Rotexy mobile Trojan – banker and ransomware. Retrieved September 23, 2019.ThreatFabric. (2021, September 9). S.O.V.A. - A new Android Banking trojan with fowl intentions. Retrieved February 6, 2023.RIFT: Research and Intelligence Fusion Team. (2022, March 3). SharkBot: a “new” generation Android banking Trojan being distributed on Google Play Store. Retrieved January 18, 2023.Felipe Naves, Andrew Conway, W. Stuart Jones, Adam McNeil . (2021, September 23). TangleBot: New Advanced SMS Malware Targets Mobile Users Across U.S. and Canada with COVID-19 Lures. Retrieved February 28, 2023.Satori Threat Intelligence and Research Team. (2020, August). TERRACOTTA Android Malware: A Technical Study. Retrieved December 18, 2020.Trend Micro. (2022, January 25). TianySpy Malware Uses Smishing Disguised as Message From Telco. Retrieved January 11, 2023.S. Desai. (2020, September 8). TikTok Spyware. Retrieved January 5, 2021.Cong Zheng, Claud Xiao and Zhi Xu. (2016, February 18). New Android Trojan “Xbot” Phishes Credit Cards and Bank Accounts, Encrypts Devices for Ransom. Retrieved December 21, 2016.Claud Xiao. (2015, September 18). Update: XcodeGhost Attacker Can Phish Passwords and Open URLs through Infected Apps. Retrieved December 21, 2016.Google. (2022, April 4). Features and APIs Overview. Retrieved April 5, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.