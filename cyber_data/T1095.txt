MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseNon-Application Layer ProtocolNon-Application Layer ProtocolAdversaries may use an OSI non-application layer protocol for communication between host and C2 server or among infected hosts within a network. The list of possible protocols is extensive.[1]Specific examples include use of network layer protocols, such as the Internet Control Message Protocol (ICMP), transport layer protocols, such as the User Datagram Protocol (UDP), session layer protocols, such as Socket Secure (SOCKS), as well as redirected/tunneled protocols, such as Serial over LAN (SOL).ICMP communication between hosts is one example.[2]Because ICMP is part of the Internet Protocol Suite, it is required to be implemented by all IP-compatible hosts.[3]However, it is not as commonly monitored as other Internet Protocols such as TCP or UDP and may be used by adversaries to hide communications.ID:T1095Sub-techniques:No sub-techniquesⓘTactic:Command and ControlⓘPlatforms:Linux, Network, Windows, macOSContributors:Duane Michael; Ryan BecwarVersion:2.3Created:31 May 2017Last Modified:29 September 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionC00342022 Ukraine Electric Power AttackDuring the2022 Ukraine Electric Power Attack,Sandworm Teamproxied C2 communications within a TLS-based tunnel.[4]S0504AnchorAnchorhas used ICMP in C2 communications.[5]G0022APT3AnAPT3downloader establishes SOCKS5 connections for its initial C2.[6]S0456Aria-bodyAria-bodyhas used TCP in C2 communications.[7]S1029AuTo StealerAuTo Stealercan use TCP to communicate with command and control servers.[8]G0135BackdoorDiplomacyBackdoorDiplomacyhas used EarthWorm for network tunneling with a SOCKS5 server and port transfer functionalities.[9]S0234BandookBandookhas a command built in to use a raw TCP socket.[10]S0268BisonalBisonalhas used raw sockets for network communication.[11]G1002BITTERBITTERhas used TCP for C2 communications.[12]S1063Brute Ratel C4Brute Ratel C4has the ability to use TCP for external C2.[13]S0043BUBBLEWRAPBUBBLEWRAPcan communicate using SOCKS.[14]C0021C0021DuringC0021, the threat actors used TCP for some C2 communications.[15]S0335CarbonCarbonuses TCP and UDP for C2.[16]S0660ClamblingClamblinghas the ability to use TCP and UDP for communication.[17]S1105COATHANGERCOATHANGERuses ICMP for transmitting configuration information to and from its command and control server.[18]S0154Cobalt StrikeCobalt Strikecan be configured to use TCP, ICMP, and UDP for C2 communications.[19][20]S0115CrimsonCrimsonuses a custom TCP protocol for C2.[21][22]S0498CryptoisticCryptoisticcan use TCP in communications with C2.[23]C0029Cutting EdgeDuringCutting Edge, threat actors used the Unix socket and a reverse TCP shell for C2 communications.[24]S0021DerusbiDerusbibinds to a raw socket on a random source port between 31800 and 31900 for C2.[25]S0502DrovorubDrovorubcan use TCP to communicate between its agent and client modules.[26]S0076FakeMSome variants ofFakeMuse SSL to communicate with C2 servers.[27]G0037FIN6FIN6has used Metasploit Bind and Reverse TCP stagers.[28]S1044FunnyDreamFunnyDreamcan communicate with C2 over TCP and UDP.[29]S0666GelsemiumGelsemiumhas the ability to use TCP and UDP in C2 communications.[30]S0032gh0st RATgh0st RAThas used an encrypted protocol within TCP segments to communicate with the C2.[31]G0125HAFNIUMHAFNIUMhas used TCP for C2.[32]S0394HiddenWaspHiddenWaspcommunicates with a simple network protocol over TCP.[33]S0260InvisiMoleInvisiMolehas used TCP to download additional modules.[34]S1051KEYPLUGKEYPLUGcan use TCP and KCP (KERN Communications Protocol) over UDP for C2 communication.[35]S1121LITTLELAMB.WOOLTEALITTLELAMB.WOOLTEAcan function as a stand-alone backdoor communicating over the/tmp/clientsDownload.socksocket.[24]S0582LookBackLookBackuses a custom binary protocol over sockets for C2 communications.[36]S1016MacMaMacMahas used a custom JSON-based protocol for its C&C communications.[37]S1060MafaldaMafaldacan use raw TCP for C2.[38]G1013MetadorMetadorhas used TCP for C2.[38]S1059metaMainmetaMaincan establish an indirect and raw TCP socket-based connection to the C2 server.[38][39]S0455MetamorfoMetamorfohas used raw TCP for C2.[40]S0084Mis-TypeMis-Typenetwork traffic can communicate over a raw socket.[41]S0083MisdatMisdatnetwork traffic communicates over a raw socket.[41]S0149MoonWindMoonWindcompletes network communication via raw sockets.[42]S0699MythicMythicsupports WebSocket and TCP-based C2 profiles.[43]S0630NebulaeNebulaecan use TCP in C2 communications.[44]S0034NETEAGLEIfNETEAGLEdoes not detect a proxy configured on the infected machine, it will send beacons via UDP/6000. Also, after retrieving a C2 IP address and Port Number,NETEAGLEwill initiate a TCP connection to this socket. The ensuing connection is a plaintext C2 channel in which commands are specified by DWORDs.[45]S0198NETWIRENETWIREcan use TCP in C2 communications.[46][47]S1100NinjaNinjacan forward TCP packets between the C2 and a remote host.[48][49]C0014Operation WocaoDuringOperation Wocao, threat actors used a custom protocol for command and control.[50]S0352OSX_OCEANLOTUS.DOSX_OCEANLOTUS.Dhas used a custom binary protocol over port 443 for C2 traffic.[51]S0556Pay2KeyPay2Keyhas sent its public key to the C2 server over TCP.[52]S0587PenquinThePenquinC2 mechanism is based on TCP and UDP packets.[53][54]S0158PHOREALPHOREALcommunicates via ICMP for C2.[55]S1031PingPullPingPullvariants have the ability to communicate with C2 servers using ICMP or TCP.[56]S0501PipeMonThePipeMoncommunication module can use a custom protocol based on TLS over TCP.[57]G0068PLATINUMPLATINUMhas used the Intel® Active Management Technology (AMT) Serial-over-LAN (SOL) channel for command and control.[58]S0013PlugXPlugXcan be configured to use raw TCP or UDP for command and control.[59]S0650QakBotQakBothas the ability use TCP to send or receive C2 packets.[60]S0262QuasarRATQuasarRATcan use TCP for C2 communication.[61]S1084QUIETEXITQUIETEXITcan establish a TCP connection as part of its initial connection to the C2.[62]S0629RainyDayRainyDaycan use TCP in C2 communications.[44]S0055RARSTONERARSTONEuses SSL to encrypt its communication with its C2 server.[63]S0662RCSessionRCSessionhas the ability to use TCP and UDP in C2 communications.[17][64]S0172ReaverSomeReavervariants use raw TCP for C2.[65]S0019ReginTheReginmalware platform can use ICMP to communicate between infected computers.[66]S0125RemsecRemsecis capable of using ICMP, TCP, and UDP for C2.[67][68]S1078RotaJakiroRotaJakirouses a custom binary protocol using a type, length, value format over TCP.[69]S1073RoyalRoyalestablishes a TCP socket for C2 communication using the APIWSASocketW.[70]S1099SamuraiSamuraican use a proxy module to forward TCP packets to external hosts.[48]S1085SardonicSardoniccan communicate with actor-controlled C2 servers by using a custom little-endian binary protocol.[71]S0461SDBbotSDBbothas the ability to communicate with C2 with TCP over port 443.[72]S0596ShadowPadShadowPadhas used UDP for C2 communications.[73]S0615SombRATSombRAThas the ability to use TCP sockets to send data and ICMP to ping the C2 server.[74][75]S1049SUGARUSHSUGARUSHhas used TCP for C2.[76]S0011TaidoorTaidoorcan use TCP for C2 communications.[77]G1022ToddyCatToddyCathas used a passive backdoor that receives commands with UDP packets.[49]S0436TSCookieTSCookiecan use ICMP to receive information on the destination server.[78]S0221UmbreonUmbreonprovides access to the system via SSH or any other protocol that uses PAM to authenticate.[79]S0022UroburosUroburoscan communicate through custom methodologies for UDP,  ICMP, and TCP that use distinct sessions to ride over the legitimate protocols.[80]S0670WarzoneRATWarzoneRATcan communicate with its C2 server via TCP over port 5200.[81]S0515WellMailWellMailcan use TCP for C2 communications.[82]S0155WINDSHIELDWINDSHIELDC2 traffic can communicate via TCP raw sockets.[55]S0430Winnti for LinuxWinnti for Linuxhas used ICMP, custom TCP, and UDP in outbound communications.[83]S0141Winnti for WindowsWinnti for Windowscan communicate using custom TCP.[84]S1114ZIPLINEZIPLINEcan communicate with C2 using a custom binary protocol.[85]MitigationsIDMitigationDescriptionM1037Filter Network TrafficFilter network traffic to prevent use of protocols across the network boundary that are unnecessary.M1031Network Intrusion PreventionNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.M1030Network SegmentationProperly configure firewalls and proxies to limit outgoing traffic to only necessary ports and through proper network gateway systems. Also ensure hosts are only provisioned to communicate over authorized interfaces.DetectionIDData SourceData ComponentDetectsDS0029Network TrafficNetwork Traffic ContentMonitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).Network Traffic FlowMonitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.ReferencesWikipedia. (n.d.). List of network protocols (OSI model). Retrieved December 4, 2014.Graham Holmes. (2015, October 8). Evolution of attacks on Cisco IOS devices. Retrieved October 19, 2020.Microsoft. (n.d.). Internet Control Message Protocol (ICMP) Basics. Retrieved December 1, 2014.Ken Proska, John Wolfram, Jared Wilson, Dan Black, Keith Lunden, Daniel Kapellmann Zafra, Nathan Brubaker, Tyler Mclellan, Chris Sistrunk. (2023, November 9). Sandworm Disrupts Power in Ukraine Using a Novel Attack Against Operational Technology. Retrieved March 28, 2024.Dahan, A. et al. (2019, December 11). DROPPING ANCHOR: FROM A TRICKBOT INFECTION TO THE DISCOVERY OF THE ANCHOR MALWARE. Retrieved September 10, 2020.Moran, N., et al. (2014, November 21). Operation Double Tap. Retrieved January 14, 2016.CheckPoint. (2020, May 7). Naikon APT: Cyber Espionage Reloaded. Retrieved May 26, 2020.Threat Intelligence Team. (2021, December 2). SideCopy APT: Connecting lures victims, payloads to infrastructure. Retrieved June 13, 2022.Adam Burgher. (2021, June 10). BackdoorDiplomacy: Upgrading from Quarian to Turian. Retrieved September 1, 2021Check Point. (2020, November 26). Bandook: Signed & Delivered. Retrieved May 31, 2021.Mercer, W., et al. (2020, March 5). Bisonal: 10 years of play. Retrieved January 26, 2022.Dela Paz, R. (2016, October 21). BITTER: a targeted attack against Pakistan. Retrieved June 1, 2022.Harbison, M. and Renals, P. (2022, July 5). When Pentest Tools Go Brutal: Red-Teaming Tool Being Abused by Malicious Actors. Retrieved February 1, 2023.FireEye Threat Intelligence. (2015, December 1). China-based Cyber Threat Group Uses Dropbox for Malware Communications and Targets Hong Kong Media Outlets. Retrieved December 4, 2015.Dunwoody, M., et al. (2018, November 19). Not So Cozy: An Uncomfortable Examination of a Suspected APT29 Phishing Campaign. Retrieved November 27, 2018.ESET. (2017, March 30). Carbon Paper: Peering into Turla’s second stage backdoor. Retrieved November 7, 2018.Lunghi, D. et al. (2020, February). Uncovering DRBControl. Retrieved November 12, 2021.Dutch Military Intelligence and Security Service (MIVD) & Dutch General Intelligence and Security Service (AIVD). (2024, February 6). Ministry of Defense of the Netherlands uncovers COATHANGER, a stealthy Chinese FortiGate RAT. Retrieved February 7, 2024.Mavis, N. (2020, September 21). The Art and Science of Detecting Cobalt Strike. Retrieved April 6, 2021.Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.Huss, D. (2016, March 1). Operation Transparent Tribe. Retrieved June 8, 2016.Dedola, G. (2020, August 20). Transparent Tribe: Evolution analysis, part 1. Retrieved September 2, 2021.Stokes, P. (2020, July 27). Four Distinct Families of Lazarus Malware Target Apple’s macOS Platform. Retrieved August 7, 2020.Lin, M. et al. (2024, February 27). Cutting Edge, Part 3: Investigating Ivanti Connect Secure VPN Exploitation and Persistence Attempts. Retrieved March 1, 2024.Fidelis Cybersecurity. (2016, February 29). The Turbo Campaign, Featuring Derusbi for 64-bit Linux. Retrieved March 2, 2016.NSA/FBI. (2020, August). Russian GRU 85th GTsSS Deploys Previously Undisclosed Drovorub Malware. Retrieved August 25, 2020.Falcone, R. and Miller-Osborn, J.. (2016, January 24). Scarlet Mimic: Years-Long Espionage Campaign Targets Minority Activists. Retrieved February 10, 2016.Chen, J. (2019, October 10). Magecart Card Skimmers Injected Into Online Shops. Retrieved September 9, 2020.Vrabie, V. (2020, November). Dissecting a Chinese APT Targeting South Eastern Asian Government Institutions. Retrieved September 19, 2022.Dupuy, T. and Faou, M. (2021, June). Gelsemium. Retrieved November 30, 2021.Quinn, J. (2019, March 25). The odd case of a Gh0stRAT variant. Retrieved July 15, 2020.MSTIC. (2021, March 2). HAFNIUM targeting Exchange Servers with 0-day exploits. Retrieved March 3, 2021.Sanmillan, I. (2019, May 29). HiddenWasp Malware Stings Targeted Linux Systems. Retrieved June 24, 2019.Hromcova, Z. and Cherpanov, A. (2020, June). INVISIMOLE: THE HIDDEN PART OF THE STORY. Retrieved July 16, 2020.Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.Raggi, M. Schwarz, D.. (2019, August 1). LookBack Malware Targets the United States Utilities Sector with Phishing Attacks Impersonating Engineering Licensing Boards. Retrieved February 25, 2021.M.Léveillé, M., Cherepanov, A.. (2022, January 25). Watering hole deploys new macOS malware, DazzleSpy, in Asia. Retrieved May 6, 2022.Ehrlich, A., et al. (2022, September). THE MYSTERY OF METADOR | AN UNATTRIBUTED THREAT HIDING IN TELCOS, ISPS, AND UNIVERSITIES. Retrieved January 23, 2023.SentinelLabs. (2022, September 22). Metador Technical Appendix. Retrieved April 4, 2023.Sierra, E., Iglesias, G.. (2018, April 24). Metamorfo Campaigns Targeting Brazilian Users. Retrieved July 30, 2020.Gross, J. (2016, February 23). Operation Dust Storm. Retrieved December 22, 2021.Miller-Osborn, J. and Grunzweig, J.. (2017, March 30). Trochilus and New MoonWind RATs Used In Attack Against Thai Organizations. Retrieved March 30, 2017.Thomas, C. (n.d.). Mythc Documentation. Retrieved March 25, 2022.Vrabie, V. (2021, April 23). NAIKON – Traces from a Military Cyber-Espionage Operation. Retrieved June 29, 2021.FireEye Labs. (2015, April). APT30 AND THE MECHANICS OF A LONG-RUNNING CYBER ESPIONAGE OPERATION. Retrieved May 1, 2015.Lambert, T. (2020, January 29). Intro to Netwire. Retrieved January 7, 2021.Duncan, B. (2020, April 3). GuLoader: Malspam Campaign Installing NetWire RAT. Retrieved January 7, 2021.Dedola, G. (2022, June 21). APT ToddyCat. Retrieved January 3, 2024.Dedola, G. et al. (2023, October 12). ToddyCat: Keep calm and check logs. Retrieved January 3, 2024.Dantzig, M. v., Schamper, E. (2019, December 19). Operation Wocao: Shining a light on one of China’s hidden hacking groups. Retrieved October 8, 2020.Erye Hernandez and Danny Tsechansky. (2017, June 22). The New and Improved macOS Backdoor from OceanLotus. Retrieved September 8, 2023.Check Point. (2020, November 6). Ransomware Alert: Pay2Key. Retrieved January 4, 2021.Baumgartner, K. and Raiu, C. (2014, December 8). The ‘Penquin’ Turla. Retrieved March 11, 2021.Leonardo. (2020, May 29). MALWARE TECHNICAL INSIGHT TURLA “Penquin_x64”. Retrieved March 11, 2021.Carr, N.. (2017, May 14). Cyber Espionage is Alive and Well: APT32 and the Threat to Global Corporations. Retrieved June 18, 2017.Unit 42. (2022, June 13). GALLIUM Expands Targeting Across Telecommunications, Government and Finance Sectors With New PingPull Tool. Retrieved August 7, 2022.Tartare, M. et al. (2020, May 21). No “Game over” for the Winnti Group. Retrieved August 24, 2020.Kaplan, D, et al. (2017, June 7). PLATINUM continues to evolve, find ways to maintain invisibility. Retrieved February 19, 2018.Dell SecureWorks Counter Threat Unit Threat Intelligence. (2015, August 5). Threat Group-3390 Targets Organizations for Cyberespionage. Retrieved August 18, 2018.Kuzmenko, A. et al. (2021, September 2). QakBot technical analysis. Retrieved September 27, 2021.CISA. (2018, December 18). Analysis Report (AR18-352A) Quasar Open-Source Remote Administration Tool. Retrieved August 1, 2022.Mandiant. (2022, May 2). UNC3524: Eye Spy on Your Email. Retrieved August 17, 2023.Aquino, M. (2013, June 13). RARSTONE Found In Targeted Attacks. Retrieved December 17, 2015.Global Threat Center, Intelligence Team. (2020, December). APT27 Turns to Ransomware. Retrieved November 12, 2021.Grunzweig, J. and Miller-Osborn, J. (2017, November 10). New Malware with Ties to SunOrcal Discovered. Retrieved November 16, 2017.Kaspersky Lab's Global Research and Analysis Team. (2014, November 24). THE REGIN PLATFORM NATION-STATE OWNAGE OF GSM NETWORKS. Retrieved December 1, 2014.Symantec Security Response. (2016, August 8). Backdoor.Remsec indicators of compromise. Retrieved August 17, 2016.Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Retrieved August 17, 2016.Alex Turing. (2021, May 6). RotaJakiro, the Linux version of the OceanLotus. Retrieved June 14, 2023.Cybereason Global SOC and Cybereason Security Research Teams. (2022, December 14). Royal Rumble: Analysis of Royal Ransomware. Retrieved March 30, 2023.Budaca, E., et al. (2021, August 25). FIN8 Threat Actor Goes Agile with New Sardonic Backdoor. Retrieved August 9, 2023.Schwarz, D. et al. (2019, October 16). TA505 Distributes New SDBbot Remote Access Trojan with Get2 Downloader. Retrieved May 29, 2020.Kaspersky Lab. (2017, August). ShadowPad: popular server management software hit in supply chain attack. Retrieved March 22, 2021.The BlackBerry Research and Intelligence Team. (2020, November 12). The CostaRicto Campaign: Cyber-Espionage Outsourced. Retrieved May 24, 2021.McLellan, T.  and Moore, J. et al. (2021, April 29). UNC2447 SOMBRAT and FIVEHANDS Ransomware: A Sophisticated Financial Threat. Retrieved June 2, 2021.Mandiant Israel Research Team. (2022, August 17). Suspected Iranian Actor Targeting Israeli Shipping, Healthcare, Government and Energy Sectors. Retrieved September 21, 2022.CISA, FBI, DOD. (2021, August). MAR-10292089-1.v2 – Chinese Remote Access Trojan: TAIDOOR. Retrieved August 24, 2021.Tomonaga, S.. (2019, September 18). Malware Used by BlackTech after Network Intrusion. Retrieved May 6, 2020.Fernando Mercês. (2016, September 5). Pokémon-themed Umbreon Linux Rootkit Hits x86, ARM Systems. Retrieved March 5, 2018.FBI et al. (2023, May 9). Hunting Russian Intelligence “Snake” Malware. Retrieved June 8, 2023.Harakhavik, Y. (2020, February 3). Warzone: Behind the enemy lines. Retrieved December 17, 2021.CISA. (2020, July 16). MAR-10296782-3.v1 – WELLMAIL. Retrieved September 29, 2020.Chronicle Blog. (2019, May 15). Winnti: More than just Windows and Gates. Retrieved April 29, 2020.Novetta Threat Research Group. (2015, April 7). Winnti Analysis. Retrieved February 8, 2017.Lin, M. et al. (2024, January 31). Cutting Edge, Part 2: Investigating Ivanti Connect Secure VPN Zero-Day Exploitation. Retrieved February 27, 2024.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.