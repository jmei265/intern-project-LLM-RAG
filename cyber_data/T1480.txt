MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseExecution GuardrailsExecution GuardrailsSub-techniques (1)IDNameT1480.001Environmental KeyingAdversaries may use execution guardrails to constrain execution or actions based on adversary supplied and environment specific conditions that are expected to be present on the target. Guardrails ensure that a payload only executes against an intended target and reduces collateral damage from an adversary’s campaign.[1]Values an adversary can provide about a target system or environment to use as guardrails may include specific network share names, attached physical devices, files, joined Active Directory (AD) domains, and local/external IP addresses.[2]Guardrails can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within. This use of guardrails is distinct from typicalVirtualization/Sandbox Evasion. While use ofVirtualization/Sandbox Evasionmay involve checking for known sandbox values and continuing with execution only if there is no match, the use of guardrails will involve checking for an expected target-specific value and only continuing with execution if there is such a match.ID:T1480Sub-techniques:T1480.001ⓘTactic:Defense EvasionⓘPlatforms:Linux, Windows, macOSⓘDefense Bypassed:Anti-virus, Host Forensic Analysis, Signature-based Detection, Static File AnalysisContributors:Nick Carr, MandiantVersion:1.1Created:31 January 2019Last Modified:03 May 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0504AnchorAnchorcan terminate itself if specific execution flags are not present.[3]S0570BitPaymerBitPaymercompares file names and paths to a list of excluded names and directory names during encryption.[4]S0635BoomBoxBoomBoxcan check its current working directory and for the presence of a specific file and terminate if specific values are not found.[5]S1111DarkGateDarkGateuses per-victim links for hosting malicious archives, such as ZIP files, in services such as SharePoint to prevent other entities from retrieving them.[6]S1052DEADEYEDEADEYEcan ensure it executes only on intended systems by identifying the victim's volume serial number, hostname, and/or DNS domain.[7]S0634EnvyScoutEnvyScoutcan callwindow.location.pathnameto ensure that embedded files are being executed from the C: drive, and will terminate if they are not.[5]S0637NativeZoneNativeZonecan check for the presence of KM.EkeyAlmaz1C.dll and will halt execution unless it is in the same directory as the rest of the malware's components.[5][8]S1035Small SieveSmall Sievecan only execute correctly if the wordPlatypusis passed to it on the command line.[9]S0603StuxnetStuxnetchecks for specific operating systems on 32-bit machines, Registry keys, and dates for vulnerabilities, and will exit execution if the values are not met.[10]S0562SUNSPOTSUNSPOTonly replaces SolarWinds Orion source code if the MD5 checksums of both the original source code file and backdoored replacement source code match hardcoded values.[11]S0678TorismaTorismais only delivered to a compromised host if the victim's IP address is on an allow-list.[12]S0636VaporRageVaporRagehas the ability to check for the presence of a specific DLL and terminate if it is not found.[5]MitigationsIDMitigationDescriptionM1055Do Not MitigateExecution Guardrailslikely should not be mitigated with preventative controls because it may protect unintended targets from being compromised. If targeted, efforts should be focused on preventing adversary tools from running earlier in the chain of activity and on identifying subsequent malicious behavior if compromised.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may gather information about the victim's business relationships that can be used during targeting. Detecting the use of guardrails may be difficult depending on the implementation.DS0009ProcessProcess CreationMonitoring for suspicious processes being spawned that gather a variety of system information or perform other forms ofDiscovery, especially in a short period of time, may aid in detection. Detecting the use of guardrails may be difficult depending on the implementation.ReferencesShoorbajee, Z. (2018, June 1). Playing nice? FireEye CEO says U.S. malware is more restrained than adversaries'. Retrieved January 17, 2019.McWhirt, M., Carr, N., Bienstock, D. (2019, December 4). Breaking the Rules: A Tough Outlook for Home Page Attacks (CVE-2017-11774). Retrieved June 23, 2020.Dahan, A. et al. (2019, December 11). DROPPING ANCHOR: FROM A TRICKBOT INFECTION TO THE DISCOVERY OF THE ANCHOR MALWARE. Retrieved September 10, 2020.Frankoff, S., Hartley, B. (2018, November 14). Big Game Hunting: The Evolution of INDRIK SPIDER From Dridex Wire Fraud to BitPaymer Targeted Ransomware. Retrieved January 6, 2021.MSTIC. (2021, May 28). Breaking down NOBELIUM’s latest early-stage toolset. Retrieved August 4, 2021.Ernesto Fernández Provecho, Pham Duy Phuc, Ciana Driscoll & Vinoo Thomas. (2023, November 21). The Continued Evolution of the DarkGate Malware-as-a-Service. Retrieved February 9, 2024.Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.Guerrero-Saade, J. (2021, June 1). NobleBaron | New Poisoned Installers Could Be Used In Supply Chain Attacks. Retrieved August 4, 2021.NCSC GCHQ. (2022, January 27). Small Sieve Malware Analysis Report. Retrieved August 22, 2022.Nicolas Falliere, Liam O Murchu, Eric Chien 2011, February W32.Stuxnet Dossier (Version 1.4) Retrieved. 2017/09/22CrowdStrike Intelligence Team. (2021, January 11). SUNSPOT: An Implant in the Build Process. Retrieved January 11, 2021.Beek, C. (2020, November 5). Operation North Star: Behind The Scenes. Retrieved December 20, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.