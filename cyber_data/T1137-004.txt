MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseOffice Application StartupOutlook Home PageOffice Application Startup:Outlook Home PageOther sub-techniques of Office Application Startup (6)IDNameT1137.001Office Template MacrosT1137.002Office TestT1137.003Outlook FormsT1137.004Outlook Home PageT1137.005Outlook RulesT1137.006Add-insAdversaries may abuse Microsoft Outlook's Home Page feature to obtain persistence on a compromised system. Outlook Home Page is a legacy feature used to customize the presentation of Outlook folders. This feature allows for an internal or external URL to be loaded and presented whenever a folder is opened. A malicious HTML page can be crafted that will execute code when loaded by Outlook Home Page.[1]Once malicious home pages have been added to the user’s mailbox, they will be loaded when Outlook is started. Malicious Home Pages will execute when the right Outlook folder is loaded/reloaded.[1]ID:T1137.004Sub-technique of:T1137ⓘTactic:PersistenceⓘPlatforms:Office 365, WindowsⓘPermissions Required:Administrator, UserVersion:1.1Created:07 November 2019Last Modified:16 August 2021Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0049OilRigOilRighas abused the Outlook Home Page feature for persistence.OilRighas also used CVE-2017-11774 to roll back the initial patch designed to protect against Home Page abuse.[2]S0358RulerRulercan be used to automate the abuse of Outlook Home Pages to establish persistence.[3]MitigationsIDMitigationDescriptionM1040Behavior Prevention on EndpointOn Windows 10, enable Attack Surface Reduction (ASR) rules to prevent Office applications from creating child processes and from writing potentially malicious executable content to disk.[4]M1051Update SoftwareFor the Outlook methods, blocking macros may be ineffective as the Visual Basic engine used for these features is separate from the macro scripting engine.[5]Microsoft has released patches to try to address each issue. Ensure KB3191938 which blocks Outlook Visual Basic and displays a malicious code warning, KB4011091 which disables custom forms by default, and KB4011162 which removes the legacy Home Page feature, are applied to systems.[1]DetectionIDData SourceData ComponentDetectsDS0015Application LogApplication Log ContentMonitor for third-party application logging, messaging, and/or other artifacts that may abuse Microsoft Outlook's Home Page feature to obtain persistence on a compromised system. SensePost, whose toolRulercan be used to carry out malicious rules, forms, and Home Page attacks, has released a tool to detect Ruler usage.[6]DS0017CommandCommand ExecutionMonitor executed commands and arguments that may abuse Microsoft Outlook's Home Page feature to obtain persistence on a compromised system. Microsoft has released a PowerShell script to safely gather mail forwarding rules and custom forms in your mail environment as well as steps to interpret the output.[7]DS0009ProcessProcess CreationMonitor newly executed processes that may abuse Microsoft Outlook's Home Page feature to obtain persistence on a compromised system.ReferencesStalmans, E. (2017, October 11). Outlook Home Page – Another Ruler Vector. Retrieved February 4, 2019.McWhirt, M., Carr, N., Bienstock, D. (2019, December 4). Breaking the Rules: A Tough Outlook for Home Page Attacks (CVE-2017-11774). Retrieved June 23, 2020.SensePost. (2016, August 18). Ruler: A tool to abuse Exchange services. Retrieved February 4, 2019.Microsoft. (2021, July 2). Use attack surface reduction rules to prevent malware infection. Retrieved June 24, 2021.Stalmans, E. (2017, April 28). Outlook Forms and Shells. Retrieved February 4, 2019.SensePost. (2017, September 21). NotRuler - The opposite of Ruler, provides blue teams with the ability to detect Ruler usage against Exchange. Retrieved February 4, 2019.Fox, C., Vangel, D. (2018, April 22). Detect and Remediate Outlook Rules and Custom Forms Injections Attacks in Office 365. Retrieved February 4, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.