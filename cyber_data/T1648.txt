MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseServerless ExecutionServerless ExecutionAdversaries may abuse serverless computing, integration, and automation services to execute arbitrary code in cloud environments. Many cloud providers offer a variety of serverless resources, including compute engines, application integration services, and web servers.Adversaries may abuse these resources in various ways as a means of executing arbitrary commands. For example, adversaries may use serverless functions to execute malicious code, such as crypto-mining malware (i.e.Resource Hijacking).[1]Adversaries may also create functions that enable further compromise of the cloud environment. For example, an adversary may use theIAM:PassRolepermission in AWS or theiam.serviceAccounts.actAspermission in Google Cloud to addAdditional Cloud Rolesto a serverless cloud function, which may then be able to perform actions the original user cannot.[2][3]Serverless functions can also be invoked in response to cloud events (i.e.Event Triggered Execution), potentially enabling persistent execution over time. For example, in AWS environments, an adversary may create a Lambda function that automatically addsAdditional Cloud Credentialsto a user and a corresponding CloudWatch events rule that invokes that function whenever a new user is created.[4]Similarly, an adversary may create a Power Automate workflow in Office 365 environments that forwards all emails a user receives or creates anonymous sharing links whenever a user is granted access to a document in SharePoint.[5][6]ID:T1648Sub-techniques:No sub-techniquesⓘTactic:ExecutionⓘPlatforms:IaaS, Office 365, SaaSContributors:Alex Soler, AttackIQ; Cisco; Oleg Kolesnikov, Securonix; Praetorian; Shailesh Tiwary (Indian Army); Varonis Threat Labs; Vectra AIVersion:1.0Created:27 May 2022Last Modified:05 March 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS1091PacuPacucan create malicious Lambda functions.[7]MitigationsIDMitigationDescriptionM1018User Account ManagementRemove permissions to create, modify, or run serverless resources from users that do not explicitly require them.DetectionIDData SourceData ComponentDetectsDS0015Application LogApplication Log ContentMonitor logs generated by serverless execution for unusual activity. For example, in Exchange environments emails sent by Power Automate via the Outlook 365 connector include the phrase ‘Power App’ or ‘Power Automate’ in the SMTP header 'x-ms-mail-application.'[8]DS0025Cloud ServiceCloud Service ModificationMonitor the creation and modification of serverless resources such as functions and workflows.ReferencesMatt Muir. (2022, April 6). Cado Discovers Denonia: The First Malware Specifically Targeting Lambda. Retrieved May 27, 2022.Rhino Security Labs. (n.d.). AWS IAM Privilege Escalation – Methods and Mitigation. Retrieved May 27, 2022.Spencer Gietzen. (n.d.). Privilege Escalation in Google Cloud Platform – Part 1 (IAM). Retrieved May 27, 2022.Daniel Grzelak. (2016, July 9). Backdooring an AWS account. Retrieved May 27, 2022.Eric Saraga. (2022, February 2). Using Power Automate for Covert Data Exfiltration in Microsoft 365. Retrieved May 27, 2022.Berk Veral. (2020, March 9). Real-life cybercrime stories from DART, the Microsoft Detection and Response Team. Retrieved May 27, 2022.Rhino Security Labs. (2019, August 22). Pacu. Retrieved October 17, 2019.Microsoft. (2022, February 15). Email exfiltration controls for connectors. Retrieved May 27, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.