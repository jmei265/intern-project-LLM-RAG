MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseCommand and Scripting InterpreterCloud APICommand and Scripting Interpreter:Cloud APIOther sub-techniques of Command and Scripting Interpreter (10)IDNameT1059.001PowerShellT1059.002AppleScriptT1059.003Windows Command ShellT1059.004Unix ShellT1059.005Visual BasicT1059.006PythonT1059.007JavaScriptT1059.008Network Device CLIT1059.009Cloud APIT1059.010AutoHotKey & AutoITAdversaries may abuse cloud APIs to execute malicious commands. APIs available in cloud environments provide various functionalities and are a feature-rich method for programmatic access to nearly all aspects of a tenant. These APIs may be utilized through various methods such as command line interpreters (CLIs), in-browser Cloud Shells,PowerShellmodules like Azure for PowerShell[1], or software developer kits (SDKs) available for languages such asPython.Cloud API functionality may allow for administrative access across all major services in a tenant such as compute, storage, identity and access management (IAM), networking, and security policies.With proper permissions (often via use of credentials such asApplication Access TokenandWeb Session Cookie), adversaries may abuse cloud APIs to invoke various functions that execute malicious actions. For example, CLI and PowerShell functionality may be accessed through binaries installed on cloud-hosted or on-premises hosts or accessed through a browser-based cloud shell offered by many cloud platforms (such as AWS, Azure, and GCP). These cloud shells are often a packaged unified environment to use CLI and/or scripting modules hosted as a container in the cloud environment.ID:T1059.009Sub-technique of:T1059ⓘTactic:ExecutionⓘPlatforms:Azure AD, Google Workspace, IaaS, Office 365, SaaSContributors:Caio Silva; Jason Sevilla; Marcus Weeks; Nichols Jasper; Ozan OlaliVersion:1.0Created:17 March 2022Last Modified:14 April 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0016APT29APT29has leveraged the Microsoft Graph API to perform various actions across Azure and M365 environments. They have also utilized AADInternals PowerShell Modules to access the API[2]S1091PacuPaculeverages the AWS CLI for its operations.[3]G0139TeamTNTTeamTNThas leveraged AWS CLI to enumerate cloud environments with compromised credentials.[4]MitigationsIDMitigationDescriptionM1038Execution PreventionUse application control where appropriate to block use of PowerShell CmdLets or other host based resources to access cloud API resources.M1026Privileged Account ManagementUse of proper Identity and Access Management (IAM) with Role Based Access Control (RBAC) policies to limit actions administrators can perform and provide a history of administrative actions to detect unauthorized use and abuse.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionConsider reviewing command history in either host machines or cloud audit logs to determine if unauthorized or suspicious commands were executed.Cloud API activity logging is typically enabled by default and may be reviewed in sources like the Microsoft Unified Audit Log, AWS CloudTrail, and GCP Admin Acitivty logs. Review these sources for history of executed API commands. Host logs may also be reviewed to capture CLI commands or PowerShell module usage to invoke Cloud API functions.ReferencesMicrosoft. (2014, December 12). Azure/azure-powershell. Retrieved March 24, 2023.MSTIC. (2021, May 28). Breaking down NOBELIUM’s latest early-stage toolset. Retrieved August 4, 2021.Rhino Security Labs. (2019, August 22). Pacu. Retrieved October 17, 2019.Darin Smith. (2022, April 21). TeamTNT targeting AWS, Alibaba. Retrieved July 8, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.