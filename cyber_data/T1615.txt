MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseGroup Policy DiscoveryGroup Policy DiscoveryAdversaries may gather information on Group Policy settings to identify paths for privilege escalation, security measures applied within a domain, and to discover patterns in domain objects that can be manipulated or used to blend in the environment. Group Policy allows for centralized management of user and computer settings in Active Directory (AD). Group policy objects (GPOs) are containers for group policy settings made up of files stored within a predictable network path\<DOMAIN>\SYSVOL\<DOMAIN>\Policies\.[1][2]Adversaries may use commands such asgpresultor various publicly available PowerShell functions, such asGet-DomainGPOandGet-DomainGPOLocalGroup, to gather information on Group Policy settings.[3][4]Adversaries may use this information to shape follow-on behaviors, including determining potential attack paths within the target network as well as opportunities to manipulate Group Policy settings (i.e.Domain or Tenant Policy Modification) for their benefit.ID:T1615Sub-techniques:No sub-techniquesⓘTactic:DiscoveryⓘPlatforms:WindowsContributors:Jonhnathan Ribeiro, 3CORESec, @_w0rk3r; Ted Samuels, Rapid7Version:1.1Created:06 August 2021Last Modified:06 January 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0521BloodHoundBloodHoundhas the ability to collect local admin information via GPO.[5]S0082EmissaryEmissaryhas the capability to executegpresult.[6]S0363EmpireEmpireincludes various modules for enumerating Group Policy.[4]G0010TurlaTurlasurveys a system upon check-in to discover Group Policy details using thegpresultcommand.[7]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0026Active DirectoryActive Directory Object AccessMonitor for abnormal LDAP queries with filters forgroupPolicyContainerand high volumes of LDAP traffic to domain controllers. Windows Event ID 4661 can also be used to detect when a directory service has been accessed.DS0017CommandCommand ExecutionMonitor for suspicious use ofgpresult. Monitor for the use of PowerShell functions such asGet-DomainGPOandGet-DomainGPOLocalGroupand processes spawning with command-line arguments containingGPOLocalGroup.DS0029Network TrafficNetwork Traffic ContentMonitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).DS0009ProcessProcess CreationMonitor for newly executed processes that may gather information on Group Policy settings to identify paths for privilege escalation, security measures applied within a domain, and to discover patterns in domain objects that can be manipulated or used to blend in the environment.DS0012ScriptScript ExecutionMonitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.Referencessrachui. (2012, February 13). Group Policy Basics – Part 1: Understanding the Structure of a Group Policy Object. Retrieved March 5, 2019.Metcalf, S. (2016, March 14). Sneaky Active Directory Persistence #17: Group Policy. Retrieved March 5, 2019.Microsoft. (2017, October 16). gpresult. Retrieved August 6, 2021.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.Robbins, A., Vazarkar, R., and Schroeder, W. (2016, April 17). Bloodhound: Six Degrees of Domain Admin. Retrieved March 5, 2019.Falcone, R. and Miller-Osborn, J. (2016, February 3). Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?. Retrieved February 15, 2016.Faou, M. (2020, May). From Agent.btz to ComRAT v4: A ten-year journey. Retrieved June 15, 2020.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.