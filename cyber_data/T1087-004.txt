MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseAccount DiscoveryCloud AccountAccount Discovery:Cloud AccountOther sub-techniques of Account Discovery (4)IDNameT1087.001Local AccountT1087.002Domain AccountT1087.003Email AccountT1087.004Cloud AccountAdversaries may attempt to get a listing of cloud accounts. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application.With authenticated access there are several tools that can be used to find accounts. TheGet-MsolRoleMemberPowerShell cmdlet can be used to obtain account names given a role or permissions group in Office 365.[1][2]The Azure CLI (AZ CLI) also provides an interface to obtain user accounts with authenticated access to a domain. The commandaz ad user listwill list all users within a domain.[3][4]The AWS commandaws iam list-usersmay be used to obtain a list of users in the current account whileaws iam list-rolescan obtain IAM roles that have a specified path prefix.[5][6]In GCP,gcloud iam service-accounts listandgcloud projects get-iam-policymay be used to obtain a listing of service accounts and users in a project.[7]ID:T1087.004Sub-technique of:T1087ⓘTactic:DiscoveryⓘPlatforms:Azure AD, Google Workspace, IaaS, Office 365, SaaSⓘPermissions Required:UserContributors:PraetorianVersion:1.2Created:21 February 2020Last Modified:16 March 2021Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0677AADInternalsAADInternalscan enumerate Azure AD users.[8]G0016APT29APT29has conducted enumeration of Azure AD accounts.[9]C0027C0027DuringC0027,Scattered Spideraccessed Azure AD to download bulk lists of group members and to identify privileged users, along with the email addresses and AD attributes.[10]S1091PacuPacucan enumerate IAM users, roles, and groups.[11]S0684ROADToolsROADToolscan enumerate Azure AD users.[12]MitigationsIDMitigationDescriptionM1047AuditRoutinely check user permissions to ensure only the expected users have the ability to list IAM identities or otherwise discover cloud accounts.M1018User Account ManagementLimit permissions to discover cloud accounts in accordance with least privilege. Organizations should limit the number of users within the organization with an IAM role that has administrative privileges, strive to reduce all permanent privileged role assignments, and conduct periodic entitlement reviews on IAM users, roles and policies.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor logs for actions that could be taken to gather information about cloud accounts, including the use of calls to cloud APIs that perform account discovery.System and network discovery techniques normally occur throughout an operation as an adversary learns the environment, and also to an extent in normal network operations. Therefore discovery data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.ReferencesMicrosoft. (n.d.). Get-MsolRoleMember. Retrieved October 6, 2019.Stringer, M.. (2018, November 21). RainDance. Retrieved October 6, 2019.Microsoft. (n.d.). az ad user. Retrieved October 6, 2019.Felch, M.. (2018, August 31). Red Teaming Microsoft Part 1 Active Directory Leaks via Azure. Retrieved October 6, 2019.Amazon. (n.d.). List Roles. Retrieved August 11, 2020.Amazon. (n.d.). List Users. Retrieved August 11, 2020.Google. (2020, June 23). gcloud iam service-accounts list. Retrieved August 4, 2020.Dr. Nestori Syynimaa. (2018, October 25). AADInternals. Retrieved February 18, 2022.Microsoft Threat Intelligence Center. (2021, October 25). NOBELIUM targeting delegated administrative privileges to facilitate broader attacks. Retrieved March 25, 2022.Parisi, T. (2022, December 2). Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies. Retrieved June 30, 2023.Rhino Security Labs. (2019, August 22). Pacu. Retrieved October 17, 2019.Dirk-jan Mollema. (2020, April 16). Introducing ROADtools - The Azure AD exploration framework. Retrieved January 31, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.