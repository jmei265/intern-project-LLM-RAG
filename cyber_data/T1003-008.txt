MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseOS Credential Dumping/etc/passwd and /etc/shadowOS Credential Dumping:/etc/passwd and /etc/shadowOther sub-techniques of OS Credential Dumping (8)IDNameT1003.001LSASS MemoryT1003.002Security Account ManagerT1003.003NTDST1003.004LSA SecretsT1003.005Cached Domain CredentialsT1003.006DCSyncT1003.007Proc FilesystemT1003.008/etc/passwd and /etc/shadowAdversaries may attempt to dump the contents of/etc/passwdand/etc/shadowto enable offline password cracking. Most modern Linux operating systems use a combination of/etc/passwdand/etc/shadowto store user account information including password hashes in/etc/shadow. By default,/etc/shadowis only readable by the root user.[1]The Linux utility, unshadow, can be used to combine the two files in a format suited for password cracking utilities such as John the Ripper:[2]# /usr/bin/unshadow /etc/passwd /etc/shadow > /tmp/crack.password.dbID:T1003.008Sub-technique of:T1003ⓘTactic:Credential AccessⓘPlatforms:LinuxⓘPermissions Required:rootVersion:1.0Created:11 February 2020Last Modified:20 March 2020Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0349LaZagneLaZagnecan obtain credential information from /etc/shadow using the shadow.py module.[3]MitigationsIDMitigationDescriptionM1027Password PoliciesEnsure that root accounts have complex, unique passwords across all systems on the network.M1026Privileged Account ManagementFollow best practices in restricting access to privileged accounts to avoid hostile programs from accessing such sensitive information.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may attempt to dump the contents of/etc/passwdand/etc/shadowto enable offline password cracking.DS0022FileFile AccessMonitor for files being accessed that may attempt to dump the contents of/etc/passwdand/etc/shadowto enable offline password cracking. The AuditD monitoring tool, which ships stock in many Linux distributions, can be used to watch for hostile processes attempting to access/etc/passwdand/etc/shadow, alerting on the pid, process name, and arguments of such programs.ReferencesThe Linux Documentation Project. (n.d.). Linux Password and Shadow File Formats. Retrieved February 19, 2020.Vivek Gite. (2014, September 17). Linux Password Cracking: Explain unshadow and john Commands (John the Ripper Tool). Retrieved February 19, 2020.Zanni, A. (n.d.). The LaZagne Project !!!. Retrieved December 14, 2018.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.