MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesMobileFile and Directory DiscoveryFile and Directory DiscoveryAdversaries may enumerate files and directories or search in specific device locations for desired information within a filesystem. Adversaries may use the information fromFile and Directory Discoveryduring automated discovery to shape follow-on behaviors, including deciding if the adversary should fully infect the target and/or attempt specific actions.On Android, Linux file permissions and SELinux policies typically stringently restrict what can be accessed by apps without taking advantage of a privilege escalation exploit. The contents of the external storage directory are generally visible, which could present concerns if sensitive data is inappropriately stored there. iOS's security architecture generally restricts the ability to perform any type ofFile and Directory Discoverywithout use of escalated privileges.ID:T1420Sub-techniques:No sub-techniquesTactic Type:Post-Adversary Device AccessⓘTactic:DiscoveryⓘPlatforms:Android, iOSⓘMTC ID:STA-41Version:1.2Created:25 October 2017Last Modified:20 March 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS1095AhRatAhRatcan enumerate files on external storage.[1]C0033C0033DuringC0033,PROMETHIUMusedStrongPityto collect file lists on the victim device.[2]S0529CarbonStealCarbonStealhas searched device storage for various files, including .amr files (audio recordings) and superuser binaries.[3]S0505Desert ScorpionDesert Scorpioncan list files stored on external storage.[4]S0550DoubleAgentDoubleAgenthas searched for specific existing data directories, including the Gmail app, Dropbox app, Pictures, and thumbnails.[3]S1092EscobarEscobarcan access external storage.[5]S0577FrozenCellFrozenCellhas searched for pdf, doc, docx, ppt, pptx, xls, and xlsx file types for exfiltration.[6]S0535Golden CupGolden Cupcan collect a directory listing of external storage.[7]S0551GoldenEagleGoldenEaglehas looked for .doc, .txt, .gif, .apk, .jpg, .png, .mp3, and .db files on external storage.[3]S1077HornbillHornbillhas a list of file extensions that it may use to log certain operations (creation, open, close, modification, movement, deletion) on files of those types.[8]C0016Operation Dust StormDuringOperation Dust Storm, the threat actors used Android backdoors capable of enumerating specific files on the infected devices.[9]S0549SilkBeanSilkBeancan get file lists on the SD card.[3]S0558Tiktok ProTiktok Procan list all hidden files in the/DCIM/.dat/directory.[10]G0112WindshiftWindshifthas included file enumeration in the malicious apps deployed as part of Operation BULL and Operation ROCK.[11]MitigationsIDMitigationDescriptionM1006Use Recent OS VersionSecurity architecture improvements in each new version of Android and iOS make it more difficult to escalate privileges. Additionally, newer versions of Android have strengthened the sandboxing applied to applications, restricting their ability to enumerate file system contents.DetectionIDData SourceData ComponentDetectsDS0042User InterfacePermissions RequestOn Android, the user is presented with a permissions popup when an application requests access to external device storage.ReferencesLukas Stefanko. (2023, May 23). Android app breaking bad: From legitimate screen recording to file exfiltration within a year. Retrieved December 18, 2023.Stefanko, L. (2023, January 10). StrongPity espionage campaign targeting Android users. Retrieved January 31, 2023.A. Kumar, K. Del Rosso, J. Albrecht, C. Hebeisen. (2020, June 1). Mobile APT Surveillance Campaigns Targeting Uyghurs - A collection of long-running Android tooling connected to a Chinese mAPT actor. Retrieved November 10, 2020.A. Blaich, M. Flossman. (2018, April 16). Lookout finds new surveillanceware in Google Play with ties to known threat actor targeting the Middle East. Retrieved September 11, 2020.B. Toulas. (2022, March 12). Android malware Escobar steals your Google Authenticator MFA codes. Retrieved September 28, 2023.Michael Flossman. (2017, October 5). FrozenCell: Multi-platform surveillance campaign against Palestinians. Retrieved November 11, 2020.R. Iarchy, E. Rynkowski. (2018, July 5). GoldenCup: New Cyber Threat Targeting World Cup Fans. Retrieved October 29, 2020.Apurva Kumar, Kristin Del Rosso. (2021, February 10). Novel Confucius APT Android Spyware Linked to India-Pakistan Conflict. Retrieved June 9, 2023.Gross, J. (2016, February 23). Operation Dust Storm. Retrieved December 22, 2021.S. Desai. (2020, September 8). TikTok Spyware. Retrieved January 5, 2021.The BlackBerry Research & Intelligence Team. (2020, October). BAHAMUT: Hack-for-Hire Masters of Phishing, Fake News, and Fake Apps. Retrieved February 8, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.