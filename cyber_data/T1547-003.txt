MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseBoot or Logon Autostart ExecutionTime ProvidersBoot or Logon Autostart Execution:Time ProvidersOther sub-techniques of Boot or Logon Autostart Execution (14)IDNameT1547.001Registry Run Keys / Startup FolderT1547.002Authentication PackageT1547.003Time ProvidersT1547.004Winlogon Helper DLLT1547.005Security Support ProviderT1547.006Kernel Modules and ExtensionsT1547.007Re-opened ApplicationsT1547.008LSASS DriverT1547.009Shortcut ModificationT1547.010Port MonitorsT1547.012Print ProcessorsT1547.013XDG Autostart EntriesT1547.014Active SetupT1547.015Login ItemsAdversaries may abuse time providers to execute DLLs when the system boots. The Windows Time service (W32Time) enables time synchronization across and within domains.[1]W32Time time providers are responsible for retrieving time stamps from hardware/network resources and outputting these values to other network clients.[2]Time providers are implemented as dynamic-link libraries (DLLs) that are registered in the subkeys ofHKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\.[2]The time provider manager, directed by the service control manager, loads and starts time providers listed and enabled under this key at system startup and/or whenever parameters are changed.[2]Adversaries may abuse this architecture to establish persistence, specifically by creating a new arbitrarily named subkey  pointing to a malicious DLL in theDllNamevalue. Administrator privileges are required for time provider registration, though execution will run in context of the Local Service account.[3]ID:T1547.003Sub-technique of:T1547ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:WindowsⓘPermissions Required:Administrator, SYSTEMContributors:Harun Küßner; Scott Lundgren, @5twenty9, Carbon BlackVersion:1.1Created:24 January 2020Last Modified:12 April 2024Version PermalinkLive VersionMitigationsIDMitigationDescriptionM1022Restrict File and Directory PermissionsConsider using Group Policy to configure and block additions/modifications to W32Time DLLs.[4]M1024Restrict Registry PermissionsConsider using Group Policy to configure and block modifications to W32Time parameters in the Registry.[4]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may abuse time providers to execute DLLs when the system boots.DS0011ModuleModule LoadThere is no restriction on the number of custom time providers registrations, though each may require a DLL payload written to disk.[3]DS0009ProcessProcess CreationMonitor newly executed processes, such as the W32tm.exe utility.[4]The Sysinternals Autoruns tool may also be used to analyze auto-starting locations, including DLLs listed as time providers.[5]DS0024Windows RegistryWindows Registry Key ModificationMonitor for changes made to windows registry keys and/or values modifying W32Time information in the Registry.ReferencesMicrosoft. (2018, February 1). Windows Time Service (W32Time). Retrieved March 26, 2018.Microsoft. (n.d.). Time Provider. Retrieved March 26, 2018.Lundgren, S. (2017, October 28). w32time. Retrieved March 26, 2018.Mathers, B. (2017, May 31). Windows Time Service Tools and Settings. Retrieved March 26, 2018.Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.