MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseEvent Triggered ExecutionChange Default File AssociationEvent Triggered Execution:Change Default File AssociationOther sub-techniques of Event Triggered Execution (16)IDNameT1546.001Change Default File AssociationT1546.002ScreensaverT1546.003Windows Management Instrumentation Event SubscriptionT1546.004Unix Shell Configuration ModificationT1546.005TrapT1546.006LC_LOAD_DYLIB AdditionT1546.007Netsh Helper DLLT1546.008Accessibility FeaturesT1546.009AppCert DLLsT1546.010AppInit DLLsT1546.011Application ShimmingT1546.012Image File Execution Options InjectionT1546.013PowerShell ProfileT1546.014EmondT1546.015Component Object Model HijackingT1546.016Installer PackagesAdversaries may establish persistence by executing malicious content triggered by a file type association. When a file is opened, the default program used to open the file (also called the file association or handler) is checked. File association selections are stored in the Windows Registry and can be edited by users, administrators, or programs that have Registry access or by administrators using the built-in assoc utility.[1][2][3]Applications can modify the file association for a given file extension to call an arbitrary program when a file with the given extension is opened.System file associations are listed underHKEY_CLASSES_ROOT.[extension], for exampleHKEY_CLASSES_ROOT.txt. The entries point to a handler for that extension located atHKEY_CLASSES_ROOT\[handler]. The various commands are then listed as subkeys underneath the shell key atHKEY_CLASSES_ROOT\[handler]\shell\[action]\command. For example:HKEY_CLASSES_ROOT\txtfile\shell\open\commandHKEY_CLASSES_ROOT\txtfile\shell\print\commandHKEY_CLASSES_ROOT\txtfile\shell\printto\commandThe values of the keys listed are commands that are executed when the handler opens the file extension. Adversaries can modify these values to continually execute arbitrary commands.[4]ID:T1546.001Sub-technique of:T1546ⓘTactics:Privilege Escalation,PersistenceⓘPlatforms:WindowsⓘPermissions Required:Administrator, SYSTEM, UserContributors:Stefan Kanthak; Travis Smith, TripwireVersion:1.0Created:24 January 2020Last Modified:30 March 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0094KimsukyKimsukyhas a HWP document stealer module which changes the default program association in the registry to open HWP documents.[5]S0692SILENTTRINITYSILENTTRINITYcan conduct an image hijack of an.mscfile extension as part of its UAC bypass process.[6]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may establish persistence by executing malicious content triggered by a file type association.DS0009ProcessProcess CreationMonitor for newly executed processes that may establish persistence by executing malicious content triggered by a file type association.DS0024Windows RegistryWindows Registry Key ModificationCollect and analyze changes to Registry keys that associate file extensions to default applications for execution and correlate with unknown process launch activity or unusual file types for that process. User file association preferences are stored under[HKEY_CURRENT_USER]\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExtsand override associations configured under[HKEY_CLASSES_ROOT]. Changes to a user's preference will occur under this entry's subkeys.ReferencesMicrosoft. (n.d.). Change which programs Windows 7 uses by default. Retrieved July 26, 2016.Microsoft. (n.d.). Specifying File Handlers for File Name Extensions. Retrieved November 13, 2014.Plett, C. et al.. (2017, October 15). assoc. Retrieved August 7, 2018.Sioting, S. (2012, October 8). TROJ_FAKEAV.GZD. Retrieved August 8, 2018.Tarakanov , D.. (2013, September 11). The “Kimsuky” Operation: A North Korean APT?. Retrieved August 13, 2019.Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.