MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterprisePeripheral Device DiscoveryPeripheral Device DiscoveryAdversaries may attempt to gather information about attached peripheral devices and components connected to a computer system.[1][2]Peripheral devices could include auxiliary resources that support a variety of functionalities such as keyboards, printers, cameras, smart card readers, or removable storage. The information may be used to enhance their awareness of the system and network environment or may be used for further actions.ID:T1120Sub-techniques:No sub-techniquesⓘTactic:DiscoveryⓘPlatforms:Linux, Windows, macOSⓘPermissions Required:Administrator, SYSTEM, UserVersion:1.3Created:31 May 2017Last Modified:30 March 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0045ADVSTORESHELLADVSTORESHELLcan list connected devices.[3]G0007APT28APT28uses a module to receive a notification every time a USB mass storage device is inserted into a victim.[4]G0067APT37APT37has a Bluetooth device harvester, which uses Windows Bluetooth APIs to find information on connected Bluetooth devices.[5]S0438AttorAttorhas a plugin that collects information about inserted storage devices, modems, and phone devices.[6]G0135BackdoorDiplomacyBackdoorDiplomacyhas used an executable to detect removable media, such as USB flash drives.[7]S0128BADNEWSBADNEWSchecks for new hard drives on the victim, such as USB devices, by listening for the WM_DEVICECHANGE window message.[8][9]S0234BandookBandookcan detect USB devices.[10]S0089BlackEnergyBlackEnergycan gather very specific information about attached USB devices, to include device instance ID and drive geometry.[11]S0454CadelspyCadelspyhas the ability to steal information about printers and the documents sent to printers.[12]S0115CrimsonCrimsonhas the ability to discover pluggable/removable drives to extract files from.[13][14]S0538CrutchCrutchcan monitor for removable drives being plugged into the compromised machine.[15]S0673DarkWatchmanDarkWatchmancan list signed PnP drivers for smartcard readers.[16]S0062DustySkyDustySkycan detect connected USB devices.[17]G0020EquationEquationhas used tools with the functionality to search for specific information about the attached hard drive that could be used to identify and overwrite the firmware.[18]S0679FerociousFerociouscan runGET.WORKSPACEin Microsoft Excel to check if a mouse is present.[19]S0381FlawedAmmyyFlawedAmmyywill attempt to detect if a usable smart card is current inserted into a card reader.[20]S1044FunnyDreamTheFunnyDreamFilepakMonitor component can detect removable drive insertion.[21]G0047Gamaredon GroupGamaredon Grouptools have contained an application to check performance of USB flash drives.Gamaredon Grouphas also used malware to scan for removable drives.[22][23]S1027Heyoka BackdoorHeyoka Backdoorcan identify removable media attached to victim's machines.[24]S0283jRATjRATcan map UPnP ports.[25]S0409MacheteMachetedetects the insertion of new devices by listening for the WM_DEVICECHANGE window message.[26]S1026MongallMongallcan identify removable media attached to compromised hosts.[24]S0149MoonWindMoonWindobtains the number of removable drives from the victim.[27]S1090NightClubNightClubhas the ability to monitor removable drives.[28]S0385njRATnjRATwill attempt to detect if the victim system has a camera during the initial infection.njRATcan also detect any removable drives connected to the system.[29][30]S0644ObliqueRATObliqueRATcan discover pluggable/removable drives to extract files from.[31]G0049OilRigOilRighas used tools to identify if a mouse is connected to a targeted system.[32]C0012Operation CuckooBeesDuringOperation CuckooBees, the threat actors used thefsutil fsinfo drivescommand as part of their advanced reconnaissance.[33]C0014Operation WocaoDuringOperation Wocao, threat actors discovered removable disks attached to a system.[34]S0113PrikormkaA module inPrikormkacollects information on available printers and disk drives.[35]S0650QakBotQakBotcan identify peripheral devices on targeted systems.[36]S0686QuietSieveQuietSievecan identify and search removable drives for specific file name extensions.[37]S0481Ragnar LockerRagnar Lockermay attempt to connect to removable drives and mapped network drives.[38]S0458RamsayRamsaycan scan for removable media which may contain documents for collection.[39][40]S0148RTMRTMcan obtain a list of smart card readers attached to the victim.[41][42]S1089SharpDiscoSharpDiscohas dropped a plugin to monitor external drives toC:\Users\Public\It3.exe.[28]S0603StuxnetStuxnetenumerates removable drives for infection.[43]S1064SVCReadySVCReadycan check for the number of devices plugged into an infected host.[44]S0098T9000T9000searches through connected drives for removable storage devices.[45]S0467TajMahalTajMahalhas the ability to identify connected Apple devices.[46]G0139TeamTNTTeamTNThas searched for attached VGA devices using lspci.[47]S0647TurianTuriancan scan for removable media to collect data.[7]G0010TurlaTurlahas usedfsutil fsinfo drivesto list connected drives.[48]S0452USBferryUSBferrycan check for connected USB devices.[49]S0136USBStealerUSBStealermonitors victims for insertion of removable drives. When dropped onto a second victim, it also enumerates drives connected to the system.[50]S0366WannaCryWannaCrycontains a thread that will attempt to scan for new attached drives every few seconds. If one is identified, it will encrypt the files on the attached device.[51]S0612WastedLockerWastedLockercan enumerate removable drives prior to the encryption process.[52]S0251ZebrocyZebrocyenumerates information about connected storage devices.[53]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may attempt to gather information about attached peripheral devices and components connected to a computer system.DS0009ProcessOS API ExecutionMonitor for API calls that may attempt to gather information about attached peripheral devices and components connected to a computer system.Process CreationMonitor for newly executed processes that may attempt to gather information about attached peripheral devices and components connected to a computer system.ReferencesShahriar Shovon. (2018, March). List USB Devices Linux. Retrieved March 11, 2022.SS64. (n.d.). system_profiler. Retrieved March 11, 2022.ESET. (2016, October). En Route with Sednit - Part 2: Observing the Comings and Goings. Retrieved November 21, 2016.Anthe, C. et al. (2015, October 19). Microsoft Security Intelligence Report Volume 19. Retrieved December 23, 2015.GReAT. (2019, May 13). ScarCruft continues to evolve, introduces Bluetooth harvester. Retrieved June 4, 2019.Hromcova, Z. (2019, October). AT COMMANDS, TOR-BASED COMMUNICATIONS: MEET ATTOR, A FANTASY CREATURE AND ALSO A SPY PLATFORM. Retrieved May 6, 2020.Adam Burgher. (2021, June 10). BackdoorDiplomacy: Upgrading from Quarian to Turian. Retrieved September 1, 2021Settle, A., et al. (2016, August 8). MONSOON - Analysis Of An APT Campaign. Retrieved September 22, 2016.Lunghi, D., et al. (2017, December). Untangling the Patchwork Cyberespionage Group. Retrieved July 10, 2018.Galperin, E., Et al.. (2016, August). I Got a Letter From the Government the Other Day.... Retrieved April 25, 2018.Baumgartner, K. and Garnaeva, M.. (2014, November 3). BE2 custom plugins, router abuse, and target profiles. Retrieved March 24, 2016.Symantec Security Response. (2015, December 7). Iran-based attackers use back door threats to spy on Middle Eastern targets. Retrieved April 17, 2019.Huss, D. (2016, March 1). Operation Transparent Tribe. Retrieved June 8, 2016.Dedola, G. (2020, August 20). Transparent Tribe: Evolution analysis, part 1. Retrieved September 2, 2021.Faou, M. (2020, December 2). Turla Crutch: Keeping the “back door” open. Retrieved December 4, 2020.Smith, S., Stafford, M. (2021, December 14). DarkWatchman: A new evolution in fileless techniques. Retrieved January 10, 2022.GReAT. (2019, April 10). Gaza Cybergang Group1, operation SneakyPastes. Retrieved May 13, 2020.Kaspersky Lab's Global Research and Analysis Team. (2015, February). Equation Group: Questions and Answers. Retrieved December 21, 2015.Yamout, M. (2021, November 29). WIRTE’s campaign in the Middle East ‘living off the land’ since at least 2019. Retrieved February 1, 2022.Proofpoint Staff. (2018, March 7). Leaked Ammyy Admin Source Code Turned into Malware. Retrieved May 28, 2019.Vrabie, V. (2020, November). Dissecting a Chinese APT Targeting South Eastern Asian Government Institutions. Retrieved September 19, 2022.Kasza, A. and Reichel, D. (2017, February 27). The Gamaredon Group Toolset Evolution. Retrieved March 1, 2017.Boutin, J. (2020, June 11). Gamaredon group grows its game. Retrieved June 16, 2020.Chen, Joey. (2022, June 9). Aoqin Dragon | Newly-Discovered Chinese-linked APT Has Been Quietly Spying On Organizations For 10 Years. Retrieved July 14, 2022.Kamluk, V. & Gostev, A. (2016, February). Adwind - A Cross-Platform RAT. Retrieved April 23, 2019.ESET. (2019, July). MACHETE JUST GOT SHARPER Venezuelan government institutions under attack. Retrieved September 13, 2019.Miller-Osborn, J. and Grunzweig, J.. (2017, March 30). Trochilus and New MoonWind RATs Used In Attack Against Thai Organizations. Retrieved March 30, 2017.Faou, M. (2023, August 10). MoustachedBouncer: Espionage against foreign diplomats in Belarus. Retrieved September 25, 2023.Fidelis Cybersecurity. (2013, June 28). Fidelis Threat Advisory #1009: "njRAT" Uncovered. Retrieved June 4, 2019.Pascual, C. (2018, November 27). AutoIt-Compiled Worm Affecting Removable Media Delivers Fileless Version of BLADABINDI/njRAT Backdoor. Retrieved June 4, 2019.Malhotra, A. (2021, March 2). ObliqueRAT returns with new campaign using hijacked websites. Retrieved September 2, 2021.Check Point. (2021, April 8). Iran’s APT34 Returns with an Updated Arsenal. Retrieved May 5, 2021.Cybereason Nocturnus. (2022, May 4). Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques. Retrieved September 22, 2022.Dantzig, M. v., Schamper, E. (2019, December 19). Operation Wocao: Shining a light on one of China’s hidden hacking groups. Retrieved October 8, 2020.Cherepanov, A.. (2016, May 17). Operation Groundbait: Analysis of a surveillance toolkit. Retrieved May 18, 2016.Mendoza, E. et al. (2020, May 25). Qakbot Resurges, Spreads through VBS Files. Retrieved September 27, 2021.Microsoft Threat Intelligence Center. (2022, February 4). ACTINIUM targets Ukrainian organizations. Retrieved February 18, 2022.SophosLabs. (2020, May 21). Ragnar Locker ransomware deploys virtual machine to dodge security. Retrieved June 29, 2020.Sanmillan, I.. (2020, May 13). Ramsay: A cyber‑espionage toolkit tailored for air‑gapped networks. Retrieved May 27, 2020.Antiy CERT. (2020, April 20). Analysis of Ramsay components of Darkhotel's infiltration and isolation network. Retrieved March 24, 2021.Faou, M. and Boutin, J. (2017, February). Read The Manual: A Guide to the RTM Banking Trojan. Retrieved March 9, 2017.Duncan, B., Harbison, M. (2019, January 23). Russian Language Malspam Pushing Redaman Banking Malware. Retrieved June 16, 2020.Nicolas Falliere, Liam O Murchu, Eric Chien 2011, February W32.Stuxnet Dossier (Version 1.4) Retrieved. 2017/09/22Schlapfer, Patrick. (2022, June 6). A New Loader Gets Ready. Retrieved December 13, 2022.Grunzweig, J. and Miller-Osborn, J.. (2016, February 4). T9000: Advanced Modular Backdoor Uses Complex Anti-Analysis Techniques. Retrieved April 15, 2016.GReAT. (2019, April 10). Project TajMahal – a sophisticated new APT framework. Retrieved October 14, 2019.Darin Smith. (2022, April 21). TeamTNT targeting AWS, Alibaba. Retrieved August 4, 2022.Faou, M. (2020, May). From Agent.btz to ComRAT v4: A ten-year journey. Retrieved June 15, 2020.Chen, J.. (2020, May 12). Tropic Trooper’s Back: USBferry Attack Targets Air gapped Environments. Retrieved May 20, 2020.Calvet, J. (2014, November 11). Sednit Espionage Group Attacking Air-Gapped Networks. Retrieved January 4, 2017.Berry, A., Homan, J., and Eitzman, R. (2017, May 23). WannaCry Malware Profile. Retrieved March 15, 2019.Walter, J.. (2020, July 23). WastedLocker Ransomware: Abusing ADS and NTFS File Attributes. Retrieved September 14, 2021.Falcone, R., Lee, B. (2018, November 20). Sofacy Continues Global Attacks and Wheels Out New ‘Cannon’ Trojan. Retrieved November 26, 2018.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.