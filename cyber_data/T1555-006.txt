MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseCredentials from Password StoresCloud Secrets Management StoresCredentials from Password Stores:Cloud Secrets Management StoresOther sub-techniques of Credentials from Password Stores (6)IDNameT1555.001KeychainT1555.002Securityd MemoryT1555.003Credentials from Web BrowsersT1555.004Windows Credential ManagerT1555.005Password ManagersT1555.006Cloud Secrets Management StoresAdversaries may acquire credentials from cloud-native secret management solutions such as AWS Secrets Manager, GCP Secret Manager, Azure Key Vault, and Terraform Vault.Secrets managers support the secure centralized management of passwords, API keys, and other credential material. Where secrets managers are in use, cloud services can dynamically acquire credentials via API requests rather than accessing secrets insecurely stored in plain text files or environment variables.If an adversary is able to gain sufficient privileges in a cloud environment – for example, by obtaining the credentials of high-privilegedCloud Accountsor compromising a service that has permission to retrieve secrets – they may be able to request secrets from the secrets manager. This can be accomplished via commands such asget-secret-valuein AWS,gcloud secrets describein GCP, andaz key vault secret showin Azure.[1][2][3][4][5]Note:this technique is distinct fromCloud Instance Metadata APIin that the credentials are being directly requested from the cloud secrets manager, rather than through the medium of the instance metadata API.ID:T1555.006Sub-technique of:T1555ⓘTactic:Credential AccessⓘPlatforms:IaaSContributors:Martin McCloskey, DatadogVersion:1.0Created:25 September 2023Last Modified:30 September 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS1091PacuPacucan retrieve secrets from the AWS Secrets Manager via the enum_secrets module.[6]MitigationsIDMitigationDescriptionM1026Privileged Account ManagementLimit the number of cloud accounts and services with permission to query the secrets manager to only those required. Ensure that accounts and services with permissions to query the secrets manager only have access to the secrets they require.DetectionIDData SourceData ComponentDetectsDS0025Cloud ServiceCloud Service EnumerationMonitor for API calls and CLI commands that attempt to enumerate and fetch credential material from the secrets manager, such asget-secret-valuein AWS,gcloud secrets describein GCP, andaz key vault secret showin Azure. Alert on any suspicious usages of these commands, such as an account or service generating an unusually high number of secret requests.ReferencesIan Ahl. (2023, September 20). LUCR-3: SCATTERED SPIDER GETTING SAAS-Y IN THE CLOUD. Retrieved September 25, 2023.Alessandro Brucato. (2023, July 11). SCARLETEEL 2.0: Fargate, Kubernetes, and Crypto. Retrieved September 25, 2023.AWS. (n.d.). Retrieve secrets from AWS Secrets Manager. Retrieved September 25, 2023.Google Cloud. (n.d.). List secrets and view secret details. Retrieved September 25, 2023.Microsoft. (2023, January 13). Quickstart: Set and retrieve a secret from Azure Key Vault using Azure CLI. Retrieved September 25, 2023.Rhino Security Labs. (2019, August 22). Pacu. Retrieved October 17, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.