MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseAccount ManipulationAdditional Cloud RolesAccount Manipulation:Additional Cloud RolesOther sub-techniques of Account Manipulation (6)IDNameT1098.001Additional Cloud CredentialsT1098.002Additional Email Delegate PermissionsT1098.003Additional Cloud RolesT1098.004SSH Authorized KeysT1098.005Device RegistrationT1098.006Additional Container Cluster RolesAn adversary may add additional roles or permissions to an adversary-controlled cloud account to maintain persistent access to a tenant. For example, adversaries may update IAM policies in cloud-based environments or add a new global administrator in Office 365 environments.[1][2][3][4]With sufficient permissions, a compromised account can gain almost unlimited access to data and settings (including the ability to reset the passwords of other admins).[5][4]This account modification may immediately followCreate Accountor other malicious account activity. Adversaries may also modify existingValid Accountsthat they have compromised. This could lead to privilege escalation, particularly if the roles added allow for lateral movement to additional accounts.For example, in AWS environments, an adversary with appropriate permissions may be able to use theCreatePolicyVersionAPI to define a new version of an IAM policy or theAttachUserPolicyAPI to attach an IAM policy with additional or distinct permissions to a compromised user account.[6]In some cases, adversaries may add roles to adversary-controlled accounts outside the victim cloud tenant. This allows these external accounts to perform actions inside the victim tenant without requiring the adversary toCreate Accountor modify a victim-owned account.[7]ID:T1098.003Sub-technique of:T1098ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:Azure AD, Google Workspace, IaaS, Office 365, SaaSContributors:Alex Parsons, Crowdstrike; Alex Soler, AttackIQ; Arad Inbar, Fidelis Security; Chris Romano, Crowdstrike; Clément Notin, Tenable; Microsoft Threat Intelligence Center (MSTIC); Pià Consigny, Tenable; Praetorian; Wojciech LesickiVersion:2.4Created:19 January 2020Last Modified:29 March 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionC0027C0027DuringC0027,Scattered Spiderused IAM manipulation to gain persistence and to assume or elevate privileges.[8]G1004LAPSUS$LAPSUS$has added the global admin role to accounts they have created in the targeted organization's cloud instances.[9]G1015Scattered SpiderDuringC0027,Scattered Spiderused IAM manipulation to gain persistence and to assume or elevate privileges.[8]Scattered Spiderhas also assigned user access admin roles in order to gain Tenant Root Group management permissions in Azure.[10]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29grantedcompany administratorprivileges to a newly created service principle.[11]MitigationsIDMitigationDescriptionM1032Multi-factor AuthenticationUse multi-factor authentication for user and privileged accounts.M1026Privileged Account ManagementEnsure that all accounts use the least privileges they require. In Azure AD environments, consider using Privileged Identity Management (PIM) to define roles that require two or more approvals before assignment to users.[12]M1018User Account ManagementEnsure that low-privileged user accounts do not have permissions to add permissions to accounts or update IAM policies.DetectionIDData SourceData ComponentDetectsDS0002User AccountUser Account ModificationCollect usage logs from cloud administrator accounts to identify unusual activity in the assignment of roles to those accounts. Monitor for accounts assigned to admin roles that go over a certain threshold of known admins. Monitor for updates to IAM policies and roles attached to user accounts.ReferencesAWS. (n.d.). Policies and permissions in IAM. Retrieved April 1, 2022.Google Cloud. (2022, March 31). Understanding policies. Retrieved April 1, 2022.Microsoft. (n.d.). Add Another Admin. Retrieved October 18, 2019.Ako-Adjei, K., Dickhaus, M., Baumgartner, P., Faigel, D., et. al.. (2019, October 8). About admin roles. Retrieved October 18, 2019.Brian Bahtiarian, David Blanton, Britton Manahan and Kyle Pellett. (2022, April 5). Incident report: From CLI to console, chasing an attacker in AWS. Retrieved April 7, 2022.Spencer Gietzen. (n.d.). AWS IAM Privilege Escalation – Methods and Mitigation. Retrieved May 27, 2022.Invictus Incident Response. (2024, January 31). The curious case of DangerDev@protonmail.me. Retrieved March 19, 2024.Parisi, T. (2022, December 2). Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies. Retrieved June 30, 2023.MSTIC, DART, M365 Defender. (2022, March 24). DEV-0537 Criminal Actor Targeting Organizations for Data Exfiltration and Destruction. Retrieved May 17, 2022.Microsoft. (2023, October 25). Octo Tempest crosses boundaries to facilitate extortion, encryption, and destruction. Retrieved March 18, 2024.CrowdStrike. (2022, January 27). Early Bird Catches the Wormhole: Observations from the StellarParticle Campaign. Retrieved February 7, 2022.Microsoft. (2023, January 30). Approve or deny requests for Azure AD roles in Privileged Identity Management. Retrieved February 21, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.