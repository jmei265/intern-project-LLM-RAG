MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseProcess InjectionDynamic-link Library InjectionProcess Injection:Dynamic-link Library InjectionOther sub-techniques of Process Injection (12)IDNameT1055.001Dynamic-link Library InjectionT1055.002Portable Executable InjectionT1055.003Thread Execution HijackingT1055.004Asynchronous Procedure CallT1055.005Thread Local StorageT1055.008Ptrace System CallsT1055.009Proc MemoryT1055.011Extra Window Memory InjectionT1055.012Process HollowingT1055.013Process DoppelgängingT1055.014VDSO HijackingT1055.015ListPlantingAdversaries may inject dynamic-link libraries (DLLs) into processes in order to evade process-based defenses as well as possibly elevate privileges. DLL injection is a method of executing arbitrary code in the address space of a separate live process.DLL injection is commonly performed by writing the path to a DLL in the virtual address space of the target process before loading the DLL by invoking a new thread. The write can be performed with native Windows API calls such asVirtualAllocExandWriteProcessMemory, then invoked withCreateRemoteThread(which calls theLoadLibraryAPI responsible for loading the DLL).[1]Variations of this method such as reflective DLL injection (writing a self-mapping DLL into a process) and memory module (map DLL when writing into process) overcome the address relocation issue as well as the additional APIs to invoke execution (since these methods load and execute the files in memory by manually preforming the function ofLoadLibrary).[2][1]Another variation of this method, often referred to as Module Stomping/Overloading or DLL Hollowing, may be leveraged to conceal injected code within a process. This method involves loading a legitimate DLL into a remote process then manually overwriting the module'sAddressOfEntryPointbefore starting a new thread in the target process.[3]This variation allows attackers to hide malicious injected code by potentially backing its execution with a legitimate DLL file on disk.[4]Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via DLL injection may also evade detection from security products since the execution is masked under a legitimate process.ID:T1055.001Sub-technique of:T1055ⓘTactics:Defense Evasion,Privilege EscalationⓘPlatforms:WindowsⓘPermissions Required:UserⓘDefense Bypassed:Anti-virus, Application controlContributors:Boominathan SundaramVersion:1.3Created:14 January 2020Last Modified:11 August 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0456Aria-bodyAria-bodyhas the ability to inject itself into another process such as rundll32.exe and dllhost.exe.[5]G0135BackdoorDiplomacyBackdoorDiplomacyhas dropped legitimate software onto a compromised host and used it to execute malicious DLLs.[6]S1081BADHATCHBADHATCHhas the ability to execute a malicious DLL by injecting intoexplorer.exeon a compromised machine.[7]S0089BlackEnergyBlackEnergyinjects its DLL component into svchost.exe.[8]S1039BumblebeeTheBumblebeeloader can support theDijcommand which gives it the ability to inject DLLs into the memory of other processes.[9][10]C0015C0015DuringC0015, the threat actors used a DLL namedD8B3.dllthat was injected into the Winlogon process.[11]S0484CarberpCarberp's bootkit can inject a malicious DLL into the address space of running processes.[12]S0335CarbonCarbonhas a command to inject code into a process.[13]S0154Cobalt StrikeCobalt Strikehas the ability to load DLLs via reflective injection.[14][15]S0126ComRATComRAThas injected its orchestrator DLL into explorer.exe.ComRAThas also injected its communications module into the victim's default browser to make C2 connections appear less suspicious as all network connections will be initiated by the browser process.[16][17]S0575ContiContihas loaded an encrypted DLL into memory and then executes it.[18][19]S1066DarkTortillaDarkTortillacan use a .NET-based DLL namedRunPe6for process injection.[20]S0021DerusbiDerusbiinjects itself into the secure shell (SSH) process.[21]S0038DuquDuquwill inject itself into different processes to evade detection. The selection of the target process is influenced by the security software that is installed on the system (Duqu will inject into different processes depending on which security suite is installed on the infected host).[22]S0024DyreDyreinjects into other processes to load modules.[23]S0081EliseEliseinjects DLL files into iexplore.exe.[24][25]S0082EmissaryEmissaryinjects its DLL file into a newly spawned Internet Explorer process.[26]S0367EmotetEmotethas been observed injecting in to Explorer.exe and other processes.[27][28][29]S0182FinFisherFinFisherinjects itself into various processes depending on whether it is low integrity or high integrity.[30][31]S1044FunnyDreamTheFunnyDreamFilepakMonitor component can inject into the Bka.exe process using theVirtualAllocEx,WriteProcessMemoryandCreateRemoteThreadAPIs to load the DLL component.[32]S0666GelsemiumGelsemiumhas the ability to inject DLLs into specific processes.[33]S0460Get2Get2has the ability to inject DLLs into processes.[34]S1027Heyoka BackdoorHeyoka Backdoorcan inject a DLL into rundll32.exe for execution.[35]S0135HIDEDRVHIDEDRVinjects a DLL forDowndelphinto the explorer.exe process.[36]S0581IronNetInjectorIronNetInjectorhas the ability to inject a DLL into running processes, including theIronNetInjectorDLL into explorer.exe.[37]S0265KazuarIf running in a Windows environment,Kazuarsaves a DLL to disk that is injected into the explorer.exe process to execute the payload.Kazuarcan also be configured to inject and execute within specific processes.[38]S0250KoadicKoadiccan perform process injection by using a reflective DLL.[39]G0032Lazarus GroupALazarus Groupmalware sample performs reflective DLL injection.[40][41]G0065LeviathanLeviathanhas utilized techniques like reflective DLL loading to write a DLL into memory and load a shell that provides backdoor access to the victim.[42]S0681LizarLizarhas used the PowerKatz plugin that can be loaded into the address space of a PowerShell process through reflective DLL loading.[43]G1026MalteiroMalteirohas injectedMispadu’s DLL into a process.[44]S0167MatryoshkaMatryoshkauses reflective DLL injection to inject the malicious library and execute the RAT.[45]S0449MazeMazehas injected the malware DLL into a target process.[46][47]S0576MegaCortexMegaCortexloadsinjecthelper.dllinto a newly createdrundll32.exeprocess.[48]S0455MetamorfoMetamorfohas injected a malicious DLL into the Windows Media Player process (wmplayer.exe).[49]S1026MongallMongallcan inject a DLL intorundll32.exefor execution.[35]S0457NetwalkerTheNetwalkerDLL has been injected reflectively into the memory of a legitimate running process.[50]S0501PipeMonPipeMoncan inject its modules into various processes using reflective DLL loading.[51]S0012PoisonIvyPoisonIvycan inject a malicious DLL into a process.[52][53]S0194PowerSploitPowerSploitcontains a collection of CodeExecution modules that inject code (DLL, shellcode) into a process.[54][55]S0613PS1PS1can inject its payload DLL Into memory.[56]S0192PupyPupycan migrate into another process using reflective DLL injection.[57]G0024Putter PandaAn executable dropped onto victims byPutter Pandaaims to inject the specified DLL into a process that would normally be accessing the network, including Outlook Express (msinm.exe), Outlook (outlook.exe), Internet Explorer (iexplore.exe), and Firefox (firefox.exe).[58]S0458RamsayRamsaycan useImprovedReflectiveDLLInjectionto deploy components.[59]S0055RARSTONEAfter decrypting itself in memory,RARSTONEdownloads a DLL file from its C2 server and loads it in the memory space of a hidden Internet Explorer process. This "downloaded" file is actually not dropped onto the system.[60]S0241RATANKBARATANKBAperforms a reflective DLL injection using a given pid.[61][62]S0125RemsecRemseccan perform DLL injection.[63]S1018Saint BotSaint Bothas injected its DLL component intoEhStorAurhn.exe.[64]S0461SDBbotSDBbothas the ability to inject a downloaded DLL into a newly created rundll32.exe process.[34]S0596ShadowPadShadowPadhas injected a DLL into svchost.exe.[65]S0273SocksbotSocksbotcreates a suspended svchost process and injects its DLL into it.[66]S0615SombRATSombRATcan executeloadfromfile,loadfromstorage, andloadfrommemto inject a DLL  from disk, storage, or memory respectively.[56]S0603StuxnetStuxnetinjects an entire DLL into an existing, newly created, or preselected trusted process.[67]S0018SykipotSykipotinjects itself into running instances of outlook.exe, iexplore.exe, or firefox.exe.[68]G0092TA505TA505has been seen injecting a DLL into winword.exe.[69]S0011TaidoorTaidoorcan perform DLL loading.[70][71]S0467TajMahalTajMahalhas the ability to inject DLLs for malicious plugins into running processes.[72]G0081Tropic TrooperTropic Trooperhas injected a DLL backdoor into dllhost.exe and svchost.exe.[73][74]G0010TurlaTurlahas used Metasploit to perform reflective DLL injection in order to escalate privileges.[75][76]S0022UroburosUroburoscan use DLL injection to load embedded files and modules.[77]G0102Wizard SpiderWizard Spiderhas injected malicious DLLs into memory with read, write, and execute permissions.[78][79]S0412ZxShellZxShellis injected into a shared SVCHOST process.[80]MitigationsIDMitigationDescriptionM1040Behavior Prevention on EndpointSome endpoint security solutions can be configured to block some types of process injection based on common sequences of behavior that occur during the injection process.DetectionIDData SourceData ComponentDetectsDS0011ModuleModule LoadMonitor DLL/PE file events, specifically creation of these binary files as well as the loading of DLLs into processes. Look for DLLs that are not recognized or not normally loaded into a process. Sysmon Event ID 7 (Image loaded) can be used to monitor the loading of DLLs into processes. This is a particularly noisy event and can generate a large volume of data, so we recommend baselining and filtering out any known benign processes and module loads to help reduce the number of events that are produced.DS0009ProcessOS API ExecutionMonitoring Windows API calls indicative of the various types of code injection may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances for known bad sequences of calls, since benign use of API functions may be common and difficult to distinguish from malicious behavior. Windows API calls such asCreateRemoteThreadand those that can be used to modify memory within another process, such asVirtualAllocEx/WriteProcessMemory, may be used for this technique.[1]Search for remote thread creations that start at LoadLibraryA or LoadLibraryW. Depending on the tool, it may provide additional information about the DLL string that is an argument to the function. If there is any security software that legitimately injects DLLs, it must be carefully whitelisted.Microsoft Windows allows for processes to remotely create threads within other processes of the same privilege level. This functionality is provided via the Windows API CreateRemoteThread. Both Windows and third-party software use this ability for legitimate purposes. For example, the Windows process csrss.exe creates threads in programs to send signals to registered callback routines. Both adversaries and host-based security software use this functionality to inject DLLs, but for very different purposes. An adversary is likely to inject into a program to evade defenses or bypass User Account Control, but a security program might do this to gain increased monitoring of API calls. One of the most common methods of DLL Injection is through the Windows API LoadLibrary.Allocate memory in the target program with VirtualAllocExWrite the name of the DLL to inject into this program with WriteProcessMemoryCreate a new thread and set its entry point to LoadLibrary using the API CreateRemoteThread.This behavior can be detected by looking for thread creations across processes, and resolving the entry point to determine the function name. If the function is LoadLibraryA or LoadLibraryW, then the intent of the remote thread is clearly to inject a DLL. When this is the case, the source process must be examined so that it can be ignored when it is both expected and a trusted process.Process AccessMonitor for process being viewed that may inject dynamic-link libraries (DLLs) into processes in order to evade process-based defenses as well as possibly elevate privileges.Process MetadataMonitor for process memory inconsistencies compared to DLL files on disk by checking memory ranges against a known copy of the legitimate module.[4]Process ModificationMonitor for changes made to processes that may inject dynamic-link libraries (DLLs) into processes in order to evade process-based defenses as well as possibly elevate privileges. Injecting a malicious DLL into a process is a common adversary TTP. Although the ways of doing this are numerous, mavinject.exe is a commonly used tool for doing so because it roles up many of the necessary steps into one, and is available within Windows. Attackers may rename the executable, so we also use the common argument "INJECTRUNNING" as a related signature here. Whitelisting certain applications may be necessary to reduce noise for this analytic.Analytic 1 - DLL Injection with Mavinject(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") Image="C:\Windows\SysWOW64\mavinject.exe" OR Image="C:\Windows\System32\mavinject.exe" OR CommandLine="/INJECTRUNNING""ReferencesHosseini, A. (2017, July 18). Ten Process Injection Techniques: A Technical Survey Of Common And Trending Process Injection Techniques. Retrieved December 7, 2017.Desimone, J. (2017, June 13). Hunting in Memory. Retrieved December 7, 2017.Red Teaming Experiments. (n.d.). Module Stomping for Shellcode Injection. Retrieved July 14, 2022.Aliz Hammond. (2019, August 15). Hiding Malicious Code with "Module Stomping": Part 1. Retrieved July 14, 2022.CheckPoint. (2020, May 7). Naikon APT: Cyber Espionage Reloaded. Retrieved May 26, 2020.Adam Burgher. (2021, June 10). BackdoorDiplomacy: Upgrading from Quarian to Turian. Retrieved September 1, 2021Savelesky, K., et al. (2019, July 23). ABADBABE 8BADFOOD: Discovering BADHATCH and a Detailed Look at FIN8's Tooling. Retrieved September 8, 2021.F-Secure Labs. (2014). BlackEnergy & Quedagh: The convergence of crimeware and APT attacks. Retrieved March 24, 2016.Merriman, K. and Trouerbach, P. (2022, April 28). This isn't Optimus Prime's Bumblebee but it's Still Transforming. Retrieved August 22, 2022.Kamble, V. (2022, June 28). Bumblebee: New Loader Rapidly Assuming Central Position in Cyber-crime Ecosystem. Retrieved August 24, 2022.DFIR Report. (2021, November 29). CONTInuing the Bazar Ransomware Story. Retrieved September 29, 2022.Matrosov, A., Rodionov, E., Volkov, D., Harley, D. (2012, March 2). Win32/Carberp When You’re in a Black Hole, Stop Digging. Retrieved July 15, 2020.ESET. (2017, March 30). Carbon Paper: Peering into Turla’s second stage backdoor. Retrieved November 7, 2018.Mavis, N. (2020, September 21). The Art and Science of Detecting Cobalt Strike. Retrieved April 6, 2021.Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.Faou, M. (2020, May). From Agent.btz to ComRAT v4: A ten-year journey. Retrieved June 15, 2020.CISA. (2020, October 29). Malware Analysis Report (AR20-303A). Retrieved December 9, 2020.Rochberger, L. (2021, January 12). Cybereason vs. Conti Ransomware. Retrieved February 17, 2021.Baskin, B. (2020, July 8). TAU Threat Discovery: Conti Ransomware. Retrieved February 17, 2021.Secureworks Counter Threat Unit Research Team. (2022, August 17). DarkTortilla Malware Analysis. Retrieved November 3, 2022.Perigaud, F. (2015, December 15). Newcomers in the Derusbi family. Retrieved December 20, 2017.Symantec Security Response. (2011, November). W32.Duqu: The precursor to the next Stuxnet. Retrieved September 17, 2015.Symantec Security Response. (2015, June 23). Dyre: Emerging threat on financial fraud landscape. Retrieved August 23, 2018.Falcone, R., et al.. (2015, June 16). Operation Lotus Blossom. Retrieved February 15, 2016.Accenture Security. (2018, January 27). DRAGONFISH DELIVERS NEW FORM OF ELISE MALWARE TARGETING ASEAN DEFENCE MINISTERS’ MEETING AND ASSOCIATES. Retrieved November 14, 2018.Falcone, R. and Miller-Osborn, J.. (2015, December 18). Attack on French Diplomat Linked to Operation Lotus Blossom. Retrieved February 15, 2016.Özarslan, S. (2018, December 21). The Christmas Card you never wanted - A new wave of Emotet is back to wreak havoc. Retrieved March 25, 2019.Salvio, J.. (2014, June 27). New Banking Malware Uses Network Sniffing for Data Theft. Retrieved March 25, 2019.US-CERT. (2018, July 20). Alert (TA18-201A) Emotet Malware. Retrieved March 25, 2019.FinFisher. (n.d.). Retrieved December 20, 2017.Allievi, A.,Flori, E. (2018, March 01). FinFisher exposed: A researcher’s tale of defeating traps, tricks, and complex virtual machines. Retrieved July 9, 2018.Vrabie, V. (2020, November). Dissecting a Chinese APT Targeting South Eastern Asian Government Institutions. Retrieved September 19, 2022.Dupuy, T. and Faou, M. (2021, June). Gelsemium. Retrieved November 30, 2021.Schwarz, D. et al. (2019, October 16). TA505 Distributes New SDBbot Remote Access Trojan with Get2 Downloader. Retrieved May 29, 2020.Chen, Joey. (2022, June 9). Aoqin Dragon | Newly-Discovered Chinese-linked APT Has Been Quietly Spying On Organizations For 10 Years. Retrieved July 14, 2022.ESET. (2016, October). En Route with Sednit - Part 3: A Mysterious Downloader. Retrieved November 21, 2016.Reichel, D. (2021, February 19). IronNetInjector: Turla’s New Malware Loading Tool. Retrieved February 24, 2021.Levene, B, et al. (2017, May 03). Kazuar: Multiplatform Espionage Backdoor with API Access. Retrieved July 17, 2018.Magius, J., et al. (2017, July 19). Koadic. Retrieved June 18, 2018.Sherstobitoff, R. (2018, February 12). Lazarus Resurfaces, Targets Global Banks and Bitcoin Users. Retrieved February 19, 2018.Saini, A. and Hossein, J. (2022, January 27). North Korea’s Lazarus APT leverages Windows Update client, GitHub in latest campaign. Retrieved January 27, 2022.Accenture iDefense Unit. (2019, March 5). Mudcarp's Focus on Submarine Technologies. Retrieved August 24, 2021.BI.ZONE Cyber Threats Research Team. (2021, May 13). From pentest to APT attack: cybercriminal group FIN7 disguises its malware as an ethical hacker’s toolkit. Retrieved February 2, 2022.SCILabs. (2021, December 23). Cyber Threat Profile Malteiro. Retrieved March 13, 2024.Minerva Labs LTD and ClearSky Cyber Security. (2015, November 23). CopyKittens Attack Group. Retrieved September 11, 2017.Mundo, A. (2020, March 26). Ransomware Maze. Retrieved May 18, 2020.Brandt, A., Mackenzie, P.. (2020, September 17). Maze Attackers Adopt Ragnar Locker Virtual Machine Technique. Retrieved October 9, 2020.Del Fierro, C. Kessem, L.. (2020, January 8). From Mega to Giga: Cross-Version Comparison of Top MegaCortex Modifications. Retrieved February 15, 2021.Erlich, C. (2020, April 3). The Avast Abuser: Metamorfo Banking Malware Hides By Abusing Avast Executable. Retrieved May 26, 2020.Victor, K.. (2020, May 18). Netwalker Fileless Ransomware Injected via Reflective Loading . Retrieved May 26, 2020.Tartare, M. et al. (2020, May 21). No “Game over” for the Winnti Group. Retrieved August 24, 2020.FireEye. (2014). POISON IVY: Assessing Damage and Extracting Intelligence. Retrieved November 12, 2014.Hayashi, K. (2005, August 18). Backdoor.Darkmoon. Retrieved February 23, 2018.PowerShellMafia. (2012, May 26). PowerSploit - A PowerShell Post-Exploitation Framework. Retrieved February 6, 2018.PowerSploit. (n.d.). PowerSploit. Retrieved February 6, 2018.The BlackBerry Research and Intelligence Team. (2020, November 12). The CostaRicto Campaign: Cyber-Espionage Outsourced. Retrieved May 24, 2021.Nicolas Verdier. (n.d.). Retrieved January 29, 2018.Crowdstrike Global Intelligence Team. (2014, June 9). CrowdStrike Intelligence Report: Putter Panda. Retrieved January 22, 2016.Sanmillan, I.. (2020, May 13). Ramsay: A cyber‑espionage toolkit tailored for air‑gapped networks. Retrieved May 27, 2020.Camba, A. (2013, February 27). BKDR_RARSTONE: New RAT to Watch Out For. Retrieved January 8, 2016.Lei, C., et al. (2018, January 24). Lazarus Campaign Targeting Cryptocurrencies Reveals Remote Controller Tool, an Evolved RATANKBA, and More. Retrieved May 22, 2018.Trend Micro. (2017, February 27). RATANKBA: Delving into Large-scale Watering Holes against Enterprises. Retrieved May 22, 2018.Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Technical Analysis. Retrieved August 17, 2016.Hasherezade. (2021, April 6). A deep dive into Saint Bot, a new downloader. Retrieved June 9, 2022.Kaspersky Lab. (2017, August). ShadowPad: popular server management software hit in supply chain attack. Retrieved March 22, 2021.Lunghi, D., et al. (2017, December). Untangling the Patchwork Cyberespionage Group. Retrieved July 10, 2018.Nicolas Falliere, Liam O Murchu, Eric Chien 2011, February W32.Stuxnet Dossier (Version 1.4) Retrieved. 2017/09/22Blasco, J. (2011, December 12). Another Sykipot sample likely targeting US federal agencies. Retrieved March 28, 2016.Frydrych, M. (2020, April 14). TA505 Continues to Infect Networks With SDBbot RAT. Retrieved May 29, 2020.Trend Micro. (2012). The Taidoor Campaign. Retrieved November 12, 2014.CISA, FBI, DOD. (2021, August). MAR-10292089-1.v2 – Chinese Remote Access Trojan: TAIDOOR. Retrieved August 24, 2021.GReAT. (2019, April 10). Project TajMahal – a sophisticated new APT framework. Retrieved October 14, 2019.Horejsi, J., et al. (2018, March 14). Tropic Trooper’s New Strategy. Retrieved November 9, 2018.Chen, J.. (2020, May 12). Tropic Trooper’s Back: USBferry Attack Targets Air gapped Environments. Retrieved May 20, 2020.ESET Research. (2018, May 22). Turla Mosquito: A shift towards more generic tools. Retrieved July 3, 2018.Rapid7. (2013, November 26). meterpreter/source/extensions/priv/server/elevate/. Retrieved July 8, 2018.FBI et al. (2023, May 9). Hunting Russian Intelligence “Snake” Malware. Retrieved June 8, 2023.DHS/CISA. (2020, October 28). Ransomware Activity Targeting the Healthcare and Public Health Sector. Retrieved October 28, 2020.The DFIR Report. (2020, November 5). Ryuk Speed Run, 2 Hours to Ransom. Retrieved November 6, 2020.Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.