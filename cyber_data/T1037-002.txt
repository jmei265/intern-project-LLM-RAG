MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseBoot or Logon Initialization ScriptsLogin HookBoot or Logon Initialization Scripts:Login HookOther sub-techniques of Boot or Logon Initialization Scripts (5)IDNameT1037.001Logon Script (Windows)T1037.002Login HookT1037.003Network Logon ScriptT1037.004RC ScriptsT1037.005Startup ItemsAdversaries may use a Login Hook to establish persistence executed upon user logon. A login hook is a plist file that points to a specific script to execute with root privileges upon user logon. The plist file is located in the/Library/Preferences/com.apple.loginwindow.plistfile and can be modified using thedefaultscommand-line utility. This behavior is the same for logout hooks where a script can be executed upon user logout. All hooks require administrator permissions to modify or create hooks.[1][2]Adversaries can add or insert a path to a malicious script in thecom.apple.loginwindow.plistfile, using theLoginHookorLogoutHookkey-value pair. The malicious script is executed upon the next user login. If a login hook already exists, adversaries can add additional commands to an existing login hook. There can be only one login and logout hook on a system at a time.[3][4]Note:Login hooks were deprecated in 10.11 version of macOS in favor ofLaunch DaemonandLaunch AgentID:T1037.002Sub-technique of:T1037ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:macOSVersion:2.0Created:10 January 2020Last Modified:20 April 2022Version PermalinkLive VersionMitigationsIDMitigationDescriptionM1022Restrict File and Directory PermissionsRestrict write access to logon scripts to specific administrators.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands with arguments to install or modify login hooks.DS0022FileFile CreationMonitor for the creation of and/or changes to login hook files (/Library/Preferences/com.apple.loginwindow.plist), especially by unusual accounts outside of normal administration duties.File ModificationMonitor for changes to login hook files (/Library/Preferences/com.apple.loginwindow.plist), especially by unusual accounts outside of normal administration duties.DS0009ProcessProcess CreationMonitor for processes and/or command-lines to install or modify login hooks, as well as processes spawned at user login by these hooks.ReferencesApple. (2016, September 13). Customizing Login and Logout. Retrieved April 1, 2022.Apple. (n.d.). LoginWindowScripts. Retrieved April 1, 2022.Stokes, P. (2019, July 17). How Malware Persists on macOS. Retrieved March 27, 2020.Patrick Wardle. (n.d.). Chapter 0x2: Persistence. Retrieved April 13, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.