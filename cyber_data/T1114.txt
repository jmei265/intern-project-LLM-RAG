MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseEmail CollectionEmail CollectionSub-techniques (3)IDNameT1114.001Local Email CollectionT1114.002Remote Email CollectionT1114.003Email Forwarding RuleAdversaries may target user email to collect sensitive information. Emails may contain sensitive data, including trade secrets or personal information, that can prove valuable to adversaries. Adversaries can collect or forward email from mail servers or clients.ID:T1114Sub-techniques:T1114.001,T1114.002,T1114.003ⓘTactic:CollectionⓘPlatforms:Google Workspace, Linux, Office 365, Windows, macOSContributors:Swetha Prabakaran, Microsoft Threat Intelligence Center (MSTIC)Version:2.5Created:31 May 2017Last Modified:29 September 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0367EmotetEmotethas been observed leveraging a module that can scrape email addresses from Outlook.[1][2][3]G0059Magic HoundMagic Houndhas compromised email credentials in order to steal sensitive data.[4]G0122Silent LibrarianSilent Librarianhas exfiltrated entire mailboxes from compromised accounts.[5]MitigationsIDMitigationDescriptionM1047AuditEnterprise email solutions have monitoring mechanisms that may include the ability to audit auto-forwarding rules on a regular basis.In an Exchange environment, Administrators can use Get-InboxRule to discover and remove potentially malicious auto-forwarding rules.[6]M1041Encrypt Sensitive InformationUse of encryption provides an added layer of security to sensitive information sent over email. Encryption using public key cryptography requires the adversary to obtain the private certificate along with an encryption key to decrypt messages.M1032Multi-factor AuthenticationUse of multi-factor authentication for public-facing webmail servers is a recommended best practice to minimize the usefulness of usernames and passwords to adversaries.DetectionIDData SourceData ComponentDetectsDS0015Application LogApplication Log ContentDetection is challenging because all messages forwarded because of an auto-forwarding rule have the same presentation as a manually forwarded message. It is also possible for the user to not be aware of the addition of such an auto-forwarding rule and not suspect that their account has been compromised; email-forwarding rules alone will not affect the normal usage patterns or operations of the email account. Auto-forwarded messages generally contain specific detectable artifacts that may be present in the header; such artifacts would be platform-specific. Examples includeX-MS-Exchange-Organization-AutoForwardedset to true,X-MailFwdByandX-Forwarded-To. TheforwardingSMTPAddressparameter used in a forwarding process that is managed by administrators and not by user actions. All messages for the mailbox are forwarded to the specified SMTP address. However, unlike typical client-side rules, the message does not appear as forwarded in the mailbox; it appears as if it were sent directly to the specified destination mailbox.[6]High volumes of emails that bear theX-MS-Exchange-Organization-AutoForwardedheader (indicating auto-forwarding) without a corresponding number of emails that match the appearance of a forwarded message may indicate that further investigation is needed at the administrator level rather than user-level.DS0017CommandCommand ExecutionMonitor executed processes and command-line arguments for actions that could be taken to gather local email files. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.On Windows systems, monitor for creation of suspicious inbox rules through the use of theNew-InboxRule,Set-InboxRule,New-TransportRule, andSet-TransportRulePowerShell cmdlets.[7][8]DS0022FileFile AccessMonitor for unusual processes access of local system email files for Exfiltration, unusual processes connecting to an email server within a network, or unusual access patterns or authentication attempts on a public-facing webmail server may all be indicators of malicious activity.DS0028Logon SessionLogon Session CreationMonitor for unusual login activity from unknown or abnormal locations, especially for privileged accounts (ex: Exchange administrator account).DS0029Network TrafficNetwork Connection CreationMonitor for newly constructed network connections that are sent or received by untrusted hosts.ReferencesCIS. (2018, December 12). MS-ISAC Security Primer- Emotet. Retrieved March 25, 2019.Kessem, L., et al. (2017, November 13). New Banking Trojan IcedID Discovered by IBM X-Force Research. Retrieved July 14, 2020.Binary Defense. (n.d.). Emotet Evolves With new Wi-Fi Spreader. Retrieved September 8, 2023.Certfa Labs. (2021, January 8). Charming Kitten’s Christmas Gift. Retrieved May 3, 2021.DOJ. (2018, March 23). U.S. v. Rafatnejad et al . Retrieved February 3, 2021.McMichael, T.. (2015, June 8). Exchange and Office 365 Mail Forwarding. Retrieved October 8, 2019.Carr, N., Sellmer, S. (2021, June 14). Behind the scenes of business email compromise: Using cross-domain threat data to disrupt a large BEC campaign. Retrieved June 15, 2021.Microsoft. (2023, February 22). Manage mail flow rules in Exchange Online. Retrieved March 13, 2023.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.