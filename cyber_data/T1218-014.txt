MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseSystem Binary Proxy ExecutionMMCSystem Binary Proxy Execution:MMCOther sub-techniques of System Binary Proxy Execution (14)IDNameT1218.001Compiled HTML FileT1218.002Control PanelT1218.003CMSTPT1218.004InstallUtilT1218.005MshtaT1218.007MsiexecT1218.008OdbcconfT1218.009Regsvcs/RegasmT1218.010Regsvr32T1218.011Rundll32T1218.012VerclsidT1218.013MavinjectT1218.014MMCT1218.015Electron ApplicationsAdversaries may abuse mmc.exe to proxy execution of malicious .msc files. Microsoft Management Console (MMC) is a binary that may be signed by Microsoft and is used in several ways in either its GUI or in a command prompt.[1][2]MMC can be used to create, open, and save custom consoles that contain administrative tools created by Microsoft, called snap-ins. These snap-ins may be used to manage Windows systems locally or remotely. MMC can also be used to open Microsoft created .msc files to manage system configuration.[3]For example,mmc C:\Users\foo\admintools.msc /awill open a custom, saved console msc file in author mode.[1]Another common example ismmc gpedit.msc, which will open the Group Policy Editor application window.Adversaries may use MMC commands to perform malicious tasks. For example,mmc wbadmin.msc delete catalog -quietdeletes the backup catalog on the system (i.e.Inhibit System Recovery) without prompts to the user (Note:wbadmin.mscmay only be present by default on Windows Server operating systems).[4][5]Adversaries may also abuse MMC to execute malicious .msc files. For example, adversaries may first create a malicious registry Class Identifier (CLSID) subkey, which uniquely identifies aComponent Object Modelclass object.[6]Then, adversaries may create custom consoles with the "Link to Web Address" snap-in that is linked to the malicious CLSID subkey.[7]Once the .msc file is saved, adversaries may invoke the malicious CLSID payload with the following command:mmc.exe -Embedding C:\path\to\test.msc.[8]ID:T1218.014Sub-technique of:T1218ⓘTactic:Defense EvasionⓘPlatforms:WindowsⓘDefense Bypassed:Application control, Digital Certificate ValidationContributors:Wes HurdVersion:2.0Created:28 September 2021Last Modified:20 May 2022Version PermalinkLive VersionMitigationsIDMitigationDescriptionM1042Disable or Remove Feature or ProgramMMC may not be necessary within a given environment since it is primarily used by system administrators, not regular users or clients.M1038Execution PreventionUse application control configured to block execution of MMC if it is not required for a given system or network to prevent potential misuse by adversaries.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that may gather information about the victim's DNS that can be used during targeting.DS0022FileFile CreationMonitor for creation and use of .msc files. MMC may legitimately be used to call Microsoft-created .msc files, such asservices.mscoreventvwr.msc. Invoking non-Microsoft .msc files may be an indicator of malicious activity.DS0009ProcessProcess CreationMonitor processes for suspicious or malicious use of MMC. Since MMC is a signed Windows binary, verify use of MMC is legitimate and not malicious.ReferencesMicrosoft. (2017, October 16). mmc. Retrieved September 20, 2021.Microsoft. (2020, September 27). What is Microsoft Management Console?. Retrieved October 5, 2021.Brinkmann, M.. (2017, June 10). Windows .msc files overview. Retrieved September 20, 2021.Microsoft. (2017, October 16). wbadmin delete catalog. Retrieved September 20, 2021.Phobos Ransomware. (2020, December 30). Phobos Ransomware, Fast.exe. Retrieved September 20, 2021.Microsoft. (2018, May 31). CLSID Key. Retrieved September 24, 2021.Boxiner, A., Vaknin, E. (2019, June 11). Microsoft Management Console (MMC) Vulnerabilities. Retrieved September 24, 2021.bohops. (2018, August 18). ABUSING THE COM REGISTRY STRUCTURE (PART 2): HIJACKING & LOADING TECHNIQUES. Retrieved September 20, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.