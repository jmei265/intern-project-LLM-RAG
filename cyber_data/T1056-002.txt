MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseInput CaptureGUI Input CaptureInput Capture:GUI Input CaptureOther sub-techniques of Input Capture (4)IDNameT1056.001KeyloggingT1056.002GUI Input CaptureT1056.003Web Portal CaptureT1056.004Credential API HookingAdversaries may mimic common operating system GUI components to prompt users for credentials with a seemingly legitimate prompt. When programs are executed that need additional privileges than are present in the current user context, it is common for the operating system to prompt the user for proper credentials to authorize the elevated privileges for the task (ex:Bypass User Account Control).Adversaries may mimic this functionality to prompt users for credentials with a seemingly legitimate prompt for a number of reasons that mimic normal usage, such as a fake installer requiring additional access or a fake malware removal suite.[1]This type of prompt can be used to collect credentials via various languages such asAppleScript[2][3][4]andPowerShell.[2][5][4]On Linux systems adversaries may launch dialog boxes prompting users for credentials from malicious shell scripts or the command line (i.e.Unix Shell).[4]Adversaries may also mimic common software authentication requests, such as those from browsers or email clients. This may also be paired with user activity monitoring (i.e.,Browser Information Discoveryand/orApplication Window Discovery) to spoof prompts when users are naturally accessing sensitive sites/data.ID:T1056.002Sub-technique of:T1056ⓘTactics:Collection,Credential AccessⓘPlatforms:Linux, Windows, macOSContributors:Matthew Molyett, @s1air, Cisco TalosVersion:1.3Created:11 February 2020Last Modified:15 April 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0482BundloreBundloreprompts the user for their credentials.[6]S0274CalistoCalistopresents an input prompt asking for the user's login and password.[7]S0281DokDokprompts the user for credentials.[8]G0085FIN4FIN4has presented victims with spoofed Windows Authentication prompts to collect their credentials.[9][10]S0278iKitteniKittenprompts the user for their credentials.[8]S0276KeydnapKeydnapprompts the users for credentials.[11]S0455MetamorfoMetamorfohas displayed fake forms on top of banking sites to intercept credentials from victims.[12]S1122MispaduMispaducan monitor browser activity for online banking actions and display full-screen overlay images to block user access to the intended site or present additional data fields.[13][14]S0279ProtonProtonprompts users for their credentials.[8]S0692SILENTTRINITYSILENTTRINITY'scredphisher.pymodule can prompt a current user for their credentials.[15]S0658XCSSETXCSSETprompts the user to input credentials using a native macOS dialog box leveraging the system process/Applications/Safari.app/Contents/MacOS/SafariForWebKitDevelopment.[16]MitigationsIDMitigationDescriptionM1017User TrainingUse user training as a way to bring awareness and raise suspicion for potentially malicious events and dialog boxes (ex: Office documents prompting for credentials).DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments, such as requests for credentials and/or strings related to creating password prompts that may be malicious.[4]DS0009ProcessProcess CreationMonitor for newly executed processesDS0012ScriptScript ExecutionMonitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.ReferencesSergei Shevchenko. (2015, June 4). New Mac OS Malware Exploits Mackeeper. Retrieved July 3, 2017.Foss, G. (2014, October 3). Do You Trust Your Computer?. Retrieved December 17, 2018.Marc-Etienne M.Leveille. (2016, July 6). New OSX/Keydnap malware is hungry for credentials. Retrieved July 3, 2017.Johann Rehberger. (2021, April 18). Spoofing credential dialogs on macOS Linux and Windows. Retrieved August 19, 2021.Nelson, M. (2015, January 21). Phishing for Credentials: If you want it, just ask!. Retrieved December 17, 2018.Sushko, O. (2019, April 17). macOS Bundlore: Mac Virus Bypassing macOS Security Features. Retrieved June 30, 2020.Pantig, J. (2018, July 30). OSX.Calisto. Retrieved September 7, 2018.Patrick Wardle. (n.d.). Mac Malware of 2017. Retrieved September 21, 2018.Vengerik, B. et al.. (2014, December 5). Hacking the Street? FIN4 Likely Playing the Market. Retrieved December 17, 2018.Vengerik, B. & Dennesen, K.. (2014, December 5). Hacking the Street?  FIN4 Likely Playing the Market. Retrieved January 15, 2019.Patrick Wardle. (2017, January 1). Mac Malware of 2016. Retrieved September 21, 2018.Sierra, E., Iglesias, G.. (2018, April 24). Metamorfo Campaigns Targeting Brazilian Users. Retrieved July 30, 2020.Pedro Tavares (Segurança Informática). (2020, September 15). Threat analysis: The emergent URSA trojan impacts many countries using a sophisticated loader. Retrieved March 13, 2024.SCILabs. (2021, December 23). Cyber Threat Profile Malteiro. Retrieved March 13, 2024.Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.Mac Threat Response, Mobile Research Team. (2020, August 13). The XCSSET Malware: Inserts Malicious Code Into Xcode Projects, Performs UXSS Backdoor Planting in Safari, and Leverages Two Zero-day Exploits. Retrieved October 5, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.