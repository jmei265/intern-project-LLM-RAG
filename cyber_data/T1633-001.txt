MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesMobileVirtualization/Sandbox EvasionSystem ChecksVirtualization/Sandbox Evasion:System ChecksAdversaries may employ various system checks to detect and avoid virtualization and analysis environments. This may include changing behavior after checking for the presence of artifacts indicative of a virtual environment or sandbox. If the adversary detects a virtual environment, they may alter their malware’s behavior to disengage from the victim or conceal the core functions of the implant. They may also search for virtualization artifacts before dropping secondary or additional payloads.Checks could include generic system properties such as host/domain name and samples of network traffic. Adversaries may also check the network adapters addresses, CPU core count, and available memory/drive size.Hardware checks, such as the presence of motion sensors, could also be used to gather evidence that can be indicative a virtual environment. Adversaries may also query for specific readings from these devices.ID:T1633.001Sub-technique of:T1633Tactic Type:Post-Adversary Device AccessⓘTactic:Defense EvasionⓘPlatforms:Android, iOSVersion:1.1Created:30 March 2022Last Modified:20 March 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS1061AbstractEmuAbstractEmucan check device system properties to potentially avoid running while under analysis.[1]S0525Android/AdDisplay.AshasAndroid/AdDisplay.Ashascan check that the device IP is not in the range of known Google IP addresses before triggering the payload and can delay payload deployment to avoid detection during testing and avoid association with unwanted ads.[2]S0422AnubisAnubishas used motion sensor data  to attempt to determine if it is running in an emulator.[3]S1094BRATABRATAcan check to see if it has been installed in a virtual environment.[4]S0480CerberusCerberusavoids being analyzed by only activating the malware after recording a certain number of steps from the accelerometer.[5]S1083ChameleonChameleoncan perform system checks to verify if the device is rooted or has ADB enabled and can avoid execution if found.[6]S0301DendroidDendroidcan detect if it is being ran on an emulator.[7]S0509FakeSpyFakeSpycan detect if it is running in an emulator and adjust its behavior accordingly.[8]S0423GinpGinpcan determine if it is running in an emulator.[9]S0544HenBoxHenBoxcan detect if the app is running on an emulator.[10]S0485MandrakeMandrakecan evade automated analysis environments by requiring a CAPTCHA on launch that will prevent the application from running if not passed. It also checks for indications that it is running in an emulator.[11]S0411RotexyRotexychecks if it is running in an analysis environment.[12]S0545TERRACOTTATERRACOTTAchecks whether its call stack has been modified, an indication that it is running in an analysis environment, and if so, does not decrypt its obfuscated strings[13].S0427TrickMoTrickMocan detect if it is running on a rooted device or an emulator.[14]G0112WindshiftWindshifthas deployed anti-analysis capabilities during their Operation BULL campaign.[15]S0489WolfRATWolfRATcan perform primitive emulation checks.[16]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0041Application VettingAPI CallsApplication vetting services could look for applications attempting to getandroid.os.SystemPropertiesorgetpropwith the runtimeexec()commands. This could indicate some level of sandbox evasion, as Google recommends against using system properties within applications.ReferencesP Shunk, K Balaam. (2021, October 28). Rooting Malware Makes a Comeback: Lookout Discovers Global Campaign. Retrieved February 6, 2023.L. Stefanko. (2019, October 24). Tracking down the developer of Android adware affecting millions of users. Retrieved October 29, 2020.K. Sun. (2019, January 17). Google Play Apps Drop Anubis, Use Motion-based Evasion. Retrieved January 20, 2021.Fernando Ruiz. (2021, April 12). BRATA Keeps Sneaking into Google Play, Now Targeting USA and Spain. Retrieved December 18, 2023.Threat Fabric. (2019, August). Cerberus - A new banking Trojan from the underworld. Retrieved June 26, 2020.Cyble Research & Intelligence Labs. (2023, April 13). Banking Trojan targeting mobile users in Australia and Poland. Retrieved August 16, 2023.Marc Rogers. (2014, March 6). Dendroid malware can take over your camera, record audio, and sneak into Google Play. Retrieved December 22, 2016.O. Almkias. (2020, July 1). FakeSpy Masquerades as Postal Service Apps Around the World. Retrieved September 15, 2020.ThreatFabric. (2019, November). Ginp - A malware patchwork borrowing from Anubis. Retrieved April 8, 2020.A. Hinchliffe, M. Harbison, J. Miller-Osborn, et al. (2018, March 13). HenBox: The Chickens Come Home to Roost. Retrieved September 9, 2019.R. Gevers, M. Tivadar, R. Bleotu, A. M. Barbatei, et al.. (2020, May 14). Uprooting Mandrake: The Story of an Advanced Android Spyware Framework That Went Undetected for 4 Years. Retrieved July 15, 2020.T. Shishkova, L. Pikman. (2018, November 22).  The Rotexy mobile Trojan – banker and ransomware. Retrieved September 23, 2019.Satori Threat Intelligence and Research Team. (2020, August). TERRACOTTA Android Malware: A Technical Study. Retrieved December 18, 2020.P. Asinovsky. (2020, March 24). TrickBot Pushing a 2FA Bypass App to Bank Customers in Germany. Retrieved April 24, 2020.The BlackBerry Research & Intelligence Team. (2020, October). BAHAMUT: Hack-for-Hire Masters of Phishing, Fake News, and Fake Apps. Retrieved February 8, 2021.W. Mercer, P. Rascagneres, V. Ventura. (2020, May 19).  The wolf is back... . Retrieved July 20, 2020.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.