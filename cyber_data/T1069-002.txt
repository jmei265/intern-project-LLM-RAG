MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterprisePermission Groups DiscoveryDomain GroupsPermission Groups Discovery:Domain GroupsOther sub-techniques of Permission Groups Discovery (3)IDNameT1069.001Local GroupsT1069.002Domain GroupsT1069.003Cloud GroupsAdversaries may attempt to find domain-level groups and permission settings. The knowledge of domain-level permission groups can help adversaries determine which groups exist and which users belong to a particular group. Adversaries may use this information to determine which users have elevated permissions, such as domain administrators.Commands such asnet group /domainof theNetutility,dscacheutil -q groupon macOS, andldapsearchon Linux can list domain-level groups.ID:T1069.002Sub-technique of:T1069ⓘTactic:DiscoveryⓘPlatforms:Linux, Windows, macOSContributors:Harshal Tupsamudre, Qualys; Miriam Wiesner, @miriamxyra, Microsoft SecurityVersion:1.2Created:21 February 2020Last Modified:07 April 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0552AdFindAdFindcan enumerate domain groups.[1][2][3][4]S1081BADHATCHBADHATCHcan usenet.exe group "domain admins" /domainto identify Domain Administrators.[5]S1068BlackCatBlackCatcan determine if a user on a compromised host has domain admin privileges.[6]S0521BloodHoundBloodHoundcan collect information about domain groups and members.[7]S1063Brute Ratel C4Brute Ratel C4can usenet groupfor discovery on targeted domains.[8]C0015C0015DuringC0015, the threat actors use the commandnet group "domain admins" /domto enumerate domain groups.[9]S0154Cobalt StrikeCobalt Strikecan identify targets by querying account groups on a domain contoller.[10]S0488CrackMapExecCrackMapExeccan gather the user accounts within domain groups.[11]G0035DragonflyDragonflyhas used batch scripts to enumerate administrators and users in the domain.[12]S0105dsquerydsquerycan be used to gather information on permission groups within a domain.[13][14]S0554EgregorEgregorcan conduct Active Directory reconnaissance using tools such as Sharphound orAdFind.[15]G0046FIN7FIN7has used the commandnet group "domain admins" /domainto enumerate domain groups.[16]S0417GRIFFONGRIFFONhas used a reconnaissance module that can be used to retrieve Windows domain membership information.[17]S0170HelminthHelminthhas checked for the domain admin group and Exchange Trusted Subsystem groups using the commandsnet group Exchange Trusted Subsystem /domainandnet group domain admins /domain.[18]G0100InceptionInceptionhas used specific malware modules to gather domain membership.[19]G0004Ke3changKe3changperforms discovery of permission groupsnet group /domain.[20]S0236KwampirsKwampirscollects a list of domain groups with the commandnet localgroup /domain.[21]G1004LAPSUS$LAPSUS$has used the AD Explorer tool to enumerate groups on a victim's network.[22]S0039NetCommands such asnet group /domaincan be used inNetto gather information about and manipulate groups.[23]G0049OilRigOilRighas usednet group /domain,net group "domain admins" /domain, andnet group "Exchange Trusted Subsystem" /domainto find domain group permission settings.[24]S0165OSInfoOSInfospecifically looks for Domain Admins and power users within the domain.[25]S0184POWRUNERPOWRUNERmay collect domain group information by runningnet group /domainor a series of other commands on a victim.[26]S0496REvilREvilcan identify the domain membership of a compromised host.[27][28][29]S0692SILENTTRINITYSILENTTRINITYcan useSystem.DirectoryServicesnamespace to retrieve domain group information.[30]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29usedAdFindto enumerate domain groups.[31]S0516SoreFangSoreFangcan enumerate domain groups by executingnet.exe group /domain.[32]G1022ToddyCatToddyCathas executednet group "domain admins" /domfor discovery on compromised machines.[33]G0010TurlaTurlahas usednet group "Domain Admins" /domainto identify domain administrators.[34]G1017Volt TyphoonVolt Typhoonhas runnet groupin compromised environments to discover domain groups.[35]S0514WellMessWellMesscan identify domain group membership for the current user.[36]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor for executed commands and arguments that may attempt to find domain-level groups and permission settings.DS0036GroupGroup EnumerationMonitor for logging that may suggest a list of available groups and/or their associated settings has been extracted, ex. Windows EID 4798 and 4799.DS0009ProcessOS API ExecutionMonitor for API calls associated with finding domain-level groups and permission settings, such asNetGroupEnum. Other API calls relevant to Domain Group discovery includeNetQueryDisplayInformationandNetGetDisplayInformationIndex.Note: Most EDR tools do not support direct monitoring of API calls due to the sheer volume of calls produced by an endpoint but may have alerts or events that are based on abstractions of OS API calls. Dynamic malware analysis tools (i.e., sandboxes) can be used to trace the execution, including OS API calls, for a single PE binary.Process CreationMonitor newly executed processes that may attempt to find domain-level groups and permission settings.For Linux, auditing frameworks that support alerting on process creation, including the audit daemon (auditd), can be used to alert on invocations of commands such asldapsearch.For MacOS, utilities that work in concert with Apple’s Endpoint Security Framework such as Process Monitor can be used to track usage of commands such asdscacheutil -q group.Note: Event IDs are for Sysmon (Event ID 10 - process access) and Windows Security Log (Event ID 4688 - a new process has been created).Analytic 1 - Local Permission Group Discovery - Net(source="WinEventLog:Microsoft-Windows-Sysmon/Operational" EventCode="1") OR (source="WinEventLog:Security" EventCode="4688") (Image= "net.exe" OR Image= "net1.exe") AND CommandLine="group/domain*")ReferencesBrian Donohue, Katie Nickels, Paul Michaud, Adina Bodkins, Taylor Chapman, Tony Lambert, Jeff Felling, Kyle Rainey, Mike Haag, Matt Graeber, Aaron Didier.. (2020, October 29). A Bazar start: How one hospital thwarted a Ryuk ransomware outbreak. Retrieved October 30, 2020.McKeague, B. et al. (2019, April 5). Pick-Six: Intercepting a FIN6 Intrusion, an Actor Recently Tied to Ryuk and LockerGoga Ransomware. Retrieved April 17, 2019.Goody, K., et al (2019, January 11). A Nasty Trick: From Credential Theft Malware to Business Disruption. Retrieved May 12, 2020.Kamble, V. (2022, June 28). Bumblebee: New Loader Rapidly Assuming Central Position in Cyber-crime Ecosystem. Retrieved August 24, 2022.Vrabie, V., et al. (2021, March 10). FIN8 Returns with Improved BADHATCH Toolkit. Retrieved September 8, 2021.Microsoft Defender Threat Intelligence. (2022, June 13). The many lives of BlackCat ransomware. Retrieved December 20, 2022.Red Team Labs. (2018, April 24). Hidden Administrative Accounts: BloodHound to the Rescue. Retrieved October 28, 2020.Kenefick, I. et al. (2022, October 12). Black Basta Ransomware Gang Infiltrates Networks via QAKBOT, Brute Ratel, and Cobalt Strike. Retrieved February 6, 2023.DFIR Report. (2021, November 29). CONTInuing the Bazar Ransomware Story. Retrieved September 29, 2022.Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.byt3bl33d3r. (2018, September 8). SMB: Command Reference. Retrieved July 17, 2020.US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.Microsoft. (n.d.). Dsquery. Retrieved April 18, 2016.Rufus Brown, Van Ta, Douglas Bienstock, Geoff Ackerman, John Wolfram. (2022, March 8). Does This Look Infected? A Summary of APT41 Targeting U.S. State Governments. Retrieved July 8, 2022.Bichet, J. (2020, November 12). Egregor – Prolock: Fraternal Twins ?. Retrieved January 6, 2021.Abdo, B., et al. (2022, April 4). FIN7 Power Hour: Adversary Archaeology and the Evolution of FIN7. Retrieved April 5, 2022.Namestnikov, Y. and Aime, F. (2019, May 8). FIN7.5: the infamous cybercrime rig “FIN7” continues its activities. Retrieved October 11, 2019.Unit 42. (2017, December 15). Unit 42 Playbook Viewer. Retrieved December 20, 2017.Symantec. (2018, March 14). Inception Framework: Alive and Well, and Hiding Behind Proxies. Retrieved May 8, 2020.Villeneuve, N., Bennett, J. T., Moran, N., Haq, T., Scott, M., & Geers, K. (2014). OPERATION “KE3CHANG”: Targeted Attacks Against Ministries of Foreign Affairs. Retrieved November 12, 2014.Symantec Security Response Attack Investigation Team. (2018, April 23). New Orangeworm attack group targets the healthcare sector in the U.S., Europe, and Asia. Retrieved May 8, 2018.MSTIC, DART, M365 Defender. (2022, March 24). DEV-0537 Criminal Actor Targeting Organizations for Data Exfiltration and Destruction. Retrieved May 17, 2022.Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015.Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.Symantec Security Response. (2016, September 6). Buckeye cyberespionage group shifts gaze from US to Hong Kong. Retrieved September 26, 2016.Sardiwal, M, et al. (2017, December 7). New Targeted Attack in the Middle East by APT34, a Suspected Iranian Threat Group, Using CVE-2017-11882 Exploit. Retrieved December 20, 2017.Mamedov, O, et al. (2019, July 3). Sodin ransomware exploits Windows vulnerability and processor architecture. Retrieved August 4, 2020.McAfee. (2019, October 2). McAfee ATR Analyzes Sodinokibi aka REvil Ransomware-as-a-Service – What The Code Tells Us. Retrieved August 4, 2020.Counter Threat Unit Research Team. (2019, September 24). REvil/Sodinokibi Ransomware. Retrieved August 4, 2020.Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.CrowdStrike. (2022, January 27). Early Bird Catches the Wormhole: Observations from the StellarParticle Campaign. Retrieved February 7, 2022.CISA. (2020, July 16). MAR-10296782-1.v1 – SOREFANG. Retrieved September 29, 2020.Dedola, G. et al. (2023, October 12). ToddyCat: Keep calm and check logs. Retrieved January 3, 2024.Faou, M. (2020, May). From Agent.btz to ComRAT v4: A ten-year journey. Retrieved June 15, 2020.Counter Threat Unit Research Team. (2023, May 24). Chinese Cyberespionage Group BRONZE SILHOUETTE Targets U.S. Government and Defense Organizations. Retrieved July 27, 2023.CISA. (2020, July 16). MAR-10296782-2.v1 – WELLMESS. Retrieved September 24, 2020.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.