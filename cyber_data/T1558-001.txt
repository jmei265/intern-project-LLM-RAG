MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseSteal or Forge Kerberos TicketsGolden TicketSteal or Forge Kerberos Tickets:Golden TicketOther sub-techniques of Steal or Forge Kerberos Tickets (4)IDNameT1558.001Golden TicketT1558.002Silver TicketT1558.003KerberoastingT1558.004AS-REP RoastingAdversaries who have the KRBTGT account password hash may forge Kerberos ticket-granting tickets (TGT), also known as a golden ticket.[1]Golden tickets enable adversaries to generate authentication material for any account in Active Directory.[2]Using a golden ticket, adversaries are then able to request ticket granting service (TGS) tickets, which enable access to specific resources. Golden tickets require adversaries to interact with the Key Distribution Center (KDC) in order to obtain TGS.[3]The KDC service runs all on domain controllers that are part of an Active Directory domain. KRBTGT is the Kerberos Key Distribution Center (KDC) service account and is responsible for encrypting and signing all Kerberos tickets.[4]The KRBTGT password hash may be obtained usingOS Credential Dumpingand privileged access to a domain controller.ID:T1558.001Sub-technique of:T1558ⓘTactic:Credential AccessⓘPlatforms:WindowsⓘPermissions Required:UserContributors:Itamar Mizrahi, CymptomVersion:1.1Created:11 February 2020Last Modified:05 November 2020Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0363EmpireEmpirecan leverage its implementation ofMimikatzto obtain and use golden tickets.[5]G0004Ke3changKe3changhas usedMimikatzto generate Kerberos golden tickets.[6]S0002MimikatzMimikatz's kerberos module can create golden tickets.[7][8]S1071RubeusRubeuscan forge a ticket-granting ticket.[9]MitigationsIDMitigationDescriptionM1015Active Directory ConfigurationFor containing the impact of a previously generated golden ticket, reset the built-in KRBTGT account password twice, which will invalidate any existing golden tickets that have been created with the KRBTGT hash and other Kerberos tickets derived from it. For each domain, change the KRBTGT account password once, force replication, and then change the password a second time. Consider rotating the KRBTGT account password every 180 days.[10]M1026Privileged Account ManagementLimit domain admin account permissions to domain controllers and limited servers. Delegate other admin functions to separate accounts.DetectionIDData SourceData ComponentDetectsDS0026Active DirectoryActive Directory Credential RequestMonitor for anomalous Kerberos activity, such as malformed or blank fields in Windows logon/logoff events (Event ID 4769, 4768), RC4 encryption within TGTs, and TGS requests without preceding TGT requests. Monitor the lifetime of TGT tickets for values that differ from the default domain duration. Monitor for indications of Pass the Ticket being used to move laterally.DS0028Logon SessionLogon Session MetadataMonitor for anomalous Kerberos activity, such as malformed or blank fields in Windows logon/logoff events (Event ID 4624, 4634, 4672). Correlate other security systems with login information (e.g., a user has the KRBTGT account password hash and forges Kerberos ticket-granting tickets).ReferencesMetcalf, S. (2015, August 7). Kerberos Golden Tickets are Now More Golden. Retrieved December 1, 2017.Abolins, D., Boldea, C., Socha, K., Soria-Machado, M. (2016, April 26). Kerberos Golden Ticket Protection. Retrieved July 13, 2017.Metcalf, S. (2015, May 03). Detecting Forged Kerberos Ticket (Golden Ticket & Silver Ticket) Use in Active Directory. Retrieved December 23, 2015.Sean Metcalf. (2014, November 10). Kerberos & KRBTGT: Active Directory’s Domain Kerberos Service Account. Retrieved January 30, 2020.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.Smallridge, R. (2018, March 10). APT15 is alive and strong: An analysis of RoyalCli and RoyalDNS. Retrieved April 4, 2018.Deply, B., Le Toux, V.. (2016, June 5). module ~ kerberos. Retrieved March 17, 2020.Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.Harmj0y. (n.d.). Rubeus. Retrieved March 29, 2023.UCF. (n.d.). The password for the krbtgt account on a domain must be reset at least every 180 days. Retrieved November 5, 2020.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.