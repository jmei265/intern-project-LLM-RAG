MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseInput CaptureCredential API HookingInput Capture:Credential API HookingOther sub-techniques of Input Capture (4)IDNameT1056.001KeyloggingT1056.002GUI Input CaptureT1056.003Web Portal CaptureT1056.004Credential API HookingAdversaries may hook into Windows application programming interface (API) functions to collect user credentials. Malicious hooking mechanisms may capture API calls that include parameters that reveal user authentication credentials.[1]UnlikeKeylogging,  this technique focuses specifically on API functions that include parameters that reveal user credentials. Hooking involves redirecting calls to these functions and can be implemented via:Hooks procedures, which intercept and execute designated code in response to events such as messages, keystrokes, and mouse inputs.[2][3]Import address table (IAT) hooking, which use modifications to a process’s IAT, where pointers to imported API functions are stored.[3][4][5]Inline hooking, which overwrites the first bytes in an API function to redirect code flow.[3][6][5]ID:T1056.004Sub-technique of:T1056ⓘTactics:Collection,Credential AccessⓘPlatforms:WindowsⓘPermissions Required:Administrator, SYSTEMVersion:1.0Created:11 February 2020Last Modified:10 November 2020Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0484CarberpCarberphas hooked several Windows API functions to steal credentials.[7]S0363EmpireEmpirecontains some modules that leverage API hooking to carry out tasks, such as netripper.[8]S0182FinFisherFinFisherhooks processes by modifying IAT pointers to CreateWindowEx.[9][3]S0353NOKKINOKKIuses the Windows call SetWindowsHookEx and begins injecting it into every GUI process running on the victim's machine.[10]G0068PLATINUMPLATINUMis capable of using Windows hook interfaces for information gathering such as credential access.[11]S0416RDFSNIFFERRDFSNIFFERhooks several Win32 API functions to hijack elements of the remote system management user-interface.[12]S0266TrickBotTrickBothas the ability to capture RDP credentials by capturing theCredEnumerateAAPI[13]S0386UrsnifUrsnifhas hooked APIs to perform a wide variety of information theft, such as monitoring traffic from browsers.[14]S0251ZebrocyZebrocyinstalls an application-defined Windows hook to get notified when a network drive has been attached, so it can then use the hook to call its RecordToFile file stealing method.[15]S0330Zeus PandaZeus Pandahooks processes by leveraging its own IAT hooked functions.[16]S0412ZxShellZxShellhooks several API functions to spawn system threads.[17]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0009ProcessOS API ExecutionMonitor for API calls to the SetWindowsHookEx and SetWinEventHook functions, which install a hook procedure.[2][18]Also consider analyzing hook chains (which hold pointers to hook procedures for each type of hook) using tools[18][19][20]or by programmatically examining internal kernel structures.[21][22]Process MetadataVerify integrity of live processes by comparing code in memory to that of corresponding static binaries, specifically checking for jumps and other instructions that redirect code flow.ReferencesMicrosoft. (2017, September 15). TrojanSpy:Win32/Ursnif.gen!I. Retrieved December 18, 2017.Microsoft. (n.d.). Hooks Overview. Retrieved December 12, 2017.Hosseini, A. (2017, July 18). Ten Process Injection Techniques: A Technical Survey Of Common And Trending Process Injection Techniques. Retrieved December 7, 2017.Tigzy. (2014, October 15). Userland Rootkits: Part 1, IAT hooks. Retrieved December 12, 2017.Hillman, M. (2015, August 8). Dynamic Hooking Techniques: User Mode. Retrieved December 20, 2017.Mariani, B. (2011, September 6). Inline Hooking in Windows. Retrieved December 12, 2017.Giuliani, M., Allievi, A. (2011, February 28). Carberp - a modular information stealing trojan. Retrieved July 15, 2020.Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.FinFisher. (n.d.). Retrieved December 20, 2017.Grunzweig, J., Lee, B. (2018, September 27). New KONNI Malware attacking Eurasia and Southeast Asia. Retrieved November 5, 2018.Windows Defender Advanced Threat Hunting Team. (2016, April 29). PLATINUM: Targeted attacks in South and Southeast Asia. Retrieved February 15, 2018.Carr, N, et all. (2019, October 10). Mahalo FIN7: Responding to the Criminal Operators’ New Tools and Techniques. Retrieved October 11, 2019.Llimos, N., Pascual, C.. (2019, February 12). Trickbot Adds Remote Application Credential-Grabbing Capabilities to Its Repertoire. Retrieved March 12, 2019.Caragay, R. (2015, March 26). URSNIF: The Multifaceted Malware. Retrieved June 5, 2019.Kaspersky Lab's Global Research & Analysis Team. (2018, February 20). A Slice of 2017 Sofacy Activity. Retrieved November 27, 2018.Ebach, L. (2017, June 22). Analysis Results of Zeus.Variant.Panda. Retrieved November 5, 2018.Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.Volatility Labs. (2012, September 24). MoVP 3.1 Detecting Malware Hooks in the Windows GUI Subsystem. Retrieved December 12, 2017.Prekas, G. (2011, July 11). Winhook. Retrieved December 12, 2017.Satiro, J. (2011, September 14). GetHooks. Retrieved December 12, 2017.Felici, M. (2006, December 6). Any application-defined hook procedure on my machine?. Retrieved December 12, 2017.Eye of Ra. (2017, June 27). Windows Keylogger Part 2: Defense against user-land. Retrieved December 12, 2017.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.