MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseDrive-by CompromiseDrive-by CompromiseAdversaries may gain access to a system through a user visiting a website over the normal course of browsing. With this technique, the user's web browser is typically targeted for exploitation, but adversaries may also use compromised websites for non-exploitation behavior such as acquiringApplication Access Token.Multiple ways of delivering exploit code to a browser exist (i.e.,Drive-by Target), including:A legitimate website is compromised where adversaries have injected some form of malicious code such as JavaScript, iFrames, and cross-site scriptingScript files served to a legitimate website from a publicly writeable cloud storage bucket are modified by an adversaryMalicious ads are paid for and served through legitimate ad providers (i.e.,Malvertising)Built-in web application interfaces are leveraged for the insertion of any other kind of object that can be used to display web content or contain a script that executes on the visiting client (e.g. forum posts, comments, and other user controllable web content).Often the website used by an adversary is one visited by a specific community, such as government, a particular industry, or region, where the goal is to compromise a specific user or set of users based on a shared interest. This kind of targeted campaign is often referred to a strategic web compromise or watering hole attack. There are several known examples of this occurring.[1]Typical drive-by compromise process:A user visits a website that is used to host the adversary controlled content.Scripts automatically execute, typically searching versions of the browser and plugins for a potentially vulnerable version.The user may be required to assist in this process by enabling scripting or active website components and ignoring warning dialog boxes.Upon finding a vulnerable version, exploit code is delivered to the browser.If exploitation is successful, then it will give the adversary code execution on the user's system unless other protections are in place.In some cases a second visit to the website after the initial scan is required before exploit code is delivered.UnlikeExploit Public-Facing Application, the focus of this technique is to exploit software on a client endpoint upon visiting a website. This will commonly give an adversary access to systems on the internal network instead of external systems that may be in a DMZ.Adversaries may also use compromised websites to deliver a user to a malicious application designed toSteal Application Access Tokens, like OAuth tokens, to gain access to protected applications and information. These malicious applications have been delivered through popups on legitimate websites.[2]ID:T1189Sub-techniques:No sub-techniquesⓘTactic:Initial AccessⓘPlatforms:Linux, SaaS, Windows, macOSContributors:Jeff Sakowicz, Microsoft Identity Developer Platform Services (IDPM Services); Saisha Agrawal, Microsoft Threat Intelligent Center (MSTIC)Version:1.5Created:18 April 2018Last Modified:14 April 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0138AndarielAndarielhas used watering hole attacks, often with zero-day exploits, to gain initial access to victims within a specific IP range.[3][4]G0073APT19APT19performed a watering hole attack on forbes.com in 2014 to compromise targets.[5]G0007APT28APT28has compromised targets via strategic web compromise utilizing custom exploit kits.[6]APT28used reflected cross-site scripting (XSS) against government websites to redirect users to phishing webpages.[7]G0050APT32APT32has infected victims by tricking them into visiting compromised watering hole websites.[8][9]G0067APT37APT37has used strategic web compromises, particularly of South Korean websites, to distribute malware. The group has also used torrent file-sharing sites to more indiscriminately disseminate malware to victims. As part of their compromises, the group has used a Javascript based profiler called RICECURRY to profile a victim's web browser and deliver malicious code accordingly.[10][11][12]G0082APT38APT38has conducted watering holes schemes to gain initial access to victims.[13][14]G0001AxiomAxiomhas used watering hole attacks to gain access.[15]S0606Bad RabbitBad Rabbitspread through watering holes on popular sites by injecting JavaScript into the HTML body or a.jsfile.[16][17]G0060BRONZE BUTLERBRONZE BUTLERcompromised three Japanese websites using a Flash exploit to perform watering hole attacks.[18]S0482BundloreBundlorehas been spread through malicious advertisements on websites.[19]C0010C0010DuringC0010, UNC3890 actors likely established a watering hole that was hosted on a login page of a legitimate Israeli shipping company that was active until at least November 2021.[20]G0070Dark CaracalDark Caracalleveraged a watering hole to serve up malicious code.[21]G0012DarkhotelDarkhotelused embedded iframes on hotel login portals to redirect selected victims to download malware.[22]G0035DragonflyDragonflyhas compromised targets via strategic web compromise (SWC) utilizing a custom exploit kit.[23][24][25]G1006Earth LuscaEarth Luscahas performed watering hole attacks.[26]G0066ElderwoodElderwoodhas delivered zero-day exploits and malware to victims by injecting malicious code into specific public Web pages visited by targets within a particular sector.[27][28][29]S0531GrandoreiroGrandoreirohas used compromised websites and Google Ads to bait victims into downloading its installer.[30][31]S0215KARAEKARAEwas distributed through torrent file-sharing websites to South Korean victims, using a YouTube video downloader application as a lure.[11]G0032Lazarus GroupLazarus GroupdeliveredRATANKBAand other malicious code to victims via a compromised legitimate website.[32][33]G0077LeafminerLeafminerhas infected victims using watering holes.[34]G0065LeviathanLeviathanhas infected victims using watering holes.[35]S0451LoudMinerLoudMineris typically bundled with pirated copies of Virtual Studio Technology (VST) for Windows and macOS.[36]G0095MacheteMachetehas distributedMachetethrough a fake blog website.[37]G0059Magic HoundMagic Houndhas conducted watering-hole attacks through media and magazine websites.[38]G1020Mustard TempestMustard Tempesthas used drive-by downloads for initial infection, often using fake browser updates as a lure.[39][40][41][42]C0016Operation Dust StormDuringOperation Dust Storm, the threat actors used a watering hole attack on a popular software reseller to exploit the then-zero-day Internet Explorer vulnerability CVE-2014-0322.[43]G0040PatchworkPatchworkhas used watering holes to deliver files with exploits to initial victims.[44][45]G0068PLATINUMPLATINUMhas sometimes used drive-by attacks against vulnerable browser plugins.[46]S0216POORAIMPOORAIMhas been delivered through compromised sites acting as watering holes.[11]G0056PROMETHIUMPROMETHIUMhas used watering hole attacks to deliver malicious versions of legitimate installers.[47]S0496REvilREvilhas infected victim machines through compromised websites and exploit kits.[48][49][50][51]G0048RTMRTMhas distributed its malware via the RIG and SUNDOWN exploit kits, as well as online advertising networkYandex.Direct.[52][53]S1086Snip3Snip3has been delivered to targets via downloads from malicious domains.[54]S1124SocGholishSocGholishhas been distributed through compromised websites with malicious content often masquerading as browser updates.[39]G0027Threat Group-3390Threat Group-3390has extensively used strategic web compromises to target victims.[55][56]G0134Transparent TribeTransparent Tribehas used websites with malicious hyperlinks and iframes to infect targeted victims withCrimson,njRAT, and other malicious tools.[57][58][59]G0010TurlaTurlahas infected victims using watering holes.[60][61]G0124WindigoWindigohas distributed Windows malware via drive-by downloads.[62]G0112WindshiftWindshifthas used compromised websites to register custom URL schemes on a remote system.[63]MitigationsIDMitigationDescriptionM1048Application Isolation and SandboxingBrowser sandboxes can be used to mitigate some of the impact of exploitation, but sandbox escapes may still exist.[64][65]Other types of virtualization and application microsegmentation may also mitigate the impact of client-side exploitation. The risks of additional exploits and weaknesses in implementation may still exist for these types of systems.[65]M1050Exploit ProtectionSecurity applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior.[66]Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring.[67]Many of these protections depend on the architecture and target application binary for compatibility.M1021Restrict Web-Based ContentFor malicious code served up through ads, adblockers can help prevent that code from executing in the first place.Script blocking extensions can help prevent the execution of JavaScript that may commonly be used during the exploitation process.M1051Update SoftwareEnsure all browsers and plugins kept updated can help prevent the exploit phase of this technique. Use modern browsers with security features turned on.DetectionIDData SourceData ComponentDetectsDS0015Application LogApplication Log ContentFirewalls and proxies can inspect URLs for potentially known-bad domains or parameters. They can also do reputation-based analytics on websites and their requested resources such as how old a domain is, who it's registered to, if it's on a known bad list, or how many other users have connected to it before.DS0022FileFile CreationMonitor for newly constructed files written to disk to gain access to a system through a user visiting a website over the normal course of browsing.DS0029Network TrafficNetwork Connection CreationMonitor for newly constructed network connections to untrusted hosts that are used to send or receive data.Network Traffic ContentMonitor for other unusual network traffic that may indicate additional tools transferred to the system. Use  network intrusion detection systems, sometimes with SSL/TLS inspection, to look for known malicious scripts (recon, heap spray, and browser identification scripts have been frequently reused), common script obfuscation, and exploit code.DS0009ProcessProcess CreationLook for behaviors on the endpoint system that might indicate successful compromise, such as abnormal behaviors of browser processes. This could include suspicious files written to disk, evidence ofProcess Injectionfor attempts to hide execution, or evidence of Discovery.ReferencesAdair, S., Moran, N. (2012, May 15). Cyber Espionage & Strategic Web Compromises – Trusted Websites Serving Dangerous Results. Retrieved March 13, 2018.Lassalle, D., et al. (2017, November 6). OceanLotus Blossoms: Mass Digital Surveillance and Attacks Targeting ASEAN, Asian Nations, the Media, Human Rights Groups, and Civil Society. Retrieved November 6, 2017.AhnLab. (2018, June 23). Targeted attacks by Andariel Threat Group,  a subgroup of the Lazarus. Retrieved September 29, 2021.Chen, Joseph. (2018, July 16). New Andariel Reconnaissance Tactics Uncovered. Retrieved September 29, 2021.Grunzweig, J., Lee, B. (2016, January 22). New Attacks Linked to C0d0so0 Group. Retrieved August 2, 2018.Secureworks CTU. (2017, March 30). IRON TWILIGHT Supports Active Measures. Retrieved February 28, 2022.Billy Leonard. (2023, April 19). Ukraine remains Russia’s biggest cyber focus in 2023. Retrieved March 1, 2024.Foltýn, T. (2018, March 13). OceanLotus ships new backdoor using old tricks. Retrieved May 22, 2018.Adair, S. and Lancaster, T. (2020, November 6). OceanLotus: Extending Cyber Espionage Operations Through Fake Websites. Retrieved November 20, 2020.Raiu, C., and Ivanov, A. (2016, June 17). Operation Daybreak. Retrieved February 15, 2018.FireEye. (2018, February 20). APT37 (Reaper): The Overlooked North Korean Actor. Retrieved March 1, 2018.Cash, D., Grunzweig, J., Meltzer, M., Adair, S., Lancaster, T. (2021, August 17). North Korean APT InkySquid Infects Victims Using Browser Exploits. Retrieved September 30, 2021.FireEye. (2018, October 03). APT38: Un-usual Suspects. Retrieved November 6, 2018.DHS/CISA. (2020, August 26). FASTCash 2.0: North Korea's BeagleBoyz Robbing Banks. Retrieved September 29, 2021.Esler, J., Lee, M., and Williams, C. (2014, October 14). Threat Spotlight: Group 72. Retrieved January 14, 2016.M.Léveille, M-E.. (2017, October 24). Bad Rabbit: Not‑Petya is back with improved ransomware. Retrieved January 28, 2021.Mamedov, O. Sinitsyn, F.  Ivanov, A.. (2017, October 24). Bad Rabbit ransomware. Retrieved January 28, 2021.DiMaggio, J. (2016, April 28). Tick cyberespionage group zeros in on Japan. Retrieved July 16, 2018.Sushko, O. (2019, April 17). macOS Bundlore: Mac Virus Bypassing macOS Security Features. Retrieved June 30, 2020.Mandiant Israel Research Team. (2022, August 17). Suspected Iranian Actor Targeting Israeli Shipping, Healthcare, Government and Energy Sectors. Retrieved September 21, 2022.Blaich, A., et al. (2018, January 18). Dark Caracal: Cyber-espionage at a Global Scale. Retrieved April 11, 2018.Kaspersky Lab's Global Research and Analysis Team. (2014, November). The Darkhotel APT A Story of Unusual Hospitality. Retrieved November 12, 2014.Secureworks. (2019, July 24). Resurgent Iron Liberty Targeting Energy Sector. Retrieved August 12, 2020.US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.Slowik, J. (2021, October). THE BAFFLING BERSERK BEAR: A DECADE’S ACTIVITY TARGETING CRITICAL INFRASTRUCTURE. Retrieved December 6, 2021.Chen, J., et al. (2022). Delving Deep: An Analysis of Earth Lusca’s Operations. Retrieved July 1, 2022.O'Gorman, G., and McDonald, G.. (2012, September 6). The Elderwood Project. Retrieved February 15, 2018.Clayton, M.. (2012, September 14). Stealing US business secrets: Experts ID two huge cyber 'gangs' in China. Retrieved February 15, 2018.Paganini, P. (2012, September 9). Elderwood project, who is behind Op. Aurora and ongoing attacks?. Retrieved February 13, 2018.GReAT. (2020, July 14). The Tetrade: Brazilian banking malware goes global. Retrieved November 9, 2020.Abramov, D. (2020, April 13). Grandoreiro Malware Now Targeting Banks in Spain. Retrieved November 12, 2020.Trend Micro. (2017, February 27). RATANKBA: Delving into Large-scale Watering Holes against Enterprises. Retrieved May 22, 2018.Weidemann, A. (2021, January 25). New campaign targeting security researchers. Retrieved December 20, 2021.Symantec Security Response. (2018, July 25). Leafminer: New Espionage Campaigns Targeting Middle Eastern Regions. Retrieved August 28, 2018.CISA. (2021, July 19). (AA21-200A) Joint Cybersecurity Advisory – Tactics, Techniques, and Procedures of Indicted APT40 Actors Associated with China’s MSS Hainan State Security Department. Retrieved August 12, 2021.Malik, M. (2019, June 20). LoudMiner: Cross-platform mining in cracked VST software. Retrieved May 18, 2020.Kaspersky Global Research and Analysis Team. (2014, August 20). El Machete. Retrieved September 13, 2019.ClearSky Research Team. (2020, August 1). The Kittens Are Back in Town 3 - Charming Kitten Campaign Evolved and Deploying Spear-Phishing link by WhatsApp. Retrieved April 21, 2021.Andrew Northern. (2022, November 22). SocGholish, a very real threat from a very fake update. Retrieved February 13, 2024.Milenkoski, A. (2022, November 7). SocGholish Diversifies and Expands Its Malware Staging Infrastructure to Counter Defenders. Retrieved March 22, 2024.Red Canary. (2024, March). Red Canary 2024 Threat Detection Report: SocGholish. Retrieved March 22, 2024.Secureworks. (n.d.). GOLD PRELUDE . Retrieved March 22, 2024.Gross, J. (2016, February 23). Operation Dust Storm. Retrieved December 22, 2021.Hamada, J.. (2016, July 25). Patchwork cyberespionage group expands targets from governments to wide range of industries. Retrieved August 17, 2016.Meltzer, M, et al. (2018, June 07). Patchwork APT Group Targets US Think Tanks. Retrieved July 16, 2018.Windows Defender Advanced Threat Hunting Team. (2016, April 29). PLATINUM: Targeted attacks in South and Southeast Asia. Retrieved February 15, 2018.Tudorica, R. et al. (2020, June 30). StrongPity APT - Revealing Trojanized Tools, Working Hours and Infrastructure. Retrieved July 20, 2020.Counter Threat Unit Research Team. (2019, September 24). REvil/Sodinokibi Ransomware. Retrieved August 4, 2020.McAfee. (2019, October 2). McAfee ATR Analyzes Sodinokibi aka REvil Ransomware-as-a-Service – What The Code Tells Us. Retrieved August 4, 2020.Ozarslan, S. (2020, January 15). A Brief History of Sodinokibi. Retrieved August 5, 2020.Secureworks . (2019, September 24). REvil: The GandCrab Connection. Retrieved August 4, 2020.Faou, M. and Boutin, J. (2017, February). Read The Manual: A Guide to the RTM Banking Trojan. Retrieved March 9, 2017.ESET Research. (2019, April 30). Buhtrap backdoor and Buran ransomware distributed via major advertising platform. Retrieved May 11, 2020.Jornet, A. (2021, December 23). Snip3, an investigation into malware. Retrieved September 19, 2023.Dell SecureWorks Counter Threat Unit Threat Intelligence. (2015, August 5). Threat Group-3390 Targets Organizations for Cyberespionage. Retrieved August 18, 2018.Legezo, D. (2018, June 13). LuckyMouse hits national data center to organize country-level waterholing campaign. Retrieved August 18, 2018.Huss, D. (2016, March 1). Operation Transparent Tribe. Retrieved June 8, 2016.Falcone, R. and Conant S. (2016, March 25). ProjectM: Link Found Between Pakistani Actor and Operation Transparent Tribe. Retrieved September 2, 2021.Malhotra, A. et al. (2021, May 13). Transparent Tribe APT expands its Windows malware arsenal. Retrieved September 2, 2021.Faou, M. (2020, May). From Agent.btz to ComRAT v4: A ten-year journey. Retrieved June 15, 2020.Secureworks CTU. (n.d.). IRON HUNTER. Retrieved February 22, 2022.Bilodeau, O., Bureau, M., Calvet, J., Dorais-Joncas, A., Léveillé, M., Vanheuverzwijn, B. (2014, March 18). Operation Windigo – the vivisection of a large Linux server‑side credential‑stealing malware campaign. Retrieved February 10, 2021.Wardle, Patrick. (2018, December 20). Middle East Cyber-Espionage analyzing WindShift's implant: OSX.WindTail (part 1). Retrieved October 3, 2019.Cowan, C. (2017, March 23). Strengthening the Microsoft Edge Sandbox. Retrieved March 12, 2018.Goodin, D. (2017, March 17). Virtual machine escape fetches $105,000 at Pwn2Own hacking contest - updated. Retrieved March 12, 2018.Nunez, N. (2017, August 9). Moving Beyond EMET II – Windows Defender Exploit Guard. Retrieved March 12, 2018.Wikipedia. (2018, January 11). Control-flow integrity. Retrieved March 12, 2018.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.