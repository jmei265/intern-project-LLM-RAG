MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseBoot or Logon Autostart ExecutionPort MonitorsBoot or Logon Autostart Execution:Port MonitorsOther sub-techniques of Boot or Logon Autostart Execution (14)IDNameT1547.001Registry Run Keys / Startup FolderT1547.002Authentication PackageT1547.003Time ProvidersT1547.004Winlogon Helper DLLT1547.005Security Support ProviderT1547.006Kernel Modules and ExtensionsT1547.007Re-opened ApplicationsT1547.008LSASS DriverT1547.009Shortcut ModificationT1547.010Port MonitorsT1547.012Print ProcessorsT1547.013XDG Autostart EntriesT1547.014Active SetupT1547.015Login ItemsAdversaries may use port monitors to run an adversary supplied DLL during system boot for persistence or privilege escalation. A port monitor can be set through theAddMonitorAPI call to set a DLL to be loaded at startup.[1]This DLL can be located inC:\Windows\System32and will be loaded and run by the print spooler service,spoolsv.exe, under SYSTEM level permissions on boot.[2]Alternatively, an arbitrary DLL can be loaded if permissions allow writing a fully-qualified pathname for that DLL to theDrivervalue of an existing or new arbitrarily named subkey ofHKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors. The Registry key contains entries for the following:Local PortStandard TCP/IP PortUSB MonitorWSD PortID:T1547.010Sub-technique of:T1547ⓘTactics:Persistence,Privilege EscalationⓘPlatforms:WindowsⓘPermissions Required:Administrator, SYSTEMⓘEffective Permissions:SYSTEMContributors:Harun Küßner; Stefan Kanthak; Travis Smith, TripwireVersion:1.2Created:24 January 2020Last Modified:12 April 2024Version PermalinkLive VersionMitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0022FileFile CreationMonitor newly constructed files that may use port monitors to run an attacker supplied DLL during system boot for persistence or privilege escalation.DS0011ModuleModule LoadMonitor DLLs that are loaded by spoolsv.exe for DLLs that are abnormal. New DLLs written to the System32 directory that do not correlate with known good software or patching may be suspicious.DS0009ProcessOS API ExecutionMonitor process API calls toAddMonitor.[1]DS0024Windows RegistryWindows Registry Key ModificationMonitor Registry writes toHKLM\SYSTEM\CurrentControlSet\Control\Print\Monitors. Run the Autoruns utility, which checks for this Registry key as a persistence mechanism[3]ReferencesMicrosoft. (n.d.). AddMonitor function. Retrieved November 12, 2014.Bloxham, B. (n.d.). Getting Windows to Play with Itself [PowerPoint slides]. Retrieved November 12, 2014.Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.