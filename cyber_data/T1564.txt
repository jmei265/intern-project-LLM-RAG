MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseHide ArtifactsHide ArtifactsSub-techniques (12)IDNameT1564.001Hidden Files and DirectoriesT1564.002Hidden UsersT1564.003Hidden WindowT1564.004NTFS File AttributesT1564.005Hidden File SystemT1564.006Run Virtual InstanceT1564.007VBA StompingT1564.008Email Hiding RulesT1564.009Resource ForkingT1564.010Process Argument SpoofingT1564.011Ignore Process InterruptsT1564.012File/Path ExclusionsAdversaries may attempt to hide artifacts associated with their behaviors to evade detection. Operating systems may have features to hide various artifacts, such as important system files and administrative task execution, to avoid disrupting user work environments and prevent users from changing files or features on the system. Adversaries may abuse these features to hide artifacts such as files, directories, user accounts, or other system activity to evade detection.[1][2][3]Adversaries may also attempt to hide artifacts associated with malicious behavior by creating computing regions that are isolated from common security instrumentation, such as through the use of virtualization technology.[4]ID:T1564Sub-techniques:T1564.001,T1564.002,T1564.003,T1564.004,T1564.005,T1564.006,T1564.007,T1564.008,T1564.009,T1564.010,T1564.011,T1564.012ⓘTactic:Defense EvasionⓘPlatforms:Linux, Office 365, Windows, macOSVersion:1.2Created:26 February 2020Last Modified:29 March 2024Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0482BundloreBundloreuses themktemputility to make unique file and directory names for payloads, such asTMP_DIR=`mktemp -d -t x.[5]S1066DarkTortillaDarkTortillahas used%HiddenReg%and%HiddenKey%as part of its persistence via the Windows registry.[6]S0402OSX/ShlayerOSX/Shlayerhas used themktemputility to make random and unique filenames for payloads, such asexport tmpDir="$(mktemp -d /tmp/XXXXXXXXXXXX)"ormktemp -t Installer.[7][5][8]S1011TarraskTarraskis able to create "hidden" scheduled tasks by deleting the Security Descriptor (SD) registry value.[9]S0670WarzoneRATWarzoneRATcan masquerade the Process Environment Block on a compromised host to hide it's attempts to elevate privileges throughIFileOperation.[10]MitigationsIDMitigationDescriptionM1049Antivirus/AntimalwareReview and audit file/folder exclusions, and limit scope of exclusions to only what is required where possible.[11]M1013Application Developer GuidanceApplication developers should consider limiting the requirements for custom or otherwise difficult to manage file/folder exclusions. Where possible, install applications to trusted system folder paths that are already protected by restricted file and directory permissions.M1033Limit Software InstallationRestrict the installation of software that may be abused to create hidden desktops, such as hVNC, to user groups that require it.DetectionIDData SourceData ComponentDetectsDS0015Application LogApplication Log ContentMonitor for third-party application logging, messaging, and/or other artifacts that may attempt to hide artifacts associated with their behaviors to evade detection.DS0017CommandCommand ExecutionMonitor executed commands and arguments that may attempt to hide artifacts associated with their behaviors to evade detection.DS0022FileFile CreationMonitor for newly constructed files that may attempt to hide artifacts associated with their behaviors to evade detection.File MetadataMonitor for contextual data about a file, which may include information such as name, the content (ex: signature, headers, or data/media), user/owner, permissions that may attempt to hide artifacts associated with their behaviors to evade detection.File ModificationMonitor for changes made to files that may attempt to hide artifacts associated with their behaviors to evade detection.DS0001FirmwareFirmware ModificationMonitor for changes made to firewall rules for unexpected modifications to allow/block specific network traffic that may attempt to hide artifacts associated with their behaviors to evade detection.DS0009ProcessOS API ExecutionMonitor for API calls that may attempt to hide artifacts associated with their behaviors to evade detection.Process CreationMonitor newly executed processes that may attempt to hide artifacts associated with their behaviors to evade detection.DS0012ScriptScript ExecutionMonitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent.DS0019ServiceService CreationMonitor for newly constructed services/daemons that may attempt to hide artifacts associated with their behaviors to evade detection.DS0002User AccountUser Account CreationMonitor for newly constructed user accounts that may attempt to hide artifacts associated with their behaviors to evade detection.User Account MetadataMonitor for contextual data about an account, which may include a username, user ID, environmental data that may attempt to hide artifacts associated with their behaviors to evade detection.DS0024Windows RegistryWindows Registry Key ModificationMonitor for changes made to windows registry keys and/or values that may attempt to hide artifacts associated with their behaviors to evade detection.ReferencesDani Creus, Tyler Halfpop, Robert Falcone. (2016, September 26). Sofacy's 'Komplex' OS X Trojan. Retrieved July 8, 2017.Amit Serper. (2016). Cybereason Lab Analysis OSX.Pirrit. Retrieved December 10, 2021.Arntz, P. (2015, July 22). Introduction to Alternate Data Streams. Retrieved March 21, 2018.SophosLabs. (2020, May 21). Ragnar Locker ransomware deploys virtual machine to dodge security. Retrieved June 29, 2020.Phil Stokes. (2021, February 16). 20 Common Tools & Techniques Used by macOS Threat Actors & Malware. Retrieved August 23, 2021.Secureworks Counter Threat Unit Research Team. (2022, August 17). DarkTortilla Malware Analysis. Retrieved November 3, 2022.Phil Stokes. (2020, September 8). Coming Out of Your Shell: From Shlayer to ZShlayer. Retrieved September 13, 2021.Jaron Bradley. (2021, April 26). Shlayer malware abusing Gatekeeper bypass on macOS. Retrieved September 22, 2021.Microsoft Threat Intelligence Team & Detection and Response Team . (2022, April 12). Tarrask malware uses scheduled tasks for defense evasion. Retrieved June 1, 2022.Harakhavik, Y. (2020, February 3). Warzone: Behind the enemy lines. Retrieved December 17, 2021.Microsoft. (2024, February 27). Contextual file and folder exclusions. Retrieved March 29, 2024.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.