MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseHide ArtifactsHidden UsersHide Artifacts:Hidden UsersOther sub-techniques of Hide Artifacts (12)IDNameT1564.001Hidden Files and DirectoriesT1564.002Hidden UsersT1564.003Hidden WindowT1564.004NTFS File AttributesT1564.005Hidden File SystemT1564.006Run Virtual InstanceT1564.007VBA StompingT1564.008Email Hiding RulesT1564.009Resource ForkingT1564.010Process Argument SpoofingT1564.011Ignore Process InterruptsT1564.012File/Path ExclusionsAdversaries may use hidden users to hide the presence of user accounts they create or modify. Administrators may want to hide users when there are many user accounts on a given system or if they want to hide their administrative or other management accounts from other users.In macOS, adversaries can create or modify a user to be hidden through manipulating plist files, folder attributes, and user attributes. To prevent a user from being shown on the login screen and in System Preferences, adversaries can set the userID to be under 500 and set the key valueHide500UserstoTRUEin the/Library/Preferences/com.apple.loginwindowplist file.[1]Every user has a userID associated with it. When theHide500Userskey value is set toTRUE, users with a userID under 500 do not appear on the login screen and in System Preferences. Using the command line, adversaries can use thedsclutility to create hidden user accounts by setting theIsHiddenattribute to1. Adversaries can also hide a user’s home folder by changing thechflagsto hidden.[2]Adversaries may similarly hide user accounts in Windows. Adversaries can set theHKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserListRegistry key value to0for a specific user to prevent that user from being listed on the logon screen.[3][4]On Linux systems, adversaries may hide user accounts from the login screen, also referred to as the greeter. The method an adversary may use depends on which Display Manager the distribution is currently using. For example, on an Ubuntu system using the GNOME Display Manger (GDM), accounts may be hidden from the greeter using thegsettingscommand (ex:sudo -u gdm gsettings set org.gnome.login-screen disable-user-list true).[5]Display Managers are not anchored to specific distributions and may be changed by a user or adversary.ID:T1564.002Sub-technique of:T1564ⓘTactic:Defense EvasionⓘPlatforms:Linux, Windows, macOSContributors:Omkar GudhateVersion:1.2Created:13 March 2020Last Modified:19 April 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0035DragonflyDragonflyhas modified the Registry to hide created user accounts.[4]G0094KimsukyKimsukyhas runreg add ‘HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList’ /vto hide a newly created user.[6]S0649SMOKEDHAMSMOKEDHAMhas modified the Registry to hide created user accounts from the Windows logon screen.[3]MitigationsIDMitigationDescriptionM1028Operating System ConfigurationIf the computer is domain joined, then group policy can help restrict the ability to create or hide users. Similarly, preventing the modification of the/Library/Preferences/com.apple.loginwindowHide500Usersvalue will force all users to be visible.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that could be taken to add a new user and subsequently hide it from login screens.DS0022FileFile ModificationMonitor for changes made to files that may use hidden users to mask the presence of user accounts they create or modify. Monitor for changes made to the/Library/Preferences/com.apple.loginwindowplist file for unexpected modifications to theHide500Userskey value on macOS.[1]DS0009ProcessProcess CreationMonitor newly executed processes for actions that could be taken to add a new user and subsequently hide it from login screens.DS0002User AccountUser Account CreationMonitor for newly constructed user accounts, such as userIDs under 500 on macOS, that may mask the presence of user accounts they create or modify.User Account MetadataMonitor for contextual data about an account, which may include a username, user ID, environmental data that may mask the presence of user accounts they create or modify. On macOS, identify users with an userID under 500 and theHide500Userskey value in the/Library/Preferences/com.apple.loginwindowplist file set toTRUE.[1]DS0024Windows RegistryWindows Registry Key ModificationMonitor for changes made to windows registry key or values for unexpected modifications of theHKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserListkey.ReferencesAmit Serper. (2016). Cybereason Lab Analysis OSX.Pirrit. Retrieved December 10, 2021.Apple. (2020, November 30). Hide a user account in macOS. Retrieved December 10, 2021.FireEye. (2021, June 16). Smoking Out a DARKSIDE Affiliate’s Supply Chain Software Compromise. Retrieved September 22, 2021.US-CERT. (2018, March 16). Alert (TA18-074A): Russian Government Cyber Activity Targeting Energy and Other Critical Infrastructure Sectors. Retrieved June 6, 2018.Ji Mingkui. (2021, June 17). How to Hide All The User Accounts in Ubuntu 20.04, 21.04 Login Screen. Retrieved March 15, 2022.KISA. (n.d.). Phishing Target Reconnaissance and Attack Resource Analysis Operation Muzabi. Retrieved March 7, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.