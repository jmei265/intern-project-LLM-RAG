MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseBuild Image on HostBuild Image on HostAdversaries may build a container image directly on a host to bypass defenses that monitor for the retrieval of malicious images from a public registry. A remotebuildrequest may be sent to the Docker API that includes a Dockerfile that pulls a vanilla base image, such as alpine, from a public or local registry and then builds a custom image upon it.[1]An adversary may take advantage of thatbuildAPI to build a custom image on the host that includes malware downloaded from their C2 server, and then they may utilizeDeploy Containerusing that custom image.[2][3]If the base image is pulled from a public registry, defenses will likely not detect the image as malicious since it’s a vanilla image. If the base image already resides in a local registry, the pull may be considered even less suspicious since the image is already in the environment.ID:T1612Sub-techniques:No sub-techniquesⓘTactic:Defense EvasionⓘPlatforms:ContainersContributors:Assaf Morag, @MoragAssaf, Team Nautilus Aqua Security; Michael Katchinskiy, @michael64194968, Team Nautilus Aqua Security; Roi Kol, @roykol1, Team Nautilus Aqua Security; Vishwas Manral, McAfeeVersion:1.3Created:30 March 2021Last Modified:15 April 2023Version PermalinkLive VersionMitigationsIDMitigationDescriptionM1047AuditAudit images deployed within the environment to ensure they do not contain any malicious components.M1035Limit Access to Resource Over NetworkLimit communications with the container service to local Unix sockets or remote access via SSH. Require secure port access to communicate with the APIs over TLS by disabling unauthenticated access to the Docker API on port 2375. Instead, communicate with the Docker API over TLS on port 2376.[4]M1030Network SegmentationDeny direct remote access to internal systems through the use of network proxies, gateways, and firewalls.M1026Privileged Account ManagementEnsure containers are not running as root by default. In Kubernetes environments, consider defining Pod Security Standards that prevent pods from running privileged containers.[5]DetectionIDData SourceData ComponentDetectsDS0007ImageImage CreationMonitor for unexpected Docker image build requests to the Docker daemon on hosts in the environment.DS0029Network TrafficNetwork Connection CreationMonitor for established network communications with anomalous IPs that have never been seen before in the environment that may indicate the download of malicious code.Network Traffic ContentMonitor for network traffic associated with requests and/or downloads of container images, especially those that may be anomalous or known malicious.Network Traffic FlowMonitor for established network communications with anomalous IPs that have never been seen before in the environment that may indicate the download of malicious code.ReferencesDocker. ( null). Docker Engine API v1.41 Reference - Build an Image. Retrieved March 30, 2021.Assaf Morag. (2020, July 15). Threat Alert: Attackers Building Malicious Images on Your Hosts. Retrieved March 29, 2021.Team Nautilus. (2021, June). Attacks in the Wild on the Container Supply Chain and Infrastructure. Retrieved August 26, 2021.Docker. (n.d.). Protect the Docker Daemon Socket. Retrieved March 29, 2021.National Security Agency, Cybersecurity and Infrastructure Security Agency. (2022, March). Kubernetes Hardening Guide. Retrieved April 1, 2022.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.