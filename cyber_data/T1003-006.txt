MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseOS Credential DumpingDCSyncOS Credential Dumping:DCSyncOther sub-techniques of OS Credential Dumping (8)IDNameT1003.001LSASS MemoryT1003.002Security Account ManagerT1003.003NTDST1003.004LSA SecretsT1003.005Cached Domain CredentialsT1003.006DCSyncT1003.007Proc FilesystemT1003.008/etc/passwd and /etc/shadowAdversaries may attempt to access credentials and other sensitive information by abusing a Windows Domain Controller's application programming interface (API)[1][2][3][4]to simulate the replication process from a remote domain controller using a technique called DCSync.Members of the Administrators, Domain Admins, and Enterprise Admin groups or computer accounts on the domain controller are able to run DCSync to pull password data[5]from Active Directory, which may include current and historical hashes of potentially useful accounts such as KRBTGT and Administrators. The hashes can then in turn be used to create aGolden Ticketfor use inPass the Ticket[6]or change an account's password as noted inAccount Manipulation.[7]DCSync functionality has been included in the "lsadump" module inMimikatz.[8]Lsadump also includes NetSync, which performs DCSync over a legacy replication protocol.[9]ID:T1003.006Sub-technique of:T1003ⓘTactic:Credential AccessⓘPlatforms:WindowsⓘPermissions Required:AdministratorContributors:ExtraHop; Vincent Le TouxVersion:1.0Created:11 February 2020Last Modified:22 April 2021Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionC0027C0027DuringC0027,Scattered Spiderperformed domain replication.[10]G1006Earth LuscaEarth Luscahas used aDCSynccommand withMimikatzto retrieve credentials from an exploited controller.[11]G1004LAPSUS$LAPSUS$has used DCSync attacks to gather credentials for privilege escalation routines.[12]S0002MimikatzMimikatzperforms credential dumping to obtain account and password information useful in gaining access to additional systems and enterprise network resources. It contains functionality to acquire information about credentials in many ways, including from DCSync/NetSync.[13][8][14][15][16]C0014Operation WocaoDuringOperation Wocao, threat actors usedMimikatz's DCSync to dump credentials from the memory of the targeted system.[17]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29used privileged accounts to replicate directory service data with domain controllers.[18][19][20]MitigationsIDMitigationDescriptionM1015Active Directory ConfigurationManage the access control list for "Replicating Directory Changes" and other permissions associated with domain controller replication.[5][21]M1027Password PoliciesEnsure that local administrator accounts have complex, unique passwords across all systems on the network.M1026Privileged Account ManagementDo not put user or admin domain accounts in the local administrator groups across systems unless they are tightly controlled, as this is often equivalent to having a local administrator account with the same password on all systems. Follow best practices for design and administration of an enterprise network to limit privileged account use across administrative tiers.DetectionIDData SourceData ComponentDetectsDS0026Active DirectoryActive Directory Object AccessMonitor domain controller logs for replication requests and other unscheduled activity possibly associated with DCSync.[1][2][3]Note: Domain controllers may not log replication requests originating from the default domain controller account.[22]DS0029Network TrafficNetwork Traffic ContentMonitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).Network Traffic FlowMonitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.ReferencesMicrosoft. (2017, December 1). MS-DRSR Directory Replication Service (DRS) Remote Protocol. Retrieved December 4, 2017.Microsoft. (n.d.). IDL_DRSGetNCChanges (Opnum 3). Retrieved December 4, 2017.SambaWiki. (n.d.). DRSUAPI. Retrieved December 4, 2017.Wine API. (n.d.). samlib.dll. Retrieved December 4, 2017.Metcalf, S. (2015, September 25). Mimikatz DCSync Usage, Exploitation, and Detection. Retrieved August 7, 2017.Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved August 7, 2017.Warren, J. (2017, July 11). Manipulating User Passwords with Mimikatz. Retrieved December 4, 2017.Deply, B., Le Toux, V. (2016, June 5). module ~ lsadump. Retrieved August 7, 2017.Microsoft. (2017, December 1). MS-NRPC - Netlogon Remote Protocol. Retrieved December 6, 2017.Parisi, T. (2022, December 2). Not a SIMulation: CrowdStrike Investigations Reveal Intrusion Campaign Targeting Telco and BPO Companies. Retrieved June 30, 2023.Chen, J., et al. (2022). Delving Deep: An Analysis of Earth Lusca’s Operations. Retrieved July 1, 2022.MSTIC, DART, M365 Defender. (2022, March 24). DEV-0537 Criminal Actor Targeting Organizations for Data Exfiltration and Destruction. Retrieved May 17, 2022.Deply, B. (n.d.). Mimikatz. Retrieved September 29, 2015.Grafnetter, M. (2015, October 26). Retrieving DPAPI Backup Keys from Active Directory. Retrieved December 19, 2017.The Australian Cyber Security Centre (ACSC), the Canadian Centre for Cyber Security (CCCS), the New Zealand National Cyber Security Centre (NZ NCSC), CERT New Zealand, the UK National Cyber Security Centre (UK NCSC) and the US National Cybersecurity and Communications Integration Center (NCCIC). (2018, October 11). Joint report on publicly available hacking tools. Retrieved March 11, 2019.Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.Dantzig, M. v., Schamper, E. (2019, December 19). Operation Wocao: Shining a light on one of China’s hidden hacking groups. Retrieved October 8, 2020.Microsoft 365 Defender Team. (2020, December 28). Using Microsoft 365 Defender to protect against Solorigate. Retrieved January 7, 2021.MSTIC, CDOC, 365 Defender Research Team. (2021, January 20). Deep dive into the Solorigate second-stage activation: From SUNBURST to TEARDROP and Raindrop . Retrieved January 22, 2021.CrowdStrike. (2022, January 27). Early Bird Catches the Wormhole: Observations from the StellarParticle Campaign. Retrieved February 7, 2022.Microsoft. (n.d.). How to grant the "Replicating Directory Changes" permission for the Microsoft Metadirectory Services ADMA service account. Retrieved December 4, 2017.Schroeder, W. (2015, September 22). Mimikatz and DCSync and ExtraSids, Oh My. Retrieved December 4, 2017.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.