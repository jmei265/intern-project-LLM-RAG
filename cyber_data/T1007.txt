MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseSystem Service DiscoverySystem Service DiscoveryAdversaries may try to gather information about registered local system services. Adversaries may obtain information about services using tools as well as OS utility commands such assc query,tasklist /svc,systemctl --type=service, andnet start.Adversaries may use the information fromSystem Service Discoveryduring automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.ID:T1007Sub-techniques:No sub-techniquesⓘTactic:DiscoveryⓘPlatforms:Linux, Windows, macOSContributors:Harshal Tupsamudre, QualysVersion:1.5Created:31 May 2017Last Modified:03 April 2023Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0018admin@338admin@338actors used the following command following exploitation of a machine withLOWBALLmalware to obtain information about services:net start >> %temp%\download[1]G0006APT1APT1used the commandsnet startandtasklistto get a listing of the services on the system.[2]G0143Aquatic PandaAquatic Pandahas attempted to discover services for third party EDR products.[3]S0638BabukBabukcan enumerate all services running on a compromised host.[4]S0127BBSRATBBSRATcan query service configuration information.[5]S0570BitPaymerBitPaymercan enumerate existing Windows services on the host that are configured to run as LocalSystem.[6]S1070Black BastaBlack Bastacan check whether the service name FAX is present.[7]G0060BRONZE BUTLERBRONZE BUTLERhas used TROJ_GETVERSION to discover system services.[8]S0572Caterpillar WebShellCaterpillar WebShellcan obtain a list of the services from a system.[9]G0114ChimeraChimerahas usednet startandnet usefor system service discovery.[10]S0154Cobalt StrikeCobalt Strikecan enumerate services on compromised hosts.[11]S0244ComnieComnieruns the command:net start >> %TEMP%\info.daton a victim.[12]S0625CubaCubacan query service status usingQueryServiceStatusExfunction.[13]S1066DarkTortillaDarkTortillacan retrieve information about a compromised system's running services.[14]S0024DyreDyrehas the ability to identify running services on a compromised host.[15]G1006Earth LuscaEarth Luscahas usedTasklistto obtain information from a compromised host.[16]S0081EliseEliseexecutesnet startafter initial communication is made to the remote server.[17]S0082EmissaryEmissaryhas the capability to execute the commandnet startto interact with services.[18]S0091EpicEpicuses thetasklist /svccommand to list the services on the system.[19]S0049GeminiDukeGeminiDukecollects information on programs and services on the victim that are configured to automatically run at startup.[20]S0237GravityRATGravityRAThas a feature to list the available services on the system.[21]S0342GreyEnergyGreyEnergyenumerates all Windows services.[22]S1027Heyoka BackdoorHeyoka Backdoorcan check if it is running as a service on a compromised host.[23]S0431HotCroissantHotCroissanthas the ability to retrieve a list of services on the infected host.[24]S0203HydraqHydraqcreates a backdoor through which remote attackers can monitor services.[25][26]S0398HyperBroHyperBrocan list all services and their configurations.[27]G0119Indrik SpiderIndrik Spiderhas used the win32_service WMI class to retrieve a list of services from the system.[28]S0260InvisiMoleInvisiMolecan obtain running services on the victim.[29]S0015IxesheIxeshecan list running services.[30]S0201JPINJPINcan list running services.[31]S0283jRATjRATcan list local services.[32]G0004Ke3changKe3changperforms service discovery usingnet startcommands.[33]G0094KimsukyKimsukyhas used an instrumentor script to gather the names of all services running on a victim's system.[34]S0236KwampirsKwampirscollects a list of running services with the commandtasklist /svc.[35]S0582LookBackLookBackcan enumerate services on the victim machine.[36]S0039NetThenet startcommand can be used inNetto find information about Windows services.[37]G0049OilRigOilRighas usedsc queryon a victim to gather information about services.[38]C0012Operation CuckooBeesDuringOperation CuckooBees, the threat actors used thenet startcommand as part of their initial reconnaissance.[39]C0014Operation WocaoDuringOperation Wocao, threat actors used thetasklistcommand to search for one of its backdoors.[40]G0033Poseidon GroupAfter compromising a victim,Poseidon Groupdiscovers all running services.[41]S0378PoshC2PoshC2can enumerate service and service permission information.[42]S0629RainyDayRainyDaycan create and register a service for execution.[43]S0241RATANKBARATANKBAusestasklist /svcto display running tasks.[44]S0496REvilREvilcan enumerate active services.[45]S0085S-TypeS-Typeruns the commandnet starton a victim.[46]S1085SardonicSardonichas the ability to execute thenet startcommand.[47]S0692SILENTTRINITYSILENTTRINITYcan search for modifiable services that could be used for privilege escalation.[48]S0533SLOTHFULMEDIASLOTHFULMEDIAhas the capability to enumerate services.[49]S0615SombRATSombRATcan enumerate services on a victim machine.[50]S0559SUNBURSTSUNBURSTcollected a list of service names that were hashed using a FNV-1a + XOR algorithm to check against similarly-hashed hardcoded blocklists.[51]S0018SykipotSykipotmay usenet startto display running services.[52]S0242SynAckSynAckenumerates all running services.[53][54]S0663SysUpdateSysUpdatecan collect a list of services on a victim machine.[55]S0057TasklistTasklistcan be used to discover services running on a system.[56]G0139TeamTNTTeamTNThas searched for services such as Alibaba Cloud Security's aliyun service and BMC Helix Cloud Security's bmc-agent service in order to disable them.[57]S0266TrickBotTrickBotcollects a list of install programs and services on the system’s machine.[58]G0010TurlaTurlasurveys a system upon check-in to discover running services and associated processes using thetasklist /svccommand.[19]S0386UrsnifUrsnifhas gathered information about running services.[59]S0180VolgmerVolgmerqueries the system to identify existing services.[60]S0219WINERACKWINERACKcan enumerate services.[61]S0086ZLibZLibhas the ability to discover and manipulate Windows services.[46]S0412ZxShellZxShellcan check the services on the system.[62]MitigationsThis type of attack technique cannot be easily mitigated with preventive controls since
                                    it is based on the abuse of system features.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionMonitor executed commands and arguments that could be taken to gather system information related to services. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such asWindows Management InstrumentationandPowerShell.DS0009ProcessOS API ExecutionMonitor for API calls associated with gathering information about registered local system services, such as QueryServiceStatusEx. Other Windows API calls worth monitoring include EnumServicesStatusExA, which can be used to enumerate services in the service control manager database.Note: Most EDR tools do not support direct monitoring of API calls due to the sheer volume of calls produced by an endpoint but may have alerts or events that are based on abstractions of OS API calls. Dynamic malware analysis tools (i.e., sandboxes) can be used to trace the execution, including OS API calls, for a single PE binary.Process CreationMonitor for newly executed processes with arguments that may try to get information about registered services. System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.Note: Event IDs are for Sysmon (Event ID 1 - process create) and Windows Security Log (Event ID 4688 - a new process has been created). For event id 4688, depending on Windows version, you might need to enableAdministrative Templates\System\Audit Process Creation\Include command line in process creation eventsgroup policy to include command line in process creation events.Analytic 1 -  Suspicious Processes((source=WinEventLog:"Security" EventCode="4688") OR (source=WinEventLog:"Microsoft-Windows-Sysmon/Operational" EventCode="1") | WHERE ((CommandLine LIKE "%sc%" AND CommandLine LIKE "%query%") OR    (CommandLine LIKE "%tasklist%" AND CommandLine LIKE "%/svc%") OR   (CommandLine LIKE "%systemctl%" AND CommandLine LIKE "%--type=service%") OR   (CommandLine LIKE "%net%" AND CommandLine LIKE "%start%"))ReferencesFireEye Threat Intelligence. (2015, December 1). China-based Cyber Threat Group Uses Dropbox for Malware Communications and Targets Hong Kong Media Outlets. Retrieved December 4, 2015.Mandiant. (n.d.). APT1 Exposing One of China’s Cyber Espionage Units. Retrieved July 18, 2016.Wiley, B. et al. (2021, December 29). OverWatch Exposes AQUATIC PANDA in Possession of Log4Shell Exploit Tools During Hands-on Intrusion Attempt. Retrieved January 18, 2022.Mundo, A. et al. (2021, February). Technical Analysis of Babuk Ransomware. Retrieved August 11, 2021.Lee, B. Grunzweig, J. (2015, December 22). BBSRAT Attacks Targeting Russian Organizations Linked to Roaming Tiger. Retrieved August 19, 2016.Frankoff, S., Hartley, B. (2018, November 14). Big Game Hunting: The Evolution of INDRIK SPIDER From Dridex Wire Fraud to BitPaymer Targeted Ransomware. Retrieved January 6, 2021.Cyble. (2022, May 6). New ransomware variant targeting high-value organizations. Retrieved March 7, 2023.Chen, J. et al. (2019, November). Operation ENDTRADE: TICK’s Multi-Stage Backdoors for Attacking Industries and Stealing Classified Data. Retrieved June 9, 2020.ClearSky Cyber Security. (2021, January). “Lebanese Cedar” APT Global Lebanese Espionage Campaign Leveraging Web Servers. Retrieved February 10, 2021.Jansen, W . (2021, January 12). Abusing cloud services to fly under the radar. Retrieved January 19, 2021.Strategic Cyber LLC. (2020, November 5). Cobalt Strike: Advanced Threat Tactics for Penetration Testers. Retrieved April 13, 2021.Grunzweig, J. (2018, January 31). Comnie Continues to Target Organizations in East Asia. Retrieved June 7, 2018.Roccio, T., et al. (2021, April). Technical Analysis of Cuba Ransomware. Retrieved June 18, 2021.Secureworks Counter Threat Unit Research Team. (2022, August 17). DarkTortilla Malware Analysis. Retrieved November 3, 2022.hasherezade. (2015, November 4). A Technical Look At Dyreza. Retrieved June 15, 2020.Chen, J., et al. (2022). Delving Deep: An Analysis of Earth Lusca’s Operations. Retrieved July 1, 2022.Falcone, R., et al.. (2015, June 16). Operation Lotus Blossom. Retrieved February 15, 2016.Falcone, R. and Miller-Osborn, J. (2016, February 3). Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?. Retrieved February 15, 2016.Kaspersky Lab's Global Research and Analysis Team. (2014, August 7). The Epic Turla Operation: Solving some of the mysteries of Snake/Uroburos. Retrieved December 11, 2014.F-Secure Labs. (2015, September 17). The Dukes: 7 years of Russian cyberespionage. Retrieved December 10, 2015.Mercer, W., Rascagneres, P. (2018, April 26). GravityRAT - The Two-Year Evolution Of An APT Targeting India. Retrieved May 16, 2018.Cherepanov, A. (2018, October). GREYENERGY A successor to BlackEnergy. Retrieved November 15, 2018.Chen, Joey. (2022, June 9). Aoqin Dragon | Newly-Discovered Chinese-linked APT Has Been Quietly Spying On Organizations For 10 Years. Retrieved July 14, 2022.Knight, S.. (2020, April 16). VMware Carbon Black TAU Threat Analysis: The Evolution of Lazarus. Retrieved May 1, 2020.Symantec Security Response. (2010, January 18). The Trojan.Hydraq Incident. Retrieved February 20, 2018.Lelli, A. (2010, January 11). Trojan.Hydraq. Retrieved February 20, 2018.Falcone, R. and Lancaster, T. (2019, May 28). Emissary Panda Attacks Middle East Government Sharepoint Servers. Retrieved July 9, 2019.Symantec Threat Intelligence. (2020, June 25). WastedLocker: Symantec Identifies Wave of Attacks Against U.S. Organizations. Retrieved May 20, 2021.Hromcová, Z. (2018, June 07). InvisiMole: Surprisingly equipped spyware, undercover since 2013. Retrieved July 10, 2018.Sancho, D., et al. (2012, May 22). IXESHE An APT Campaign. Retrieved June 7, 2019.Windows Defender Advanced Threat Hunting Team. (2016, April 29). PLATINUM: Targeted attacks in South and Southeast Asia. Retrieved February 15, 2018.Kamluk, V. & Gostev, A. (2016, February). Adwind - A Cross-Platform RAT. Retrieved April 23, 2019.Villeneuve, N., Bennett, J. T., Moran, N., Haq, T., Scott, M., & Geers, K. (2014). OPERATION “KE3CHANG”: Targeted Attacks Against Ministries of Foreign Affairs. Retrieved November 12, 2014.An, J and Malhotra, A. (2021, November 10). North Korean attackers use malicious blogs to deliver malware to high-profile South Korean targets. Retrieved December 29, 2021.Symantec Security Response Attack Investigation Team. (2018, April 23). New Orangeworm attack group targets the healthcare sector in the U.S., Europe, and Asia. Retrieved May 8, 2018.Raggi, M. Schwarz, D.. (2019, August 1). LookBack Malware Targets the United States Utilities Sector with Phishing Attacks Impersonating Engineering Licensing Boards. Retrieved February 25, 2021.Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015.Falcone, R. and Lee, B.. (2016, May 26). The OilRig Campaign: Attacks on Saudi Arabian Organizations Deliver Helminth Backdoor. Retrieved May 3, 2017.Cybereason Nocturnus. (2022, May 4). Operation CuckooBees: Deep-Dive into Stealthy Winnti Techniques. Retrieved September 22, 2022.Dantzig, M. v., Schamper, E. (2019, December 19). Operation Wocao: Shining a light on one of China’s hidden hacking groups. Retrieved October 8, 2020.Kaspersky Lab's Global Research and Analysis Team. (2016, February 9). Poseidon Group: a Targeted Attack Boutique specializing in global cyber-espionage. Retrieved March 16, 2016.Nettitude. (2018, July 23). Python Server for PoshC2. Retrieved April 23, 2019.Vrabie, V. (2021, April 23). NAIKON – Traces from a Military Cyber-Espionage Operation. Retrieved June 29, 2021.Trend Micro. (2017, February 27). RATANKBA: Delving into Large-scale Watering Holes against Enterprises. Retrieved May 22, 2018.Intel 471 Malware Intelligence team. (2020, March 31). REvil Ransomware-as-a-Service – An analysis of a ransomware affiliate operation. Retrieved August 4, 2020.Gross, J. (2016, February 23). Operation Dust Storm. Retrieved December 22, 2021.Budaca, E., et al. (2021, August 25). FIN8 Threat Actor Goes Agile with New Sardonic Backdoor. Retrieved August 9, 2023.Salvati, M. (2019, August 6). SILENTTRINITY Modules. Retrieved March 24, 2022.DHS/CISA, Cyber National Mission Force. (2020, October 1). Malware Analysis Report (MAR) MAR-10303705-1.v1 – Remote Access Trojan: SLOTHFULMEDIA. Retrieved October 2, 2020.The BlackBerry Research and Intelligence Team. (2020, November 12). The CostaRicto Campaign: Cyber-Espionage Outsourced. Retrieved May 24, 2021.FireEye. (2020, December 13). Highly Evasive Attacker Leverages SolarWinds Supply Chain to Compromise Multiple Global Victims With SUNBURST Backdoor. Retrieved January 4, 2021.Blasco, J. (2011, December 12). Another Sykipot sample likely targeting US federal agencies. Retrieved March 28, 2016.Ivanov, A. et al. (2018, May 7). SynAck targeted ransomware uses the Doppelgänging technique. Retrieved May 22, 2018.Bettencourt, J. (2018, May 7). Kaspersky Lab finds new variant of SynAck ransomware using sophisticated Doppelgänging technique. Retrieved May 24, 2018.Daniel Lunghi. (2023, March 1). Iron Tiger’s SysUpdate Reappears, Adds Linux Targeting. Retrieved March 20, 2023.Microsoft. (n.d.). Tasklist. Retrieved December 23, 2015.Darin Smith. (2022, April 21). TeamTNT targeting AWS, Alibaba. Retrieved August 4, 2022.Salinas, M., Holguin, J. (2017, June). Evolution of Trickbot. Retrieved July 31, 2018.Caragay, R. (2015, March 26). URSNIF: The Multifaceted Malware. Retrieved June 5, 2019.US-CERT. (2017, November 22). Alert (TA17-318B): HIDDEN COBRA – North Korean Trojan: Volgmer. Retrieved December 7, 2017.FireEye. (2018, February 20). APT37 (Reaper): The Overlooked North Korean Actor. Retrieved March 1, 2018.Allievi, A., et al. (2014, October 28). Threat Spotlight: Group 72, Opening the ZxShell. Retrieved September 24, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.