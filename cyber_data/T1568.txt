MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseDynamic ResolutionDynamic ResolutionSub-techniques (3)IDNameT1568.001Fast Flux DNST1568.002Domain Generation AlgorithmsT1568.003DNS CalculationAdversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations. This may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications. These calculations can be used to dynamically adjust parameters such as the domain name, IP address, or port number the malware uses for command and control.Adversaries may use dynamic resolution for the purpose ofFallback Channels. When contact is lost with the primary command and control server malware may employ dynamic resolution as a means to reestablishing command and control.[1][2][3]ID:T1568Sub-techniques:T1568.001,T1568.002,T1568.003ⓘTactic:Command and ControlⓘPlatforms:Linux, Windows, macOSⓘPermissions Required:UserContributors:Chris RoffeVersion:1.0Created:10 March 2020Last Modified:11 March 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionG0016APT29APT29has used Dynamic DNS providers for their malware C2 infrastructure.[4]S1087AsyncRATAsyncRATcan be configured to use dynamic DNS.[5]S0268BisonalBisonalhas used a dynamic DNS service for C2.[6]G1002BITTERBITTERhas used DDNS for C2 communications.[7]C0026C0026DuringC0026, the threat actors re-registered a ClouDNS dynamic DNS subdomain which was previously used byANDROMEDA.[8]G0047Gamaredon GroupGamaredon Grouphas incorporated dynamic DNS domains in its infrastructure.[9]S0666GelsemiumGelsemiumcan use dynamic DNS domain names in C2.[10]S0449MazeMazehas forged POST strings with a random choice from a list of possibilities including "forum", "php", "view", etc. while making connection with the C2, hindering detection efforts.[11]S0034NETEAGLENETEAGLEcan use HTTP to download resources that contain an IP address and port number pair to connect to for C2.[12]C0002Night DragonDuringNight Dragon, threat actors used dynamic DNS services for C2.[13]C0016Operation Dust StormForOperation Dust Storm, the threat actors used dynamic DNS domains from a variety of free providers, including No-IP, Oray, and 3322.[14]C0005Operation SpalaxForOperation Spalax, the threat actors used dynamic DNS services, including Duck DNS and DNS Exit, as part of their C2 infrastructure.[15]S0148RTMRTMhas resolvedPonyC2 server IP addresses by either converting Bitcoin blockchain transaction data to specific octets, or accessing IP addresses directly within the Namecoin blockchain.[16][17]C0024SolarWinds CompromiseDuring theSolarWinds Compromise,APT29used dynamic DNS resolution to construct and resolve to randomly-generated subdomains for C2.[18]S0559SUNBURSTSUNBURSTdynamically resolved C2 infrastructure for randomly-generated subdomains within a parent domain.[19]G1018TA2541TA2541has used dynamic DNS services for C2 infrastructure.[20]S0671TomirisTomirishas connected to a signalization server that provides a URL and port, and thenTomirissends a GET request to that URL to establish C2.[21]G0134Transparent TribeTransparent Tribehas used dynamic DNS services to set up C2.[22]MitigationsIDMitigationDescriptionM1031Network Intrusion PreventionNetwork intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Malware researchers can reverse engineer malware variants that use dynamic resolution and determine future C2 infrastructure that the malware will attempt to contact, but this is a time and resource intensive effort.[23][24]M1021Restrict Web-Based ContentIn some cases a local DNS sinkhole may be used to help prevent behaviors associated with dynamic resolution.DetectionIDData SourceData ComponentDetectsDS0029Network TrafficNetwork Connection CreationMonitor for newly constructed network connections that are sent or received by untrusted hosts.Network Traffic ContentMonitor and analyze traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (e.g extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (e.g. monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).Network Traffic FlowMonitor network data for uncommon data flows. Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious.ReferencesBrumaghin, E. et al. (2017, September 18). CCleanup: A Vast Number of Machines at Risk. Retrieved March 9, 2018.Dunwoody, M.. (2017, April 3). Dissecting One of APT29’s Fileless WMI and PowerShell Backdoors (POSHSPY). Retrieved April 5, 2017.ESET. (2017, December 21). Sednit update: How Fancy Bear Spent the Year. Retrieved February 18, 2019.Mandiant. (2022, May 2). UNC3524: Eye Spy on Your Email. Retrieved August 17, 2023.Nyan-x-Cat. (n.d.). NYAN-x-CAT / AsyncRAT-C-Sharp. Retrieved October 3, 2023.Mercer, W., et al. (2020, March 5). Bisonal: 10 years of play. Retrieved January 26, 2022.Dela Paz, R. (2016, October 21). BITTER: a targeted attack against Pakistan. Retrieved June 1, 2022.Hawley, S. et al. (2023, February 2). Turla: A Galaxy of Opportunity. Retrieved May 15, 2023.Unit 42. (2022, February 3). Russia’s Gamaredon aka Primitive Bear APT Group Actively Targeting Ukraine. Retrieved February 21, 2022.Dupuy, T. and Faou, M. (2021, June). Gelsemium. Retrieved November 30, 2021.Mundo, A. (2020, March 26). Ransomware Maze. Retrieved May 18, 2020.FireEye Labs. (2015, April). APT30 AND THE MECHANICS OF A LONG-RUNNING CYBER ESPIONAGE OPERATION. Retrieved May 1, 2015.McAfee® Foundstone® Professional Services and McAfee Labs™. (2011, February 10). Global Energy Cyberattacks: “Night Dragon”. Retrieved February 19, 2018.Gross, J. (2016, February 23). Operation Dust Storm. Retrieved December 22, 2021.M. Porolli. (2021, January 21). Operation Spalax: Targeted malware attacks in Colombia. Retrieved September 16, 2022.Eisenkraft, K., Olshtein, A. (2019, October 17). Pony’s C&C servers hidden inside the Bitcoin blockchain. Retrieved June 15, 2020.Duncan, B., Harbison, M. (2019, January 23). Russian Language Malspam Pushing Redaman Banking Malware. Retrieved June 16, 2020.Cash, D. et al. (2020, December 14). Dark Halo Leverages SolarWinds Compromise to Breach Organizations. Retrieved December 29, 2020.FireEye. (2020, December 13). Highly Evasive Attacker Leverages SolarWinds Supply Chain to Compromise Multiple Global Victims With SUNBURST Backdoor. Retrieved January 4, 2021.Larson, S. and Wise, J. (2022, February 15). Charting TA2541's Flight. Retrieved September 12, 2023.Kwiatkoswki, I. and Delcher, P. (2021, September 29). DarkHalo After SolarWinds: the Tomiris connection. Retrieved December 27, 2021.Huss, D. (2016, March 1). Operation Transparent Tribe. Retrieved June 8, 2016.Sternfeld, U. (2016). Dissecting Domain Generation Algorithms: Eight Real World DGA Variants. Retrieved February 18, 2019.Kasza, A. (2015, February 18). Using Algorithms to Brute Force Algorithms. Retrieved February 18, 2019.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.