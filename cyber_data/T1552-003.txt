MatricesEnterpriseMobileICSTacticsEnterpriseMobileICSTechniquesEnterpriseMobileICSDefensesData SourcesMitigationsEnterpriseMobileICSAssetsCTIGroupsSoftwareCampaignsResourcesGet StartedLearn More about ATT&CKATT&CKconATT&CK Data & ToolsFAQEngage with ATT&CKVersion HistoryLegal & BrandingBenefactorsBlogSearchATT&CKcon 5.0 returns October 22-23, 2024 in McLean, VA.Register heretoday!HomeTechniquesEnterpriseUnsecured CredentialsBash HistoryUnsecured Credentials:Bash HistoryOther sub-techniques of Unsecured Credentials (8)IDNameT1552.001Credentials In FilesT1552.002Credentials in RegistryT1552.003Bash HistoryT1552.004Private KeysT1552.005Cloud Instance Metadata APIT1552.006Group Policy PreferencesT1552.007Container APIT1552.008Chat MessagesAdversaries may search the bash command history on compromised systems for insecurely stored credentials. Bash keeps track of the commands users type on the command-line with the "history" utility. Once a user logs out, the history is flushed to the user’s.bash_historyfile. For each user, this file resides at the same location:~/.bash_history. Typically, this file keeps track of the user’s last 500 commands. Users often type usernames and passwords on the command-line as parameters to programs, which then get saved to this file when they log out. Adversaries can abuse this by looking through the file for potential credentials.[1]ID:T1552.003Sub-technique of:T1552ⓘTactic:Credential AccessⓘPlatforms:Linux, macOSⓘPermissions Required:UserVersion:1.1Created:04 February 2020Last Modified:08 March 2022Version PermalinkLive VersionProcedure ExamplesIDNameDescriptionS0599KinsingKinsinghas searchedbash_historyfor credentials.[2]MitigationsIDMitigationDescriptionM1028Operating System ConfigurationThere are multiple methods of preventing a user's command history from being flushed to their .bash_history file, including use of the following commands:set +o historyandset -o historyto start logging again;unset HISTFILEbeing added to a user's .bash_rc file; andln -s /dev/null ~/.bash_historyto write commands to/dev/nullinstead.DetectionIDData SourceData ComponentDetectsDS0017CommandCommand ExecutionWhile users do typically rely on their history of commands, they often access this history through other utilities like "history" instead of commands likecat ~/.bash_history.DS0022FileFile AccessMonitoring when the user's.bash_historyis read can help alert to suspicious activity.ReferencesAlex Rymdeko-Harvey, Steve Borosh. (2016, May 14). External to DA, the OS X Way. Retrieved July 3, 2017.Singer, G. (2020, April 3). Threat Alert: Kinsing Malware Attacks Targeting Container Environments. Retrieved April 1, 2021.×load more resultsContact UsTerms of UsePrivacy PolicyWebsite Changelog© 2015 - 2024, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.